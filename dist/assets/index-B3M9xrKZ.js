(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var pa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function Qx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function IT(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var e2={exports:{}},Bh={},t2={exports:{}},Mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qu=Symbol.for("react.element"),DT=Symbol.for("react.portal"),PT=Symbol.for("react.fragment"),RT=Symbol.for("react.strict_mode"),jT=Symbol.for("react.profiler"),FT=Symbol.for("react.provider"),LT=Symbol.for("react.context"),MT=Symbol.for("react.forward_ref"),BT=Symbol.for("react.suspense"),$T=Symbol.for("react.memo"),UT=Symbol.for("react.lazy"),gy=Symbol.iterator;function zT(e){return e===null||typeof e!="object"?null:(e=gy&&e[gy]||e["@@iterator"],typeof e=="function"?e:null)}var r2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},n2=Object.assign,a2={};function Xl(e,t,r){this.props=e,this.context=t,this.refs=a2,this.updater=r||r2}Xl.prototype.isReactComponent={};Xl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function s2(){}s2.prototype=Xl.prototype;function jg(e,t,r){this.props=e,this.context=t,this.refs=a2,this.updater=r||r2}var Fg=jg.prototype=new s2;Fg.constructor=jg;n2(Fg,Xl.prototype);Fg.isPureReactComponent=!0;var vy=Array.isArray,i2=Object.prototype.hasOwnProperty,Lg={current:null},o2={key:!0,ref:!0,__self:!0,__source:!0};function l2(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)i2.call(t,n)&&!o2.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:qu,type:e,key:s,ref:i,props:a,_owner:Lg.current}}function VT(e,t){return{$$typeof:qu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Mg(e){return typeof e=="object"&&e!==null&&e.$$typeof===qu}function WT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var yy=/\/+/g;function ep(e,t){return typeof e=="object"&&e!==null&&e.key!=null?WT(""+e.key):t.toString(36)}function gd(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case qu:case DT:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+ep(i,0):n,vy(a)?(r="",e!=null&&(r=e.replace(yy,"$&/")+"/"),gd(a,t,r,"",function(c){return c})):a!=null&&(Mg(a)&&(a=VT(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(yy,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",vy(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+ep(s,o);i+=gd(s,t,r,l,a)}else if(l=zT(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+ep(s,o++),i+=gd(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function If(e,t,r){if(e==null)return e;var n=[],a=0;return gd(e,n,"","",function(s){return t.call(r,s,a++)}),n}function HT(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Kn={current:null},vd={transition:null},KT={ReactCurrentDispatcher:Kn,ReactCurrentBatchConfig:vd,ReactCurrentOwner:Lg};function c2(){throw Error("act(...) is not supported in production builds of React.")}Mt.Children={map:If,forEach:function(e,t,r){If(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return If(e,function(){t++}),t},toArray:function(e){return If(e,function(t){return t})||[]},only:function(e){if(!Mg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Mt.Component=Xl;Mt.Fragment=PT;Mt.Profiler=jT;Mt.PureComponent=jg;Mt.StrictMode=RT;Mt.Suspense=BT;Mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KT;Mt.act=c2;Mt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=n2({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Lg.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)i2.call(t,l)&&!o2.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:qu,type:e.type,key:a,ref:s,props:n,_owner:i}};Mt.createContext=function(e){return e={$$typeof:LT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:FT,_context:e},e.Consumer=e};Mt.createElement=l2;Mt.createFactory=function(e){var t=l2.bind(null,e);return t.type=e,t};Mt.createRef=function(){return{current:null}};Mt.forwardRef=function(e){return{$$typeof:MT,render:e}};Mt.isValidElement=Mg;Mt.lazy=function(e){return{$$typeof:UT,_payload:{_status:-1,_result:e},_init:HT}};Mt.memo=function(e,t){return{$$typeof:$T,type:e,compare:t===void 0?null:t}};Mt.startTransition=function(e){var t=vd.transition;vd.transition={};try{e()}finally{vd.transition=t}};Mt.unstable_act=c2;Mt.useCallback=function(e,t){return Kn.current.useCallback(e,t)};Mt.useContext=function(e){return Kn.current.useContext(e)};Mt.useDebugValue=function(){};Mt.useDeferredValue=function(e){return Kn.current.useDeferredValue(e)};Mt.useEffect=function(e,t){return Kn.current.useEffect(e,t)};Mt.useId=function(){return Kn.current.useId()};Mt.useImperativeHandle=function(e,t,r){return Kn.current.useImperativeHandle(e,t,r)};Mt.useInsertionEffect=function(e,t){return Kn.current.useInsertionEffect(e,t)};Mt.useLayoutEffect=function(e,t){return Kn.current.useLayoutEffect(e,t)};Mt.useMemo=function(e,t){return Kn.current.useMemo(e,t)};Mt.useReducer=function(e,t,r){return Kn.current.useReducer(e,t,r)};Mt.useRef=function(e){return Kn.current.useRef(e)};Mt.useState=function(e){return Kn.current.useState(e)};Mt.useSyncExternalStore=function(e,t,r){return Kn.current.useSyncExternalStore(e,t,r)};Mt.useTransition=function(){return Kn.current.useTransition()};Mt.version="18.3.1";t2.exports=Mt;var j=t2.exports;const Jt=Qx(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qT=j,GT=Symbol.for("react.element"),XT=Symbol.for("react.fragment"),ZT=Object.prototype.hasOwnProperty,YT=qT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JT={key:!0,ref:!0,__self:!0,__source:!0};function u2(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)ZT.call(t,n)&&!JT.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:GT,type:e,key:s,ref:i,props:a,_owner:YT.current}}Bh.Fragment=XT;Bh.jsx=u2;Bh.jsxs=u2;e2.exports=Bh;var m=e2.exports,f2={exports:{}},va={},d2={exports:{}},h2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Ce,Z){var Se=Ce.length;Ce.push(Z);e:for(;0<Se;){var Ve=Se-1>>>1,B=Ce[Ve];if(0<a(B,Z))Ce[Ve]=Z,Ce[Se]=B,Se=Ve;else break e}}function r(Ce){return Ce.length===0?null:Ce[0]}function n(Ce){if(Ce.length===0)return null;var Z=Ce[0],Se=Ce.pop();if(Se!==Z){Ce[0]=Se;e:for(var Ve=0,B=Ce.length,J=B>>>1;Ve<J;){var K=2*(Ve+1)-1,X=Ce[K],ge=K+1,Pe=Ce[ge];if(0>a(X,Se))ge<B&&0>a(Pe,X)?(Ce[Ve]=Pe,Ce[ge]=Se,Ve=ge):(Ce[Ve]=X,Ce[K]=Se,Ve=K);else if(ge<B&&0>a(Pe,Se))Ce[Ve]=Pe,Ce[ge]=Se,Ve=ge;else break e}}return Z}function a(Ce,Z){var Se=Ce.sortIndex-Z.sortIndex;return Se!==0?Se:Ce.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,d=null,h=3,v=!1,y=!1,p=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Ce){for(var Z=r(c);Z!==null;){if(Z.callback===null)n(c);else if(Z.startTime<=Ce)n(c),Z.sortIndex=Z.expirationTime,t(l,Z);else break;Z=r(c)}}function E(Ce){if(p=!1,w(Ce),!y)if(r(l)!==null)y=!0,ke(I);else{var Z=r(c);Z!==null&&Oe(E,Z.startTime-Ce)}}function I(Ce,Z){y=!1,p&&(p=!1,x(V),V=-1),v=!0;var Se=h;try{for(w(Z),d=r(l);d!==null&&(!(d.expirationTime>Z)||Ce&&!re());){var Ve=d.callback;if(typeof Ve=="function"){d.callback=null,h=d.priorityLevel;var B=Ve(d.expirationTime<=Z);Z=e.unstable_now(),typeof B=="function"?d.callback=B:d===r(l)&&n(l),w(Z)}else n(l);d=r(l)}if(d!==null)var J=!0;else{var K=r(c);K!==null&&Oe(E,K.startTime-Z),J=!1}return J}finally{d=null,h=Se,v=!1}}var D=!1,C=null,V=-1,z=5,ee=-1;function re(){return!(e.unstable_now()-ee<z)}function G(){if(C!==null){var Ce=e.unstable_now();ee=Ce;var Z=!0;try{Z=C(!0,Ce)}finally{Z?me():(D=!1,C=null)}}else D=!1}var me;if(typeof k=="function")me=function(){k(G)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Ae=Ee.port2;Ee.port1.onmessage=G,me=function(){Ae.postMessage(null)}}else me=function(){_(G,0)};function ke(Ce){C=Ce,D||(D=!0,me())}function Oe(Ce,Z){V=_(function(){Ce(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ce){Ce.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,ke(I))},e.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<Ce?Math.floor(1e3/Ce):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(Ce){switch(h){case 1:case 2:case 3:var Z=3;break;default:Z=h}var Se=h;h=Z;try{return Ce()}finally{h=Se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ce,Z){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var Se=h;h=Ce;try{return Z()}finally{h=Se}},e.unstable_scheduleCallback=function(Ce,Z,Se){var Ve=e.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?Ve+Se:Ve):Se=Ve,Ce){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Se+B,Ce={id:u++,callback:Z,priorityLevel:Ce,startTime:Se,expirationTime:B,sortIndex:-1},Se>Ve?(Ce.sortIndex=Se,t(c,Ce),r(l)===null&&Ce===r(c)&&(p?(x(V),V=-1):p=!0,Oe(E,Se-Ve))):(Ce.sortIndex=B,t(l,Ce),y||v||(y=!0,ke(I))),Ce},e.unstable_shouldYield=re,e.unstable_wrapCallback=function(Ce){var Z=h;return function(){var Se=h;h=Z;try{return Ce.apply(this,arguments)}finally{h=Se}}}})(h2);d2.exports=h2;var QT=d2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e3=j,ma=QT;function ze(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p2=new Set,du={};function Po(e,t){Ll(e,t),Ll(e+"Capture",t)}function Ll(e,t){for(du[e]=t,e=0;e<t.length;e++)p2.add(t[e])}var Hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),im=Object.prototype.hasOwnProperty,t3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_y={},wy={};function r3(e){return im.call(wy,e)?!0:im.call(_y,e)?!1:t3.test(e)?wy[e]=!0:(_y[e]=!0,!1)}function n3(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function a3(e,t,r,n){if(t===null||typeof t>"u"||n3(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function qn(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var yn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){yn[e]=new qn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];yn[t]=new qn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){yn[e]=new qn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){yn[e]=new qn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){yn[e]=new qn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){yn[e]=new qn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){yn[e]=new qn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){yn[e]=new qn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){yn[e]=new qn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Bg=/[\-:]([a-z])/g;function $g(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Bg,$g);yn[t]=new qn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Bg,$g);yn[t]=new qn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Bg,$g);yn[t]=new qn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){yn[e]=new qn(e,1,!1,e.toLowerCase(),null,!1,!1)});yn.xlinkHref=new qn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){yn[e]=new qn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ug(e,t,r,n){var a=yn.hasOwnProperty(t)?yn[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(a3(t,r,a,n)&&(r=null),n||a===null?r3(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Js=e3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Df=Symbol.for("react.element"),fl=Symbol.for("react.portal"),dl=Symbol.for("react.fragment"),zg=Symbol.for("react.strict_mode"),om=Symbol.for("react.profiler"),m2=Symbol.for("react.provider"),g2=Symbol.for("react.context"),Vg=Symbol.for("react.forward_ref"),lm=Symbol.for("react.suspense"),cm=Symbol.for("react.suspense_list"),Wg=Symbol.for("react.memo"),hi=Symbol.for("react.lazy"),v2=Symbol.for("react.offscreen"),xy=Symbol.iterator;function yc(e){return e===null||typeof e!="object"?null:(e=xy&&e[xy]||e["@@iterator"],typeof e=="function"?e:null)}var Sr=Object.assign,tp;function jc(e){if(tp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);tp=t&&t[1]||""}return`
`+tp+e}var rp=!1;function np(e,t){if(!e||rp)return"";rp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{rp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?jc(e):""}function s3(e){switch(e.tag){case 5:return jc(e.type);case 16:return jc("Lazy");case 13:return jc("Suspense");case 19:return jc("SuspenseList");case 0:case 2:case 15:return e=np(e.type,!1),e;case 11:return e=np(e.type.render,!1),e;case 1:return e=np(e.type,!0),e;default:return""}}function um(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case dl:return"Fragment";case fl:return"Portal";case om:return"Profiler";case zg:return"StrictMode";case lm:return"Suspense";case cm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case g2:return(e.displayName||"Context")+".Consumer";case m2:return(e._context.displayName||"Context")+".Provider";case Vg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Wg:return t=e.displayName||null,t!==null?t:um(e.type)||"Memo";case hi:t=e._payload,e=e._init;try{return um(e(t))}catch{}}return null}function i3(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return um(t);case 8:return t===zg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Pi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function y2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function o3(e){var t=y2(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pf(e){e._valueTracker||(e._valueTracker=o3(e))}function _2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=y2(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function jd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function fm(e,t){var r=t.checked;return Sr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function ky(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Pi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function w2(e,t){t=t.checked,t!=null&&Ug(e,"checked",t,!1)}function dm(e,t){w2(e,t);var r=Pi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hm(e,t.type,r):t.hasOwnProperty("defaultValue")&&hm(e,t.type,Pi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function by(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function hm(e,t,r){(t!=="number"||jd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Fc=Array.isArray;function Tl(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Pi(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function pm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ze(91));return Sr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Sy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ze(92));if(Fc(r)){if(1<r.length)throw Error(ze(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Pi(r)}}function x2(e,t){var r=Pi(t.value),n=Pi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Ey(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function k2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?k2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Rf,b2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Rf=Rf||document.createElement("div"),Rf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Rf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function hu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Wc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},l3=["Webkit","ms","Moz","O"];Object.keys(Wc).forEach(function(e){l3.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Wc[t]=Wc[e]})});function S2(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Wc.hasOwnProperty(e)&&Wc[e]?(""+t).trim():t+"px"}function E2(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=S2(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var c3=Sr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gm(e,t){if(t){if(c3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ze(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ze(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ze(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ze(62))}}function vm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ym=null;function Hg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _m=null,Cl=null,Nl=null;function Ty(e){if(e=Zu(e)){if(typeof _m!="function")throw Error(ze(280));var t=e.stateNode;t&&(t=Wh(t),_m(e.stateNode,e.type,t))}}function T2(e){Cl?Nl?Nl.push(e):Nl=[e]:Cl=e}function C2(){if(Cl){var e=Cl,t=Nl;if(Nl=Cl=null,Ty(e),t)for(e=0;e<t.length;e++)Ty(t[e])}}function N2(e,t){return e(t)}function A2(){}var ap=!1;function O2(e,t,r){if(ap)return e(t,r);ap=!0;try{return N2(e,t,r)}finally{ap=!1,(Cl!==null||Nl!==null)&&(A2(),C2())}}function pu(e,t){var r=e.stateNode;if(r===null)return null;var n=Wh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ze(231,t,typeof r));return r}var wm=!1;if(Hs)try{var _c={};Object.defineProperty(_c,"passive",{get:function(){wm=!0}}),window.addEventListener("test",_c,_c),window.removeEventListener("test",_c,_c)}catch{wm=!1}function u3(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Hc=!1,Fd=null,Ld=!1,xm=null,f3={onError:function(e){Hc=!0,Fd=e}};function d3(e,t,r,n,a,s,i,o,l){Hc=!1,Fd=null,u3.apply(f3,arguments)}function h3(e,t,r,n,a,s,i,o,l){if(d3.apply(this,arguments),Hc){if(Hc){var c=Fd;Hc=!1,Fd=null}else throw Error(ze(198));Ld||(Ld=!0,xm=c)}}function Ro(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function I2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Cy(e){if(Ro(e)!==e)throw Error(ze(188))}function p3(e){var t=e.alternate;if(!t){if(t=Ro(e),t===null)throw Error(ze(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Cy(a),e;if(s===n)return Cy(a),t;s=s.sibling}throw Error(ze(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(ze(189))}}if(r.alternate!==n)throw Error(ze(190))}if(r.tag!==3)throw Error(ze(188));return r.stateNode.current===r?e:t}function D2(e){return e=p3(e),e!==null?P2(e):null}function P2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=P2(e);if(t!==null)return t;e=e.sibling}return null}var R2=ma.unstable_scheduleCallback,Ny=ma.unstable_cancelCallback,m3=ma.unstable_shouldYield,g3=ma.unstable_requestPaint,jr=ma.unstable_now,v3=ma.unstable_getCurrentPriorityLevel,Kg=ma.unstable_ImmediatePriority,j2=ma.unstable_UserBlockingPriority,Md=ma.unstable_NormalPriority,y3=ma.unstable_LowPriority,F2=ma.unstable_IdlePriority,$h=null,xs=null;function _3(e){if(xs&&typeof xs.onCommitFiberRoot=="function")try{xs.onCommitFiberRoot($h,e,void 0,(e.current.flags&128)===128)}catch{}}var Ya=Math.clz32?Math.clz32:k3,w3=Math.log,x3=Math.LN2;function k3(e){return e>>>=0,e===0?32:31-(w3(e)/x3|0)|0}var jf=64,Ff=4194304;function Lc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Bd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Lc(o):(s&=i,s!==0&&(n=Lc(s)))}else i=r&~a,i!==0?n=Lc(i):s!==0&&(n=Lc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ya(t),a=1<<r,n|=e[r],t&=~a;return n}function b3(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S3(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Ya(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=b3(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function km(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function L2(){var e=jf;return jf<<=1,!(jf&4194240)&&(jf=64),e}function sp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Gu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ya(t),e[t]=r}function E3(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Ya(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function qg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ya(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var er=0;function M2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var B2,Gg,$2,U2,z2,bm=!1,Lf=[],Ei=null,Ti=null,Ci=null,mu=new Map,gu=new Map,mi=[],T3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ay(e,t){switch(e){case"focusin":case"focusout":Ei=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":Ci=null;break;case"pointerover":case"pointerout":mu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gu.delete(t.pointerId)}}function wc(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=Zu(t),t!==null&&Gg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function C3(e,t,r,n,a){switch(t){case"focusin":return Ei=wc(Ei,e,t,r,n,a),!0;case"dragenter":return Ti=wc(Ti,e,t,r,n,a),!0;case"mouseover":return Ci=wc(Ci,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return mu.set(s,wc(mu.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,gu.set(s,wc(gu.get(s)||null,e,t,r,n,a)),!0}return!1}function V2(e){var t=lo(e.target);if(t!==null){var r=Ro(t);if(r!==null){if(t=r.tag,t===13){if(t=I2(r),t!==null){e.blockedOn=t,z2(e.priority,function(){$2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function yd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Sm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);ym=n,r.target.dispatchEvent(n),ym=null}else return t=Zu(r),t!==null&&Gg(t),e.blockedOn=r,!1;t.shift()}return!0}function Oy(e,t,r){yd(e)&&r.delete(t)}function N3(){bm=!1,Ei!==null&&yd(Ei)&&(Ei=null),Ti!==null&&yd(Ti)&&(Ti=null),Ci!==null&&yd(Ci)&&(Ci=null),mu.forEach(Oy),gu.forEach(Oy)}function xc(e,t){e.blockedOn===t&&(e.blockedOn=null,bm||(bm=!0,ma.unstable_scheduleCallback(ma.unstable_NormalPriority,N3)))}function vu(e){function t(a){return xc(a,e)}if(0<Lf.length){xc(Lf[0],e);for(var r=1;r<Lf.length;r++){var n=Lf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ei!==null&&xc(Ei,e),Ti!==null&&xc(Ti,e),Ci!==null&&xc(Ci,e),mu.forEach(t),gu.forEach(t),r=0;r<mi.length;r++)n=mi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<mi.length&&(r=mi[0],r.blockedOn===null);)V2(r),r.blockedOn===null&&mi.shift()}var Al=Js.ReactCurrentBatchConfig,$d=!0;function A3(e,t,r,n){var a=er,s=Al.transition;Al.transition=null;try{er=1,Xg(e,t,r,n)}finally{er=a,Al.transition=s}}function O3(e,t,r,n){var a=er,s=Al.transition;Al.transition=null;try{er=4,Xg(e,t,r,n)}finally{er=a,Al.transition=s}}function Xg(e,t,r,n){if($d){var a=Sm(e,t,r,n);if(a===null)mp(e,t,n,Ud,r),Ay(e,n);else if(C3(a,e,t,r,n))n.stopPropagation();else if(Ay(e,n),t&4&&-1<T3.indexOf(e)){for(;a!==null;){var s=Zu(a);if(s!==null&&B2(s),s=Sm(e,t,r,n),s===null&&mp(e,t,n,Ud,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else mp(e,t,n,null,r)}}var Ud=null;function Sm(e,t,r,n){if(Ud=null,e=Hg(n),e=lo(e),e!==null)if(t=Ro(e),t===null)e=null;else if(r=t.tag,r===13){if(e=I2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ud=e,null}function W2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(v3()){case Kg:return 1;case j2:return 4;case Md:case y3:return 16;case F2:return 536870912;default:return 16}default:return 16}}var xi=null,Zg=null,_d=null;function H2(){if(_d)return _d;var e,t=Zg,r=t.length,n,a="value"in xi?xi.value:xi.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return _d=a.slice(e,1<n?1-n:void 0)}function wd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Mf(){return!0}function Iy(){return!1}function ya(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Mf:Iy,this.isPropagationStopped=Iy,this}return Sr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Mf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Mf)},persist:function(){},isPersistent:Mf}),t}var Zl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yg=ya(Zl),Xu=Sr({},Zl,{view:0,detail:0}),I3=ya(Xu),ip,op,kc,Uh=Sr({},Xu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==kc&&(kc&&e.type==="mousemove"?(ip=e.screenX-kc.screenX,op=e.screenY-kc.screenY):op=ip=0,kc=e),ip)},movementY:function(e){return"movementY"in e?e.movementY:op}}),Dy=ya(Uh),D3=Sr({},Uh,{dataTransfer:0}),P3=ya(D3),R3=Sr({},Xu,{relatedTarget:0}),lp=ya(R3),j3=Sr({},Zl,{animationName:0,elapsedTime:0,pseudoElement:0}),F3=ya(j3),L3=Sr({},Zl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),M3=ya(L3),B3=Sr({},Zl,{data:0}),Py=ya(B3),$3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},U3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function V3(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=z3[e])?!!t[e]:!1}function Jg(){return V3}var W3=Sr({},Xu,{key:function(e){if(e.key){var t=$3[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?U3[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jg,charCode:function(e){return e.type==="keypress"?wd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),H3=ya(W3),K3=Sr({},Uh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ry=ya(K3),q3=Sr({},Xu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jg}),G3=ya(q3),X3=Sr({},Zl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Z3=ya(X3),Y3=Sr({},Uh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),J3=ya(Y3),Q3=[9,13,27,32],Qg=Hs&&"CompositionEvent"in window,Kc=null;Hs&&"documentMode"in document&&(Kc=document.documentMode);var e6=Hs&&"TextEvent"in window&&!Kc,K2=Hs&&(!Qg||Kc&&8<Kc&&11>=Kc),jy=" ",Fy=!1;function q2(e,t){switch(e){case"keyup":return Q3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function G2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hl=!1;function t6(e,t){switch(e){case"compositionend":return G2(t);case"keypress":return t.which!==32?null:(Fy=!0,jy);case"textInput":return e=t.data,e===jy&&Fy?null:e;default:return null}}function r6(e,t){if(hl)return e==="compositionend"||!Qg&&q2(e,t)?(e=H2(),_d=Zg=xi=null,hl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return K2&&t.locale!=="ko"?null:t.data;default:return null}}var n6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ly(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!n6[e.type]:t==="textarea"}function X2(e,t,r,n){T2(n),t=zd(t,"onChange"),0<t.length&&(r=new Yg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var qc=null,yu=null;function a6(e){ik(e,0)}function zh(e){var t=gl(e);if(_2(t))return e}function s6(e,t){if(e==="change")return t}var Z2=!1;if(Hs){var cp;if(Hs){var up="oninput"in document;if(!up){var My=document.createElement("div");My.setAttribute("oninput","return;"),up=typeof My.oninput=="function"}cp=up}else cp=!1;Z2=cp&&(!document.documentMode||9<document.documentMode)}function By(){qc&&(qc.detachEvent("onpropertychange",Y2),yu=qc=null)}function Y2(e){if(e.propertyName==="value"&&zh(yu)){var t=[];X2(t,yu,e,Hg(e)),O2(a6,t)}}function i6(e,t,r){e==="focusin"?(By(),qc=t,yu=r,qc.attachEvent("onpropertychange",Y2)):e==="focusout"&&By()}function o6(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zh(yu)}function l6(e,t){if(e==="click")return zh(t)}function c6(e,t){if(e==="input"||e==="change")return zh(t)}function u6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ts=typeof Object.is=="function"?Object.is:u6;function _u(e,t){if(ts(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!im.call(t,a)||!ts(e[a],t[a]))return!1}return!0}function $y(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Uy(e,t){var r=$y(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$y(r)}}function J2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?J2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Q2(){for(var e=window,t=jd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=jd(e.document)}return t}function e1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function f6(e){var t=Q2(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&J2(r.ownerDocument.documentElement,r)){if(n!==null&&e1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Uy(r,s);var i=Uy(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var d6=Hs&&"documentMode"in document&&11>=document.documentMode,pl=null,Em=null,Gc=null,Tm=!1;function zy(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Tm||pl==null||pl!==jd(n)||(n=pl,"selectionStart"in n&&e1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Gc&&_u(Gc,n)||(Gc=n,n=zd(Em,"onSelect"),0<n.length&&(t=new Yg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=pl)))}function Bf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ml={animationend:Bf("Animation","AnimationEnd"),animationiteration:Bf("Animation","AnimationIteration"),animationstart:Bf("Animation","AnimationStart"),transitionend:Bf("Transition","TransitionEnd")},fp={},ek={};Hs&&(ek=document.createElement("div").style,"AnimationEvent"in window||(delete ml.animationend.animation,delete ml.animationiteration.animation,delete ml.animationstart.animation),"TransitionEvent"in window||delete ml.transitionend.transition);function Vh(e){if(fp[e])return fp[e];if(!ml[e])return e;var t=ml[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ek)return fp[e]=t[r];return e}var tk=Vh("animationend"),rk=Vh("animationiteration"),nk=Vh("animationstart"),ak=Vh("transitionend"),sk=new Map,Vy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bi(e,t){sk.set(e,t),Po(t,[e])}for(var dp=0;dp<Vy.length;dp++){var hp=Vy[dp],h6=hp.toLowerCase(),p6=hp[0].toUpperCase()+hp.slice(1);Bi(h6,"on"+p6)}Bi(tk,"onAnimationEnd");Bi(rk,"onAnimationIteration");Bi(nk,"onAnimationStart");Bi("dblclick","onDoubleClick");Bi("focusin","onFocus");Bi("focusout","onBlur");Bi(ak,"onTransitionEnd");Ll("onMouseEnter",["mouseout","mouseover"]);Ll("onMouseLeave",["mouseout","mouseover"]);Ll("onPointerEnter",["pointerout","pointerover"]);Ll("onPointerLeave",["pointerout","pointerover"]);Po("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Po("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Po("onBeforeInput",["compositionend","keypress","textInput","paste"]);Po("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Po("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Po("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m6=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mc));function Wy(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,h3(n,t,void 0,e),e.currentTarget=null}function ik(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;Wy(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;Wy(a,o,c),s=l}}}if(Ld)throw e=xm,Ld=!1,xm=null,e}function ur(e,t){var r=t[Im];r===void 0&&(r=t[Im]=new Set);var n=e+"__bubble";r.has(n)||(ok(t,e,2,!1),r.add(n))}function pp(e,t,r){var n=0;t&&(n|=4),ok(r,e,n,t)}var $f="_reactListening"+Math.random().toString(36).slice(2);function wu(e){if(!e[$f]){e[$f]=!0,p2.forEach(function(r){r!=="selectionchange"&&(m6.has(r)||pp(r,!1,e),pp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$f]||(t[$f]=!0,pp("selectionchange",!1,t))}}function ok(e,t,r,n){switch(W2(t)){case 1:var a=A3;break;case 4:a=O3;break;default:a=Xg}r=a.bind(null,t,r,e),a=void 0,!wm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function mp(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=lo(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}O2(function(){var c=s,u=Hg(r),d=[];e:{var h=sk.get(e);if(h!==void 0){var v=Yg,y=e;switch(e){case"keypress":if(wd(r)===0)break e;case"keydown":case"keyup":v=H3;break;case"focusin":y="focus",v=lp;break;case"focusout":y="blur",v=lp;break;case"beforeblur":case"afterblur":v=lp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Dy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=P3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=G3;break;case tk:case rk:case nk:v=F3;break;case ak:v=Z3;break;case"scroll":v=I3;break;case"wheel":v=J3;break;case"copy":case"cut":case"paste":v=M3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Ry}var p=(t&4)!==0,_=!p&&e==="scroll",x=p?h!==null?h+"Capture":null:h;p=[];for(var k=c,w;k!==null;){w=k;var E=w.stateNode;if(w.tag===5&&E!==null&&(w=E,x!==null&&(E=pu(k,x),E!=null&&p.push(xu(k,E,w)))),_)break;k=k.return}0<p.length&&(h=new v(h,y,null,r,u),d.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",h&&r!==ym&&(y=r.relatedTarget||r.fromElement)&&(lo(y)||y[Ks]))break e;if((v||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,v?(y=r.relatedTarget||r.toElement,v=c,y=y?lo(y):null,y!==null&&(_=Ro(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=c),v!==y)){if(p=Dy,E="onMouseLeave",x="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(p=Ry,E="onPointerLeave",x="onPointerEnter",k="pointer"),_=v==null?h:gl(v),w=y==null?h:gl(y),h=new p(E,k+"leave",v,r,u),h.target=_,h.relatedTarget=w,E=null,lo(u)===c&&(p=new p(x,k+"enter",y,r,u),p.target=w,p.relatedTarget=_,E=p),_=E,v&&y)t:{for(p=v,x=y,k=0,w=p;w;w=Zo(w))k++;for(w=0,E=x;E;E=Zo(E))w++;for(;0<k-w;)p=Zo(p),k--;for(;0<w-k;)x=Zo(x),w--;for(;k--;){if(p===x||x!==null&&p===x.alternate)break t;p=Zo(p),x=Zo(x)}p=null}else p=null;v!==null&&Hy(d,h,v,p,!1),y!==null&&_!==null&&Hy(d,_,y,p,!0)}}e:{if(h=c?gl(c):window,v=h.nodeName&&h.nodeName.toLowerCase(),v==="select"||v==="input"&&h.type==="file")var I=s6;else if(Ly(h))if(Z2)I=c6;else{I=o6;var D=i6}else(v=h.nodeName)&&v.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(I=l6);if(I&&(I=I(e,c))){X2(d,I,r,u);break e}D&&D(e,h,c),e==="focusout"&&(D=h._wrapperState)&&D.controlled&&h.type==="number"&&hm(h,"number",h.value)}switch(D=c?gl(c):window,e){case"focusin":(Ly(D)||D.contentEditable==="true")&&(pl=D,Em=c,Gc=null);break;case"focusout":Gc=Em=pl=null;break;case"mousedown":Tm=!0;break;case"contextmenu":case"mouseup":case"dragend":Tm=!1,zy(d,r,u);break;case"selectionchange":if(d6)break;case"keydown":case"keyup":zy(d,r,u)}var C;if(Qg)e:{switch(e){case"compositionstart":var V="onCompositionStart";break e;case"compositionend":V="onCompositionEnd";break e;case"compositionupdate":V="onCompositionUpdate";break e}V=void 0}else hl?q2(e,r)&&(V="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(V="onCompositionStart");V&&(K2&&r.locale!=="ko"&&(hl||V!=="onCompositionStart"?V==="onCompositionEnd"&&hl&&(C=H2()):(xi=u,Zg="value"in xi?xi.value:xi.textContent,hl=!0)),D=zd(c,V),0<D.length&&(V=new Py(V,e,null,r,u),d.push({event:V,listeners:D}),C?V.data=C:(C=G2(r),C!==null&&(V.data=C)))),(C=e6?t6(e,r):r6(e,r))&&(c=zd(c,"onBeforeInput"),0<c.length&&(u=new Py("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=C))}ik(d,t)})}function xu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function zd(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=pu(e,r),s!=null&&n.unshift(xu(e,s,a)),s=pu(e,t),s!=null&&n.push(xu(e,s,a))),e=e.return}return n}function Zo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Hy(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=pu(r,s),l!=null&&i.unshift(xu(r,l,o))):a||(l=pu(r,s),l!=null&&i.push(xu(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var g6=/\r\n?/g,v6=/\u0000|\uFFFD/g;function Ky(e){return(typeof e=="string"?e:""+e).replace(g6,`
`).replace(v6,"")}function Uf(e,t,r){if(t=Ky(t),Ky(e)!==t&&r)throw Error(ze(425))}function Vd(){}var Cm=null,Nm=null;function Am(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Om=typeof setTimeout=="function"?setTimeout:void 0,y6=typeof clearTimeout=="function"?clearTimeout:void 0,qy=typeof Promise=="function"?Promise:void 0,_6=typeof queueMicrotask=="function"?queueMicrotask:typeof qy<"u"?function(e){return qy.resolve(null).then(e).catch(w6)}:Om;function w6(e){setTimeout(function(){throw e})}function gp(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),vu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);vu(t)}function Ni(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Gy(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Yl=Math.random().toString(36).slice(2),vs="__reactFiber$"+Yl,ku="__reactProps$"+Yl,Ks="__reactContainer$"+Yl,Im="__reactEvents$"+Yl,x6="__reactListeners$"+Yl,k6="__reactHandles$"+Yl;function lo(e){var t=e[vs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ks]||r[vs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Gy(e);e!==null;){if(r=e[vs])return r;e=Gy(e)}return t}e=r,r=e.parentNode}return null}function Zu(e){return e=e[vs]||e[Ks],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function gl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ze(33))}function Wh(e){return e[ku]||null}var Dm=[],vl=-1;function $i(e){return{current:e}}function dr(e){0>vl||(e.current=Dm[vl],Dm[vl]=null,vl--)}function ir(e,t){vl++,Dm[vl]=e.current,e.current=t}var Ri={},Pn=$i(Ri),Qn=$i(!1),wo=Ri;function Ml(e,t){var r=e.type.contextTypes;if(!r)return Ri;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ea(e){return e=e.childContextTypes,e!=null}function Wd(){dr(Qn),dr(Pn)}function Xy(e,t,r){if(Pn.current!==Ri)throw Error(ze(168));ir(Pn,t),ir(Qn,r)}function lk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ze(108,i3(e)||"Unknown",a));return Sr({},r,n)}function Hd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ri,wo=Pn.current,ir(Pn,e),ir(Qn,Qn.current),!0}function Zy(e,t,r){var n=e.stateNode;if(!n)throw Error(ze(169));r?(e=lk(e,t,wo),n.__reactInternalMemoizedMergedChildContext=e,dr(Qn),dr(Pn),ir(Pn,e)):dr(Qn),ir(Qn,r)}var js=null,Hh=!1,vp=!1;function ck(e){js===null?js=[e]:js.push(e)}function b6(e){Hh=!0,ck(e)}function Ui(){if(!vp&&js!==null){vp=!0;var e=0,t=er;try{var r=js;for(er=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}js=null,Hh=!1}catch(a){throw js!==null&&(js=js.slice(e+1)),R2(Kg,Ui),a}finally{er=t,vp=!1}}return null}var yl=[],_l=0,Kd=null,qd=0,Na=[],Aa=0,xo=null,Fs=1,Ls="";function ro(e,t){yl[_l++]=qd,yl[_l++]=Kd,Kd=e,qd=t}function uk(e,t,r){Na[Aa++]=Fs,Na[Aa++]=Ls,Na[Aa++]=xo,xo=e;var n=Fs;e=Ls;var a=32-Ya(n)-1;n&=~(1<<a),r+=1;var s=32-Ya(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Fs=1<<32-Ya(t)+a|r<<a|n,Ls=s+e}else Fs=1<<s|r<<a|n,Ls=e}function t1(e){e.return!==null&&(ro(e,1),uk(e,1,0))}function r1(e){for(;e===Kd;)Kd=yl[--_l],yl[_l]=null,qd=yl[--_l],yl[_l]=null;for(;e===xo;)xo=Na[--Aa],Na[Aa]=null,Ls=Na[--Aa],Na[Aa]=null,Fs=Na[--Aa],Na[Aa]=null}var ha=null,da=null,mr=!1,Ka=null;function fk(e,t){var r=Oa(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Yy(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ha=e,da=Ni(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ha=e,da=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=xo!==null?{id:Fs,overflow:Ls}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Oa(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ha=e,da=null,!0):!1;default:return!1}}function Pm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Rm(e){if(mr){var t=da;if(t){var r=t;if(!Yy(e,t)){if(Pm(e))throw Error(ze(418));t=Ni(r.nextSibling);var n=ha;t&&Yy(e,t)?fk(n,r):(e.flags=e.flags&-4097|2,mr=!1,ha=e)}}else{if(Pm(e))throw Error(ze(418));e.flags=e.flags&-4097|2,mr=!1,ha=e}}}function Jy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ha=e}function zf(e){if(e!==ha)return!1;if(!mr)return Jy(e),mr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Am(e.type,e.memoizedProps)),t&&(t=da)){if(Pm(e))throw dk(),Error(ze(418));for(;t;)fk(e,t),t=Ni(t.nextSibling)}if(Jy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ze(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){da=Ni(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}da=null}}else da=ha?Ni(e.stateNode.nextSibling):null;return!0}function dk(){for(var e=da;e;)e=Ni(e.nextSibling)}function Bl(){da=ha=null,mr=!1}function n1(e){Ka===null?Ka=[e]:Ka.push(e)}var S6=Js.ReactCurrentBatchConfig;function bc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ze(309));var n=r.stateNode}if(!n)throw Error(ze(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(ze(284));if(!r._owner)throw Error(ze(290,e))}return e}function Vf(e,t){throw e=Object.prototype.toString.call(t),Error(ze(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qy(e){var t=e._init;return t(e._payload)}function hk(e){function t(x,k){if(e){var w=x.deletions;w===null?(x.deletions=[k],x.flags|=16):w.push(k)}}function r(x,k){if(!e)return null;for(;k!==null;)t(x,k),k=k.sibling;return null}function n(x,k){for(x=new Map;k!==null;)k.key!==null?x.set(k.key,k):x.set(k.index,k),k=k.sibling;return x}function a(x,k){return x=Di(x,k),x.index=0,x.sibling=null,x}function s(x,k,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<k?(x.flags|=2,k):w):(x.flags|=2,k)):(x.flags|=1048576,k)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,k,w,E){return k===null||k.tag!==6?(k=Sp(w,x.mode,E),k.return=x,k):(k=a(k,w),k.return=x,k)}function l(x,k,w,E){var I=w.type;return I===dl?u(x,k,w.props.children,E,w.key):k!==null&&(k.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===hi&&Qy(I)===k.type)?(E=a(k,w.props),E.ref=bc(x,k,w),E.return=x,E):(E=Cd(w.type,w.key,w.props,null,x.mode,E),E.ref=bc(x,k,w),E.return=x,E)}function c(x,k,w,E){return k===null||k.tag!==4||k.stateNode.containerInfo!==w.containerInfo||k.stateNode.implementation!==w.implementation?(k=Ep(w,x.mode,E),k.return=x,k):(k=a(k,w.children||[]),k.return=x,k)}function u(x,k,w,E,I){return k===null||k.tag!==7?(k=mo(w,x.mode,E,I),k.return=x,k):(k=a(k,w),k.return=x,k)}function d(x,k,w){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Sp(""+k,x.mode,w),k.return=x,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Df:return w=Cd(k.type,k.key,k.props,null,x.mode,w),w.ref=bc(x,null,k),w.return=x,w;case fl:return k=Ep(k,x.mode,w),k.return=x,k;case hi:var E=k._init;return d(x,E(k._payload),w)}if(Fc(k)||yc(k))return k=mo(k,x.mode,w,null),k.return=x,k;Vf(x,k)}return null}function h(x,k,w,E){var I=k!==null?k.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return I!==null?null:o(x,k,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Df:return w.key===I?l(x,k,w,E):null;case fl:return w.key===I?c(x,k,w,E):null;case hi:return I=w._init,h(x,k,I(w._payload),E)}if(Fc(w)||yc(w))return I!==null?null:u(x,k,w,E,null);Vf(x,w)}return null}function v(x,k,w,E,I){if(typeof E=="string"&&E!==""||typeof E=="number")return x=x.get(w)||null,o(k,x,""+E,I);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Df:return x=x.get(E.key===null?w:E.key)||null,l(k,x,E,I);case fl:return x=x.get(E.key===null?w:E.key)||null,c(k,x,E,I);case hi:var D=E._init;return v(x,k,w,D(E._payload),I)}if(Fc(E)||yc(E))return x=x.get(w)||null,u(k,x,E,I,null);Vf(k,E)}return null}function y(x,k,w,E){for(var I=null,D=null,C=k,V=k=0,z=null;C!==null&&V<w.length;V++){C.index>V?(z=C,C=null):z=C.sibling;var ee=h(x,C,w[V],E);if(ee===null){C===null&&(C=z);break}e&&C&&ee.alternate===null&&t(x,C),k=s(ee,k,V),D===null?I=ee:D.sibling=ee,D=ee,C=z}if(V===w.length)return r(x,C),mr&&ro(x,V),I;if(C===null){for(;V<w.length;V++)C=d(x,w[V],E),C!==null&&(k=s(C,k,V),D===null?I=C:D.sibling=C,D=C);return mr&&ro(x,V),I}for(C=n(x,C);V<w.length;V++)z=v(C,x,V,w[V],E),z!==null&&(e&&z.alternate!==null&&C.delete(z.key===null?V:z.key),k=s(z,k,V),D===null?I=z:D.sibling=z,D=z);return e&&C.forEach(function(re){return t(x,re)}),mr&&ro(x,V),I}function p(x,k,w,E){var I=yc(w);if(typeof I!="function")throw Error(ze(150));if(w=I.call(w),w==null)throw Error(ze(151));for(var D=I=null,C=k,V=k=0,z=null,ee=w.next();C!==null&&!ee.done;V++,ee=w.next()){C.index>V?(z=C,C=null):z=C.sibling;var re=h(x,C,ee.value,E);if(re===null){C===null&&(C=z);break}e&&C&&re.alternate===null&&t(x,C),k=s(re,k,V),D===null?I=re:D.sibling=re,D=re,C=z}if(ee.done)return r(x,C),mr&&ro(x,V),I;if(C===null){for(;!ee.done;V++,ee=w.next())ee=d(x,ee.value,E),ee!==null&&(k=s(ee,k,V),D===null?I=ee:D.sibling=ee,D=ee);return mr&&ro(x,V),I}for(C=n(x,C);!ee.done;V++,ee=w.next())ee=v(C,x,V,ee.value,E),ee!==null&&(e&&ee.alternate!==null&&C.delete(ee.key===null?V:ee.key),k=s(ee,k,V),D===null?I=ee:D.sibling=ee,D=ee);return e&&C.forEach(function(G){return t(x,G)}),mr&&ro(x,V),I}function _(x,k,w,E){if(typeof w=="object"&&w!==null&&w.type===dl&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Df:e:{for(var I=w.key,D=k;D!==null;){if(D.key===I){if(I=w.type,I===dl){if(D.tag===7){r(x,D.sibling),k=a(D,w.props.children),k.return=x,x=k;break e}}else if(D.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===hi&&Qy(I)===D.type){r(x,D.sibling),k=a(D,w.props),k.ref=bc(x,D,w),k.return=x,x=k;break e}r(x,D);break}else t(x,D);D=D.sibling}w.type===dl?(k=mo(w.props.children,x.mode,E,w.key),k.return=x,x=k):(E=Cd(w.type,w.key,w.props,null,x.mode,E),E.ref=bc(x,k,w),E.return=x,x=E)}return i(x);case fl:e:{for(D=w.key;k!==null;){if(k.key===D)if(k.tag===4&&k.stateNode.containerInfo===w.containerInfo&&k.stateNode.implementation===w.implementation){r(x,k.sibling),k=a(k,w.children||[]),k.return=x,x=k;break e}else{r(x,k);break}else t(x,k);k=k.sibling}k=Ep(w,x.mode,E),k.return=x,x=k}return i(x);case hi:return D=w._init,_(x,k,D(w._payload),E)}if(Fc(w))return y(x,k,w,E);if(yc(w))return p(x,k,w,E);Vf(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,k!==null&&k.tag===6?(r(x,k.sibling),k=a(k,w),k.return=x,x=k):(r(x,k),k=Sp(w,x.mode,E),k.return=x,x=k),i(x)):r(x,k)}return _}var $l=hk(!0),pk=hk(!1),Gd=$i(null),Xd=null,wl=null,a1=null;function s1(){a1=wl=Xd=null}function i1(e){var t=Gd.current;dr(Gd),e._currentValue=t}function jm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ol(e,t){Xd=e,a1=wl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Jn=!0),e.firstContext=null)}function Pa(e){var t=e._currentValue;if(a1!==e)if(e={context:e,memoizedValue:t,next:null},wl===null){if(Xd===null)throw Error(ze(308));wl=e,Xd.dependencies={lanes:0,firstContext:e}}else wl=wl.next=e;return t}var co=null;function o1(e){co===null?co=[e]:co.push(e)}function mk(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,o1(t)):(r.next=a.next,a.next=r),t.interleaved=r,qs(e,n)}function qs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var pi=!1;function l1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ai(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,zt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,qs(e,r)}return a=n.interleaved,a===null?(t.next=t,o1(n)):(t.next=a.next,a.next=t),n.interleaved=t,qs(e,r)}function xd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,qg(e,r)}}function e_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Zd(e,t,r,n){var a=e.updateQueue;pi=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,u=c=l=null,o=s;do{var h=o.lane,v=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=e,p=o;switch(h=t,v=r,p.tag){case 1:if(y=p.payload,typeof y=="function"){d=y.call(v,d,h);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=p.payload,h=typeof y=="function"?y.call(v,d,h):y,h==null)break e;d=Sr({},d,h);break e;case 2:pi=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else v={eventTime:v,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=v,l=d):u=u.next=v,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(u===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);bo|=i,e.lanes=i,e.memoizedState=d}}function t_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ze(191,a));a.call(n)}}}var Yu={},ks=$i(Yu),bu=$i(Yu),Su=$i(Yu);function uo(e){if(e===Yu)throw Error(ze(174));return e}function c1(e,t){switch(ir(Su,t),ir(bu,e),ir(ks,Yu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:mm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=mm(t,e)}dr(ks),ir(ks,t)}function Ul(){dr(ks),dr(bu),dr(Su)}function vk(e){uo(Su.current);var t=uo(ks.current),r=mm(t,e.type);t!==r&&(ir(bu,e),ir(ks,r))}function u1(e){bu.current===e&&(dr(ks),dr(bu))}var wr=$i(0);function Yd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var yp=[];function f1(){for(var e=0;e<yp.length;e++)yp[e]._workInProgressVersionPrimary=null;yp.length=0}var kd=Js.ReactCurrentDispatcher,_p=Js.ReactCurrentBatchConfig,ko=0,br=null,Xr=null,an=null,Jd=!1,Xc=!1,Eu=0,E6=0;function kn(){throw Error(ze(321))}function d1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ts(e[r],t[r]))return!1;return!0}function h1(e,t,r,n,a,s){if(ko=s,br=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,kd.current=e===null||e.memoizedState===null?A6:O6,e=r(n,a),Xc){s=0;do{if(Xc=!1,Eu=0,25<=s)throw Error(ze(301));s+=1,an=Xr=null,t.updateQueue=null,kd.current=I6,e=r(n,a)}while(Xc)}if(kd.current=Qd,t=Xr!==null&&Xr.next!==null,ko=0,an=Xr=br=null,Jd=!1,t)throw Error(ze(300));return e}function p1(){var e=Eu!==0;return Eu=0,e}function ds(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?br.memoizedState=an=e:an=an.next=e,an}function Ra(){if(Xr===null){var e=br.alternate;e=e!==null?e.memoizedState:null}else e=Xr.next;var t=an===null?br.memoizedState:an.next;if(t!==null)an=t,Xr=e;else{if(e===null)throw Error(ze(310));Xr=e,e={memoizedState:Xr.memoizedState,baseState:Xr.baseState,baseQueue:Xr.baseQueue,queue:Xr.queue,next:null},an===null?br.memoizedState=an=e:an=an.next=e}return an}function Tu(e,t){return typeof t=="function"?t(e):t}function wp(e){var t=Ra(),r=t.queue;if(r===null)throw Error(ze(311));r.lastRenderedReducer=e;var n=Xr,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var u=c.lane;if((ko&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,br.lanes|=u,bo|=u}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,ts(n,t.memoizedState)||(Jn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,br.lanes|=s,bo|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function xp(e){var t=Ra(),r=t.queue;if(r===null)throw Error(ze(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);ts(s,t.memoizedState)||(Jn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function yk(){}function _k(e,t){var r=br,n=Ra(),a=t(),s=!ts(n.memoizedState,a);if(s&&(n.memoizedState=a,Jn=!0),n=n.queue,m1(kk.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||an!==null&&an.memoizedState.tag&1){if(r.flags|=2048,Cu(9,xk.bind(null,r,n,a,t),void 0,null),ln===null)throw Error(ze(349));ko&30||wk(r,t,a)}return a}function wk(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=br.updateQueue,t===null?(t={lastEffect:null,stores:null},br.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function xk(e,t,r,n){t.value=r,t.getSnapshot=n,bk(t)&&Sk(e)}function kk(e,t,r){return r(function(){bk(t)&&Sk(e)})}function bk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ts(e,r)}catch{return!0}}function Sk(e){var t=qs(e,1);t!==null&&Ja(t,e,1,-1)}function r_(e){var t=ds();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tu,lastRenderedState:e},t.queue=e,e=e.dispatch=N6.bind(null,br,e),[t.memoizedState,e]}function Cu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=br.updateQueue,t===null?(t={lastEffect:null,stores:null},br.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Ek(){return Ra().memoizedState}function bd(e,t,r,n){var a=ds();br.flags|=e,a.memoizedState=Cu(1|t,r,void 0,n===void 0?null:n)}function Kh(e,t,r,n){var a=Ra();n=n===void 0?null:n;var s=void 0;if(Xr!==null){var i=Xr.memoizedState;if(s=i.destroy,n!==null&&d1(n,i.deps)){a.memoizedState=Cu(t,r,s,n);return}}br.flags|=e,a.memoizedState=Cu(1|t,r,s,n)}function n_(e,t){return bd(8390656,8,e,t)}function m1(e,t){return Kh(2048,8,e,t)}function Tk(e,t){return Kh(4,2,e,t)}function Ck(e,t){return Kh(4,4,e,t)}function Nk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ak(e,t,r){return r=r!=null?r.concat([e]):null,Kh(4,4,Nk.bind(null,t,e),r)}function g1(){}function Ok(e,t){var r=Ra();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&d1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ik(e,t){var r=Ra();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&d1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Dk(e,t,r){return ko&21?(ts(r,t)||(r=L2(),br.lanes|=r,bo|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Jn=!0),e.memoizedState=r)}function T6(e,t){var r=er;er=r!==0&&4>r?r:4,e(!0);var n=_p.transition;_p.transition={};try{e(!1),t()}finally{er=r,_p.transition=n}}function Pk(){return Ra().memoizedState}function C6(e,t,r){var n=Ii(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Rk(e))jk(t,r);else if(r=mk(e,t,r,n),r!==null){var a=Wn();Ja(r,e,n,a),Fk(r,t,n)}}function N6(e,t,r){var n=Ii(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Rk(e))jk(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,ts(o,i)){var l=t.interleaved;l===null?(a.next=a,o1(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=mk(e,t,a,n),r!==null&&(a=Wn(),Ja(r,e,n,a),Fk(r,t,n))}}function Rk(e){var t=e.alternate;return e===br||t!==null&&t===br}function jk(e,t){Xc=Jd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Fk(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,qg(e,r)}}var Qd={readContext:Pa,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},A6={readContext:Pa,useCallback:function(e,t){return ds().memoizedState=[e,t===void 0?null:t],e},useContext:Pa,useEffect:n_,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,bd(4194308,4,Nk.bind(null,t,e),r)},useLayoutEffect:function(e,t){return bd(4194308,4,e,t)},useInsertionEffect:function(e,t){return bd(4,2,e,t)},useMemo:function(e,t){var r=ds();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ds();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=C6.bind(null,br,e),[n.memoizedState,e]},useRef:function(e){var t=ds();return e={current:e},t.memoizedState=e},useState:r_,useDebugValue:g1,useDeferredValue:function(e){return ds().memoizedState=e},useTransition:function(){var e=r_(!1),t=e[0];return e=T6.bind(null,e[1]),ds().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=br,a=ds();if(mr){if(r===void 0)throw Error(ze(407));r=r()}else{if(r=t(),ln===null)throw Error(ze(349));ko&30||wk(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,n_(kk.bind(null,n,s,e),[e]),n.flags|=2048,Cu(9,xk.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ds(),t=ln.identifierPrefix;if(mr){var r=Ls,n=Fs;r=(n&~(1<<32-Ya(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Eu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=E6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},O6={readContext:Pa,useCallback:Ok,useContext:Pa,useEffect:m1,useImperativeHandle:Ak,useInsertionEffect:Tk,useLayoutEffect:Ck,useMemo:Ik,useReducer:wp,useRef:Ek,useState:function(){return wp(Tu)},useDebugValue:g1,useDeferredValue:function(e){var t=Ra();return Dk(t,Xr.memoizedState,e)},useTransition:function(){var e=wp(Tu)[0],t=Ra().memoizedState;return[e,t]},useMutableSource:yk,useSyncExternalStore:_k,useId:Pk,unstable_isNewReconciler:!1},I6={readContext:Pa,useCallback:Ok,useContext:Pa,useEffect:m1,useImperativeHandle:Ak,useInsertionEffect:Tk,useLayoutEffect:Ck,useMemo:Ik,useReducer:xp,useRef:Ek,useState:function(){return xp(Tu)},useDebugValue:g1,useDeferredValue:function(e){var t=Ra();return Xr===null?t.memoizedState=e:Dk(t,Xr.memoizedState,e)},useTransition:function(){var e=xp(Tu)[0],t=Ra().memoizedState;return[e,t]},useMutableSource:yk,useSyncExternalStore:_k,useId:Pk,unstable_isNewReconciler:!1};function Va(e,t){if(e&&e.defaultProps){t=Sr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Fm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Sr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var qh={isMounted:function(e){return(e=e._reactInternals)?Ro(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Wn(),a=Ii(e),s=Bs(n,a);s.payload=t,r!=null&&(s.callback=r),t=Ai(e,s,a),t!==null&&(Ja(t,e,a,n),xd(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Wn(),a=Ii(e),s=Bs(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ai(e,s,a),t!==null&&(Ja(t,e,a,n),xd(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Wn(),n=Ii(e),a=Bs(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ai(e,a,n),t!==null&&(Ja(t,e,n,r),xd(t,e,n))}};function a_(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!_u(r,n)||!_u(a,s):!0}function Lk(e,t,r){var n=!1,a=Ri,s=t.contextType;return typeof s=="object"&&s!==null?s=Pa(s):(a=ea(t)?wo:Pn.current,n=t.contextTypes,s=(n=n!=null)?Ml(e,a):Ri),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=qh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function s_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&qh.enqueueReplaceState(t,t.state,null)}function Lm(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},l1(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Pa(s):(s=ea(t)?wo:Pn.current,a.context=Ml(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Fm(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&qh.enqueueReplaceState(a,a.state,null),Zd(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function zl(e,t){try{var r="",n=t;do r+=s3(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function kp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Mm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var D6=typeof WeakMap=="function"?WeakMap:Map;function Mk(e,t,r){r=Bs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){th||(th=!0,Gm=n),Mm(e,t)},r}function Bk(e,t,r){r=Bs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Mm(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Mm(e,t),typeof n!="function"&&(Oi===null?Oi=new Set([this]):Oi.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function i_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new D6;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=K6.bind(null,e,t,r),t.then(e,e))}function o_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function l_(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Bs(-1,1),t.tag=2,Ai(r,t,1))),r.lanes|=1),e)}var P6=Js.ReactCurrentOwner,Jn=!1;function $n(e,t,r,n){t.child=e===null?pk(t,null,r,n):$l(t,e.child,r,n)}function c_(e,t,r,n,a){r=r.render;var s=t.ref;return Ol(t,a),n=h1(e,t,r,n,s,a),r=p1(),e!==null&&!Jn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a)):(mr&&r&&t1(t),t.flags|=1,$n(e,t,n,a),t.child)}function u_(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!S1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,$k(e,t,s,n,a)):(e=Cd(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:_u,r(i,n)&&e.ref===t.ref)return Gs(e,t,a)}return t.flags|=1,e=Di(s,n),e.ref=t.ref,e.return=t,t.child=e}function $k(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(_u(s,n)&&e.ref===t.ref)if(Jn=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Jn=!0);else return t.lanes=e.lanes,Gs(e,t,a)}return Bm(e,t,r,n,a)}function Uk(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ir(kl,oa),oa|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ir(kl,oa),oa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ir(kl,oa),oa|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,ir(kl,oa),oa|=n;return $n(e,t,a,r),t.child}function zk(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Bm(e,t,r,n,a){var s=ea(r)?wo:Pn.current;return s=Ml(t,s),Ol(t,a),r=h1(e,t,r,n,s,a),n=p1(),e!==null&&!Jn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a)):(mr&&n&&t1(t),t.flags|=1,$n(e,t,r,a),t.child)}function f_(e,t,r,n,a){if(ea(r)){var s=!0;Hd(t)}else s=!1;if(Ol(t,a),t.stateNode===null)Sd(e,t),Lk(t,r,n),Lm(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Pa(c):(c=ea(r)?wo:Pn.current,c=Ml(t,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&s_(t,i,n,c),pi=!1;var h=t.memoizedState;i.state=h,Zd(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Qn.current||pi?(typeof u=="function"&&(Fm(t,r,u,n),l=t.memoizedState),(o=pi||a_(t,r,o,n,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,gk(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Va(t.type,o),i.props=c,d=t.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Pa(l):(l=ea(r)?wo:Pn.current,l=Ml(t,l));var v=r.getDerivedStateFromProps;(u=typeof v=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==l)&&s_(t,i,n,l),pi=!1,h=t.memoizedState,i.state=h,Zd(t,n,i,a);var y=t.memoizedState;o!==d||h!==y||Qn.current||pi?(typeof v=="function"&&(Fm(t,r,v,n),y=t.memoizedState),(c=pi||a_(t,r,c,n,h,y,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,y,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,y,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),i.props=n,i.state=y,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return $m(e,t,r,n,s,a)}function $m(e,t,r,n,a,s){zk(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Zy(t,r,!1),Gs(e,t,s);n=t.stateNode,P6.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=$l(t,e.child,null,s),t.child=$l(t,null,o,s)):$n(e,t,o,s),t.memoizedState=n.state,a&&Zy(t,r,!0),t.child}function Vk(e){var t=e.stateNode;t.pendingContext?Xy(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Xy(e,t.context,!1),c1(e,t.containerInfo)}function d_(e,t,r,n,a){return Bl(),n1(a),t.flags|=256,$n(e,t,r,n),t.child}var Um={dehydrated:null,treeContext:null,retryLane:0};function zm(e){return{baseLanes:e,cachePool:null,transitions:null}}function Wk(e,t,r){var n=t.pendingProps,a=wr.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ir(wr,a&1),e===null)return Rm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Zh(i,n,0,null),e=mo(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=zm(r),t.memoizedState=Um,e):v1(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return R6(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Di(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Di(o,s):(s=mo(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?zm(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=Um,n}return s=e.child,e=s.sibling,n=Di(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function v1(e,t){return t=Zh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wf(e,t,r,n){return n!==null&&n1(n),$l(t,e.child,null,r),e=v1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function R6(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=kp(Error(ze(422))),Wf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Zh({mode:"visible",children:n.children},a,0,null),s=mo(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&$l(t,e.child,null,i),t.child.memoizedState=zm(i),t.memoizedState=Um,s);if(!(t.mode&1))return Wf(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ze(419)),n=kp(s,n,void 0),Wf(e,t,i,n)}if(o=(i&e.childLanes)!==0,Jn||o){if(n=ln,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,qs(e,a),Ja(n,e,a,-1))}return b1(),n=kp(Error(ze(421))),Wf(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=q6.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,da=Ni(a.nextSibling),ha=t,mr=!0,Ka=null,e!==null&&(Na[Aa++]=Fs,Na[Aa++]=Ls,Na[Aa++]=xo,Fs=e.id,Ls=e.overflow,xo=t),t=v1(t,n.children),t.flags|=4096,t)}function h_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),jm(e.return,t,r)}function bp(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Hk(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if($n(e,t,n.children,r),n=wr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&h_(e,r,t);else if(e.tag===19)h_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ir(wr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Yd(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),bp(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Yd(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}bp(t,!0,r,null,s);break;case"together":bp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),bo|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ze(153));if(t.child!==null){for(e=t.child,r=Di(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Di(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function j6(e,t,r){switch(t.tag){case 3:Vk(t),Bl();break;case 5:vk(t);break;case 1:ea(t.type)&&Hd(t);break;case 4:c1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;ir(Gd,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ir(wr,wr.current&1),t.flags|=128,null):r&t.child.childLanes?Wk(e,t,r):(ir(wr,wr.current&1),e=Gs(e,t,r),e!==null?e.sibling:null);ir(wr,wr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Hk(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ir(wr,wr.current),n)break;return null;case 22:case 23:return t.lanes=0,Uk(e,t,r)}return Gs(e,t,r)}var Kk,Vm,qk,Gk;Kk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Vm=function(){};qk=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,uo(ks.current);var s=null;switch(r){case"input":a=fm(e,a),n=fm(e,n),s=[];break;case"select":a=Sr({},a,{value:void 0}),n=Sr({},n,{value:void 0}),s=[];break;case"textarea":a=pm(e,a),n=pm(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Vd)}gm(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(du.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(du.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ur("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Gk=function(e,t,r,n){r!==n&&(t.flags|=4)};function Sc(e,t){if(!mr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function bn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function F6(e,t,r){var n=t.pendingProps;switch(r1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(t),null;case 1:return ea(t.type)&&Wd(),bn(t),null;case 3:return n=t.stateNode,Ul(),dr(Qn),dr(Pn),f1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(zf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ka!==null&&(Ym(Ka),Ka=null))),Vm(e,t),bn(t),null;case 5:u1(t);var a=uo(Su.current);if(r=t.type,e!==null&&t.stateNode!=null)qk(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ze(166));return bn(t),null}if(e=uo(ks.current),zf(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[vs]=t,n[ku]=s,e=(t.mode&1)!==0,r){case"dialog":ur("cancel",n),ur("close",n);break;case"iframe":case"object":case"embed":ur("load",n);break;case"video":case"audio":for(a=0;a<Mc.length;a++)ur(Mc[a],n);break;case"source":ur("error",n);break;case"img":case"image":case"link":ur("error",n),ur("load",n);break;case"details":ur("toggle",n);break;case"input":ky(n,s),ur("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ur("invalid",n);break;case"textarea":Sy(n,s),ur("invalid",n)}gm(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Uf(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Uf(n.textContent,o,e),a=["children",""+o]):du.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ur("scroll",n)}switch(r){case"input":Pf(n),by(n,s,!0);break;case"textarea":Pf(n),Ey(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Vd)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=k2(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[vs]=t,e[ku]=n,Kk(e,t,!1,!1),t.stateNode=e;e:{switch(i=vm(r,n),r){case"dialog":ur("cancel",e),ur("close",e),a=n;break;case"iframe":case"object":case"embed":ur("load",e),a=n;break;case"video":case"audio":for(a=0;a<Mc.length;a++)ur(Mc[a],e);a=n;break;case"source":ur("error",e),a=n;break;case"img":case"image":case"link":ur("error",e),ur("load",e),a=n;break;case"details":ur("toggle",e),a=n;break;case"input":ky(e,n),a=fm(e,n),ur("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Sr({},n,{value:void 0}),ur("invalid",e);break;case"textarea":Sy(e,n),a=pm(e,n),ur("invalid",e);break;default:a=n}gm(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?E2(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&b2(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&hu(e,l):typeof l=="number"&&hu(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(du.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ur("scroll",e):l!=null&&Ug(e,s,l,i))}switch(r){case"input":Pf(e),by(e,n,!1);break;case"textarea":Pf(e),Ey(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Pi(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Tl(e,!!n.multiple,s,!1):n.defaultValue!=null&&Tl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Vd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return bn(t),null;case 6:if(e&&t.stateNode!=null)Gk(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ze(166));if(r=uo(Su.current),uo(ks.current),zf(t)){if(n=t.stateNode,r=t.memoizedProps,n[vs]=t,(s=n.nodeValue!==r)&&(e=ha,e!==null))switch(e.tag){case 3:Uf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Uf(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[vs]=t,t.stateNode=n}return bn(t),null;case 13:if(dr(wr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(mr&&da!==null&&t.mode&1&&!(t.flags&128))dk(),Bl(),t.flags|=98560,s=!1;else if(s=zf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ze(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ze(317));s[vs]=t}else Bl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;bn(t),s=!1}else Ka!==null&&(Ym(Ka),Ka=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||wr.current&1?Jr===0&&(Jr=3):b1())),t.updateQueue!==null&&(t.flags|=4),bn(t),null);case 4:return Ul(),Vm(e,t),e===null&&wu(t.stateNode.containerInfo),bn(t),null;case 10:return i1(t.type._context),bn(t),null;case 17:return ea(t.type)&&Wd(),bn(t),null;case 19:if(dr(wr),s=t.memoizedState,s===null)return bn(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)Sc(s,!1);else{if(Jr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Yd(e),i!==null){for(t.flags|=128,Sc(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ir(wr,wr.current&1|2),t.child}e=e.sibling}s.tail!==null&&jr()>Vl&&(t.flags|=128,n=!0,Sc(s,!1),t.lanes=4194304)}else{if(!n)if(e=Yd(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Sc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!mr)return bn(t),null}else 2*jr()-s.renderingStartTime>Vl&&r!==1073741824&&(t.flags|=128,n=!0,Sc(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=jr(),t.sibling=null,r=wr.current,ir(wr,n?r&1|2:r&1),t):(bn(t),null);case 22:case 23:return k1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?oa&1073741824&&(bn(t),t.subtreeFlags&6&&(t.flags|=8192)):bn(t),null;case 24:return null;case 25:return null}throw Error(ze(156,t.tag))}function L6(e,t){switch(r1(t),t.tag){case 1:return ea(t.type)&&Wd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ul(),dr(Qn),dr(Pn),f1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return u1(t),null;case 13:if(dr(wr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ze(340));Bl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return dr(wr),null;case 4:return Ul(),null;case 10:return i1(t.type._context),null;case 22:case 23:return k1(),null;case 24:return null;default:return null}}var Hf=!1,Cn=!1,M6=typeof WeakSet=="function"?WeakSet:Set,ot=null;function xl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nr(e,t,n)}else r.current=null}function Wm(e,t,r){try{r()}catch(n){Nr(e,t,n)}}var p_=!1;function B6(e,t){if(Cm=$d,e=Q2(),e1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var v;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(v=d.firstChild)!==null;)h=d,d=v;for(;;){if(d===e)break t;if(h===r&&++c===a&&(o=i),h===s&&++u===n&&(l=i),(v=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=v}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Nm={focusedElem:e,selectionRange:r},$d=!1,ot=t;ot!==null;)if(t=ot,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ot=e;else for(;ot!==null;){t=ot;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var p=y.memoizedProps,_=y.memoizedState,x=t.stateNode,k=x.getSnapshotBeforeUpdate(t.elementType===t.type?p:Va(t.type,p),_);x.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ze(163))}}catch(E){Nr(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,ot=e;break}ot=t.return}return y=p_,p_=!1,y}function Zc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Wm(t,r,s)}a=a.next}while(a!==n)}}function Gh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Hm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Xk(e){var t=e.alternate;t!==null&&(e.alternate=null,Xk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[vs],delete t[ku],delete t[Im],delete t[x6],delete t[k6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Zk(e){return e.tag===5||e.tag===3||e.tag===4}function m_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Zk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Km(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Vd));else if(n!==4&&(e=e.child,e!==null))for(Km(e,t,r),e=e.sibling;e!==null;)Km(e,t,r),e=e.sibling}function qm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(qm(e,t,r),e=e.sibling;e!==null;)qm(e,t,r),e=e.sibling}var pn=null,Wa=!1;function li(e,t,r){for(r=r.child;r!==null;)Yk(e,t,r),r=r.sibling}function Yk(e,t,r){if(xs&&typeof xs.onCommitFiberUnmount=="function")try{xs.onCommitFiberUnmount($h,r)}catch{}switch(r.tag){case 5:Cn||xl(r,t);case 6:var n=pn,a=Wa;pn=null,li(e,t,r),pn=n,Wa=a,pn!==null&&(Wa?(e=pn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):pn.removeChild(r.stateNode));break;case 18:pn!==null&&(Wa?(e=pn,r=r.stateNode,e.nodeType===8?gp(e.parentNode,r):e.nodeType===1&&gp(e,r),vu(e)):gp(pn,r.stateNode));break;case 4:n=pn,a=Wa,pn=r.stateNode.containerInfo,Wa=!0,li(e,t,r),pn=n,Wa=a;break;case 0:case 11:case 14:case 15:if(!Cn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Wm(r,t,i),a=a.next}while(a!==n)}li(e,t,r);break;case 1:if(!Cn&&(xl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Nr(r,t,o)}li(e,t,r);break;case 21:li(e,t,r);break;case 22:r.mode&1?(Cn=(n=Cn)||r.memoizedState!==null,li(e,t,r),Cn=n):li(e,t,r);break;default:li(e,t,r)}}function g_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new M6),t.forEach(function(n){var a=G6.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ba(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:pn=o.stateNode,Wa=!1;break e;case 3:pn=o.stateNode.containerInfo,Wa=!0;break e;case 4:pn=o.stateNode.containerInfo,Wa=!0;break e}o=o.return}if(pn===null)throw Error(ze(160));Yk(s,i,a),pn=null,Wa=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Nr(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Jk(t,e),t=t.sibling}function Jk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ba(t,e),os(e),n&4){try{Zc(3,e,e.return),Gh(3,e)}catch(p){Nr(e,e.return,p)}try{Zc(5,e,e.return)}catch(p){Nr(e,e.return,p)}}break;case 1:Ba(t,e),os(e),n&512&&r!==null&&xl(r,r.return);break;case 5:if(Ba(t,e),os(e),n&512&&r!==null&&xl(r,r.return),e.flags&32){var a=e.stateNode;try{hu(a,"")}catch(p){Nr(e,e.return,p)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&w2(a,s),vm(o,i);var c=vm(o,s);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?E2(a,d):u==="dangerouslySetInnerHTML"?b2(a,d):u==="children"?hu(a,d):Ug(a,u,d,c)}switch(o){case"input":dm(a,s);break;case"textarea":x2(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Tl(a,!!s.multiple,v,!1):h!==!!s.multiple&&(s.defaultValue!=null?Tl(a,!!s.multiple,s.defaultValue,!0):Tl(a,!!s.multiple,s.multiple?[]:"",!1))}a[ku]=s}catch(p){Nr(e,e.return,p)}}break;case 6:if(Ba(t,e),os(e),n&4){if(e.stateNode===null)throw Error(ze(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(p){Nr(e,e.return,p)}}break;case 3:if(Ba(t,e),os(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{vu(t.containerInfo)}catch(p){Nr(e,e.return,p)}break;case 4:Ba(t,e),os(e);break;case 13:Ba(t,e),os(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(w1=jr())),n&4&&g_(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Cn=(c=Cn)||u,Ba(t,e),Cn=c):Ba(t,e),os(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ot=e,u=e.child;u!==null;){for(d=ot=u;ot!==null;){switch(h=ot,v=h.child,h.tag){case 0:case 11:case 14:case 15:Zc(4,h,h.return);break;case 1:xl(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(p){Nr(n,r,p)}}break;case 5:xl(h,h.return);break;case 22:if(h.memoizedState!==null){y_(d);continue}}v!==null?(v.return=h,ot=v):y_(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{a=d.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=S2("display",i))}catch(p){Nr(e,e.return,p)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(p){Nr(e,e.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ba(t,e),os(e),n&4&&g_(e);break;case 21:break;default:Ba(t,e),os(e)}}function os(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Zk(r)){var n=r;break e}r=r.return}throw Error(ze(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(hu(a,""),n.flags&=-33);var s=m_(e);qm(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=m_(e);Km(e,o,i);break;default:throw Error(ze(161))}}catch(l){Nr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $6(e,t,r){ot=e,Qk(e)}function Qk(e,t,r){for(var n=(e.mode&1)!==0;ot!==null;){var a=ot,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Hf;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Cn;o=Hf;var c=Cn;if(Hf=i,(Cn=l)&&!c)for(ot=a;ot!==null;)i=ot,l=i.child,i.tag===22&&i.memoizedState!==null?__(a):l!==null?(l.return=i,ot=l):__(a);for(;s!==null;)ot=s,Qk(s),s=s.sibling;ot=a,Hf=o,Cn=c}v_(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,ot=s):v_(e)}}function v_(e){for(;ot!==null;){var t=ot;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Cn||Gh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Cn)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Va(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&t_(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}t_(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&vu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ze(163))}Cn||t.flags&512&&Hm(t)}catch(h){Nr(t,t.return,h)}}if(t===e){ot=null;break}if(r=t.sibling,r!==null){r.return=t.return,ot=r;break}ot=t.return}}function y_(e){for(;ot!==null;){var t=ot;if(t===e){ot=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ot=r;break}ot=t.return}}function __(e){for(;ot!==null;){var t=ot;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Gh(4,t)}catch(l){Nr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Nr(t,a,l)}}var s=t.return;try{Hm(t)}catch(l){Nr(t,s,l)}break;case 5:var i=t.return;try{Hm(t)}catch(l){Nr(t,i,l)}}}catch(l){Nr(t,t.return,l)}if(t===e){ot=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ot=o;break}ot=t.return}}var U6=Math.ceil,eh=Js.ReactCurrentDispatcher,y1=Js.ReactCurrentOwner,Ia=Js.ReactCurrentBatchConfig,zt=0,ln=null,Hr=null,vn=0,oa=0,kl=$i(0),Jr=0,Nu=null,bo=0,Xh=0,_1=0,Yc=null,Zn=null,w1=0,Vl=1/0,Ps=null,th=!1,Gm=null,Oi=null,Kf=!1,ki=null,rh=0,Jc=0,Xm=null,Ed=-1,Td=0;function Wn(){return zt&6?jr():Ed!==-1?Ed:Ed=jr()}function Ii(e){return e.mode&1?zt&2&&vn!==0?vn&-vn:S6.transition!==null?(Td===0&&(Td=L2()),Td):(e=er,e!==0||(e=window.event,e=e===void 0?16:W2(e.type)),e):1}function Ja(e,t,r,n){if(50<Jc)throw Jc=0,Xm=null,Error(ze(185));Gu(e,r,n),(!(zt&2)||e!==ln)&&(e===ln&&(!(zt&2)&&(Xh|=r),Jr===4&&gi(e,vn)),ta(e,n),r===1&&zt===0&&!(t.mode&1)&&(Vl=jr()+500,Hh&&Ui()))}function ta(e,t){var r=e.callbackNode;S3(e,t);var n=Bd(e,e===ln?vn:0);if(n===0)r!==null&&Ny(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ny(r),t===1)e.tag===0?b6(w_.bind(null,e)):ck(w_.bind(null,e)),_6(function(){!(zt&6)&&Ui()}),r=null;else{switch(M2(n)){case 1:r=Kg;break;case 4:r=j2;break;case 16:r=Md;break;case 536870912:r=F2;break;default:r=Md}r=ob(r,eb.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function eb(e,t){if(Ed=-1,Td=0,zt&6)throw Error(ze(327));var r=e.callbackNode;if(Il()&&e.callbackNode!==r)return null;var n=Bd(e,e===ln?vn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=nh(e,n);else{t=n;var a=zt;zt|=2;var s=rb();(ln!==e||vn!==t)&&(Ps=null,Vl=jr()+500,po(e,t));do try{W6();break}catch(o){tb(e,o)}while(!0);s1(),eh.current=s,zt=a,Hr!==null?t=0:(ln=null,vn=0,t=Jr)}if(t!==0){if(t===2&&(a=km(e),a!==0&&(n=a,t=Zm(e,a))),t===1)throw r=Nu,po(e,0),gi(e,n),ta(e,jr()),r;if(t===6)gi(e,n);else{if(a=e.current.alternate,!(n&30)&&!z6(a)&&(t=nh(e,n),t===2&&(s=km(e),s!==0&&(n=s,t=Zm(e,s))),t===1))throw r=Nu,po(e,0),gi(e,n),ta(e,jr()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ze(345));case 2:no(e,Zn,Ps);break;case 3:if(gi(e,n),(n&130023424)===n&&(t=w1+500-jr(),10<t)){if(Bd(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Wn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Om(no.bind(null,e,Zn,Ps),t);break}no(e,Zn,Ps);break;case 4:if(gi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Ya(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=jr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*U6(n/1960))-n,10<n){e.timeoutHandle=Om(no.bind(null,e,Zn,Ps),n);break}no(e,Zn,Ps);break;case 5:no(e,Zn,Ps);break;default:throw Error(ze(329))}}}return ta(e,jr()),e.callbackNode===r?eb.bind(null,e):null}function Zm(e,t){var r=Yc;return e.current.memoizedState.isDehydrated&&(po(e,t).flags|=256),e=nh(e,t),e!==2&&(t=Zn,Zn=r,t!==null&&Ym(t)),e}function Ym(e){Zn===null?Zn=e:Zn.push.apply(Zn,e)}function z6(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!ts(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function gi(e,t){for(t&=~_1,t&=~Xh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ya(t),n=1<<r;e[r]=-1,t&=~n}}function w_(e){if(zt&6)throw Error(ze(327));Il();var t=Bd(e,0);if(!(t&1))return ta(e,jr()),null;var r=nh(e,t);if(e.tag!==0&&r===2){var n=km(e);n!==0&&(t=n,r=Zm(e,n))}if(r===1)throw r=Nu,po(e,0),gi(e,t),ta(e,jr()),r;if(r===6)throw Error(ze(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,no(e,Zn,Ps),ta(e,jr()),null}function x1(e,t){var r=zt;zt|=1;try{return e(t)}finally{zt=r,zt===0&&(Vl=jr()+500,Hh&&Ui())}}function So(e){ki!==null&&ki.tag===0&&!(zt&6)&&Il();var t=zt;zt|=1;var r=Ia.transition,n=er;try{if(Ia.transition=null,er=1,e)return e()}finally{er=n,Ia.transition=r,zt=t,!(zt&6)&&Ui()}}function k1(){oa=kl.current,dr(kl)}function po(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,y6(r)),Hr!==null)for(r=Hr.return;r!==null;){var n=r;switch(r1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Wd();break;case 3:Ul(),dr(Qn),dr(Pn),f1();break;case 5:u1(n);break;case 4:Ul();break;case 13:dr(wr);break;case 19:dr(wr);break;case 10:i1(n.type._context);break;case 22:case 23:k1()}r=r.return}if(ln=e,Hr=e=Di(e.current,null),vn=oa=t,Jr=0,Nu=null,_1=Xh=bo=0,Zn=Yc=null,co!==null){for(t=0;t<co.length;t++)if(r=co[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}co=null}return e}function tb(e,t){do{var r=Hr;try{if(s1(),kd.current=Qd,Jd){for(var n=br.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Jd=!1}if(ko=0,an=Xr=br=null,Xc=!1,Eu=0,y1.current=null,r===null||r.return===null){Jr=1,Nu=t,Hr=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=vn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var v=o_(i);if(v!==null){v.flags&=-257,l_(v,i,o,s,t),v.mode&1&&i_(s,c,t),t=v,l=c;var y=t.updateQueue;if(y===null){var p=new Set;p.add(l),t.updateQueue=p}else y.add(l);break e}else{if(!(t&1)){i_(s,c,t),b1();break e}l=Error(ze(426))}}else if(mr&&o.mode&1){var _=o_(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),l_(_,i,o,s,t),n1(zl(l,o));break e}}s=l=zl(l,o),Jr!==4&&(Jr=2),Yc===null?Yc=[s]:Yc.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=Mk(s,l,t);e_(s,x);break e;case 1:o=l;var k=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Oi===null||!Oi.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=Bk(s,o,t);e_(s,E);break e}}s=s.return}while(s!==null)}ab(r)}catch(I){t=I,Hr===r&&r!==null&&(Hr=r=r.return);continue}break}while(!0)}function rb(){var e=eh.current;return eh.current=Qd,e===null?Qd:e}function b1(){(Jr===0||Jr===3||Jr===2)&&(Jr=4),ln===null||!(bo&268435455)&&!(Xh&268435455)||gi(ln,vn)}function nh(e,t){var r=zt;zt|=2;var n=rb();(ln!==e||vn!==t)&&(Ps=null,po(e,t));do try{V6();break}catch(a){tb(e,a)}while(!0);if(s1(),zt=r,eh.current=n,Hr!==null)throw Error(ze(261));return ln=null,vn=0,Jr}function V6(){for(;Hr!==null;)nb(Hr)}function W6(){for(;Hr!==null&&!m3();)nb(Hr)}function nb(e){var t=ib(e.alternate,e,oa);e.memoizedProps=e.pendingProps,t===null?ab(e):Hr=t,y1.current=null}function ab(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=L6(r,t),r!==null){r.flags&=32767,Hr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Jr=6,Hr=null;return}}else if(r=F6(r,t,oa),r!==null){Hr=r;return}if(t=t.sibling,t!==null){Hr=t;return}Hr=t=e}while(t!==null);Jr===0&&(Jr=5)}function no(e,t,r){var n=er,a=Ia.transition;try{Ia.transition=null,er=1,H6(e,t,r,n)}finally{Ia.transition=a,er=n}return null}function H6(e,t,r,n){do Il();while(ki!==null);if(zt&6)throw Error(ze(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ze(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(E3(e,s),e===ln&&(Hr=ln=null,vn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Kf||(Kf=!0,ob(Md,function(){return Il(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ia.transition,Ia.transition=null;var i=er;er=1;var o=zt;zt|=4,y1.current=null,B6(e,r),Jk(r,e),f6(Nm),$d=!!Cm,Nm=Cm=null,e.current=r,$6(r),g3(),zt=o,er=i,Ia.transition=s}else e.current=r;if(Kf&&(Kf=!1,ki=e,rh=a),s=e.pendingLanes,s===0&&(Oi=null),_3(r.stateNode),ta(e,jr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(th)throw th=!1,e=Gm,Gm=null,e;return rh&1&&e.tag!==0&&Il(),s=e.pendingLanes,s&1?e===Xm?Jc++:(Jc=0,Xm=e):Jc=0,Ui(),null}function Il(){if(ki!==null){var e=M2(rh),t=Ia.transition,r=er;try{if(Ia.transition=null,er=16>e?16:e,ki===null)var n=!1;else{if(e=ki,ki=null,rh=0,zt&6)throw Error(ze(331));var a=zt;for(zt|=4,ot=e.current;ot!==null;){var s=ot,i=s.child;if(ot.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ot=c;ot!==null;){var u=ot;switch(u.tag){case 0:case 11:case 15:Zc(8,u,s)}var d=u.child;if(d!==null)d.return=u,ot=d;else for(;ot!==null;){u=ot;var h=u.sibling,v=u.return;if(Xk(u),u===c){ot=null;break}if(h!==null){h.return=v,ot=h;break}ot=v}}}var y=s.alternate;if(y!==null){var p=y.child;if(p!==null){y.child=null;do{var _=p.sibling;p.sibling=null,p=_}while(p!==null)}}ot=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,ot=i;else e:for(;ot!==null;){if(s=ot,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Zc(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ot=x;break e}ot=s.return}}var k=e.current;for(ot=k;ot!==null;){i=ot;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,ot=w;else e:for(i=k;ot!==null;){if(o=ot,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Gh(9,o)}}catch(I){Nr(o,o.return,I)}if(o===i){ot=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,ot=E;break e}ot=o.return}}if(zt=a,Ui(),xs&&typeof xs.onPostCommitFiberRoot=="function")try{xs.onPostCommitFiberRoot($h,e)}catch{}n=!0}return n}finally{er=r,Ia.transition=t}}return!1}function x_(e,t,r){t=zl(r,t),t=Mk(e,t,1),e=Ai(e,t,1),t=Wn(),e!==null&&(Gu(e,1,t),ta(e,t))}function Nr(e,t,r){if(e.tag===3)x_(e,e,r);else for(;t!==null;){if(t.tag===3){x_(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Oi===null||!Oi.has(n))){e=zl(r,e),e=Bk(t,e,1),t=Ai(t,e,1),e=Wn(),t!==null&&(Gu(t,1,e),ta(t,e));break}}t=t.return}}function K6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Wn(),e.pingedLanes|=e.suspendedLanes&r,ln===e&&(vn&r)===r&&(Jr===4||Jr===3&&(vn&130023424)===vn&&500>jr()-w1?po(e,0):_1|=r),ta(e,t)}function sb(e,t){t===0&&(e.mode&1?(t=Ff,Ff<<=1,!(Ff&130023424)&&(Ff=4194304)):t=1);var r=Wn();e=qs(e,t),e!==null&&(Gu(e,t,r),ta(e,r))}function q6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),sb(e,r)}function G6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ze(314))}n!==null&&n.delete(t),sb(e,r)}var ib;ib=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Qn.current)Jn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Jn=!1,j6(e,t,r);Jn=!!(e.flags&131072)}else Jn=!1,mr&&t.flags&1048576&&uk(t,qd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Sd(e,t),e=t.pendingProps;var a=Ml(t,Pn.current);Ol(t,r),a=h1(null,t,n,e,a,r);var s=p1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ea(n)?(s=!0,Hd(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,l1(t),a.updater=qh,t.stateNode=a,a._reactInternals=t,Lm(t,n,e,r),t=$m(null,t,n,!0,s,r)):(t.tag=0,mr&&s&&t1(t),$n(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Sd(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Z6(n),e=Va(n,e),a){case 0:t=Bm(null,t,n,e,r);break e;case 1:t=f_(null,t,n,e,r);break e;case 11:t=c_(null,t,n,e,r);break e;case 14:t=u_(null,t,n,Va(n.type,e),r);break e}throw Error(ze(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Va(n,a),Bm(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Va(n,a),f_(e,t,n,a,r);case 3:e:{if(Vk(t),e===null)throw Error(ze(387));n=t.pendingProps,s=t.memoizedState,a=s.element,gk(e,t),Zd(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=zl(Error(ze(423)),t),t=d_(e,t,n,r,a);break e}else if(n!==a){a=zl(Error(ze(424)),t),t=d_(e,t,n,r,a);break e}else for(da=Ni(t.stateNode.containerInfo.firstChild),ha=t,mr=!0,Ka=null,r=pk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Bl(),n===a){t=Gs(e,t,r);break e}$n(e,t,n,r)}t=t.child}return t;case 5:return vk(t),e===null&&Rm(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,Am(n,a)?i=null:s!==null&&Am(n,s)&&(t.flags|=32),zk(e,t),$n(e,t,i,r),t.child;case 6:return e===null&&Rm(t),null;case 13:return Wk(e,t,r);case 4:return c1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=$l(t,null,n,r):$n(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Va(n,a),c_(e,t,n,a,r);case 7:return $n(e,t,t.pendingProps,r),t.child;case 8:return $n(e,t,t.pendingProps.children,r),t.child;case 12:return $n(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,ir(Gd,n._currentValue),n._currentValue=i,s!==null)if(ts(s.value,i)){if(s.children===a.children&&!Qn.current){t=Gs(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Bs(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),jm(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(ze(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),jm(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}$n(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ol(t,r),a=Pa(a),n=n(a),t.flags|=1,$n(e,t,n,r),t.child;case 14:return n=t.type,a=Va(n,t.pendingProps),a=Va(n.type,a),u_(e,t,n,a,r);case 15:return $k(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Va(n,a),Sd(e,t),t.tag=1,ea(n)?(e=!0,Hd(t)):e=!1,Ol(t,r),Lk(t,n,a),Lm(t,n,a,r),$m(null,t,n,!0,e,r);case 19:return Hk(e,t,r);case 22:return Uk(e,t,r)}throw Error(ze(156,t.tag))};function ob(e,t){return R2(e,t)}function X6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oa(e,t,r,n){return new X6(e,t,r,n)}function S1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Z6(e){if(typeof e=="function")return S1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Vg)return 11;if(e===Wg)return 14}return 2}function Di(e,t){var r=e.alternate;return r===null?(r=Oa(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Cd(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")S1(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case dl:return mo(r.children,a,s,t);case zg:i=8,a|=8;break;case om:return e=Oa(12,r,t,a|2),e.elementType=om,e.lanes=s,e;case lm:return e=Oa(13,r,t,a),e.elementType=lm,e.lanes=s,e;case cm:return e=Oa(19,r,t,a),e.elementType=cm,e.lanes=s,e;case v2:return Zh(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case m2:i=10;break e;case g2:i=9;break e;case Vg:i=11;break e;case Wg:i=14;break e;case hi:i=16,n=null;break e}throw Error(ze(130,e==null?e:typeof e,""))}return t=Oa(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function mo(e,t,r,n){return e=Oa(7,e,n,t),e.lanes=r,e}function Zh(e,t,r,n){return e=Oa(22,e,n,t),e.elementType=v2,e.lanes=r,e.stateNode={isHidden:!1},e}function Sp(e,t,r){return e=Oa(6,e,null,t),e.lanes=r,e}function Ep(e,t,r){return t=Oa(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Y6(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sp(0),this.expirationTimes=sp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sp(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function E1(e,t,r,n,a,s,i,o,l){return e=new Y6(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Oa(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},l1(s),e}function J6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function lb(e){if(!e)return Ri;e=e._reactInternals;e:{if(Ro(e)!==e||e.tag!==1)throw Error(ze(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ea(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ze(171))}if(e.tag===1){var r=e.type;if(ea(r))return lk(e,r,t)}return t}function cb(e,t,r,n,a,s,i,o,l){return e=E1(r,n,!0,e,a,s,i,o,l),e.context=lb(null),r=e.current,n=Wn(),a=Ii(r),s=Bs(n,a),s.callback=t??null,Ai(r,s,a),e.current.lanes=a,Gu(e,a,n),ta(e,n),e}function Yh(e,t,r,n){var a=t.current,s=Wn(),i=Ii(a);return r=lb(r),t.context===null?t.context=r:t.pendingContext=r,t=Bs(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ai(a,t,i),e!==null&&(Ja(e,a,i,s),xd(e,a,i)),i}function ah(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function k_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function T1(e,t){k_(e,t),(e=e.alternate)&&k_(e,t)}function Q6(){return null}var ub=typeof reportError=="function"?reportError:function(e){console.error(e)};function C1(e){this._internalRoot=e}Jh.prototype.render=C1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ze(409));Yh(e,t,null,null)};Jh.prototype.unmount=C1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;So(function(){Yh(null,e,null,null)}),t[Ks]=null}};function Jh(e){this._internalRoot=e}Jh.prototype.unstable_scheduleHydration=function(e){if(e){var t=U2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<mi.length&&t!==0&&t<mi[r].priority;r++);mi.splice(r,0,e),r===0&&V2(e)}};function N1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Qh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function b_(){}function e5(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=ah(i);s.call(c)}}var i=cb(t,n,e,0,null,!1,!1,"",b_);return e._reactRootContainer=i,e[Ks]=i.current,wu(e.nodeType===8?e.parentNode:e),So(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=ah(l);o.call(c)}}var l=E1(e,0,!1,null,null,!1,!1,"",b_);return e._reactRootContainer=l,e[Ks]=l.current,wu(e.nodeType===8?e.parentNode:e),So(function(){Yh(t,l,r,n)}),l}function e0(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=ah(i);o.call(l)}}Yh(t,i,e,a)}else i=e5(r,t,e,a,n);return ah(i)}B2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Lc(t.pendingLanes);r!==0&&(qg(t,r|1),ta(t,jr()),!(zt&6)&&(Vl=jr()+500,Ui()))}break;case 13:So(function(){var n=qs(e,1);if(n!==null){var a=Wn();Ja(n,e,1,a)}}),T1(e,1)}};Gg=function(e){if(e.tag===13){var t=qs(e,134217728);if(t!==null){var r=Wn();Ja(t,e,134217728,r)}T1(e,134217728)}};$2=function(e){if(e.tag===13){var t=Ii(e),r=qs(e,t);if(r!==null){var n=Wn();Ja(r,e,t,n)}T1(e,t)}};U2=function(){return er};z2=function(e,t){var r=er;try{return er=e,t()}finally{er=r}};_m=function(e,t,r){switch(t){case"input":if(dm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Wh(n);if(!a)throw Error(ze(90));_2(n),dm(n,a)}}}break;case"textarea":x2(e,r);break;case"select":t=r.value,t!=null&&Tl(e,!!r.multiple,t,!1)}};N2=x1;A2=So;var t5={usingClientEntryPoint:!1,Events:[Zu,gl,Wh,T2,C2,x1]},Ec={findFiberByHostInstance:lo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},r5={bundleType:Ec.bundleType,version:Ec.version,rendererPackageName:Ec.rendererPackageName,rendererConfig:Ec.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Js.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=D2(e),e===null?null:e.stateNode},findFiberByHostInstance:Ec.findFiberByHostInstance||Q6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qf.isDisabled&&qf.supportsFiber)try{$h=qf.inject(r5),xs=qf}catch{}}va.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t5;va.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N1(t))throw Error(ze(200));return J6(e,t,null,r)};va.createRoot=function(e,t){if(!N1(e))throw Error(ze(299));var r=!1,n="",a=ub;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=E1(e,1,!1,null,null,r,!1,n,a),e[Ks]=t.current,wu(e.nodeType===8?e.parentNode:e),new C1(t)};va.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ze(188)):(e=Object.keys(e).join(","),Error(ze(268,e)));return e=D2(t),e=e===null?null:e.stateNode,e};va.flushSync=function(e){return So(e)};va.hydrate=function(e,t,r){if(!Qh(t))throw Error(ze(200));return e0(null,e,t,!0,r)};va.hydrateRoot=function(e,t,r){if(!N1(e))throw Error(ze(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=ub;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=cb(t,null,e,1,r??null,a,!1,s,i),e[Ks]=t.current,wu(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Jh(t)};va.render=function(e,t,r){if(!Qh(t))throw Error(ze(200));return e0(null,e,t,!1,r)};va.unmountComponentAtNode=function(e){if(!Qh(e))throw Error(ze(40));return e._reactRootContainer?(So(function(){e0(null,null,e,!1,function(){e._reactRootContainer=null,e[Ks]=null})}),!0):!1};va.unstable_batchedUpdates=x1;va.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Qh(r))throw Error(ze(200));if(e==null||e._reactInternals===void 0)throw Error(ze(38));return e0(e,t,r,!1,n)};va.version="18.3.1-next-f1338f8080-20240426";function fb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fb)}catch(e){console.error(e)}}fb(),f2.exports=va;var n5=f2.exports,db,S_=n5;db=S_.createRoot,S_.hydrateRoot;/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var E_="popstate";function a5(e={}){function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return Jm("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Au(a)}return i5(t,r,null,e)}function gr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function rs(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function s5(){return Math.random().toString(36).substring(2,10)}function T_(e,t){return{usr:e.state,key:e.key,idx:t}}function Jm(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Jl(t):t,state:r,key:t&&t.key||n||s5()}}function Au({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Jl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function i5(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o="POP",l=null,c=u();c==null&&(c=0,i.replaceState({...i.state,idx:c},""));function u(){return(i.state||{idx:null}).idx}function d(){o="POP";let _=u(),x=_==null?null:_-c;c=_,l&&l({action:o,location:p.location,delta:x})}function h(_,x){o="PUSH";let k=Jm(p.location,_,x);c=u()+1;let w=T_(k,c),E=p.createHref(k);try{i.pushState(w,"",E)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;a.location.assign(E)}s&&l&&l({action:o,location:p.location,delta:1})}function v(_,x){o="REPLACE";let k=Jm(p.location,_,x);c=u();let w=T_(k,c),E=p.createHref(k);i.replaceState(w,"",E),s&&l&&l({action:o,location:p.location,delta:0})}function y(_){return o5(_)}let p={get action(){return o},get location(){return e(a,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(E_,d),l=_,()=>{a.removeEventListener(E_,d),l=null}},createHref(_){return t(a,_)},createURL:y,encodeLocation(_){let x=y(_);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:v,go(_){return i.go(_)}};return p}function o5(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),gr(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Au(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function hb(e,t,r="/"){return l5(e,t,r,!1)}function l5(e,t,r,n){let a=typeof t=="string"?Jl(t):t,s=Xs(a.pathname||"/",r);if(s==null)return null;let i=pb(e);c5(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=w5(s);o=y5(i[l],c,n)}return o}function pb(e,t=[],r=[],n="",a=!1){let s=(i,o,l=a,c)=>{let u={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&l)return;gr(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let d=$s([n,u.relativePath]),h=r.concat(u);i.children&&i.children.length>0&&(gr(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),pb(i.children,t,h,d,l)),!(i.path==null&&!i.index)&&t.push({path:d,score:g5(d,i.index),routesMeta:h})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of mb(i.path))s(i,o,!0,c)}),t}function mb(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=mb(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function c5(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:v5(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var u5=/^:[\w-]+$/,f5=3,d5=2,h5=1,p5=10,m5=-2,C_=e=>e==="*";function g5(e,t){let r=e.split("/"),n=r.length;return r.some(C_)&&(n+=m5),t&&(n+=d5),r.filter(a=>!C_(a)).reduce((a,s)=>a+(u5.test(s)?f5:s===""?h5:p5),n)}function v5(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function y5(e,t,r=!1){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?t:t.slice(s.length)||"/",d=sh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&r&&!n[n.length-1].route.index&&(d=sh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:$s([s,d.pathname]),pathnameBase:S5($s([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=$s([s,d.pathnameBase]))}return i}function sh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=_5(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,{paramName:u,isOptional:d},h)=>{if(u==="*"){let y=o[h]||"";i=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const v=o[h];return d&&!v?c[u]=void 0:c[u]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function _5(e,t=!1,r=!0){rs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function w5(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return rs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Xs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function x5(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Jl(e):e;return{pathname:r?r.startsWith("/")?r:k5(r,t):t,search:E5(n),hash:T5(a)}}function k5(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Tp(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function b5(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function A1(e){let t=b5(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function O1(e,t,r,n=!1){let a;typeof e=="string"?a=Jl(e):(a={...e},gr(!a.pathname||!a.pathname.includes("?"),Tp("?","pathname","search",a)),gr(!a.pathname||!a.pathname.includes("#"),Tp("#","pathname","hash",a)),gr(!a.search||!a.search.includes("#"),Tp("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}o=d>=0?t[d]:"/"}let l=x5(a,o),c=i&&i!=="/"&&i.endsWith("/"),u=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var $s=e=>e.join("/").replace(/\/\/+/g,"/"),S5=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),E5=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,T5=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function C5(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var gb=["POST","PUT","PATCH","DELETE"];new Set(gb);var N5=["GET",...gb];new Set(N5);var Ql=j.createContext(null);Ql.displayName="DataRouter";var t0=j.createContext(null);t0.displayName="DataRouterState";j.createContext(!1);var vb=j.createContext({isTransitioning:!1});vb.displayName="ViewTransition";var A5=j.createContext(new Map);A5.displayName="Fetchers";var O5=j.createContext(null);O5.displayName="Await";var ns=j.createContext(null);ns.displayName="Navigation";var Ju=j.createContext(null);Ju.displayName="Location";var bs=j.createContext({outlet:null,matches:[],isDataRoute:!1});bs.displayName="Route";var I1=j.createContext(null);I1.displayName="RouteError";function I5(e,{relative:t}={}){gr(ec(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=j.useContext(ns),{hash:a,pathname:s,search:i}=Qu(e,{relative:t}),o=s;return r!=="/"&&(o=s==="/"?r:$s([r,s])),n.createHref({pathname:o,search:i,hash:a})}function ec(){return j.useContext(Ju)!=null}function zi(){return gr(ec(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(Ju).location}var yb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function _b(e){j.useContext(ns).static||j.useLayoutEffect(e)}function D1(){let{isDataRoute:e}=j.useContext(bs);return e?W5():D5()}function D5(){gr(ec(),"useNavigate() may be used only in the context of a <Router> component.");let e=j.useContext(Ql),{basename:t,navigator:r}=j.useContext(ns),{matches:n}=j.useContext(bs),{pathname:a}=zi(),s=JSON.stringify(A1(n)),i=j.useRef(!1);return _b(()=>{i.current=!0}),j.useCallback((l,c={})=>{if(rs(i.current,yb),!i.current)return;if(typeof l=="number"){r.go(l);return}let u=O1(l,JSON.parse(s),a,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:$s([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,s,a,e])}j.createContext(null);function Qu(e,{relative:t}={}){let{matches:r}=j.useContext(bs),{pathname:n}=zi(),a=JSON.stringify(A1(r));return j.useMemo(()=>O1(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function P5(e,t){return wb(e,t)}function wb(e,t,r,n,a){var k;gr(ec(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=j.useContext(ns),{matches:i}=j.useContext(bs),o=i[i.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",d=o&&o.route;{let w=d&&d.path||"";xb(c,!d||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let h=zi(),v;if(t){let w=typeof t=="string"?Jl(t):t;gr(u==="/"||((k=w.pathname)==null?void 0:k.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${w.pathname}" was given in the \`location\` prop.`),v=w}else v=h;let y=v.pathname||"/",p=y;if(u!=="/"){let w=u.replace(/^\//,"").split("/");p="/"+y.replace(/^\//,"").split("/").slice(w.length).join("/")}let _=hb(e,{pathname:p});rs(d||_!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),rs(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=M5(_&&_.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:$s([u,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?u:$s([u,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,r,n,a);return t&&x?j.createElement(Ju.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},x):x}function R5(){let e=V5(),t=C5(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=j.createElement(j.Fragment,null,j.createElement("p",null,"💿 Hey developer 👋"),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:s},"ErrorBoundary")," or"," ",j.createElement("code",{style:s},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},t),r?j.createElement("pre",{style:a},r):null,i)}var j5=j.createElement(R5,null),F5=class extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?j.createElement(bs.Provider,{value:this.props.routeContext},j.createElement(I1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function L5({routeContext:e,match:t,children:r}){let n=j.useContext(Ql);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(bs.Provider,{value:e},r)}function M5(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,i=r==null?void 0:r.errors;if(i!=null){let c=s.findIndex(u=>u.route.id&&(i==null?void 0:i[u.route.id])!==void 0);gr(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<s.length;c++){let u=s[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:h}=r,v=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!h||h[u.route.id]===void 0);if(u.route.lazy||v){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,u,d)=>{let h,v=!1,y=null,p=null;r&&(h=i&&u.route.id?i[u.route.id]:void 0,y=u.route.errorElement||j5,o&&(l<0&&d===0?(xb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,p=null):l===d&&(v=!0,p=u.route.hydrateFallbackElement||null)));let _=t.concat(s.slice(0,d+1)),x=()=>{let k;return h?k=y:v?k=p:u.route.Component?k=j.createElement(u.route.Component,null):u.route.element?k=u.route.element:k=c,j.createElement(L5,{match:u,routeContext:{outlet:c,matches:_,isDataRoute:r!=null},children:k})};return r&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?j.createElement(F5,{location:r.location,revalidation:r.revalidation,component:y,error:h,children:x(),routeContext:{outlet:null,matches:_,isDataRoute:!0},unstable_onError:n}):x()},null)}function P1(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function B5(e){let t=j.useContext(Ql);return gr(t,P1(e)),t}function $5(e){let t=j.useContext(t0);return gr(t,P1(e)),t}function U5(e){let t=j.useContext(bs);return gr(t,P1(e)),t}function R1(e){let t=U5(e),r=t.matches[t.matches.length-1];return gr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function z5(){return R1("useRouteId")}function V5(){var n;let e=j.useContext(I1),t=$5("useRouteError"),r=R1("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function W5(){let{router:e}=B5("useNavigate"),t=R1("useNavigate"),r=j.useRef(!1);return _b(()=>{r.current=!0}),j.useCallback(async(a,s={})=>{rs(r.current,yb),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...s}))},[e,t])}var N_={};function xb(e,t,r){!t&&!N_[e]&&(N_[e]=!0,rs(!1,r))}j.memo(H5);function H5({routes:e,future:t,state:r,unstable_onError:n}){return wb(e,void 0,r,n,t)}function Qm({to:e,replace:t,state:r,relative:n}){gr(ec(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=j.useContext(ns);rs(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=j.useContext(bs),{pathname:i}=zi(),o=D1(),l=O1(e,A1(s),i,n==="path"),c=JSON.stringify(l);return j.useEffect(()=>{o(JSON.parse(c),{replace:t,state:r,relative:n})},[o,c,n,t,r]),null}function Nd(e){gr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function K5({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){gr(!ec(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),o=j.useMemo(()=>({basename:i,navigator:a,static:s,future:{}}),[i,a,s]);typeof r=="string"&&(r=Jl(r));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:h="default"}=r,v=j.useMemo(()=>{let y=Xs(l,i);return y==null?null:{location:{pathname:y,search:c,hash:u,state:d,key:h},navigationType:n}},[i,l,c,u,d,h,n]);return rs(v!=null,`<Router basename="${i}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:j.createElement(ns.Provider,{value:o},j.createElement(Ju.Provider,{children:t,value:v}))}function q5({children:e,location:t}){return P5(eg(e),t)}function eg(e,t=[]){let r=[];return j.Children.forEach(e,(n,a)=>{if(!j.isValidElement(n))return;let s=[...t,a];if(n.type===j.Fragment){r.push.apply(r,eg(n.props.children,s));return}gr(n.type===Nd,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=eg(n.props.children,s)),r.push(i)}),r}var Ad="get",Od="application/x-www-form-urlencoded";function r0(e){return e!=null&&typeof e.tagName=="string"}function G5(e){return r0(e)&&e.tagName.toLowerCase()==="button"}function X5(e){return r0(e)&&e.tagName.toLowerCase()==="form"}function Z5(e){return r0(e)&&e.tagName.toLowerCase()==="input"}function Y5(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function J5(e,t){return e.button===0&&(!t||t==="_self")&&!Y5(e)}var Gf=null;function Q5(){if(Gf===null)try{new FormData(document.createElement("form"),0),Gf=!1}catch{Gf=!0}return Gf}var eC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Cp(e){return e!=null&&!eC.has(e)?(rs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Od}"`),null):e}function tC(e,t){let r,n,a,s,i;if(X5(e)){let o=e.getAttribute("action");n=o?Xs(o,t):null,r=e.getAttribute("method")||Ad,a=Cp(e.getAttribute("enctype"))||Od,s=new FormData(e)}else if(G5(e)||Z5(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||o.getAttribute("action");if(n=l?Xs(l,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||Ad,a=Cp(e.getAttribute("formenctype"))||Cp(o.getAttribute("enctype"))||Od,s=new FormData(o,e),!Q5()){let{name:c,type:u,value:d}=e;if(u==="image"){let h=c?`${c}.`:"";s.append(`${h}x`,"0"),s.append(`${h}y`,"0")}else c&&s.append(c,d)}}else{if(r0(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Ad,n=null,a=Od,i=e}return s&&a==="text/plain"&&(i=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function j1(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function rC(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&Xs(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function nC(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function aC(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function sC(e,t,r){let n=await Promise.all(e.map(async a=>{let s=t.routes[a.route.id];if(s){let i=await nC(s,r);return i.links?i.links():[]}return[]}));return cC(n.flat(1).filter(aC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function A_(e,t,r,n,a,s){let i=(l,c)=>r[c]?l.route.id!==r[c].route.id:!0,o=(l,c)=>{var u;return r[c].pathname!==l.pathname||((u=r[c].route.path)==null?void 0:u.endsWith("*"))&&r[c].params["*"]!==l.params["*"]};return s==="assets"?t.filter((l,c)=>i(l,c)||o(l,c)):s==="data"?t.filter((l,c)=>{var d;let u=n.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(i(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=r[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function iC(e,t,{includeHydrateFallback:r}={}){return oC(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function oC(e){return[...new Set(e)]}function lC(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function cC(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let s=JSON.stringify(lC(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function kb(){let e=j.useContext(Ql);return j1(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function uC(){let e=j.useContext(t0);return j1(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var F1=j.createContext(void 0);F1.displayName="FrameworkContext";function bb(){let e=j.useContext(F1);return j1(e,"You must render this element inside a <HydratedRouter> element"),e}function fC(e,t){let r=j.useContext(F1),[n,a]=j.useState(!1),[s,i]=j.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=t,h=j.useRef(null);j.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let p=x=>{x.forEach(k=>{i(k.isIntersecting)})},_=new IntersectionObserver(p,{threshold:.5});return h.current&&_.observe(h.current),()=>{_.disconnect()}}},[e]),j.useEffect(()=>{if(n){let p=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(p)}}},[n]);let v=()=>{a(!0)},y=()=>{a(!1),i(!1)};return r?e!=="intent"?[s,h,{}]:[s,h,{onFocus:Tc(o,v),onBlur:Tc(l,y),onMouseEnter:Tc(c,v),onMouseLeave:Tc(u,y),onTouchStart:Tc(d,v)}]:[!1,h,{}]}function Tc(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function dC({page:e,...t}){let{router:r}=kb(),n=j.useMemo(()=>hb(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?j.createElement(pC,{page:e,matches:n,...t}):null}function hC(e){let{manifest:t,routeModules:r}=bb(),[n,a]=j.useState([]);return j.useEffect(()=>{let s=!1;return sC(e,t,r).then(i=>{s||a(i)}),()=>{s=!0}},[e,t,r]),n}function pC({page:e,matches:t,...r}){let n=zi(),{manifest:a,routeModules:s}=bb(),{basename:i}=kb(),{loaderData:o,matches:l}=uC(),c=j.useMemo(()=>A_(e,t,l,a,n,"data"),[e,t,l,a,n]),u=j.useMemo(()=>A_(e,t,l,a,n,"assets"),[e,t,l,a,n]),d=j.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let y=new Set,p=!1;if(t.forEach(x=>{var w;let k=a.routes[x.route.id];!k||!k.hasLoader||(!c.some(E=>E.route.id===x.route.id)&&x.route.id in o&&((w=s[x.route.id])!=null&&w.shouldRevalidate)||k.hasClientLoader?p=!0:y.add(x.route.id))}),y.size===0)return[];let _=rC(e,i,"data");return p&&y.size>0&&_.searchParams.set("_routes",t.filter(x=>y.has(x.route.id)).map(x=>x.route.id).join(",")),[_.pathname+_.search]},[i,o,n,a,c,t,e,s]),h=j.useMemo(()=>iC(u,a),[u,a]),v=hC(u);return j.createElement(j.Fragment,null,d.map(y=>j.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),h.map(y=>j.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),v.map(({key:y,link:p})=>j.createElement("link",{key:y,nonce:r.nonce,...p})))}function mC(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Sb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Sb&&(window.__reactRouterVersion="7.8.2")}catch{}function gC({basename:e,children:t,window:r}){let n=j.useRef();n.current==null&&(n.current=a5({window:r,v5Compat:!0}));let a=n.current,[s,i]=j.useState({action:a.action,location:a.location}),o=j.useCallback(l=>{j.startTransition(()=>i(l))},[i]);return j.useLayoutEffect(()=>a.listen(o),[a,o]),j.createElement(K5,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:a})}var Eb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tb=j.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d,...h},v){let{basename:y}=j.useContext(ns),p=typeof c=="string"&&Eb.test(c),_,x=!1;if(typeof c=="string"&&p&&(_=c,Sb))try{let z=new URL(window.location.href),ee=c.startsWith("//")?new URL(z.protocol+c):new URL(c),re=Xs(ee.pathname,y);ee.origin===z.origin&&re!=null?c=re+ee.search+ee.hash:x=!0}catch{rs(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=I5(c,{relative:a}),[w,E,I]=fC(n,h),D=wC(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:d});function C(z){t&&t(z),z.defaultPrevented||D(z)}let V=j.createElement("a",{...h,...I,href:_||k,onClick:x||s?t:C,ref:mC(v,E),target:l,"data-discover":!p&&r==="render"?"true":void 0});return w&&!p?j.createElement(j.Fragment,null,V,j.createElement(dC,{page:k})):V});Tb.displayName="Link";var vC=j.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:i,viewTransition:o,children:l,...c},u){let d=Qu(i,{relative:c.relative}),h=zi(),v=j.useContext(t0),{navigator:y,basename:p}=j.useContext(ns),_=v!=null&&EC(d)&&o===!0,x=y.encodeLocation?y.encodeLocation(d).pathname:d.pathname,k=h.pathname,w=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(k=k.toLowerCase(),w=w?w.toLowerCase():null,x=x.toLowerCase()),w&&p&&(w=Xs(w,p)||w);const E=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let I=k===x||!a&&k.startsWith(x)&&k.charAt(E)==="/",D=w!=null&&(w===x||!a&&w.startsWith(x)&&w.charAt(x.length)==="/"),C={isActive:I,isPending:D,isTransitioning:_},V=I?t:void 0,z;typeof n=="function"?z=n(C):z=[n,I?"active":null,D?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let ee=typeof s=="function"?s(C):s;return j.createElement(Tb,{...c,"aria-current":V,className:z,ref:u,style:ee,to:i,viewTransition:o},typeof l=="function"?l(C):l)});vC.displayName="NavLink";var yC=j.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:s,method:i=Ad,action:o,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...h},v)=>{let y=bC(),p=SC(o,{relative:c}),_=i.toLowerCase()==="get"?"get":"post",x=typeof o=="string"&&Eb.test(o),k=w=>{if(l&&l(w),w.defaultPrevented)return;w.preventDefault();let E=w.nativeEvent.submitter,I=(E==null?void 0:E.getAttribute("formmethod"))||i;y(E||w.currentTarget,{fetcherKey:t,method:I,navigate:r,replace:a,state:s,relative:c,preventScrollReset:u,viewTransition:d})};return j.createElement("form",{ref:v,method:_,action:p,onSubmit:n?l:k,...h,"data-discover":!x&&e==="render"?"true":void 0})});yC.displayName="Form";function _C(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Cb(e){let t=j.useContext(Ql);return gr(t,_C(e)),t}function wC(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:i}={}){let o=D1(),l=zi(),c=Qu(e,{relative:s});return j.useCallback(u=>{if(J5(u,t)){u.preventDefault();let d=r!==void 0?r:Au(l)===Au(c);o(e,{replace:d,state:n,preventScrollReset:a,relative:s,viewTransition:i})}},[l,o,c,r,n,t,e,a,s,i])}var xC=0,kC=()=>`__${String(++xC)}__`;function bC(){let{router:e}=Cb("useSubmit"),{basename:t}=j.useContext(ns),r=z5();return j.useCallback(async(n,a={})=>{let{action:s,method:i,encType:o,formData:l,body:c}=tC(n,t);if(a.navigate===!1){let u=a.fetcherKey||kC();await e.fetch(u,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function SC(e,{relative:t}={}){let{basename:r}=j.useContext(ns),n=j.useContext(bs);gr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...Qu(e||".",{relative:t})},i=zi();if(e==null){s.search=i.search;let o=new URLSearchParams(s.search),l=o.getAll("index");if(l.some(u=>u==="")){o.delete("index"),l.filter(d=>d).forEach(d=>o.append("index",d));let u=o.toString();s.search=u?`?${u}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:$s([r,s.pathname])),Au(s)}function EC(e,{relative:t}={}){let r=j.useContext(vb);gr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Cb("useViewTransitionState"),a=Qu(e,{relative:t});if(!r.isTransitioning)return!1;let s=Xs(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=Xs(r.nextLocation.pathname,n)||r.nextLocation.pathname;return sh(a.pathname,i)!=null||sh(a.pathname,s)!=null}let TC={data:""},CC=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||TC,NC=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,AC=/\/\*[^]*?\*\/|  +/g,O_=/\n+/g,vi=(e,t)=>{let r="",n="",a="";for(let s in e){let i=e[s];s[0]=="@"?s[1]=="i"?r=s+" "+i+";":n+=s[1]=="f"?vi(i,s):s+"{"+vi(i,s[1]=="k"?"":t)+"}":typeof i=="object"?n+=vi(i,t?t.replace(/([^,])+/g,o=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,o):o?o+" "+l:l)):s):i!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=vi.p?vi.p(s,i):s+":"+i+";")}return r+(t&&a?t+"{"+a+"}":a)+n},As={},Nb=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Nb(e[r]);return t}return e},OC=(e,t,r,n,a)=>{let s=Nb(e),i=As[s]||(As[s]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(s));if(!As[i]){let l=s!==e?e:(c=>{let u,d,h=[{}];for(;u=NC.exec(c.replace(AC,""));)u[4]?h.shift():u[3]?(d=u[3].replace(O_," ").trim(),h.unshift(h[0][d]=h[0][d]||{})):h[0][u[1]]=u[2].replace(O_," ").trim();return h[0]})(e);As[i]=vi(a?{["@keyframes "+i]:l}:l,r?"":"."+i)}let o=r&&As.g?As.g:null;return r&&(As.g=As[i]),((l,c,u,d)=>{d?c.data=c.data.replace(d,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(As[i],t,n,o),i},IC=(e,t,r)=>e.reduce((n,a,s)=>{let i=t[s];if(i&&i.call){let o=i(r),l=o&&o.props&&o.props.className||/^go/.test(o)&&o;i=l?"."+l:o&&typeof o=="object"?o.props?"":vi(o,""):o===!1?"":o}return n+a+(i??"")},"");function n0(e){let t=this||{},r=e.call?e(t.p):e;return OC(r.unshift?r.raw?IC(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,CC(t.target),t.g,t.o,t.k)}let Ab,tg,rg;n0.bind({g:1});let Zs=n0.bind({k:1});function DC(e,t,r,n){vi.p=t,Ab=e,tg=r,rg=n}function Vi(e,t){let r=this||{};return function(){let n=arguments;function a(s,i){let o=Object.assign({},s),l=o.className||a.className;r.p=Object.assign({theme:tg&&tg()},o),r.o=/ *go\d+/.test(l),o.className=n0.apply(r,n)+(l?" "+l:"");let c=e;return e[0]&&(c=o.as||e,delete o.as),rg&&c[0]&&rg(o),Ab(c,o)}return a}}var PC=e=>typeof e=="function",ih=(e,t)=>PC(e)?e(t):e,RC=(()=>{let e=0;return()=>(++e).toString()})(),Ob=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),jC=20,L1="default",Ib=(e,t)=>{let{toastLimit:r}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,r)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:n}=t;return Ib(e,{type:e.toasts.find(i=>i.id===n.id)?1:0,toast:n});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(i=>i.id===a||a===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},Id=[],Db={toasts:[],pausedAt:void 0,settings:{toastLimit:jC}},ys={},Pb=(e,t=L1)=>{ys[t]=Ib(ys[t]||Db,e),Id.forEach(([r,n])=>{r===t&&n(ys[t])})},Rb=e=>Object.keys(ys).forEach(t=>Pb(e,t)),FC=e=>Object.keys(ys).find(t=>ys[t].toasts.some(r=>r.id===e)),a0=(e=L1)=>t=>{Pb(t,e)},LC={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},MC=(e={},t=L1)=>{let[r,n]=j.useState(ys[t]||Db),a=j.useRef(ys[t]);j.useEffect(()=>(a.current!==ys[t]&&n(ys[t]),Id.push([t,n]),()=>{let i=Id.findIndex(([o])=>o===t);i>-1&&Id.splice(i,1)}),[t]);let s=r.toasts.map(i=>{var o,l,c;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((o=e[i.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((l=e[i.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||LC[i.type],style:{...e.style,...(c=e[i.type])==null?void 0:c.style,...i.style}}});return{...r,toasts:s}},BC=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||RC()}),ef=e=>(t,r)=>{let n=BC(t,e,r);return a0(n.toasterId||FC(n.id))({type:2,toast:n}),n.id},Zr=(e,t)=>ef("blank")(e,t);Zr.error=ef("error");Zr.success=ef("success");Zr.loading=ef("loading");Zr.custom=ef("custom");Zr.dismiss=(e,t)=>{let r={type:3,toastId:e};t?a0(t)(r):Rb(r)};Zr.dismissAll=e=>Zr.dismiss(void 0,e);Zr.remove=(e,t)=>{let r={type:4,toastId:e};t?a0(t)(r):Rb(r)};Zr.removeAll=e=>Zr.remove(void 0,e);Zr.promise=(e,t,r)=>{let n=Zr.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let s=t.success?ih(t.success,a):void 0;return s?Zr.success(s,{id:n,...r,...r==null?void 0:r.success}):Zr.dismiss(n),a}).catch(a=>{let s=t.error?ih(t.error,a):void 0;s?Zr.error(s,{id:n,...r,...r==null?void 0:r.error}):Zr.dismiss(n)}),e};var $C=1e3,UC=(e,t="default")=>{let{toasts:r,pausedAt:n}=MC(e,t),a=j.useRef(new Map).current,s=j.useCallback((d,h=$C)=>{if(a.has(d))return;let v=setTimeout(()=>{a.delete(d),i({type:4,toastId:d})},h);a.set(d,v)},[]);j.useEffect(()=>{if(n)return;let d=Date.now(),h=r.map(v=>{if(v.duration===1/0)return;let y=(v.duration||0)+v.pauseDuration-(d-v.createdAt);if(y<0){v.visible&&Zr.dismiss(v.id);return}return setTimeout(()=>Zr.dismiss(v.id,t),y)});return()=>{h.forEach(v=>v&&clearTimeout(v))}},[r,n,t]);let i=j.useCallback(a0(t),[t]),o=j.useCallback(()=>{i({type:5,time:Date.now()})},[i]),l=j.useCallback((d,h)=>{i({type:1,toast:{id:d,height:h}})},[i]),c=j.useCallback(()=>{n&&i({type:6,time:Date.now()})},[n,i]),u=j.useCallback((d,h)=>{let{reverseOrder:v=!1,gutter:y=8,defaultPosition:p}=h||{},_=r.filter(w=>(w.position||p)===(d.position||p)&&w.height),x=_.findIndex(w=>w.id===d.id),k=_.filter((w,E)=>E<x&&w.visible).length;return _.filter(w=>w.visible).slice(...v?[k+1]:[0,k]).reduce((w,E)=>w+(E.height||0)+y,0)},[r]);return j.useEffect(()=>{r.forEach(d=>{if(d.dismissed)s(d.id,d.removeDelay);else{let h=a.get(d.id);h&&(clearTimeout(h),a.delete(d.id))}})},[r,s]),{toasts:r,handlers:{updateHeight:l,startPause:o,endPause:c,calculateOffset:u}}},zC=Zs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,VC=Zs`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,WC=Zs`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,HC=Vi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${zC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${VC} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${WC} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,KC=Zs`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,qC=Vi("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${KC} 1s linear infinite;
`,GC=Zs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,XC=Zs`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ZC=Vi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${GC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${XC} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,YC=Vi("div")`
  position: absolute;
`,JC=Vi("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,QC=Zs`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,eN=Vi("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${QC} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,tN=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?j.createElement(eN,null,t):t:r==="blank"?null:j.createElement(JC,null,j.createElement(qC,{...n}),r!=="loading"&&j.createElement(YC,null,r==="error"?j.createElement(HC,{...n}):j.createElement(ZC,{...n})))},rN=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,nN=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,aN="0%{opacity:0;} 100%{opacity:1;}",sN="0%{opacity:1;} 100%{opacity:0;}",iN=Vi("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,oN=Vi("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,lN=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=Ob()?[aN,sN]:[rN(r),nN(r)];return{animation:t?`${Zs(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Zs(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},cN=j.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?lN(e.position||t||"top-center",e.visible):{opacity:0},s=j.createElement(tN,{toast:e}),i=j.createElement(oN,{...e.ariaProps},ih(e.message,e));return j.createElement(iN,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:s,message:i}):j.createElement(j.Fragment,null,s,i))});DC(j.createElement);var uN=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let s=j.useCallback(i=>{if(i){let o=()=>{let l=i.getBoundingClientRect().height;n(e,l)};o(),new MutationObserver(o).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return j.createElement("div",{ref:s,className:t,style:r},a)},fN=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Ob()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},dN=n0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Xf=16,hN=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,toasterId:s,containerStyle:i,containerClassName:o})=>{let{toasts:l,handlers:c}=UC(r,s);return j.createElement("div",{"data-rht-toaster":s||"",style:{position:"fixed",zIndex:9999,top:Xf,left:Xf,right:Xf,bottom:Xf,pointerEvents:"none",...i},className:o,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let d=u.position||t,h=c.calculateOffset(u,{reverseOrder:e,gutter:n,defaultPosition:t}),v=fN(d,h);return j.createElement(uN,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?dN:"",style:v},u.type==="custom"?ih(u.message,u):a?a(u):j.createElement(cN,{toast:u,position:d}))}))},Bt=Zr;const pN="modulepreload",mN=function(e){return"/"+e},I_={},tf=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=mN(l),l in I_)return;I_[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":pN,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,v)=>{d.addEventListener("load",h),d.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},gN=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>tf(async()=>{const{default:n}=await Promise.resolve().then(()=>tc);return{default:n}},[]).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class M1 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class vN extends M1{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class D_ extends M1{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class P_ extends M1{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var ng;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(ng||(ng={}));var yN=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class _N{constructor(t,{headers:r={},customFetch:n,region:a=ng.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=gN(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return yN(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(p=>{throw new vN(p)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new D_(d);if(!d.ok)throw new P_(d);let v=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),y;return v==="application/json"?y=yield d.json():v==="application/octet-stream"?y=yield d.blob():v==="text/event-stream"?y=d:v==="multipart/form-data"?y=yield d.formData():y=yield d.text(),{data:y,error:null,response:d}}catch(a){return{data:null,error:a,response:a instanceof P_||a instanceof D_?a.context:void 0}}})}}var Yn={},B1={},s0={},rf={},i0={},o0={},wN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("unable to locate global object")},Wl=wN();const xN=Wl.fetch,jb=Wl.fetch.bind(Wl),Fb=Wl.Headers,kN=Wl.Request,bN=Wl.Response,tc=Object.freeze(Object.defineProperty({__proto__:null,Headers:Fb,Request:kN,Response:bN,default:jb,fetch:xN},Symbol.toStringTag,{value:"Module"})),SN=IT(tc);var l0={};Object.defineProperty(l0,"__esModule",{value:!0});let EN=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};l0.default=EN;var Lb=pa&&pa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o0,"__esModule",{value:!0});const TN=Lb(SN),CN=Lb(l0);let NN=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=TN.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l,c;let u=null,d=null,h=null,v=s.status,y=s.statusText;if(s.ok){if(this.method!=="HEAD"){const k=await s.text();k===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?d=k:d=JSON.parse(k))}const _=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),x=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");_&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,v=406,y="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const _=await s.text();try{u=JSON.parse(_),Array.isArray(u)&&s.status===404&&(d=[],u=null,v=200,y="OK")}catch{s.status===404&&_===""?(v=204,y="No Content"):u={message:_}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,v=200,y="OK"),u&&this.shouldThrowOnError)throw new CN.default(u)}return{error:u,data:d,count:h,status:v,statusText:y}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};o0.default=NN;var AN=pa&&pa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i0,"__esModule",{value:!0});const ON=AN(o0);let IN=class extends ON.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};i0.default=IN;var DN=pa&&pa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rf,"__esModule",{value:!0});const PN=DN(i0);let RN=class extends PN.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};rf.default=RN;var jN=pa&&pa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s0,"__esModule",{value:!0});const Cc=jN(rf);let FN=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new Cc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const s="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Cc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Cc.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Cc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Cc.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};s0.default=FN;var Mb=pa&&pa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(B1,"__esModule",{value:!0});const LN=Mb(s0),MN=Mb(rf);let BN=class Bb{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new LN.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Bb(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",c=r);const u=new Headers(this.headers);return s&&u.set("Prefer",`count=${s}`),new MN.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};B1.default=BN;var rc=pa&&pa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.PostgrestError=Yn.PostgrestBuilder=Yn.PostgrestTransformBuilder=Yn.PostgrestFilterBuilder=Yn.PostgrestQueryBuilder=Yn.PostgrestClient=void 0;const $b=rc(B1);Yn.PostgrestClient=$b.default;const Ub=rc(s0);Yn.PostgrestQueryBuilder=Ub.default;const zb=rc(rf);Yn.PostgrestFilterBuilder=zb.default;const Vb=rc(i0);Yn.PostgrestTransformBuilder=Vb.default;const Wb=rc(o0);Yn.PostgrestBuilder=Wb.default;const Hb=rc(l0);Yn.PostgrestError=Hb.default;var $N=Yn.default={PostgrestClient:$b.default,PostgrestQueryBuilder:Ub.default,PostgrestFilterBuilder:zb.default,PostgrestTransformBuilder:Vb.default,PostgrestBuilder:Wb.default,PostgrestError:Hb.default};const{PostgrestClient:UN,PostgrestQueryBuilder:nK,PostgrestFilterBuilder:aK,PostgrestTransformBuilder:sK,PostgrestBuilder:iK,PostgrestError:oK}=$N;class zN{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const VN="2.15.5",WN=`realtime-js/${VN}`,HN="1.0.0",ag=1e4,KN=1e3,qN=100;var Qc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Qc||(Qc={}));var qr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(qr||(qr={}));var Ha;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ha||(Ha={}));var sg;(function(e){e.websocket="websocket"})(sg||(sg={}));var so;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(so||(so={}));class GN{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const l=n.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Kb{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var sr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(sr||(sr={}));const R_=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=XN(i,e,t,a),s),{})},XN=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?qb(s,i):ig(i)},qb=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return QN(t,r)}switch(e){case sr.bool:return ZN(t);case sr.float4:case sr.float8:case sr.int2:case sr.int4:case sr.int8:case sr.numeric:case sr.oid:return YN(t);case sr.json:case sr.jsonb:return JN(t);case sr.timestamp:return eA(t);case sr.abstime:case sr.date:case sr.daterange:case sr.int4range:case sr.int8range:case sr.money:case sr.reltime:case sr.text:case sr.time:case sr.timestamptz:case sr.timetz:case sr.tsrange:case sr.tstzrange:return ig(t);default:return ig(t)}},ig=e=>e,ZN=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},YN=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},JN=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},QN=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>qb(t,o))}return e},eA=e=>typeof e=="string"?e.replace(" ","T"):e,Gb=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Np{constructor(t,r,n={},a=ag){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var j_;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(j_||(j_={}));class eu{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=eu.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=eu.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=eu.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const d=s[c];if(d){const h=u.map(_=>_.presence_ref),v=d.map(_=>_.presence_ref),y=u.filter(_=>v.indexOf(_.presence_ref)<0),p=d.filter(_=>h.indexOf(_.presence_ref)<0);y.length>0&&(o[c]=y),p.length>0&&(l[c]=p)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const d=t[o].map(v=>v.presence_ref),h=u.filter(v=>d.indexOf(v.presence_ref)<0);t[o].unshift(...h)}n(o,u,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var F_;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(F_||(F_={}));var tu;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(tu||(tu={}));var Rs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Rs||(Rs={}));class $1{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=qr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Np(this,Ha.join,this.params,this.timeout),this.rejoinTimer=new Kb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=qr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=qr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=qr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=qr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=qr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ha.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new eu(this),this.broadcastEndpointURL=Gb(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==qr.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(v=>v.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[tu.PRESENCE]&&this.bindings[tu.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,d={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(v=>t==null?void 0:t(Rs.CHANNEL_ERROR,v)),this._onClose(()=>t==null?void 0:t(Rs.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var y;if(this.socket.setAuth(),v===void 0){t==null||t(Rs.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,_=(y=p==null?void 0:p.length)!==null&&y!==void 0?y:0,x=[];for(let k=0;k<_;k++){const w=p[k],{filter:{event:E,schema:I,table:D,filter:C}}=w,V=v&&v[k];if(V&&V.event===E&&V.schema===I&&V.table===D&&V.filter===C)x.push(Object.assign(Object.assign({},w),{id:V.id}));else{this.unsubscribe(),this.state=qr.errored,t==null||t(Rs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(Rs.SUBSCRIBED);return}}).receive("error",v=>{this.state=qr.errored,t==null||t(Rs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Rs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===qr.joined&&t===tu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=qr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ha.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Np(this,Ha.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=qr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Np(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>qN){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Ha;if(n&&[o,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var y,p,_;return((y=v.filter)===null||y===void 0?void 0:y.event)==="*"||((_=(p=v.filter)===null||p===void 0?void 0:p.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(v=>v.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(v=>{var y,p,_,x,k,w;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in v){const E=v.id,I=(y=v.filter)===null||y===void 0?void 0:y.event;return E&&((p=r.ids)===null||p===void 0?void 0:p.includes(E))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const E=(k=(x=v==null?void 0:v.filter)===null||x===void 0?void 0:x.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return E==="*"||E===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===i}).map(v=>{if(typeof h=="object"&&"ids"in h){const y=h.data,{schema:p,table:_,commit_timestamp:x,type:k,errors:w}=y;h=Object.assign(Object.assign({},{schema:p,table:_,commit_timestamp:x,eventType:k,new:{},old:{},errors:w}),this._getPayloadRecords(y))}v.callback(h,n)})}_isClosed(){return this.state===qr.closed}_isJoined(){return this.state===qr.joined}_isJoining(){return this.state===qr.joining}_isLeaving(){return this.state===qr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&$1.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ha.close,{},t)}_onError(t){this._on(Ha.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=qr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=R_(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=R_(t.columns,t.old_record)),r}}const Ap=()=>{},Zf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},tA=[1e3,2e3,5e3,1e4],rA=1e4,nA=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class aA{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ag,this.transport=null,this.heartbeatIntervalMs=Zf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ap,this.ref=0,this.reconnectTimer=null,this.logger=Ap,this.conn=null,this.sendBuffer=[],this.serializer=new GN,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...i)=>tf(async()=>{const{default:o}=await Promise.resolve().then(()=>tc);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${sg.websocket}`,this.httpEndpoint=Gb(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zN.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:HN}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Qc.connecting:return so.Connecting;case Qc.open:return so.Open;case Qc.closing:return so.Closing;default:return so.Closed}}isConnected(){return this.connectionState()===so.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new $1(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(KN,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Zf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ha.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([nA],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:WN};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Ha.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Kb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Zf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,l,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:ag,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Zf.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Ap,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:d=>tA[d-1]||rA,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(d,h)=>h(JSON.stringify(d)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class U1 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Gr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class sA extends U1{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class og extends U1{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var iA=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Xb=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>tf(async()=>{const{default:n}=await Promise.resolve().then(()=>tc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},oA=()=>iA(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield tf(()=>Promise.resolve().then(()=>tc),void 0)).Response:Response}),lg=e=>{if(Array.isArray(e))return e.map(r=>lg(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=lg(n)}),t},lA=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var jo=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Op=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),cA=(e,t,r)=>jo(void 0,void 0,void 0,function*(){const n=yield oA();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,i=(a==null?void 0:a.statusCode)||s+"";t(new sA(Op(a),s,i))}).catch(a=>{t(new og(Op(a),a))}):t(new og(Op(e),e))}),uA=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(lA(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function nf(e,t,r,n,a,s){return jo(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,uA(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>cA(l,o,n))})})}function oh(e,t,r,n){return jo(this,void 0,void 0,function*(){return nf(e,"GET",t,r,n)})}function hs(e,t,r,n,a){return jo(this,void 0,void 0,function*(){return nf(e,"POST",t,n,a,r)})}function cg(e,t,r,n,a){return jo(this,void 0,void 0,function*(){return nf(e,"PUT",t,n,a,r)})}function fA(e,t,r,n){return jo(this,void 0,void 0,function*(){return nf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Zb(e,t,r,n,a){return jo(this,void 0,void 0,function*(){return nf(e,"DELETE",t,n,a,r)})}var Bn=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const dA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},L_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class hA{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=Xb(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Bn(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},L_),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),d=yield(t=="PUT"?cg:hs)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Gr(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Bn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Bn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:L_.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield cg(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:d.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Gr(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Bn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield hs(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new U1("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Gr(n))return{data:null,error:n};throw n}})}update(t,r,n){return Bn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Bn(this,void 0,void 0,function*(){try{return{data:yield hs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Gr(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Bn(this,void 0,void 0,function*(){try{return{data:{path:(yield hs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Gr(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Bn(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield hs(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Gr(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Bn(this,void 0,void 0,function*(){try{const a=yield hs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Gr(a))return{data:null,error:a};throw a}})}download(t,r){return Bn(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield oh(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Gr(o))return{data:null,error:o};throw o}})}info(t){return Bn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield oh(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:lg(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Gr(n))return{data:null,error:n};throw n}})}exists(t){return Bn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield fA(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Gr(n)&&n instanceof og){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Bn(this,void 0,void 0,function*(){try{return{data:yield Zb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gr(r))return{data:null,error:r};throw r}})}list(t,r,n){return Bn(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},dA),r),{prefix:t||""});return{data:yield hs(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Gr(a))return{data:null,error:a};throw a}})}listV2(t,r){return Bn(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield hs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Gr(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const pA="2.12.1",mA={"X-Client-Info":`storage-js/${pA}`};var Yo=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,[])).next())})};class gA{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},mA),r),this.fetch=Xb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Yo(this,void 0,void 0,function*(){try{return{data:yield oh(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gr(t))return{data:null,error:t};throw t}})}getBucket(t){return Yo(this,void 0,void 0,function*(){try{return{data:yield oh(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Yo(this,void 0,void 0,function*(){try{return{data:yield hs(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Gr(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Yo(this,void 0,void 0,function*(){try{return{data:yield cg(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Gr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Yo(this,void 0,void 0,function*(){try{return{data:yield hs(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Yo(this,void 0,void 0,function*(){try{return{data:yield Zb(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gr(r))return{data:null,error:r};throw r}})}}class vA extends gA{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new hA(this.url,this.headers,t,this.fetch)}}const yA="2.57.4";let Bc="";typeof Deno<"u"?Bc="deno":typeof document<"u"?Bc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bc="react-native":Bc="node";const _A={"X-Client-Info":`supabase-js-${Bc}/${yA}`},wA={headers:_A},xA={schema:"public"},kA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bA={};var SA=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const EA=e=>{let t;return e?t=e:typeof fetch>"u"?t=jb:t=fetch,(...r)=>t(...r)},TA=()=>typeof Headers>"u"?Fb:Headers,CA=(e,t,r)=>{const n=EA(r),a=TA();return(s,i)=>SA(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var NA=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,[])).next())})};function AA(e){return e.endsWith("/")?e:e+"/"}function OA(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:d}=t,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>NA(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function IA(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(AA(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Yb="2.71.1",ol=30*1e3,ug=3,Ip=ug*ol,DA="http://localhost:9999",PA="supabase.auth.token",RA={"X-Client-Info":`gotrue-js/${Yb}`},fg="X-Supabase-Api-Version",Jb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,FA=10*60*1e3;class z1 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ot(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class LA extends z1{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function MA(e){return Ot(e)&&e.name==="AuthApiError"}class Qb extends z1{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Wi extends z1{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class fi extends Wi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function BA(e){return Ot(e)&&e.name==="AuthSessionMissingError"}class Yf extends Wi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jf extends Wi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Qf extends Wi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $A(e){return Ot(e)&&e.name==="AuthImplicitGrantRedirectError"}class M_ extends Wi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class dg extends Wi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Dp(e){return Ot(e)&&e.name==="AuthRetryableFetchError"}class B_ extends Wi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class hg extends Wi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const lh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$_=` 	
\r=`.split(""),UA=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<$_.length;t+=1)e[$_[t].charCodeAt(0)]=-2;for(let t=0;t<lh.length;t+=1)e[lh[t].charCodeAt(0)]=t;return e})();function U_(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(lh[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(lh[n]),t.queuedBits-=6}}function eS(e,t,r){const n=UA[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function z_(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{WA(i,n,r)};for(let i=0;i<e.length;i+=1)eS(e.charCodeAt(i),a,s);return t.join("")}function zA(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function VA(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}zA(n,t)}}function WA(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function HA(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)eS(e.charCodeAt(a),r,n);return new Uint8Array(t)}function KA(e){const t=[];return VA(e,r=>t.push(r)),new Uint8Array(t)}function qA(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>U_(a,r,n)),U_(null,r,n),t.join("")}function GA(e){return Math.round(Date.now()/1e3)+e}function XA(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const za=()=>typeof window<"u"&&typeof document<"u",eo={tested:!1,writable:!1},tS=()=>{if(!za())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(eo.tested)return eo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),eo.tested=!0,eo.writable=!0}catch{eo.tested=!0,eo.writable=!1}return eo.writable};function ZA(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const rS=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>tf(async()=>{const{default:n}=await Promise.resolve().then(()=>tc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},YA=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ll=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},to=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ci=async(e,t)=>{await e.removeItem(t)};class c0{constructor(){this.promise=new c0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}c0.promiseConstructor=Promise;function Pp(e){const t=e.split(".");if(t.length!==3)throw new hg("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!jA.test(t[n]))throw new hg("JWT not in base64url format");return{header:JSON.parse(z_(t[0])),payload:JSON.parse(z_(t[1])),signature:HA(t[2]),raw:{header:t[0],payload:t[1]}}}async function JA(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function QA(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function eO(e){return("0"+e.toString(16)).substr(-2)}function tO(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,eO).join("")}async function rO(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function nO(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await rO(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Jo(e,t,r=!1){const n=tO();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await ll(e,`${t}-code-verifier`,a);const s=await nO(n);return[s,n===s?"plain":"s256"]}const aO=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function sO(e){const t=e.headers.get(fg);if(!t||!t.match(aO))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function iO(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function oO(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const lO=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Qo(e){if(!lO.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Rp(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function V_(e){return JSON.parse(JSON.stringify(e))}var cO=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const ao=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),uO=[502,503,504];async function W_(e){var t;if(!YA(e))throw new dg(ao(e),0);if(uO.includes(e.status))throw new dg(ao(e),e.status);let r;try{r=await e.json()}catch(s){throw new Qb(ao(s),s)}let n;const a=sO(e);if(a&&a.getTime()>=Jb["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new B_(ao(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new fi}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new B_(ao(r),e.status,r.weak_password.reasons);throw new LA(ao(r),e.status||500,n)}const fO=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Lt(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[fg]||(s[fg]=Jb["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await dO(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function dO(e,t,r,n,a,s){const i=fO(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new dg(ao(l),0)}if(o.ok||await W_(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await W_(l)}}function Ds(e){var t;let r=null;gO(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=GA(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function H_(e){const t=Ds(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function yi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function hO(e){return{data:e,error:null}}function pO(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=cO(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function mO(e){return e}function gO(e){return e.access_token&&e.refresh_token&&e.expires_in}const jp=["global","local","others"];var vO=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class yO{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=rS(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=jp[0]){if(jp.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${jp.join(", ")}`);try{return await Lt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ot(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Lt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:yi})}catch(n){if(Ot(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=vO(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Lt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:pO,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ot(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Lt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:yi})}catch(r){if(Ot(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Lt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:mO});if(u.error)throw u.error;const d=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,v=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return v.length>0&&(v.forEach(y=>{const p=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(y.split(";")[1].split("=")[1]);c[`${_}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Ot(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Qo(t);try{return await Lt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:yi})}catch(r){if(Ot(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Qo(t);try{return await Lt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:yi})}catch(n){if(Ot(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Qo(t);try{return await Lt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:yi})}catch(n){if(Ot(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Qo(t.userId);try{const{data:r,error:n}=await Lt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Ot(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Qo(t.userId),Qo(t.id);try{return{data:await Lt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ot(r))return{data:null,error:r};throw r}}}function K_(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function _O(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const el={debug:!!(globalThis&&tS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class nS extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class wO extends nS{}async function xO(e,t,r){el.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),el.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){el.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{el.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw el.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new wO(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(el.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}_O();const kO={url:DA,storageKey:PA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:RA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function q_(e,t,r){return await r()}const tl={};class Ou{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ou.nextInstanceID,Ou.nextInstanceID+=1,this.instanceID>0&&za()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},kO),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new yO({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=rS(a.fetch),this.lock=a.lock||q_,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:za()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=xO:this.lock=q_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:tS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=K_(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=K_(this.memoryStorage)),za()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=tl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){tl[this.storageKey]=Object.assign(Object.assign({},tl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=tl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){tl[this.storageKey]=Object.assign(Object.assign({},tl[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Yb}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=ZA(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),za()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),$A(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ot(r)?{error:r}:{error:new Qb("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ds}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Ot(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:u,password:d,options:h}=t;let v=null,y=null;this.flowType==="pkce"&&([v,y]=await Jo(this.storage,this.storageKey)),s=await Lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:v,code_challenge_method:y},xform:Ds})}else if("phone"in t){const{phone:u,password:d,options:h}=t;s=await Lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ds})}else throw new Jf("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Ot(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await Lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:H_})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await Lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:H_})}else throw new Jf("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Yf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Ot(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,i,o,l,c,u,d,h,v;let y,p;if("message"in t)y=t.message,p=t.signature;else{const{chain:_,wallet:x,statement:k,options:w}=t;let E;if(za())if(typeof x=="object")E=x;else{const D=window;if("solana"in D&&typeof D.solana=="object"&&("signIn"in D.solana&&typeof D.solana.signIn=="function"||"signMessage"in D.solana&&typeof D.solana.signMessage=="function"))E=D.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=x}const I=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const D=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),k?{statement:k}:null));let C;if(Array.isArray(D)&&D[0]&&typeof D[0]=="object")C=D[0];else if(D&&typeof D=="object"&&"signedMessage"in D&&"signature"in D)C=D;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)y=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),p=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${I.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(a=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((d=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...w.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const D=await E.signMessage(new TextEncoder().encode(y),"utf8");if(!D||!(D instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=D}}try{const{data:_,error:x}=await Lt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:qA(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Ds});if(x)throw x;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Yf}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:x})}catch(_){if(Ot(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(t){const r=await to(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await Lt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ds});if(await ci(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Yf}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(Ot(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await Lt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ds}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Yf}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Ot(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Jo(this.storage,this.storageKey));const{error:d}=await Lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Jf("You must provide either an email or phone number.")}catch(o){if(Ot(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Lt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Ds});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Ot(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Jo(this.storage,this.storageKey)),await Lt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:hO})}catch(s){if(Ot(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new fi;const{error:a}=await Lt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Ot(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await Lt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await Lt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Jf("You must provide either an email or phone number and a type")}catch(r){if(Ot(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await to(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Ip:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await to(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Rp()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:yi}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new fi}:await Lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:yi})})}catch(r){if(Ot(r))return BA(r)&&(await this._removeSession(),await ci(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new fi;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Jo(this.storage,this.storageKey));const{data:c,error:u}=await Lt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:yi});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Ot(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new fi;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=Pp(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Ot(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new fi;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ot(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!za())throw new Qf("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Qf(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new M_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qf("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new M_("No code detected.");const{data:k,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new Qf("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(o);let h=u+d;l&&(h=parseInt(l));const v=h-u;v*1e3<=ol&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${d}s`);const y=h-d;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,h,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,h,u);const{data:p,error:_}=await this._getUser(s);if(_)throw _;const x={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:h,refresh_token:i,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Ot(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await to(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(MA(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await ci(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=XA(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Jo(this.storage,this.storageKey,!0));try{return await Lt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Ot(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ot(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,u;const{data:d,error:h}=s;if(h)throw h;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Lt(this.fetch,"GET",v,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return za()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ot(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await Lt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Ot(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await QA(async a=>(a>0&&await JA(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Lt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ds})),(a,s)=>{const i=200*Math.pow(2,a);return s&&Dp(s)&&Date.now()+i-n<ol})}catch(n){if(this._debug(r,"error",n),Ot(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),za()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await to(this.storage,this.storageKey);if(a&&this.userStorage){let i=await to(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await ll(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Rp()}else if(a&&!a.user&&!a.user){const i=await to(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await ci(this.storage,this.storageKey+"-user"),await ll(this.storage,this.storageKey,a)):a.user=Rp()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ip;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Ip}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),Dp(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new fi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new c0;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new fi;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Ot(s)){const i={session:null,error:s};return Dp(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ll(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=V_(a);await ll(this.storage,this.storageKey,s)}else{const a=V_(r);await ll(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ci(this.storage,this.storageKey),await ci(this.storage,this.storageKey+"-code-verifier"),await ci(this.storage,this.storageKey+"-user"),this.userStorage&&await ci(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&za()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ol);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/ol);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${ol}ms, refresh threshold is ${ug} ticks`),a<=ug&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof nS)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!za()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Jo(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Lt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ot(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Lt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Ot(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await Lt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Ot(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Lt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ot(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Pp(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+FA>a)return n;const{data:s,error:i}=await Lt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:v,error:y}=await this.getSession();if(y||!v.session)return{data:null,error:y};n=v.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=Pp(n);r!=null&&r.allowExpired||iO(s.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:s,header:a,signature:i},error:null}}const u=oO(a.alg),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,i,KA(`${o}.${l}`)))throw new hg("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Ot(n))return{data:null,error:n};throw n}}}Ou.nextInstanceID=0;const bO=Ou;class SO extends bO{constructor(t){super(t)}}var EO=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,[])).next())})};class TO{constructor(t,r,n){var a,s,i;this.supabaseUrl=t,this.supabaseKey=r;const o=IA(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:xA,realtime:bA,auth:Object.assign(Object.assign({},kA),{storageKey:l}),global:wA},u=OA(n??{},c);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=CA(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new UN(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new vA(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new _N(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return EO(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,storageKey:i,flowType:o,lock:l,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SO({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new aA(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const CO=(e,t,r)=>new TO(e,t,r);function NO(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}NO()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const AO="https://artgvpolienazfaalwtk.supabase.co",OO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFydGd2cG9saWVuYXpmYWFsd3RrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMDEwOTMsImV4cCI6MjA3MzY3NzA5M30.h7MDx9CLxFte-OJCoLcfcsRoo15gDEtp9B8nUJLYJIg",yt=CO(AO,OO,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:window.localStorage},db:{schema:"public"},global:{headers:{"x-application":"farmageniuscaixa"}}}),Os={searchTransactionsByValue:async(e,t)=>{const{data:r,error:n}=await yt.rpc("search_transactions_by_value",{p_user_id:e,p_value:t});return{data:r,error:n}},transferToConference:async(e,t)=>{const{data:r,error:n}=await yt.rpc("transfer_to_conference",{p_user_id:e,p_transaction_id:t});return{data:r,error:n}},removeFromConference:async(e,t)=>{const{data:r,error:n}=await yt.rpc("remove_from_conference",{p_user_id:e,p_conference_id:t});return{data:r,error:n}},registerNotFound:async(e,t,r)=>{const{data:n,error:a}=await yt.rpc("register_not_found",{p_user_id:e,p_searched_value:t,p_normalized_value:r});return{data:n,error:a}},getUserStats:async e=>{const{data:t,error:r}=await yt.rpc("get_user_stats",{p_user_id:e});return{data:t,error:r}},restartWorkDay:async e=>{const{data:t,error:r}=await yt.rpc("restart_work_day",{p_user_id:e});return{data:t,error:r}},insertBankingTransactions:async(e,t,r)=>{const n=r.map((i,o)=>({file_id:t,user_id:e,transaction_date:i.date,payment_type:i.paymentType,cpf:i.cpf,value:i.value,original_history:i.originalHistory,row_index:o,original_data:i})),{data:a,error:s}=await yt.from("banking_transactions").insert(n).select();return{data:a,error:s}},getActiveConferences:async e=>{const{data:t,error:r}=await yt.from("cash_conference").select("*").eq("user_id",e).eq("conference_status","active").order("conference_date",{ascending:!1});return{data:t,error:r}},getNotFoundHistory:async e=>{const{data:t,error:r}=await yt.from("not_found_history").select("*").eq("user_id",e).eq("status","not_found").order("search_timestamp",{ascending:!1});return{data:t,error:r}}},aS=j.createContext(void 0),IO=({children:e})=>{const[t,r]=j.useState(()=>{try{if(typeof window>"u")return null;const l=localStorage.getItem("auth_user");if(l){const c=JSON.parse(l);if(c&&typeof c=="object"&&c.username)return c}return null}catch(l){console.warn("Failed to parse saved user from localStorage:",l);try{localStorage.removeItem("auth_user")}catch{}return null}}),[n,a]=j.useState(!0),s=async(l,c)=>{var u,d,h,v,y,p;a(!0);try{const{data:_,error:x}=await yt.auth.signInWithPassword({email:l.includes("@")?l:`${l}@manipularium.com`,password:c});if(x){if(console.error("Supabase login error:",x.message),l==="admin"&&c==="manipularium"){const k={username:"admin"};return r(k),localStorage.setItem("auth_user",JSON.stringify(k)),!0}return!1}if(_.user){let{data:k,error:w}=await yt.from("profiles").select("*").eq("id",_.user.id).single();if(w&&w.code==="PGRST116"){const{data:I,error:D}=await yt.from("profiles").insert({id:_.user.id,username:((u=_.user.email)==null?void 0:u.split("@")[0])||"user",full_name:((d=_.user.user_metadata)==null?void 0:d.full_name)||((h=_.user.email)==null?void 0:h.split("@")[0]),role:"user"}).select().single();D?(console.error("Error creating profile:",D.message),k={id:_.user.id,username:((v=_.user.email)==null?void 0:v.split("@")[0])||"user",full_name:((y=_.user.email)==null?void 0:y.split("@")[0])||"user",role:"user"}):k=I}const E={username:(k==null?void 0:k.username)||((p=_.user.email)==null?void 0:p.split("@")[0])||"user",id:_.user.id,email:_.user.email,profile:k};return r(E),localStorage.setItem("auth_user",JSON.stringify(E)),!0}return!1}catch(_){if(console.error("Login error:",_),l==="admin"&&c==="manipularium"){const x={username:"admin"};return r(x),localStorage.setItem("auth_user",JSON.stringify(x)),!0}return!1}finally{a(!1)}},i=async()=>{try{await yt.auth.signOut()}catch(l){console.error("Logout error:",l)}r(null),localStorage.removeItem("auth_user"),localStorage.removeItem("dashboard_filters")};j.useEffect(()=>{if(t){a(!1);try{yt.auth.getSession().then(({data:{session:l}})=>{!(l!=null&&l.user)&&!t.username.includes("admin")&&i()}).catch(l=>{console.warn("Supabase session check failed:",l)})}catch(l){console.warn("Supabase not available:",l)}return}try{yt.auth.getSession().then(({data:{session:l}})=>{l!=null&&l.user&&yt.from("profiles").select("*").eq("id",l.user.id).single().then(({data:c})=>{var d;const u={username:(c==null?void 0:c.username)||((d=l.user.email)==null?void 0:d.split("@")[0])||"user",id:l.user.id,email:l.user.email,profile:c};r(u),localStorage.setItem("auth_user",JSON.stringify(u))}),a(!1)}).catch(l=>{console.warn("Supabase session initialization failed:",l),a(!1)})}catch(l){console.warn("Supabase not available:",l),a(!1)}try{const{data:{subscription:l}}=yt.auth.onAuthStateChange(async(c,u)=>{var d;if(c==="SIGNED_IN"&&(u!=null&&u.user)){const{data:h}=await yt.from("profiles").select("*").eq("id",u.user.id).single(),v={username:(h==null?void 0:h.username)||((d=u.user.email)==null?void 0:d.split("@")[0])||"user",id:u.user.id,email:u.user.email,profile:h};r(v),localStorage.setItem("auth_user",JSON.stringify(v))}else c==="SIGNED_OUT"&&(r(null),localStorage.removeItem("auth_user"),localStorage.removeItem("dashboard_filters"));a(!1)});return()=>l.unsubscribe()}catch(l){console.warn("Supabase auth listener failed:",l)}},[]);const o={user:t,isLoading:n,login:s,logout:i};return m.jsx(aS.Provider,{value:o,children:e})},u0=()=>{const e=j.useContext(aS);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e};var af=e=>e.type==="checkbox",fo=e=>e instanceof Date,Un=e=>e==null;const sS=e=>typeof e=="object";var Fr=e=>!Un(e)&&!Array.isArray(e)&&sS(e)&&!fo(e),DO=e=>Fr(e)&&e.target?af(e.target)?e.target.checked:e.target.value:e,PO=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,RO=(e,t)=>e.has(PO(t)),jO=e=>{const t=e.constructor&&e.constructor.prototype;return Fr(t)&&t.hasOwnProperty("isPrototypeOf")},V1=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function rn(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(V1&&(e instanceof Blob||n))&&(r||Fr(e)))if(t=r?[]:Object.create(Object.getPrototypeOf(e)),!r&&!jO(e))t=e;else for(const a in e)e.hasOwnProperty(a)&&(t[a]=rn(e[a]));else return e;return t}var f0=e=>/^\w*$/.test(e),Wr=e=>e===void 0,W1=e=>Array.isArray(e)?e.filter(Boolean):[],H1=e=>W1(e.replace(/["|']|\]/g,"").split(/\.|\[/)),ut=(e,t,r)=>{if(!t||!Fr(e))return r;const n=(f0(t)?[t]:H1(t)).reduce((a,s)=>Un(a)?a:a[s],e);return Wr(n)||n===e?Wr(e[t])?r:e[t]:n},ps=e=>typeof e=="boolean",nr=(e,t,r)=>{let n=-1;const a=f0(t)?[t]:H1(t),s=a.length,i=s-1;for(;++n<s;){const o=a[n];let l=r;if(n!==i){const c=e[o];l=Fr(c)||Array.isArray(c)?c:isNaN(+a[n+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;e[o]=l,e=e[o]}};const G_={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},qa={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Is={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},FO=Jt.createContext(null);FO.displayName="HookFormContext";var LO=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(a,s,{get:()=>{const i=s;return t._proxyFormState[i]!==qa.all&&(t._proxyFormState[i]=!n||qa.all),e[i]}});return a};const MO=typeof window<"u"?Jt.useLayoutEffect:Jt.useEffect;var _s=e=>typeof e=="string",BO=(e,t,r,n,a)=>_s(e)?(n&&t.watch.add(e),ut(r,e,a)):Array.isArray(e)?e.map(s=>(n&&t.watch.add(s),ut(r,s))):(n&&(t.watchAll=!0),r),pg=e=>Un(e)||!sS(e);function _i(e,t,r=new WeakSet){if(pg(e)||pg(t))return e===t;if(fo(e)&&fo(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const s of n){const i=e[s];if(!a.includes(s))return!1;if(s!=="ref"){const o=t[s];if(fo(i)&&fo(o)||Fr(i)&&Fr(o)||Array.isArray(i)&&Array.isArray(o)?!_i(i,o,r):i!==o)return!1}}return!0}var K1=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},ru=e=>Array.isArray(e)?e:[e],X_=()=>{let e=[];return{get observers(){return e},next:a=>{for(const s of e)s.next&&s.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(s=>s!==a)}}),unsubscribe:()=>{e=[]}}},Gn=e=>Fr(e)&&!Object.keys(e).length,q1=e=>e.type==="file",Ga=e=>typeof e=="function",ch=e=>{if(!V1)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},iS=e=>e.type==="select-multiple",G1=e=>e.type==="radio",$O=e=>G1(e)||af(e),Fp=e=>ch(e)&&e.isConnected;function UO(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=Wr(e)?n++:e[t[n++]];return e}function zO(e){for(const t in e)if(e.hasOwnProperty(t)&&!Wr(e[t]))return!1;return!0}function Ur(e,t){const r=Array.isArray(t)?t:f0(t)?[t]:H1(t),n=r.length===1?e:UO(e,r),a=r.length-1,s=r[a];return n&&delete n[s],a!==0&&(Fr(n)&&Gn(n)||Array.isArray(n)&&zO(n))&&Ur(e,r.slice(0,-1)),e}var oS=e=>{for(const t in e)if(Ga(e[t]))return!0;return!1};function uh(e,t={}){const r=Array.isArray(e);if(Fr(e)||r)for(const n in e)Array.isArray(e[n])||Fr(e[n])&&!oS(e[n])?(t[n]=Array.isArray(e[n])?[]:{},uh(e[n],t[n])):Un(e[n])||(t[n]=!0);return t}function lS(e,t,r){const n=Array.isArray(e);if(Fr(e)||n)for(const a in e)Array.isArray(e[a])||Fr(e[a])&&!oS(e[a])?Wr(t)||pg(r[a])?r[a]=Array.isArray(e[a])?uh(e[a],[]):{...uh(e[a])}:lS(e[a],Un(t)?{}:t[a],r[a]):r[a]=!_i(e[a],t[a]);return r}var Nc=(e,t)=>lS(e,t,uh(t));const Z_={value:!1,isValid:!1},Y_={value:!0,isValid:!0};var cS=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Wr(e[0].attributes.value)?Wr(e[0].value)||e[0].value===""?Y_:{value:e[0].value,isValid:!0}:Y_:Z_}return Z_},uS=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>Wr(e)?e:t?e===""?NaN:e&&+e:r&&_s(e)?new Date(e):n?n(e):e;const J_={isValid:!1,value:null};var fS=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,J_):J_;function Q_(e){const t=e.ref;return q1(t)?t.files:G1(t)?fS(e.refs).value:iS(t)?[...t.selectedOptions].map(({value:r})=>r):af(t)?cS(e.refs).value:uS(Wr(t.value)?e.ref.value:t.value,e)}var VO=(e,t,r,n)=>{const a={};for(const s of e){const i=ut(t,s);i&&nr(a,s,i._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},fh=e=>e instanceof RegExp,Ac=e=>Wr(e)?e:fh(e)?e.source:Fr(e)?fh(e.value)?e.value.source:e.value:e,ew=e=>({isOnSubmit:!e||e===qa.onSubmit,isOnBlur:e===qa.onBlur,isOnChange:e===qa.onChange,isOnAll:e===qa.all,isOnTouch:e===qa.onTouched});const tw="AsyncFunction";var WO=e=>!!e&&!!e.validate&&!!(Ga(e.validate)&&e.validate.constructor.name===tw||Fr(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===tw)),HO=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),rw=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const nu=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const s=ut(e,a);if(s){const{_f:i,...o}=s;if(i){if(i.refs&&i.refs[0]&&t(i.refs[0],a)&&!n)return!0;if(i.ref&&t(i.ref,i.name)&&!n)return!0;if(nu(o,t))break}else if(Fr(o)&&nu(o,t))break}}};function nw(e,t,r){const n=ut(e,r);if(n||f0(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const s=a.join("."),i=ut(t,s),o=ut(e,s);if(i&&!Array.isArray(i)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};if(o&&o.root&&o.root.type)return{name:`${s}.root`,error:o.root};a.pop()}return{name:r}}var KO=(e,t,r,n)=>{r(e);const{name:a,...s}=e;return Gn(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(i=>t[i]===(!n||qa.all))},qO=(e,t,r)=>!e||!t||e===t||ru(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n))),GO=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,XO=(e,t)=>!W1(ut(e,t)).length&&Ur(e,t),ZO=(e,t,r)=>{const n=ru(ut(e,r));return nr(n,"root",t[r]),nr(e,r,n),e},Dd=e=>_s(e);function aw(e,t,r="validate"){if(Dd(e)||Array.isArray(e)&&e.every(Dd)||ps(e)&&!e)return{type:r,message:Dd(e)?e:"",ref:t}}var rl=e=>Fr(e)&&!fh(e)?e:{value:e,message:""},sw=async(e,t,r,n,a,s)=>{const{ref:i,refs:o,required:l,maxLength:c,minLength:u,min:d,max:h,pattern:v,validate:y,name:p,valueAsNumber:_,mount:x}=e._f,k=ut(r,p);if(!x||t.has(p))return{};const w=o?o[0]:i,E=G=>{a&&w.reportValidity&&(w.setCustomValidity(ps(G)?"":G||""),w.reportValidity())},I={},D=G1(i),C=af(i),V=D||C,z=(_||q1(i))&&Wr(i.value)&&Wr(k)||ch(i)&&i.value===""||k===""||Array.isArray(k)&&!k.length,ee=K1.bind(null,p,n,I),re=(G,me,Ee,Ae=Is.maxLength,ke=Is.minLength)=>{const Oe=G?me:Ee;I[p]={type:G?Ae:ke,message:Oe,ref:i,...ee(G?Ae:ke,Oe)}};if(s?!Array.isArray(k)||!k.length:l&&(!V&&(z||Un(k))||ps(k)&&!k||C&&!cS(o).isValid||D&&!fS(o).isValid)){const{value:G,message:me}=Dd(l)?{value:!!l,message:l}:rl(l);if(G&&(I[p]={type:Is.required,message:me,ref:w,...ee(Is.required,me)},!n))return E(me),I}if(!z&&(!Un(d)||!Un(h))){let G,me;const Ee=rl(h),Ae=rl(d);if(!Un(k)&&!isNaN(k)){const ke=i.valueAsNumber||k&&+k;Un(Ee.value)||(G=ke>Ee.value),Un(Ae.value)||(me=ke<Ae.value)}else{const ke=i.valueAsDate||new Date(k),Oe=Se=>new Date(new Date().toDateString()+" "+Se),Ce=i.type=="time",Z=i.type=="week";_s(Ee.value)&&k&&(G=Ce?Oe(k)>Oe(Ee.value):Z?k>Ee.value:ke>new Date(Ee.value)),_s(Ae.value)&&k&&(me=Ce?Oe(k)<Oe(Ae.value):Z?k<Ae.value:ke<new Date(Ae.value))}if((G||me)&&(re(!!G,Ee.message,Ae.message,Is.max,Is.min),!n))return E(I[p].message),I}if((c||u)&&!z&&(_s(k)||s&&Array.isArray(k))){const G=rl(c),me=rl(u),Ee=!Un(G.value)&&k.length>+G.value,Ae=!Un(me.value)&&k.length<+me.value;if((Ee||Ae)&&(re(Ee,G.message,me.message),!n))return E(I[p].message),I}if(v&&!z&&_s(k)){const{value:G,message:me}=rl(v);if(fh(G)&&!k.match(G)&&(I[p]={type:Is.pattern,message:me,ref:i,...ee(Is.pattern,me)},!n))return E(me),I}if(y){if(Ga(y)){const G=await y(k,r),me=aw(G,w);if(me&&(I[p]={...me,...ee(Is.validate,me.message)},!n))return E(me.message),I}else if(Fr(y)){let G={};for(const me in y){if(!Gn(G)&&!n)break;const Ee=aw(await y[me](k,r),w,me);Ee&&(G={...Ee,...ee(me,Ee.message)},E(Ee.message),n&&(I[p]=G))}if(!Gn(G)&&(I[p]={ref:w,...G},!n))return I}}return E(!0),I};const YO={mode:qa.onSubmit,reValidateMode:qa.onChange,shouldFocusError:!0};function JO(e={}){let t={...YO,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ga(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=Fr(t.defaultValues)||Fr(t.values)?rn(t.defaultValues||t.values)||{}:{},s=t.shouldUnregister?{}:rn(a),i={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const h={array:X_(),state:X_()},v=t.criteriaMode===qa.all,y=H=>ae=>{clearTimeout(c),c=setTimeout(H,ae)},p=async H=>{if(!t.disabled&&(u.isValid||d.isValid||H)){const ae=t.resolver?Gn((await C()).errors):await z(n,!0);ae!==r.isValid&&h.state.next({isValid:ae})}},_=(H,ae)=>{!t.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((H||Array.from(o.mount)).forEach(ye=>{ye&&(ae?nr(r.validatingFields,ye,ae):Ur(r.validatingFields,ye))}),h.state.next({validatingFields:r.validatingFields,isValidating:!Gn(r.validatingFields)}))},x=(H,ae=[],ye,Ke,Be=!0,Re=!0)=>{if(Ke&&ye&&!t.disabled){if(i.action=!0,Re&&Array.isArray(ut(n,H))){const nt=ye(ut(n,H),Ke.argA,Ke.argB);Be&&nr(n,H,nt)}if(Re&&Array.isArray(ut(r.errors,H))){const nt=ye(ut(r.errors,H),Ke.argA,Ke.argB);Be&&nr(r.errors,H,nt),XO(r.errors,H)}if((u.touchedFields||d.touchedFields)&&Re&&Array.isArray(ut(r.touchedFields,H))){const nt=ye(ut(r.touchedFields,H),Ke.argA,Ke.argB);Be&&nr(r.touchedFields,H,nt)}(u.dirtyFields||d.dirtyFields)&&(r.dirtyFields=Nc(a,s)),h.state.next({name:H,isDirty:re(H,ae),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else nr(s,H,ae)},k=(H,ae)=>{nr(r.errors,H,ae),h.state.next({errors:r.errors})},w=H=>{r.errors=H,h.state.next({errors:r.errors,isValid:!1})},E=(H,ae,ye,Ke)=>{const Be=ut(n,H);if(Be){const Re=ut(s,H,Wr(ye)?ut(a,H):ye);Wr(Re)||Ke&&Ke.defaultChecked||ae?nr(s,H,ae?Re:Q_(Be._f)):Ee(H,Re),i.mount&&p()}},I=(H,ae,ye,Ke,Be)=>{let Re=!1,nt=!1;const St={name:H};if(!t.disabled){if(!ye||Ke){(u.isDirty||d.isDirty)&&(nt=r.isDirty,r.isDirty=St.isDirty=re(),Re=nt!==St.isDirty);const gt=_i(ut(a,H),ae);nt=!!ut(r.dirtyFields,H),gt?Ur(r.dirtyFields,H):nr(r.dirtyFields,H,!0),St.dirtyFields=r.dirtyFields,Re=Re||(u.dirtyFields||d.dirtyFields)&&nt!==!gt}if(ye){const gt=ut(r.touchedFields,H);gt||(nr(r.touchedFields,H,ye),St.touchedFields=r.touchedFields,Re=Re||(u.touchedFields||d.touchedFields)&&gt!==ye)}Re&&Be&&h.state.next(St)}return Re?St:{}},D=(H,ae,ye,Ke)=>{const Be=ut(r.errors,H),Re=(u.isValid||d.isValid)&&ps(ae)&&r.isValid!==ae;if(t.delayError&&ye?(l=y(()=>k(H,ye)),l(t.delayError)):(clearTimeout(c),l=null,ye?nr(r.errors,H,ye):Ur(r.errors,H)),(ye?!_i(Be,ye):Be)||!Gn(Ke)||Re){const nt={...Ke,...Re&&ps(ae)?{isValid:ae}:{},errors:r.errors,name:H};r={...r,...nt},h.state.next(nt)}},C=async H=>{_(H,!0);const ae=await t.resolver(s,t.context,VO(H||o.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return _(H),ae},V=async H=>{const{errors:ae}=await C(H);if(H)for(const ye of H){const Ke=ut(ae,ye);Ke?nr(r.errors,ye,Ke):Ur(r.errors,ye)}else r.errors=ae;return ae},z=async(H,ae,ye={valid:!0})=>{for(const Ke in H){const Be=H[Ke];if(Be){const{_f:Re,...nt}=Be;if(Re){const St=o.array.has(Re.name),gt=Be._f&&WO(Be._f);gt&&u.validatingFields&&_([Ke],!0);const qt=await sw(Be,o.disabled,s,v,t.shouldUseNativeValidation&&!ae,St);if(gt&&u.validatingFields&&_([Ke]),qt[Re.name]&&(ye.valid=!1,ae))break;!ae&&(ut(qt,Re.name)?St?ZO(r.errors,qt,Re.name):nr(r.errors,Re.name,qt[Re.name]):Ur(r.errors,Re.name))}!Gn(nt)&&await z(nt,ae,ye)}}return ye.valid},ee=()=>{for(const H of o.unMount){const ae=ut(n,H);ae&&(ae._f.refs?ae._f.refs.every(ye=>!Fp(ye)):!Fp(ae._f.ref))&&Pe(H)}o.unMount=new Set},re=(H,ae)=>!t.disabled&&(H&&ae&&nr(s,H,ae),!_i(Se(),a)),G=(H,ae,ye)=>BO(H,o,{...i.mount?s:Wr(ae)?a:_s(H)?{[H]:ae}:ae},ye,ae),me=H=>W1(ut(i.mount?s:a,H,t.shouldUnregister?ut(a,H,[]):[])),Ee=(H,ae,ye={})=>{const Ke=ut(n,H);let Be=ae;if(Ke){const Re=Ke._f;Re&&(!Re.disabled&&nr(s,H,uS(ae,Re)),Be=ch(Re.ref)&&Un(ae)?"":ae,iS(Re.ref)?[...Re.ref.options].forEach(nt=>nt.selected=Be.includes(nt.value)):Re.refs?af(Re.ref)?Re.refs.forEach(nt=>{(!nt.defaultChecked||!nt.disabled)&&(Array.isArray(Be)?nt.checked=!!Be.find(St=>St===nt.value):nt.checked=Be===nt.value||!!Be)}):Re.refs.forEach(nt=>nt.checked=nt.value===Be):q1(Re.ref)?Re.ref.value="":(Re.ref.value=Be,Re.ref.type||h.state.next({name:H,values:rn(s)})))}(ye.shouldDirty||ye.shouldTouch)&&I(H,Be,ye.shouldTouch,ye.shouldDirty,!0),ye.shouldValidate&&Z(H)},Ae=(H,ae,ye)=>{for(const Ke in ae){if(!ae.hasOwnProperty(Ke))return;const Be=ae[Ke],Re=H+"."+Ke,nt=ut(n,Re);(o.array.has(H)||Fr(Be)||nt&&!nt._f)&&!fo(Be)?Ae(Re,Be,ye):Ee(Re,Be,ye)}},ke=(H,ae,ye={})=>{const Ke=ut(n,H),Be=o.array.has(H),Re=rn(ae);nr(s,H,Re),Be?(h.array.next({name:H,values:rn(s)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&ye.shouldDirty&&h.state.next({name:H,dirtyFields:Nc(a,s),isDirty:re(H,Re)})):Ke&&!Ke._f&&!Un(Re)?Ae(H,Re,ye):Ee(H,Re,ye),rw(H,o)&&h.state.next({...r,name:H}),h.state.next({name:i.mount?H:void 0,values:rn(s)})},Oe=async H=>{i.mount=!0;const ae=H.target;let ye=ae.name,Ke=!0;const Be=ut(n,ye),Re=gt=>{Ke=Number.isNaN(gt)||fo(gt)&&isNaN(gt.getTime())||_i(gt,ut(s,ye,gt))},nt=ew(t.mode),St=ew(t.reValidateMode);if(Be){let gt,qt;const wt=ae.type?Q_(Be._f):DO(H),jt=H.type===G_.BLUR||H.type===G_.FOCUS_OUT,lr=!HO(Be._f)&&!t.resolver&&!ut(r.errors,ye)&&!Be._f.deps||GO(jt,ut(r.touchedFields,ye),r.isSubmitted,St,nt),Gt=rw(ye,o,jt);nr(s,ye,wt),jt?(!ae||!ae.readOnly)&&(Be._f.onBlur&&Be._f.onBlur(H),l&&l(0)):Be._f.onChange&&Be._f.onChange(H);const cn=I(ye,wt,jt),Fn=!Gn(cn)||Gt;if(!jt&&h.state.next({name:ye,type:H.type,values:rn(s)}),lr)return(u.isValid||d.isValid)&&(t.mode==="onBlur"?jt&&p():jt||p()),Fn&&h.state.next({name:ye,...Gt?{}:cn});if(!jt&&Gt&&h.state.next({...r}),t.resolver){const{errors:lt}=await C([ye]);if(Re(wt),Ke){const _a=nw(r.errors,n,ye),Ln=nw(lt,n,_a.name||ye);gt=Ln.error,ye=Ln.name,qt=Gn(lt)}}else _([ye],!0),gt=(await sw(Be,o.disabled,s,v,t.shouldUseNativeValidation))[ye],_([ye]),Re(wt),Ke&&(gt?qt=!1:(u.isValid||d.isValid)&&(qt=await z(n,!0)));Ke&&(Be._f.deps&&Z(Be._f.deps),D(ye,qt,gt,cn))}},Ce=(H,ae)=>{if(ut(r.errors,ae)&&H.focus)return H.focus(),1},Z=async(H,ae={})=>{let ye,Ke;const Be=ru(H);if(t.resolver){const Re=await V(Wr(H)?H:Be);ye=Gn(Re),Ke=H?!Be.some(nt=>ut(Re,nt)):ye}else H?(Ke=(await Promise.all(Be.map(async Re=>{const nt=ut(n,Re);return await z(nt&&nt._f?{[Re]:nt}:nt)}))).every(Boolean),!(!Ke&&!r.isValid)&&p()):Ke=ye=await z(n);return h.state.next({...!_s(H)||(u.isValid||d.isValid)&&ye!==r.isValid?{}:{name:H},...t.resolver||!H?{isValid:ye}:{},errors:r.errors}),ae.shouldFocus&&!Ke&&nu(n,Ce,H?Be:o.mount),Ke},Se=H=>{const ae={...i.mount?s:a};return Wr(H)?ae:_s(H)?ut(ae,H):H.map(ye=>ut(ae,ye))},Ve=(H,ae)=>({invalid:!!ut((ae||r).errors,H),isDirty:!!ut((ae||r).dirtyFields,H),error:ut((ae||r).errors,H),isValidating:!!ut(r.validatingFields,H),isTouched:!!ut((ae||r).touchedFields,H)}),B=H=>{H&&ru(H).forEach(ae=>Ur(r.errors,ae)),h.state.next({errors:H?r.errors:{}})},J=(H,ae,ye)=>{const Ke=(ut(n,H,{_f:{}})._f||{}).ref,Be=ut(r.errors,H)||{},{ref:Re,message:nt,type:St,...gt}=Be;nr(r.errors,H,{...gt,...ae,ref:Ke}),h.state.next({name:H,errors:r.errors,isValid:!1}),ye&&ye.shouldFocus&&Ke&&Ke.focus&&Ke.focus()},K=(H,ae)=>Ga(H)?h.state.subscribe({next:ye=>"values"in ye&&H(G(void 0,ae),ye)}):G(H,ae,!0),X=H=>h.state.subscribe({next:ae=>{qO(H.name,ae.name,H.exact)&&KO(ae,H.formState||u,Fe,H.reRenderRoot)&&H.callback({values:{...s},...r,...ae,defaultValues:a})}}).unsubscribe,ge=H=>(i.mount=!0,d={...d,...H.formState},X({...H,formState:d})),Pe=(H,ae={})=>{for(const ye of H?ru(H):o.mount)o.mount.delete(ye),o.array.delete(ye),ae.keepValue||(Ur(n,ye),Ur(s,ye)),!ae.keepError&&Ur(r.errors,ye),!ae.keepDirty&&Ur(r.dirtyFields,ye),!ae.keepTouched&&Ur(r.touchedFields,ye),!ae.keepIsValidating&&Ur(r.validatingFields,ye),!t.shouldUnregister&&!ae.keepDefaultValue&&Ur(a,ye);h.state.next({values:rn(s)}),h.state.next({...r,...ae.keepDirty?{isDirty:re()}:{}}),!ae.keepIsValid&&p()},je=({disabled:H,name:ae})=>{(ps(H)&&i.mount||H||o.disabled.has(ae))&&(H?o.disabled.add(ae):o.disabled.delete(ae))},ce=(H,ae={})=>{let ye=ut(n,H);const Ke=ps(ae.disabled)||ps(t.disabled);return nr(n,H,{...ye||{},_f:{...ye&&ye._f?ye._f:{ref:{name:H}},name:H,mount:!0,...ae}}),o.mount.add(H),ye?je({disabled:ps(ae.disabled)?ae.disabled:t.disabled,name:H}):E(H,!0,ae.value),{...Ke?{disabled:ae.disabled||t.disabled}:{},...t.progressive?{required:!!ae.required,min:Ac(ae.min),max:Ac(ae.max),minLength:Ac(ae.minLength),maxLength:Ac(ae.maxLength),pattern:Ac(ae.pattern)}:{},name:H,onChange:Oe,onBlur:Oe,ref:Be=>{if(Be){ce(H,ae),ye=ut(n,H);const Re=Wr(Be.value)&&Be.querySelectorAll&&Be.querySelectorAll("input,select,textarea")[0]||Be,nt=$O(Re),St=ye._f.refs||[];if(nt?St.find(gt=>gt===Re):Re===ye._f.ref)return;nr(n,H,{_f:{...ye._f,...nt?{refs:[...St.filter(Fp),Re,...Array.isArray(ut(a,H))?[{}]:[]],ref:{type:Re.type,name:H}}:{ref:Re}}}),E(H,!1,void 0,Re)}else ye=ut(n,H,{}),ye._f&&(ye._f.mount=!1),(t.shouldUnregister||ae.shouldUnregister)&&!(RO(o.array,H)&&i.action)&&o.unMount.add(H)}}},Te=()=>t.shouldFocusError&&nu(n,Ce,o.mount),dt=H=>{ps(H)&&(h.state.next({disabled:H}),nu(n,(ae,ye)=>{const Ke=ut(n,ye);Ke&&(ae.disabled=Ke._f.disabled||H,Array.isArray(Ke._f.refs)&&Ke._f.refs.forEach(Be=>{Be.disabled=Ke._f.disabled||H}))},0,!1))},N=(H,ae)=>async ye=>{let Ke;ye&&(ye.preventDefault&&ye.preventDefault(),ye.persist&&ye.persist());let Be=rn(s);if(h.state.next({isSubmitting:!0}),t.resolver){const{errors:Re,values:nt}=await C();r.errors=Re,Be=rn(nt)}else await z(n);if(o.disabled.size)for(const Re of o.disabled)Ur(Be,Re);if(Ur(r.errors,"root"),Gn(r.errors)){h.state.next({errors:{}});try{await H(Be,ye)}catch(Re){Ke=Re}}else ae&&await ae({...r.errors},ye),Te(),setTimeout(Te);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Gn(r.errors)&&!Ke,submitCount:r.submitCount+1,errors:r.errors}),Ke)throw Ke},Ue=(H,ae={})=>{ut(n,H)&&(Wr(ae.defaultValue)?ke(H,rn(ut(a,H))):(ke(H,ae.defaultValue),nr(a,H,rn(ae.defaultValue))),ae.keepTouched||Ur(r.touchedFields,H),ae.keepDirty||(Ur(r.dirtyFields,H),r.isDirty=ae.defaultValue?re(H,rn(ut(a,H))):re()),ae.keepError||(Ur(r.errors,H),u.isValid&&p()),h.state.next({...r}))},it=(H,ae={})=>{const ye=H?rn(H):a,Ke=rn(ye),Be=Gn(H),Re=Be?a:Ke;if(ae.keepDefaultValues||(a=ye),!ae.keepValues){if(ae.keepDirtyValues){const nt=new Set([...o.mount,...Object.keys(Nc(a,s))]);for(const St of Array.from(nt))ut(r.dirtyFields,St)?nr(Re,St,ut(s,St)):ke(St,ut(Re,St))}else{if(V1&&Wr(H))for(const nt of o.mount){const St=ut(n,nt);if(St&&St._f){const gt=Array.isArray(St._f.refs)?St._f.refs[0]:St._f.ref;if(ch(gt)){const qt=gt.closest("form");if(qt){qt.reset();break}}}}if(ae.keepFieldsRef)for(const nt of o.mount)ke(nt,ut(Re,nt));else n={}}s=t.shouldUnregister?ae.keepDefaultValues?rn(a):{}:rn(Re),h.array.next({values:{...Re}}),h.state.next({values:{...Re}})}o={mount:ae.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!u.isValid||!!ae.keepIsValid||!!ae.keepDirtyValues,i.watch=!!t.shouldUnregister,h.state.next({submitCount:ae.keepSubmitCount?r.submitCount:0,isDirty:Be?!1:ae.keepDirty?r.isDirty:!!(ae.keepDefaultValues&&!_i(H,a)),isSubmitted:ae.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:Be?{}:ae.keepDirtyValues?ae.keepDefaultValues&&s?Nc(a,s):r.dirtyFields:ae.keepDefaultValues&&H?Nc(a,H):ae.keepDirty?r.dirtyFields:{},touchedFields:ae.keepTouched?r.touchedFields:{},errors:ae.keepErrors?r.errors:{},isSubmitSuccessful:ae.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:a})},ct=(H,ae)=>it(Ga(H)?H(s):H,ae),mt=(H,ae={})=>{const ye=ut(n,H),Ke=ye&&ye._f;if(Ke){const Be=Ke.refs?Ke.refs[0]:Ke.ref;Be.focus&&(Be.focus(),ae.shouldSelect&&Ga(Be.select)&&Be.select())}},Fe=H=>{r={...r,...H}},yr={control:{register:ce,unregister:Pe,getFieldState:Ve,handleSubmit:N,setError:J,_subscribe:X,_runSchema:C,_focusError:Te,_getWatch:G,_getDirty:re,_setValid:p,_setFieldArray:x,_setDisabledField:je,_setErrors:w,_getFieldArray:me,_reset:it,_resetDefaultValues:()=>Ga(t.defaultValues)&&t.defaultValues().then(H=>{ct(H,t.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:ee,_disableForm:dt,_subjects:h,_proxyFormState:u,get _fields(){return n},get _formValues(){return s},get _state(){return i},set _state(H){i=H},get _defaultValues(){return a},get _names(){return o},set _names(H){o=H},get _formState(){return r},get _options(){return t},set _options(H){t={...t,...H}}},subscribe:ge,trigger:Z,register:ce,handleSubmit:N,watch:K,setValue:ke,getValues:Se,reset:ct,resetField:Ue,clearErrors:B,unregister:Pe,setError:J,setFocus:mt,getFieldState:Ve};return{...yr,formControl:yr}}function QO(e={}){const t=Jt.useRef(void 0),r=Jt.useRef(void 0),[n,a]=Jt.useState({isDirty:!1,isValidating:!1,isLoading:Ga(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Ga(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:n},e.defaultValues&&!Ga(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:i,...o}=JO(e);t.current={...o,formState:n}}const s=t.current.control;return s._options=e,MO(()=>{const i=s._subscribe({formState:s._proxyFormState,callback:()=>a({...s._formState}),reRenderRoot:!0});return a(o=>({...o,isReady:!0})),s._formState.isReady=!0,i},[s]),Jt.useEffect(()=>s._disableForm(e.disabled),[s,e.disabled]),Jt.useEffect(()=>{e.mode&&(s._options.mode=e.mode),e.reValidateMode&&(s._options.reValidateMode=e.reValidateMode)},[s,e.mode,e.reValidateMode]),Jt.useEffect(()=>{e.errors&&(s._setErrors(e.errors),s._focusError())},[s,e.errors]),Jt.useEffect(()=>{e.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,e.shouldUnregister]),Jt.useEffect(()=>{if(s._proxyFormState.isDirty){const i=s._getDirty();i!==n.isDirty&&s._subjects.state.next({isDirty:i})}},[s,n.isDirty]),Jt.useEffect(()=>{e.values&&!_i(e.values,r.current)?(s._reset(e.values,{keepFieldsRef:!0,...s._options.resetOptions}),r.current=e.values,a(i=>({...i}))):s._resetDefaultValues()},[s,e.values]),Jt.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),t.current.formState=LO(n,s),t.current}const iw=(e,t,r)=>{if(e&&"reportValidity"in e){const n=ut(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},mg=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?iw(n.ref,r,e):n&&n.refs&&n.refs.forEach(a=>iw(a,r,e))}},ow=(e,t)=>{t.shouldUseNativeValidation&&mg(e,t);const r={};for(const n in e){const a=ut(t.fields,n),s=Object.assign(e[n]||{},{ref:a&&a.ref});if(eI(t.names||Object.keys(e),n)){const i=Object.assign({},ut(r,n));nr(i,"root",s),nr(r,n,i)}else nr(r,n,s)}return r},eI=(e,t)=>{const r=lw(t);return e.some(n=>lw(n).match(`^${r}\\.\\d+`))};function lw(e){return e.replace(/\]|\[/g,"")}function Ne(e,t,r){function n(o,l){var c;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(c=o._zod).traits??(c.traits=new Set),o._zod.traits.add(e),t(o,l);for(const u in i.prototype)u in o||Object.defineProperty(o,u,{value:i.prototype[u].bind(o)});o._zod.constr=i,o._zod.def=l}const a=(r==null?void 0:r.Parent)??Object;class s extends a{}Object.defineProperty(s,"name",{value:e});function i(o){var l;const c=r!=null&&r.Parent?new s:this;n(c,o),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:o=>{var l,c;return r!=null&&r.Parent&&o instanceof r.Parent?!0:(c=(l=o==null?void 0:o._zod)==null?void 0:l.traits)==null?void 0:c.has(e)}}),Object.defineProperty(i,"name",{value:e}),i}class Dl extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class dS extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const hS={};function Eo(e){return hS}function tI(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,a])=>t.indexOf(+n)===-1).map(([n,a])=>a)}function gg(e,t){return typeof t=="bigint"?t.toString():t}function X1(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function Z1(e){return e==null}function Y1(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function rI(e,t){const r=(e.toString().split(".")[1]||"").length,n=t.toString();let a=(n.split(".")[1]||"").length;if(a===0&&/\d?e-\d?/.test(n)){const l=n.match(/\d?e-(\d?)/);l!=null&&l[1]&&(a=Number.parseInt(l[1]))}const s=r>a?r:a,i=Number.parseInt(e.toFixed(s).replace(".","")),o=Number.parseInt(t.toFixed(s).replace(".",""));return i%o/10**s}const cw=Symbol("evaluating");function or(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==cw)return n===void 0&&(n=cw,n=r()),n},set(a){Object.defineProperty(e,t,{value:a})},configurable:!0})}function nI(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function Hi(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function nc(...e){const t={};for(const r of e){const n=Object.getOwnPropertyDescriptors(r);Object.assign(t,n)}return Object.defineProperties({},t)}function uw(e){return JSON.stringify(e)}const pS="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function dh(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const aI=X1(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Iu(e){if(dh(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(dh(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function mS(e){return Iu(e)?{...e}:Array.isArray(e)?[...e]:e}const sI=new Set(["string","number","symbol"]);function d0(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ki(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r!=null&&r.parent)&&(n._zod.parent=e),n}function pt(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function iI(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const oI={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function lI(e,t){const r=e._zod.def,n=nc(e._zod.def,{get shape(){const a={};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&(a[s]=r.shape[s])}return Hi(this,"shape",a),a},checks:[]});return Ki(e,n)}function cI(e,t){const r=e._zod.def,n=nc(e._zod.def,{get shape(){const a={...e._zod.def.shape};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&delete a[s]}return Hi(this,"shape",a),a},checks:[]});return Ki(e,n)}function uI(e,t){if(!Iu(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const a=nc(e._zod.def,{get shape(){const s={...e._zod.def.shape,...t};return Hi(this,"shape",s),s},checks:[]});return Ki(e,a)}function fI(e,t){if(!Iu(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return Hi(this,"shape",n),n},checks:e._zod.def.checks};return Ki(e,r)}function dI(e,t){const r=nc(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return Hi(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return Ki(e,r)}function hI(e,t,r){const n=nc(t._zod.def,{get shape(){const a=t._zod.def.shape,s={...a};if(r)for(const i in r){if(!(i in a))throw new Error(`Unrecognized key: "${i}"`);r[i]&&(s[i]=e?new e({type:"optional",innerType:a[i]}):a[i])}else for(const i in a)s[i]=e?new e({type:"optional",innerType:a[i]}):a[i];return Hi(this,"shape",s),s},checks:[]});return Ki(t,n)}function pI(e,t,r){const n=nc(t._zod.def,{get shape(){const a=t._zod.def.shape,s={...a};if(r)for(const i in r){if(!(i in s))throw new Error(`Unrecognized key: "${i}"`);r[i]&&(s[i]=new e({type:"nonoptional",innerType:a[i]}))}else for(const i in a)s[i]=new e({type:"nonoptional",innerType:a[i]});return Hi(this,"shape",s),s},checks:[]});return Ki(t,n)}function bl(e,t=0){var r;if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(((r=e.issues[n])==null?void 0:r.continue)!==!0)return!0;return!1}function gS(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function ed(e){return typeof e=="string"?e:e==null?void 0:e.message}function To(e,t,r){var a,s,i,o,l,c;const n={...e,path:e.path??[]};if(!e.message){const u=ed((i=(s=(a=e.inst)==null?void 0:a._zod.def)==null?void 0:s.error)==null?void 0:i.call(s,e))??ed((o=t==null?void 0:t.error)==null?void 0:o.call(t,e))??ed((l=r.customError)==null?void 0:l.call(r,e))??ed((c=r.localeError)==null?void 0:c.call(r,e))??"Invalid input";n.message=u}return delete n.inst,delete n.continue,t!=null&&t.reportInput||delete n.input,n}function J1(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Du(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}const vS=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,gg,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Q1=Ne("$ZodError",vS),h0=Ne("$ZodError",vS,{Parent:Error});function mI(e,t=r=>r.message){const r={},n=[];for(const a of e.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}function gI(e,t){const r=t||function(s){return s.message},n={_errors:[]},a=s=>{for(const i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(o=>a({issues:o}));else if(i.code==="invalid_key")a({issues:i.issues});else if(i.code==="invalid_element")a({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let o=n,l=0;for(;l<i.path.length;){const c=i.path[l];l===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return a(e),n}const p0=e=>(t,r,n,a)=>{const s=n?Object.assign(n,{async:!1}):{async:!1},i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new Dl;if(i.issues.length){const o=new((a==null?void 0:a.Err)??e)(i.issues.map(l=>To(l,s,Eo())));throw pS(o,a==null?void 0:a.callee),o}return i.value},vI=p0(h0),m0=e=>async(t,r,n,a)=>{const s=n?Object.assign(n,{async:!0}):{async:!0};let i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){const o=new((a==null?void 0:a.Err)??e)(i.issues.map(l=>To(l,s,Eo())));throw pS(o,a==null?void 0:a.callee),o}return i.value},yI=m0(h0),g0=e=>(t,r,n)=>{const a=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},a);if(s instanceof Promise)throw new Dl;return s.issues.length?{success:!1,error:new(e??Q1)(s.issues.map(i=>To(i,a,Eo())))}:{success:!0,data:s.value}},_I=g0(h0),v0=e=>async(t,r,n)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let s=t._zod.run({value:r,issues:[]},a);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(i=>To(i,a,Eo())))}:{success:!0,data:s.value}},wI=v0(h0),xI=e=>(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return p0(e)(t,r,a)},kI=e=>(t,r,n)=>p0(e)(t,r,n),bI=e=>async(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return m0(e)(t,r,a)},SI=e=>async(t,r,n)=>m0(e)(t,r,n),EI=e=>(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return g0(e)(t,r,a)},TI=e=>(t,r,n)=>g0(e)(t,r,n),CI=e=>async(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return v0(e)(t,r,a)},NI=e=>async(t,r,n)=>v0(e)(t,r,n),AI=/^[cC][^\s-]{8,}$/,OI=/^[0-9a-z]+$/,II=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,DI=/^[0-9a-vA-V]{20}$/,PI=/^[A-Za-z0-9]{27}$/,RI=/^[a-zA-Z0-9_-]{21}$/,jI=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,FI=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,fw=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,LI=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,MI="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function BI(){return new RegExp(MI,"u")}const $I=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,UI=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,zI=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,VI=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,WI=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,yS=/^[A-Za-z0-9_-]*$/,HI=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,KI=/^\+(?:[0-9]){6,14}[0-9]$/,_S="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",qI=new RegExp(`^${_S}$`);function wS(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function GI(e){return new RegExp(`^${wS(e)}$`)}function XI(e){const t=wS({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${t}(?:${r.join("|")})`;return new RegExp(`^${_S}T(?:${n})$`)}const ZI=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},YI=/^-?\d+$/,JI=/^-?\d+(?:\.\d+)?/,QI=/^[^A-Z]*$/,eD=/^[^a-z]*$/,aa=Ne("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),xS={number:"number",bigint:"bigint",object:"date"},kS=Ne("$ZodCheckLessThan",(e,t)=>{aa.init(e,t);const r=xS[typeof t.value];e._zod.onattach.push(n=>{const a=n._zod.bag,s=(t.inclusive?a.maximum:a.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<s&&(t.inclusive?a.maximum=t.value:a.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),bS=Ne("$ZodCheckGreaterThan",(e,t)=>{aa.init(e,t);const r=xS[typeof t.value];e._zod.onattach.push(n=>{const a=n._zod.bag,s=(t.inclusive?a.minimum:a.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>s&&(t.inclusive?a.minimum=t.value:a.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),tD=Ne("$ZodCheckMultipleOf",(e,t)=>{aa.init(e,t),e._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):rI(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),rD=Ne("$ZodCheckNumberFormat",(e,t)=>{var i;aa.init(e,t),t.format=t.format||"float64";const r=(i=t.format)==null?void 0:i.includes("int"),n=r?"int":"number",[a,s]=oI[t.format];e._zod.onattach.push(o=>{const l=o._zod.bag;l.format=t.format,l.minimum=a,l.maximum=s,r&&(l.pattern=YI)}),e._zod.check=o=>{const l=o.value;if(r){if(!Number.isInteger(l)){o.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:l,inst:e});return}if(!Number.isSafeInteger(l)){l>0?o.issues.push({input:l,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):o.issues.push({input:l,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}l<a&&o.issues.push({origin:"number",input:l,code:"too_small",minimum:a,inclusive:!0,inst:e,continue:!t.abort}),l>s&&o.issues.push({origin:"number",input:l,code:"too_big",maximum:s,inst:e})}}),nD=Ne("$ZodCheckMaxLength",(e,t)=>{var r;aa.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!Z1(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<a&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const a=n.value;if(a.length<=t.maximum)return;const i=J1(a);n.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),aD=Ne("$ZodCheckMinLength",(e,t)=>{var r;aa.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!Z1(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>a&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const a=n.value;if(a.length>=t.minimum)return;const i=J1(a);n.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),sD=Ne("$ZodCheckLengthEquals",(e,t)=>{var r;aa.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!Z1(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag;a.minimum=t.length,a.maximum=t.length,a.length=t.length}),e._zod.check=n=>{const a=n.value,s=a.length;if(s===t.length)return;const i=J1(a),o=s>t.length;n.issues.push({origin:i,...o?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),y0=Ne("$ZodCheckStringFormat",(e,t)=>{var r,n;aa.init(e,t),e._zod.onattach.push(a=>{const s=a._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=a=>{t.pattern.lastIndex=0,!t.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:t.format,input:a.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),iD=Ne("$ZodCheckRegex",(e,t)=>{y0.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),oD=Ne("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=QI),y0.init(e,t)}),lD=Ne("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=eD),y0.init(e,t)}),cD=Ne("$ZodCheckIncludes",(e,t)=>{aa.init(e,t);const r=d0(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(a=>{const s=a._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=a=>{a.value.includes(t.includes,t.position)||a.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:a.value,inst:e,continue:!t.abort})}}),uD=Ne("$ZodCheckStartsWith",(e,t)=>{aa.init(e,t);const r=new RegExp(`^${d0(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),fD=Ne("$ZodCheckEndsWith",(e,t)=>{aa.init(e,t);const r=new RegExp(`.*${d0(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),dD=Ne("$ZodCheckOverwrite",(e,t)=>{aa.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class hD{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(i=>i),a=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(a)).map(i=>" ".repeat(this.indent*2)+i);for(const i of s)this.content.push(i)}compile(){const t=Function,r=this==null?void 0:this.args,a=[...((this==null?void 0:this.content)??[""]).map(s=>`  ${s}`)];return new t(...r,a.join(`
`))}}const pD={major:4,minor:1,patch:9},Kr=Ne("$ZodType",(e,t)=>{var a;var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=pD;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const s of n)for(const i of s._zod.onattach)i(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),(a=e._zod.deferred)==null||a.push(()=>{e._zod.run=e._zod.parse});else{const s=(o,l,c)=>{let u=bl(o),d;for(const h of l){if(h._zod.def.when){if(!h._zod.def.when(o))continue}else if(u)continue;const v=o.issues.length,y=h._zod.check(o);if(y instanceof Promise&&(c==null?void 0:c.async)===!1)throw new Dl;if(d||y instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await y,o.issues.length!==v&&(u||(u=bl(o,v)))});else{if(o.issues.length===v)continue;u||(u=bl(o,v))}}return d?d.then(()=>o):o},i=(o,l,c)=>{if(bl(o))return o.aborted=!0,o;const u=s(l,n,c);if(u instanceof Promise){if(c.async===!1)throw new Dl;return u.then(d=>e._zod.parse(d,c))}return e._zod.parse(u,c)};e._zod.run=(o,l)=>{if(l.skipChecks)return e._zod.parse(o,l);if(l.direction==="backward"){const u=e._zod.parse({value:o.value,issues:[]},{...l,skipChecks:!0});return u instanceof Promise?u.then(d=>i(d,o,l)):i(u,o,l)}const c=e._zod.parse(o,l);if(c instanceof Promise){if(l.async===!1)throw new Dl;return c.then(u=>s(u,n,l))}return s(c,n,l)}}e["~standard"]={validate:s=>{var i;try{const o=_I(e,s);return o.success?{value:o.data}:{issues:(i=o.error)==null?void 0:i.issues}}catch{return wI(e,s).then(l=>{var c;return l.success?{value:l.data}:{issues:(c=l.error)==null?void 0:c.issues}})}},vendor:"zod",version:1}}),ev=Ne("$ZodString",(e,t)=>{var r;Kr.init(e,t),e._zod.pattern=[...((r=e==null?void 0:e._zod.bag)==null?void 0:r.patterns)??[]].pop()??ZI(e._zod.bag),e._zod.parse=(n,a)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),vr=Ne("$ZodStringFormat",(e,t)=>{y0.init(e,t),ev.init(e,t)}),mD=Ne("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=FI),vr.init(e,t)}),gD=Ne("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=fw(n))}else t.pattern??(t.pattern=fw());vr.init(e,t)}),vD=Ne("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=LI),vr.init(e,t)}),yD=Ne("$ZodURL",(e,t)=>{vr.init(e,t),e._zod.check=r=>{try{const n=r.value.trim(),a=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(a.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:HI.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(a.protocol.endsWith(":")?a.protocol.slice(0,-1):a.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=a.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),_D=Ne("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=BI()),vr.init(e,t)}),wD=Ne("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=RI),vr.init(e,t)}),xD=Ne("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=AI),vr.init(e,t)}),kD=Ne("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=OI),vr.init(e,t)}),bD=Ne("$ZodULID",(e,t)=>{t.pattern??(t.pattern=II),vr.init(e,t)}),SD=Ne("$ZodXID",(e,t)=>{t.pattern??(t.pattern=DI),vr.init(e,t)}),ED=Ne("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=PI),vr.init(e,t)}),TD=Ne("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=XI(t)),vr.init(e,t)}),CD=Ne("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=qI),vr.init(e,t)}),ND=Ne("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=GI(t)),vr.init(e,t)}),AD=Ne("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=jI),vr.init(e,t)}),OD=Ne("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=$I),vr.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),ID=Ne("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=UI),vr.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),DD=Ne("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=zI),vr.init(e,t)}),PD=Ne("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=VI),vr.init(e,t),e._zod.check=r=>{const n=r.value.split("/");try{if(n.length!==2)throw new Error;const[a,s]=n;if(!s)throw new Error;const i=Number(s);if(`${i}`!==s)throw new Error;if(i<0||i>128)throw new Error;new URL(`http://[${a}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function SS(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const RD=Ne("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=WI),vr.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{SS(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function jD(e){if(!yS.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return SS(r)}const FD=Ne("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=yS),vr.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{jD(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),LD=Ne("$ZodE164",(e,t)=>{t.pattern??(t.pattern=KI),vr.init(e,t)});function MD(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const a=JSON.parse(atob(n));return!("typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&(!("alg"in a)||a.alg!==t))}catch{return!1}}const BD=Ne("$ZodJWT",(e,t)=>{vr.init(e,t),e._zod.check=r=>{MD(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),ES=Ne("$ZodNumber",(e,t)=>{Kr.init(e,t),e._zod.pattern=e._zod.bag.pattern??JI,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const a=r.value;if(typeof a=="number"&&!Number.isNaN(a)&&Number.isFinite(a))return r;const s=typeof a=="number"?Number.isNaN(a)?"NaN":Number.isFinite(a)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:a,inst:e,...s?{received:s}:{}}),r}}),$D=Ne("$ZodNumber",(e,t)=>{rD.init(e,t),ES.init(e,t)}),UD=Ne("$ZodUnknown",(e,t)=>{Kr.init(e,t),e._zod.parse=r=>r}),zD=Ne("$ZodNever",(e,t)=>{Kr.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function dw(e,t,r){e.issues.length&&t.issues.push(...gS(r,e.issues)),t.value[r]=e.value}const VD=Ne("$ZodArray",(e,t)=>{Kr.init(e,t),e._zod.parse=(r,n)=>{const a=r.value;if(!Array.isArray(a))return r.issues.push({expected:"array",code:"invalid_type",input:a,inst:e}),r;r.value=Array(a.length);const s=[];for(let i=0;i<a.length;i++){const o=a[i],l=t.element._zod.run({value:o,issues:[]},n);l instanceof Promise?s.push(l.then(c=>dw(c,r,i))):dw(l,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function hh(e,t,r,n){e.issues.length&&t.issues.push(...gS(r,e.issues)),e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function TS(e){var n,a,s,i;const t=Object.keys(e.shape);for(const o of t)if(!((i=(s=(a=(n=e.shape)==null?void 0:n[o])==null?void 0:a._zod)==null?void 0:s.traits)!=null&&i.has("$ZodType")))throw new Error(`Invalid element at key "${o}": expected a Zod schema`);const r=iI(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function CS(e,t,r,n,a,s){const i=[],o=a.keySet,l=a.catchall._zod,c=l.def.type;for(const u of Object.keys(t)){if(o.has(u))continue;if(c==="never"){i.push(u);continue}const d=l.run({value:t[u],issues:[]},n);d instanceof Promise?e.push(d.then(h=>hh(h,r,u,t))):hh(d,r,u,t)}return i.length&&r.issues.push({code:"unrecognized_keys",keys:i,input:t,inst:s}),e.length?Promise.all(e).then(()=>r):r}const WD=Ne("$ZodObject",(e,t)=>{Kr.init(e,t);const r=X1(()=>TS(t));or(e._zod,"propValues",()=>{const i=t.shape,o={};for(const l in i){const c=i[l]._zod;if(c.values){o[l]??(o[l]=new Set);for(const u of c.values)o[l].add(u)}}return o});const n=dh,a=t.catchall;let s;e._zod.parse=(i,o)=>{s??(s=r.value);const l=i.value;if(!n(l))return i.issues.push({expected:"object",code:"invalid_type",input:l,inst:e}),i;i.value={};const c=[],u=s.shape;for(const d of s.keys){const v=u[d]._zod.run({value:l[d],issues:[]},o);v instanceof Promise?c.push(v.then(y=>hh(y,i,d,l))):hh(v,i,d,l)}return a?CS(c,l,i,o,r.value,e):c.length?Promise.all(c).then(()=>i):i}}),HD=Ne("$ZodObjectJIT",(e,t)=>{WD.init(e,t);const r=e._zod.parse,n=X1(()=>TS(t)),a=h=>{const v=new hD(["shape","payload","ctx"]),y=n.value,p=w=>{const E=uw(w);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};v.write("const input = payload.value;");const _=Object.create(null);let x=0;for(const w of y.keys)_[w]=`key_${x++}`;v.write("const newResult = {};");for(const w of y.keys){const E=_[w],I=uw(w);v.write(`const ${E} = ${p(w)};`),v.write(`
        if (${E}.issues.length) {
          payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${I}, ...iss.path] : [${I}]
          })));
        }
        
        
        if (${E}.value === undefined) {
          if (${I} in input) {
            newResult[${I}] = undefined;
          }
        } else {
          newResult[${I}] = ${E}.value;
        }
        
      `)}v.write("payload.value = newResult;"),v.write("return payload;");const k=v.compile();return(w,E)=>k(h,w,E)};let s;const i=dh,o=!hS.jitless,c=o&&aI.value,u=t.catchall;let d;e._zod.parse=(h,v)=>{d??(d=n.value);const y=h.value;return i(y)?o&&c&&(v==null?void 0:v.async)===!1&&v.jitless!==!0?(s||(s=a(t.shape)),h=s(h,v),u?CS([],y,h,v,d,e):h):r(h,v):(h.issues.push({expected:"object",code:"invalid_type",input:y,inst:e}),h)}});function hw(e,t,r,n){for(const s of e)if(s.issues.length===0)return t.value=s.value,t;const a=e.filter(s=>!bl(s));return a.length===1?(t.value=a[0].value,a[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(s=>s.issues.map(i=>To(i,n,Eo())))}),t)}const KD=Ne("$ZodUnion",(e,t)=>{Kr.init(e,t),or(e._zod,"optin",()=>t.options.some(a=>a._zod.optin==="optional")?"optional":void 0),or(e._zod,"optout",()=>t.options.some(a=>a._zod.optout==="optional")?"optional":void 0),or(e._zod,"values",()=>{if(t.options.every(a=>a._zod.values))return new Set(t.options.flatMap(a=>Array.from(a._zod.values)))}),or(e._zod,"pattern",()=>{if(t.options.every(a=>a._zod.pattern)){const a=t.options.map(s=>s._zod.pattern);return new RegExp(`^(${a.map(s=>Y1(s.source)).join("|")})$`)}});const r=t.options.length===1,n=t.options[0]._zod.run;e._zod.parse=(a,s)=>{if(r)return n(a,s);let i=!1;const o=[];for(const l of t.options){const c=l._zod.run({value:a.value,issues:[]},s);if(c instanceof Promise)o.push(c),i=!0;else{if(c.issues.length===0)return c;o.push(c)}}return i?Promise.all(o).then(l=>hw(l,a,e,s)):hw(o,a,e,s)}}),qD=Ne("$ZodIntersection",(e,t)=>{Kr.init(e,t),e._zod.parse=(r,n)=>{const a=r.value,s=t.left._zod.run({value:a,issues:[]},n),i=t.right._zod.run({value:a,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([l,c])=>pw(r,l,c)):pw(r,s,i)}});function vg(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Iu(e)&&Iu(t)){const r=Object.keys(t),n=Object.keys(e).filter(s=>r.indexOf(s)!==-1),a={...e,...t};for(const s of n){const i=vg(e[s],t[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};a[s]=i.data}return{valid:!0,data:a}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<e.length;n++){const a=e[n],s=t[n],i=vg(a,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function pw(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),bl(e))return e;const n=vg(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const GD=Ne("$ZodEnum",(e,t)=>{Kr.init(e,t);const r=tI(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=new RegExp(`^(${r.filter(a=>sI.has(typeof a)).map(a=>typeof a=="string"?d0(a):a.toString()).join("|")})$`),e._zod.parse=(a,s)=>{const i=a.value;return n.has(i)||a.issues.push({code:"invalid_value",values:r,input:i,inst:e}),a}}),XD=Ne("$ZodTransform",(e,t)=>{Kr.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new dS(e.constructor.name);const a=t.transform(r.value,r);if(n.async)return(a instanceof Promise?a:Promise.resolve(a)).then(i=>(r.value=i,r));if(a instanceof Promise)throw new Dl;return r.value=a,r}});function mw(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const ZD=Ne("$ZodOptional",(e,t)=>{Kr.init(e,t),e._zod.optin="optional",e._zod.optout="optional",or(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),or(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${Y1(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>{if(t.innerType._zod.optin==="optional"){const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>mw(s,r.value)):mw(a,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,n)}}),YD=Ne("$ZodNullable",(e,t)=>{Kr.init(e,t),or(e._zod,"optin",()=>t.innerType._zod.optin),or(e._zod,"optout",()=>t.innerType._zod.optout),or(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${Y1(r.source)}|null)$`):void 0}),or(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),JD=Ne("$ZodDefault",(e,t)=>{Kr.init(e,t),e._zod.optin="optional",or(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);if(r.value===void 0)return r.value=t.defaultValue,r;const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>gw(s,t)):gw(a,t)}});function gw(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const QD=Ne("$ZodPrefault",(e,t)=>{Kr.init(e,t),e._zod.optin="optional",or(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),eP=Ne("$ZodNonOptional",(e,t)=>{Kr.init(e,t),or(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>vw(s,e)):vw(a,e)}});function vw(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const tP=Ne("$ZodCatch",(e,t)=>{Kr.init(e,t),or(e._zod,"optin",()=>t.innerType._zod.optin),or(e._zod,"optout",()=>t.innerType._zod.optout),or(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>(r.value=s.value,s.issues.length&&(r.value=t.catchValue({...r,error:{issues:s.issues.map(i=>To(i,n,Eo()))},input:r.value}),r.issues=[]),r)):(r.value=a.value,a.issues.length&&(r.value=t.catchValue({...r,error:{issues:a.issues.map(s=>To(s,n,Eo()))},input:r.value}),r.issues=[]),r)}}),rP=Ne("$ZodPipe",(e,t)=>{Kr.init(e,t),or(e._zod,"values",()=>t.in._zod.values),or(e._zod,"optin",()=>t.in._zod.optin),or(e._zod,"optout",()=>t.out._zod.optout),or(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,n)=>{if(n.direction==="backward"){const s=t.out._zod.run(r,n);return s instanceof Promise?s.then(i=>td(i,t.in,n)):td(s,t.in,n)}const a=t.in._zod.run(r,n);return a instanceof Promise?a.then(s=>td(s,t.out,n)):td(a,t.out,n)}});function td(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const nP=Ne("$ZodReadonly",(e,t)=>{Kr.init(e,t),or(e._zod,"propValues",()=>t.innerType._zod.propValues),or(e._zod,"values",()=>t.innerType._zod.values),or(e._zod,"optin",()=>t.innerType._zod.optin),or(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(yw):yw(a)}});function yw(e){return e.value=Object.freeze(e.value),e}const aP=Ne("$ZodCustom",(e,t)=>{aa.init(e,t),Kr.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{const n=r.value,a=t.fn(n);if(a instanceof Promise)return a.then(s=>_w(s,r,n,e));_w(a,r,n,e)}});function _w(e,t,r,n){if(!e){const a={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(a.params=n._zod.def.params),t.issues.push(Du(a))}}class sP{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const n={...this.get(r)??{}};delete n.id;const a={...n,...this._map.get(t)};return Object.keys(a).length?a:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function iP(){return new sP}const rd=iP();function oP(e,t){return new e({type:"string",...pt(t)})}function lP(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...pt(t)})}function ww(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...pt(t)})}function cP(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...pt(t)})}function uP(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...pt(t)})}function fP(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...pt(t)})}function dP(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...pt(t)})}function hP(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...pt(t)})}function pP(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...pt(t)})}function mP(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...pt(t)})}function gP(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...pt(t)})}function vP(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...pt(t)})}function yP(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...pt(t)})}function _P(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...pt(t)})}function wP(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...pt(t)})}function xP(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...pt(t)})}function kP(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...pt(t)})}function bP(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...pt(t)})}function SP(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...pt(t)})}function EP(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...pt(t)})}function TP(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...pt(t)})}function CP(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...pt(t)})}function NP(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...pt(t)})}function AP(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...pt(t)})}function OP(e,t){return new e({type:"string",format:"date",check:"string_format",...pt(t)})}function IP(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...pt(t)})}function DP(e,t){return new e({type:"string",format:"duration",check:"string_format",...pt(t)})}function PP(e,t){return new e({type:"number",checks:[],...pt(t)})}function RP(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...pt(t)})}function jP(e){return new e({type:"unknown"})}function FP(e,t){return new e({type:"never",...pt(t)})}function xw(e,t){return new kS({check:"less_than",...pt(t),value:e,inclusive:!1})}function Lp(e,t){return new kS({check:"less_than",...pt(t),value:e,inclusive:!0})}function kw(e,t){return new bS({check:"greater_than",...pt(t),value:e,inclusive:!1})}function Mp(e,t){return new bS({check:"greater_than",...pt(t),value:e,inclusive:!0})}function bw(e,t){return new tD({check:"multiple_of",...pt(t),value:e})}function NS(e,t){return new nD({check:"max_length",...pt(t),maximum:e})}function ph(e,t){return new aD({check:"min_length",...pt(t),minimum:e})}function AS(e,t){return new sD({check:"length_equals",...pt(t),length:e})}function LP(e,t){return new iD({check:"string_format",format:"regex",...pt(t),pattern:e})}function MP(e){return new oD({check:"string_format",format:"lowercase",...pt(e)})}function BP(e){return new lD({check:"string_format",format:"uppercase",...pt(e)})}function $P(e,t){return new cD({check:"string_format",format:"includes",...pt(t),includes:e})}function UP(e,t){return new uD({check:"string_format",format:"starts_with",...pt(t),prefix:e})}function zP(e,t){return new fD({check:"string_format",format:"ends_with",...pt(t),suffix:e})}function sf(e){return new dD({check:"overwrite",tx:e})}function VP(e){return sf(t=>t.normalize(e))}function WP(){return sf(e=>e.trim())}function HP(){return sf(e=>e.toLowerCase())}function KP(){return sf(e=>e.toUpperCase())}function qP(e,t,r){return new e({type:"array",element:t,...pt(r)})}function GP(e,t,r){return new e({type:"custom",check:"custom",fn:t,...pt(r)})}function XP(e){const t=ZP(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(Du(n,r.value,t._zod.def));else{const a=n;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=t),a.continue??(a.continue=!t._zod.def.abort),r.issues.push(Du(a))}},e(r.value,r)));return t}function ZP(e,t){const r=new aa({check:"custom",...pt(t)});return r._zod.check=e,r}function Sw(e,t){try{var r=e()}catch(n){return t(n)}return r&&r.then?r.then(void 0,t):r}function YP(e,t){for(var r={};e.length;){var n=e[0],a=n.code,s=n.message,i=n.path.join(".");if(!r[i])if("unionErrors"in n){var o=n.unionErrors[0].errors[0];r[i]={message:o.message,type:o.code}}else r[i]={message:s,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(u){return u.errors.forEach(function(d){return e.push(d)})}),t){var l=r[i].types,c=l&&l[n.code];r[i]=K1(i,t,r,a,c?[].concat(c,n.message):n.message)}e.shift()}return r}function JP(e,t){for(var r={};e.length;){var n=e[0],a=n.code,s=n.message,i=n.path.join(".");if(!r[i])if(n.code==="invalid_union"&&n.errors.length>0){var o=n.errors[0][0];r[i]={message:o.message,type:o.code}}else r[i]={message:s,type:a};if(n.code==="invalid_union"&&n.errors.forEach(function(u){return u.forEach(function(d){return e.push(d)})}),t){var l=r[i].types,c=l&&l[n.code];r[i]=K1(i,t,r,a,c?[].concat(c,n.message):n.message)}e.shift()}return r}function QP(e,t,r){if(r===void 0&&(r={}),function(n){return"_def"in n&&typeof n._def=="object"&&"typeName"in n._def}(e))return function(n,a,s){try{return Promise.resolve(Sw(function(){return Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(i){return s.shouldUseNativeValidation&&mg({},s),{errors:{},values:r.raw?Object.assign({},n):i}})},function(i){if(function(o){return Array.isArray(o==null?void 0:o.issues)}(i))return{values:{},errors:ow(YP(i.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw i}))}catch(i){return Promise.reject(i)}};if(function(n){return"_zod"in n&&typeof n._zod=="object"}(e))return function(n,a,s){try{return Promise.resolve(Sw(function(){return Promise.resolve((r.mode==="sync"?vI:yI)(e,n,t)).then(function(i){return s.shouldUseNativeValidation&&mg({},s),{errors:{},values:r.raw?Object.assign({},n):i}})},function(i){if(function(o){return o instanceof Q1}(i))return{values:{},errors:ow(JP(i.issues,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw i}))}catch(i){return Promise.reject(i)}};throw new Error("Invalid input: not a Zod schema")}const eR=Ne("ZodISODateTime",(e,t)=>{TD.init(e,t),Er.init(e,t)});function tR(e){return AP(eR,e)}const rR=Ne("ZodISODate",(e,t)=>{CD.init(e,t),Er.init(e,t)});function nR(e){return OP(rR,e)}const aR=Ne("ZodISOTime",(e,t)=>{ND.init(e,t),Er.init(e,t)});function sR(e){return IP(aR,e)}const iR=Ne("ZodISODuration",(e,t)=>{AD.init(e,t),Er.init(e,t)});function oR(e){return DP(iR,e)}const lR=(e,t)=>{Q1.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>gI(e,r)},flatten:{value:r=>mI(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,gg,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,gg,2)}},isEmpty:{get(){return e.issues.length===0}}})},Fa=Ne("ZodError",lR,{Parent:Error}),cR=p0(Fa),uR=m0(Fa),fR=g0(Fa),dR=v0(Fa),hR=xI(Fa),pR=kI(Fa),mR=bI(Fa),gR=SI(Fa),vR=EI(Fa),yR=TI(Fa),_R=CI(Fa),wR=NI(Fa),en=Ne("ZodType",(e,t)=>(Kr.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),e.clone=(r,n)=>Ki(e,r,n),e.brand=()=>e,e.register=(r,n)=>(r.add(e,n),e),e.parse=(r,n)=>cR(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>fR(e,r,n),e.parseAsync=async(r,n)=>uR(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>dR(e,r,n),e.spa=e.safeParseAsync,e.encode=(r,n)=>hR(e,r,n),e.decode=(r,n)=>pR(e,r,n),e.encodeAsync=async(r,n)=>mR(e,r,n),e.decodeAsync=async(r,n)=>gR(e,r,n),e.safeEncode=(r,n)=>vR(e,r,n),e.safeDecode=(r,n)=>yR(e,r,n),e.safeEncodeAsync=async(r,n)=>_R(e,r,n),e.safeDecodeAsync=async(r,n)=>wR(e,r,n),e.refine=(r,n)=>e.check(c8(r,n)),e.superRefine=r=>e.check(u8(r)),e.overwrite=r=>e.check(sf(r)),e.optional=()=>Nw(e),e.nullable=()=>Aw(e),e.nullish=()=>Nw(Aw(e)),e.nonoptional=r=>r8(e,r),e.array=()=>WR(e),e.or=r=>gh([e,r]),e.and=r=>GR(e,r),e.transform=r=>Ow(e,ZR(r)),e.default=r=>QR(e,r),e.prefault=r=>t8(e,r),e.catch=r=>a8(e,r),e.pipe=r=>Ow(e,r),e.readonly=()=>o8(e),e.describe=r=>{const n=e.clone();return rd.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){var r;return(r=rd.get(e))==null?void 0:r.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return rd.get(e);const n=e.clone();return rd.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),OS=Ne("_ZodString",(e,t)=>{ev.init(e,t),en.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(LP(...n)),e.includes=(...n)=>e.check($P(...n)),e.startsWith=(...n)=>e.check(UP(...n)),e.endsWith=(...n)=>e.check(zP(...n)),e.min=(...n)=>e.check(ph(...n)),e.max=(...n)=>e.check(NS(...n)),e.length=(...n)=>e.check(AS(...n)),e.nonempty=(...n)=>e.check(ph(1,...n)),e.lowercase=n=>e.check(MP(n)),e.uppercase=n=>e.check(BP(n)),e.trim=()=>e.check(WP()),e.normalize=(...n)=>e.check(VP(...n)),e.toLowerCase=()=>e.check(HP()),e.toUpperCase=()=>e.check(KP())}),xR=Ne("ZodString",(e,t)=>{ev.init(e,t),OS.init(e,t),e.email=r=>e.check(lP(kR,r)),e.url=r=>e.check(hP(bR,r)),e.jwt=r=>e.check(NP(MR,r)),e.emoji=r=>e.check(pP(SR,r)),e.guid=r=>e.check(ww(Ew,r)),e.uuid=r=>e.check(cP(nd,r)),e.uuidv4=r=>e.check(uP(nd,r)),e.uuidv6=r=>e.check(fP(nd,r)),e.uuidv7=r=>e.check(dP(nd,r)),e.nanoid=r=>e.check(mP(ER,r)),e.guid=r=>e.check(ww(Ew,r)),e.cuid=r=>e.check(gP(TR,r)),e.cuid2=r=>e.check(vP(CR,r)),e.ulid=r=>e.check(yP(NR,r)),e.base64=r=>e.check(EP(jR,r)),e.base64url=r=>e.check(TP(FR,r)),e.xid=r=>e.check(_P(AR,r)),e.ksuid=r=>e.check(wP(OR,r)),e.ipv4=r=>e.check(xP(IR,r)),e.ipv6=r=>e.check(kP(DR,r)),e.cidrv4=r=>e.check(bP(PR,r)),e.cidrv6=r=>e.check(SP(RR,r)),e.e164=r=>e.check(CP(LR,r)),e.datetime=r=>e.check(tR(r)),e.date=r=>e.check(nR(r)),e.time=r=>e.check(sR(r)),e.duration=r=>e.check(oR(r))});function On(e){return oP(xR,e)}const Er=Ne("ZodStringFormat",(e,t)=>{vr.init(e,t),OS.init(e,t)}),kR=Ne("ZodEmail",(e,t)=>{vD.init(e,t),Er.init(e,t)}),Ew=Ne("ZodGUID",(e,t)=>{mD.init(e,t),Er.init(e,t)}),nd=Ne("ZodUUID",(e,t)=>{gD.init(e,t),Er.init(e,t)}),bR=Ne("ZodURL",(e,t)=>{yD.init(e,t),Er.init(e,t)}),SR=Ne("ZodEmoji",(e,t)=>{_D.init(e,t),Er.init(e,t)}),ER=Ne("ZodNanoID",(e,t)=>{wD.init(e,t),Er.init(e,t)}),TR=Ne("ZodCUID",(e,t)=>{xD.init(e,t),Er.init(e,t)}),CR=Ne("ZodCUID2",(e,t)=>{kD.init(e,t),Er.init(e,t)}),NR=Ne("ZodULID",(e,t)=>{bD.init(e,t),Er.init(e,t)}),AR=Ne("ZodXID",(e,t)=>{SD.init(e,t),Er.init(e,t)}),OR=Ne("ZodKSUID",(e,t)=>{ED.init(e,t),Er.init(e,t)}),IR=Ne("ZodIPv4",(e,t)=>{OD.init(e,t),Er.init(e,t)}),DR=Ne("ZodIPv6",(e,t)=>{ID.init(e,t),Er.init(e,t)}),PR=Ne("ZodCIDRv4",(e,t)=>{DD.init(e,t),Er.init(e,t)}),RR=Ne("ZodCIDRv6",(e,t)=>{PD.init(e,t),Er.init(e,t)}),jR=Ne("ZodBase64",(e,t)=>{RD.init(e,t),Er.init(e,t)}),FR=Ne("ZodBase64URL",(e,t)=>{FD.init(e,t),Er.init(e,t)}),LR=Ne("ZodE164",(e,t)=>{LD.init(e,t),Er.init(e,t)}),MR=Ne("ZodJWT",(e,t)=>{BD.init(e,t),Er.init(e,t)}),IS=Ne("ZodNumber",(e,t)=>{ES.init(e,t),en.init(e,t),e.gt=(n,a)=>e.check(kw(n,a)),e.gte=(n,a)=>e.check(Mp(n,a)),e.min=(n,a)=>e.check(Mp(n,a)),e.lt=(n,a)=>e.check(xw(n,a)),e.lte=(n,a)=>e.check(Lp(n,a)),e.max=(n,a)=>e.check(Lp(n,a)),e.int=n=>e.check(Tw(n)),e.safe=n=>e.check(Tw(n)),e.positive=n=>e.check(kw(0,n)),e.nonnegative=n=>e.check(Mp(0,n)),e.negative=n=>e.check(xw(0,n)),e.nonpositive=n=>e.check(Lp(0,n)),e.multipleOf=(n,a)=>e.check(bw(n,a)),e.step=(n,a)=>e.check(bw(n,a)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function mh(e){return PP(IS,e)}const BR=Ne("ZodNumberFormat",(e,t)=>{$D.init(e,t),IS.init(e,t)});function Tw(e){return RP(BR,e)}const $R=Ne("ZodUnknown",(e,t)=>{UD.init(e,t),en.init(e,t)});function Cw(){return jP($R)}const UR=Ne("ZodNever",(e,t)=>{zD.init(e,t),en.init(e,t)});function zR(e){return FP(UR,e)}const VR=Ne("ZodArray",(e,t)=>{VD.init(e,t),en.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(ph(r,n)),e.nonempty=r=>e.check(ph(1,r)),e.max=(r,n)=>e.check(NS(r,n)),e.length=(r,n)=>e.check(AS(r,n)),e.unwrap=()=>e.element});function WR(e,t){return qP(VR,e,t)}const HR=Ne("ZodObject",(e,t)=>{HD.init(e,t),en.init(e,t),or(e,"shape",()=>t.shape),e.keyof=()=>DS(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Cw()}),e.loose=()=>e.clone({...e._zod.def,catchall:Cw()}),e.strict=()=>e.clone({...e._zod.def,catchall:zR()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>uI(e,r),e.safeExtend=r=>fI(e,r),e.merge=r=>dI(e,r),e.pick=r=>lI(e,r),e.omit=r=>cI(e,r),e.partial=(...r)=>hI(PS,e,r[0]),e.required=(...r)=>pI(RS,e,r[0])});function Fo(e,t){const r={type:"object",get shape(){return Hi(this,"shape",e?nI(e):{}),this.shape},...pt(t)};return new HR(r)}const KR=Ne("ZodUnion",(e,t)=>{KD.init(e,t),en.init(e,t),e.options=t.options});function gh(e,t){return new KR({type:"union",options:e,...pt(t)})}const qR=Ne("ZodIntersection",(e,t)=>{qD.init(e,t),en.init(e,t)});function GR(e,t){return new qR({type:"intersection",left:e,right:t})}const yg=Ne("ZodEnum",(e,t)=>{GD.init(e,t),en.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(n,a)=>{const s={};for(const i of n)if(r.has(i))s[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new yg({...t,checks:[],...pt(a),entries:s})},e.exclude=(n,a)=>{const s={...t.entries};for(const i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new yg({...t,checks:[],...pt(a),entries:s})}});function DS(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new yg({type:"enum",entries:r,...pt(t)})}const XR=Ne("ZodTransform",(e,t)=>{XD.init(e,t),en.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new dS(e.constructor.name);r.addIssue=s=>{if(typeof s=="string")r.issues.push(Du(s,r.value,t));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),r.issues.push(Du(i))}};const a=t.transform(r.value,r);return a instanceof Promise?a.then(s=>(r.value=s,r)):(r.value=a,r)}});function ZR(e){return new XR({type:"transform",transform:e})}const PS=Ne("ZodOptional",(e,t)=>{ZD.init(e,t),en.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Nw(e){return new PS({type:"optional",innerType:e})}const YR=Ne("ZodNullable",(e,t)=>{YD.init(e,t),en.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Aw(e){return new YR({type:"nullable",innerType:e})}const JR=Ne("ZodDefault",(e,t)=>{JD.init(e,t),en.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function QR(e,t){return new JR({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():mS(t)}})}const e8=Ne("ZodPrefault",(e,t)=>{QD.init(e,t),en.init(e,t),e.unwrap=()=>e._zod.def.innerType});function t8(e,t){return new e8({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():mS(t)}})}const RS=Ne("ZodNonOptional",(e,t)=>{eP.init(e,t),en.init(e,t),e.unwrap=()=>e._zod.def.innerType});function r8(e,t){return new RS({type:"nonoptional",innerType:e,...pt(t)})}const n8=Ne("ZodCatch",(e,t)=>{tP.init(e,t),en.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function a8(e,t){return new n8({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const s8=Ne("ZodPipe",(e,t)=>{rP.init(e,t),en.init(e,t),e.in=t.in,e.out=t.out});function Ow(e,t){return new s8({type:"pipe",in:e,out:t})}const i8=Ne("ZodReadonly",(e,t)=>{nP.init(e,t),en.init(e,t),e.unwrap=()=>e._zod.def.innerType});function o8(e){return new i8({type:"readonly",innerType:e})}const l8=Ne("ZodCustom",(e,t)=>{aP.init(e,t),en.init(e,t)});function c8(e,t={}){return GP(l8,e,t)}function u8(e){return XP(e)}const f8=Fo({username:On().min(1,"Nome de usuário é obrigatório").min(3,"Nome de usuário deve ter pelo menos 3 caracteres"),password:On().min(1,"Senha é obrigatória").min(6,"Senha deve ter pelo menos 6 caracteres")}),jS="/assets/ManipulariumLogo-8slJorZ1.png",d8=()=>{const e=D1(),{login:t,isLoading:r}=u0(),[n,a]=j.useState(""),{register:s,handleSubmit:i,formState:{errors:o}}=QO({resolver:QP(f8)}),l=async c=>{a(""),await t(c.username,c.password)?e("/dashboard"):a("Credenciais inválidas. Verifique seu nome de usuário e senha.")};return m.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 to-black px-4 py-12",children:m.jsxs("div",{className:"w-full max-w-md space-y-8",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"mx-auto mb-6",children:m.jsx("img",{src:jS,alt:"Manipularium Logo",className:"h-24 w-24 mx-auto drop-shadow-lg",style:{backgroundColor:"transparent"}})}),m.jsx("h2",{className:"text-3xl font-bold text-gray-100",children:"Manipularium"}),m.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Conferência Bancária - Acesso Restrito"})]}),m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 px-6 py-8",children:[m.jsxs("form",{className:"space-y-6",onSubmit:i(l),children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-300 mb-2",children:"Nome de usuário"}),m.jsx("input",{...s("username"),id:"username",name:"username",type:"text",autoComplete:"username","aria-describedby":o.username?"username-error":void 0,className:`w-full px-3 py-2 border rounded-md shadow-sm bg-gray-700 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${o.username?"border-red-400":"border-gray-600"}`,placeholder:"Digite seu nome de usuário"}),o.username&&m.jsx("p",{id:"username-error",className:"mt-1 text-sm text-red-400",role:"alert",children:o.username.message})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Senha"}),m.jsx("input",{...s("password"),id:"password",name:"password",type:"password",autoComplete:"current-password","aria-describedby":o.password?"password-error":void 0,className:`w-full px-3 py-2 border rounded-md shadow-sm bg-gray-700 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${o.password?"border-red-400":"border-gray-600"}`,placeholder:"Digite sua senha"}),o.password&&m.jsx("p",{id:"password-error",className:"mt-1 text-sm text-red-400",role:"alert",children:o.password.message})]}),n&&m.jsx("div",{className:"bg-red-900/20 border border-red-400 rounded-md p-3",children:m.jsx("p",{className:"text-sm text-red-400",role:"alert",children:n})}),m.jsx("button",{type:"submit",disabled:r,className:"w-full flex justify-center items-center py-2.5 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?m.jsxs(m.Fragment,{children:[m.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Entrando..."]}):"Entrar"})]}),m.jsx("div",{className:"mt-6 p-3 bg-indigo-900/20 border border-indigo-600/30 rounded-md",children:m.jsxs("p",{className:"text-xs text-indigo-300",children:[m.jsx("strong",{children:"Credenciais de demonstração:"}),m.jsx("br",{}),"Usuário: admin",m.jsx("br",{}),"Senha: manipularium"]})})]})]})})},h8=({children:e})=>{const{user:t}=u0();return t?m.jsx(m.Fragment,{children:e}):m.jsx(Qm,{to:"/",replace:!0})};function _g(){return _g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_g.apply(null,arguments)}function Iw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wg(e,t){return wg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},wg(e,t)}function p8(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,wg(e,t)}var Dw=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function m8(e,t){return!!(e===t||Dw(e)&&Dw(t))}function g8(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!m8(e[r],t[r]))return!1;return!0}function Bp(e,t){t===void 0&&(t=g8);var r,n=[],a,s=!1;function i(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];return s&&r===this&&t(o,n)||(a=e.apply(this,o),s=!0,r=this,n=o),a}return i}var v8=typeof performance=="object"&&typeof performance.now=="function",Pw=v8?function(){return performance.now()}:function(){return Date.now()};function Rw(e){cancelAnimationFrame(e.id)}function y8(e,t){var r=Pw();function n(){Pw()-r>=t?e.call(null):a.id=requestAnimationFrame(n)}var a={id:requestAnimationFrame(n)};return a}var $p=-1;function jw(e){if(e===void 0&&(e=!1),$p===-1||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),$p=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return $p}var nl=null;function Fw(e){if(e===void 0&&(e=!1),nl===null||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),a=n.style;return a.width="100px",a.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?nl="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?nl="negative":nl="positive-ascending"),document.body.removeChild(t),nl}return nl}var _8=150,w8=function(t,r){return t};function x8(e){var t,r=e.getItemOffset,n=e.getEstimatedTotalSize,a=e.getItemSize,s=e.getOffsetForIndexAndAlignment,i=e.getStartIndexForOffset,o=e.getStopIndexForStartIndex,l=e.initInstanceProps,c=e.shouldResetStyleCacheOnItemSizeChange,u=e.validateProps;return t=function(d){p8(h,d);function h(y){var p;return p=d.call(this,y)||this,p._instanceProps=l(p.props,Iw(p)),p._outerRef=void 0,p._resetIsScrollingTimeoutId=null,p.state={instance:Iw(p),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof p.props.initialScrollOffset=="number"?p.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},p._callOnItemsRendered=void 0,p._callOnItemsRendered=Bp(function(_,x,k,w){return p.props.onItemsRendered({overscanStartIndex:_,overscanStopIndex:x,visibleStartIndex:k,visibleStopIndex:w})}),p._callOnScroll=void 0,p._callOnScroll=Bp(function(_,x,k){return p.props.onScroll({scrollDirection:_,scrollOffset:x,scrollUpdateWasRequested:k})}),p._getItemStyle=void 0,p._getItemStyle=function(_){var x=p.props,k=x.direction,w=x.itemSize,E=x.layout,I=p._getItemStyleCache(c&&w,c&&E,c&&k),D;if(I.hasOwnProperty(_))D=I[_];else{var C=r(p.props,_,p._instanceProps),V=a(p.props,_,p._instanceProps),z=k==="horizontal"||E==="horizontal",ee=k==="rtl",re=z?C:0;I[_]=D={position:"absolute",left:ee?void 0:re,right:ee?re:void 0,top:z?0:C,height:z?"100%":V,width:z?V:"100%"}}return D},p._getItemStyleCache=void 0,p._getItemStyleCache=Bp(function(_,x,k){return{}}),p._onScrollHorizontal=function(_){var x=_.currentTarget,k=x.clientWidth,w=x.scrollLeft,E=x.scrollWidth;p.setState(function(I){if(I.scrollOffset===w)return null;var D=p.props.direction,C=w;if(D==="rtl")switch(Fw()){case"negative":C=-w;break;case"positive-descending":C=E-k-w;break}return C=Math.max(0,Math.min(C,E-k)),{isScrolling:!0,scrollDirection:I.scrollOffset<w?"forward":"backward",scrollOffset:C,scrollUpdateWasRequested:!1}},p._resetIsScrollingDebounced)},p._onScrollVertical=function(_){var x=_.currentTarget,k=x.clientHeight,w=x.scrollHeight,E=x.scrollTop;p.setState(function(I){if(I.scrollOffset===E)return null;var D=Math.max(0,Math.min(E,w-k));return{isScrolling:!0,scrollDirection:I.scrollOffset<D?"forward":"backward",scrollOffset:D,scrollUpdateWasRequested:!1}},p._resetIsScrollingDebounced)},p._outerRefSetter=function(_){var x=p.props.outerRef;p._outerRef=_,typeof x=="function"?x(_):x!=null&&typeof x=="object"&&x.hasOwnProperty("current")&&(x.current=_)},p._resetIsScrollingDebounced=function(){p._resetIsScrollingTimeoutId!==null&&Rw(p._resetIsScrollingTimeoutId),p._resetIsScrollingTimeoutId=y8(p._resetIsScrolling,_8)},p._resetIsScrolling=function(){p._resetIsScrollingTimeoutId=null,p.setState({isScrolling:!1},function(){p._getItemStyleCache(-1,null)})},p}h.getDerivedStateFromProps=function(p,_){return k8(p,_),u(p),null};var v=h.prototype;return v.scrollTo=function(p){p=Math.max(0,p),this.setState(function(_){return _.scrollOffset===p?null:{scrollDirection:_.scrollOffset<p?"forward":"backward",scrollOffset:p,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},v.scrollToItem=function(p,_){_===void 0&&(_="auto");var x=this.props,k=x.itemCount,w=x.layout,E=this.state.scrollOffset;p=Math.max(0,Math.min(p,k-1));var I=0;if(this._outerRef){var D=this._outerRef;w==="vertical"?I=D.scrollWidth>D.clientWidth?jw():0:I=D.scrollHeight>D.clientHeight?jw():0}this.scrollTo(s(this.props,p,_,E,this._instanceProps,I))},v.componentDidMount=function(){var p=this.props,_=p.direction,x=p.initialScrollOffset,k=p.layout;if(typeof x=="number"&&this._outerRef!=null){var w=this._outerRef;_==="horizontal"||k==="horizontal"?w.scrollLeft=x:w.scrollTop=x}this._callPropsCallbacks()},v.componentDidUpdate=function(){var p=this.props,_=p.direction,x=p.layout,k=this.state,w=k.scrollOffset,E=k.scrollUpdateWasRequested;if(E&&this._outerRef!=null){var I=this._outerRef;if(_==="horizontal"||x==="horizontal")if(_==="rtl")switch(Fw()){case"negative":I.scrollLeft=-w;break;case"positive-ascending":I.scrollLeft=w;break;default:var D=I.clientWidth,C=I.scrollWidth;I.scrollLeft=C-D-w;break}else I.scrollLeft=w;else I.scrollTop=w}this._callPropsCallbacks()},v.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&Rw(this._resetIsScrollingTimeoutId)},v.render=function(){var p=this.props,_=p.children,x=p.className,k=p.direction,w=p.height,E=p.innerRef,I=p.innerElementType,D=p.innerTagName,C=p.itemCount,V=p.itemData,z=p.itemKey,ee=z===void 0?w8:z,re=p.layout,G=p.outerElementType,me=p.outerTagName,Ee=p.style,Ae=p.useIsScrolling,ke=p.width,Oe=this.state.isScrolling,Ce=k==="horizontal"||re==="horizontal",Z=Ce?this._onScrollHorizontal:this._onScrollVertical,Se=this._getRangeToRender(),Ve=Se[0],B=Se[1],J=[];if(C>0)for(var K=Ve;K<=B;K++)J.push(j.createElement(_,{data:V,key:ee(K,V),index:K,isScrolling:Ae?Oe:void 0,style:this._getItemStyle(K)}));var X=n(this.props,this._instanceProps);return j.createElement(G||me||"div",{className:x,onScroll:Z,ref:this._outerRefSetter,style:_g({position:"relative",height:w,width:ke,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:k},Ee)},j.createElement(I||D||"div",{children:J,ref:E,style:{height:Ce?"100%":X,pointerEvents:Oe?"none":void 0,width:Ce?X:"100%"}}))},v._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var p=this.props.itemCount;if(p>0){var _=this._getRangeToRender(),x=_[0],k=_[1],w=_[2],E=_[3];this._callOnItemsRendered(x,k,w,E)}}if(typeof this.props.onScroll=="function"){var I=this.state,D=I.scrollDirection,C=I.scrollOffset,V=I.scrollUpdateWasRequested;this._callOnScroll(D,C,V)}},v._getRangeToRender=function(){var p=this.props,_=p.itemCount,x=p.overscanCount,k=this.state,w=k.isScrolling,E=k.scrollDirection,I=k.scrollOffset;if(_===0)return[0,0,0,0];var D=i(this.props,I,this._instanceProps),C=o(this.props,D,I,this._instanceProps),V=!w||E==="backward"?Math.max(1,x):1,z=!w||E==="forward"?Math.max(1,x):1;return[Math.max(0,D-V),Math.max(0,Math.min(_-1,C+z)),D,C]},h}(j.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var k8=function(t,r){t.children,t.direction,t.height,t.layout,t.innerTagName,t.outerTagName,t.width,r.instance},_0=x8({getItemOffset:function(t,r){var n=t.itemSize;return r*n},getItemSize:function(t,r){var n=t.itemSize;return n},getEstimatedTotalSize:function(t){var r=t.itemCount,n=t.itemSize;return n*r},getOffsetForIndexAndAlignment:function(t,r,n,a,s,i){var o=t.direction,l=t.height,c=t.itemCount,u=t.itemSize,d=t.layout,h=t.width,v=o==="horizontal"||d==="horizontal",y=v?h:l,p=Math.max(0,c*u-y),_=Math.min(p,r*u),x=Math.max(0,r*u-y+u+i);switch(n==="smart"&&(a>=x-y&&a<=_+y?n="auto":n="center"),n){case"start":return _;case"end":return x;case"center":{var k=Math.round(x+(_-x)/2);return k<Math.ceil(y/2)?0:k>p+Math.floor(y/2)?p:k}case"auto":default:return a>=x&&a<=_?a:a<x?x:_}},getStartIndexForOffset:function(t,r){var n=t.itemCount,a=t.itemSize;return Math.max(0,Math.min(n-1,Math.floor(r/a)))},getStopIndexForStartIndex:function(t,r,n){var a=t.direction,s=t.height,i=t.itemCount,o=t.itemSize,l=t.layout,c=t.width,u=a==="horizontal"||l==="horizontal",d=r*o,h=u?c:s,v=Math.ceil((h+n-d)/o);return Math.max(0,Math.min(i-1,r+v-1))},initInstanceProps:function(t){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(t){t.itemSize}});function b8(e,t,r){const n=j.useMemo(()=>e!=null&&e.data?e.data.filter(i=>{var o,l;if(t.has(i.id)||r.dateFilter&&!((o=i.date)!=null&&o.includes(r.dateFilter))||r.typeFilter&&r.typeFilter!=="all"&&i.paymentType!==r.typeFilter)return!1;if(r.searchText){const c=r.searchText.toLowerCase();if(![i.originalHistory,i.description,i.cpf,(l=i.value)==null?void 0:l.toString()].join(" ").toLowerCase().includes(c))return!1}return!(r.minValue!==void 0&&i.value<r.minValue||r.maxValue!==void 0&&i.value>r.maxValue)}):[],[e==null?void 0:e.data,t,r]),a=j.useMemo(()=>{const o=((e==null?void 0:e.data)||[]).filter(h=>!t.has(h.id)),l=o.reduce((h,v)=>h+(v.value||0),0),c=n.reduce((h,v)=>h+(v.value||0),0),u={};o.forEach(h=>{const v=h.validationStatus||"unknown";u[v]=(u[v]||0)+1});const d={};return o.forEach(h=>{const v=h.paymentType||"OUTROS";d[v]=(d[v]||0)+1}),{totalItems:o.length,totalValue:l,itemsByStatus:u,itemsByType:d,averageValue:o.length>0?l/o.length:0,filteredCount:n.length,filteredValue:c}},[e==null?void 0:e.data,t,n]),s=j.useMemo(()=>[...n].sort((i,o)=>(o.value||0)-(i.value||0)),[n]);return{filteredData:s,stats:a,isEmpty:s.length===0,hasFilters:Object.values(r).some(i=>i!==""&&i!=="all"&&i!==void 0)}}function S8(e,t){const r=j.useMemo(()=>e.filter(s=>{var i;if(t.dateFilter&&!s.conferredAt.toLocaleDateString("pt-BR").includes(t.dateFilter)||t.typeFilter&&t.typeFilter!=="all"&&s.paymentType!==t.typeFilter)return!1;if(t.searchText){const o=t.searchText.toLowerCase();if(![s.originalHistory,s.description,s.cpf,(i=s.value)==null?void 0:i.toString(),s.conferredId].join(" ").toLowerCase().includes(o))return!1}return!(t.minValue!==void 0&&s.value<t.minValue||t.maxValue!==void 0&&s.value>t.maxValue)}),[e,t]),n=j.useMemo(()=>{const s=e.reduce((c,u)=>c+(u.value||0),0),i=r.reduce((c,u)=>c+(u.value||0),0),o={};e.forEach(c=>{const u=c.paymentType||"OUTROS";o[u]=(o[u]||0)+1});const l={conferred:e.length};return{totalItems:e.length,totalValue:s,itemsByStatus:l,itemsByType:o,averageValue:e.length>0?s/e.length:0,filteredCount:r.length,filteredValue:i}},[e,r]),a=j.useMemo(()=>[...r].sort((s,i)=>i.conferredAt.getTime()-s.conferredAt.getTime()),[r]);return{filteredData:a,stats:n,isEmpty:a.length===0,hasFilters:Object.values(t).some(s=>s!==""&&s!=="all"&&s!==void 0)}}function E8(e,t){const r=j.useMemo(()=>e.filter(s=>{var i,o;if(t.dateFilter&&!((i=s.operation_date)!=null&&i.includes(t.dateFilter))||t.typeFilter&&t.typeFilter!=="all"&&s.operation_type!==t.typeFilter||t.statusFilter&&t.statusFilter!=="all"&&s.status!==t.statusFilter)return!1;if(t.searchText){const l=t.searchText.toLowerCase();if(![s.description,s.document_number,(o=s.value)==null?void 0:o.toString(),s.operation_type,s.status].join(" ").toLowerCase().includes(l))return!1}return!(t.minValue!==void 0&&(s.value||0)<t.minValue||t.maxValue!==void 0&&(s.value||0)>t.maxValue)}),[e,t]),n=j.useMemo(()=>{const s=e.reduce((c,u)=>c+(u.value||0),0),i=r.reduce((c,u)=>c+(u.value||0),0),o={};e.forEach(c=>{const u=c.status||"unknown";o[u]=(o[u]||0)+1});const l={};return e.forEach(c=>{const u=c.operation_type||"unknown";l[u]=(l[u]||0)+1}),{totalItems:e.length,totalValue:s,itemsByStatus:o,itemsByType:l,averageValue:e.length>0?s/e.length:0,filteredCount:r.length,filteredValue:i}},[e,r]),a=j.useMemo(()=>[...r].sort((s,i)=>{const o=new Date(s.operation_timestamp||"").getTime();return new Date(i.operation_timestamp||"").getTime()-o}),[r]);return{filteredData:a,stats:n,isEmpty:a.length===0,hasFilters:Object.values(t).some(s=>s!==""&&s!=="all"&&s!==void 0)}}function ms(e,t,r){const[n,a]=j.useState(()=>{try{if(typeof window>"u")return t;const s=localStorage.getItem(e);if(s&&s!=="undefined"&&s!=="null"){const i=r!=null&&r.deserialize?r.deserialize(s):JSON.parse(s);if(i!=null)return i}return t}catch(s){console.warn(`Failed to load ${e} from localStorage:`,s);try{localStorage.removeItem(e)}catch{}return t}});return j.useEffect(()=>{try{const s=r!=null&&r.serialize?r.serialize(n):JSON.stringify(n);localStorage.setItem(e,s)}catch(s){console.warn(`Failed to save ${e} to localStorage:`,s)}},[e,n,r]),[n,a]}function FS(){return ms("dashboard_filters",{selectedDate:new Date().toISOString().split("T")[0],searchValue:"",currentPage:1,statusFilter:"all",conferenceValue:""})}const LS=Jt.memo(({index:e,style:t,data:r})=>{const n=r.items[e],a=r.transferredIds.has(n.id),s=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),i=l=>{switch(l){case"valid":return m.jsx("span",{className:"px-2 py-1 text-xs bg-green-900 text-green-200 rounded",children:"Válido"});case"warning":return m.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-900 text-yellow-200 rounded",children:"Aviso"});case"error":return m.jsx("span",{className:"px-2 py-1 text-xs bg-red-900 text-red-200 rounded",children:"Erro"});default:return m.jsx("span",{className:"px-2 py-1 text-xs bg-gray-700 text-gray-300 rounded",children:"Desconhecido"})}},o=l=>{const u={"PIX RECEBIDO":"bg-green-900 text-green-200","PIX ENVIADO":"bg-red-900 text-red-200",TED:"bg-blue-900 text-blue-200",DOC:"bg-purple-900 text-purple-200",CARTÃO:"bg-indigo-900 text-indigo-200",DINHEIRO:"bg-yellow-900 text-yellow-200",BOLETO:"bg-orange-900 text-orange-200"}[l]||"bg-gray-700 text-gray-300";return m.jsx("span",{className:`px-2 py-1 text-xs rounded ${u}`,children:l})};return m.jsxs("div",{style:t,className:`grid grid-cols-12 gap-2 px-4 py-2 border-b border-gray-700 text-sm ${a?"bg-gray-800 opacity-50":e%2===0?"bg-gray-900":"bg-gray-850"}`,children:[m.jsx("div",{className:"col-span-1 text-gray-400 font-mono",children:e+1}),m.jsx("div",{className:"col-span-2 text-gray-300",children:n.date||"-"}),m.jsx("div",{className:"col-span-2",children:o(n.paymentType)}),m.jsx("div",{className:"col-span-2 text-gray-300 font-mono",children:n.cpf?`${n.cpf.slice(0,3)}.${n.cpf.slice(3,6)}.${n.cpf.slice(6,9)}-${n.cpf.slice(9)}`:"-"}),m.jsx("div",{className:"col-span-2 text-right font-semibold",children:m.jsx("span",{className:n.value>=0?"text-green-400":"text-red-400",children:s(n.value)})}),m.jsx("div",{className:"col-span-2",children:i(n.validationStatus||"unknown")}),m.jsx("div",{className:"col-span-1 text-center",children:a?m.jsx("span",{className:"text-xs text-green-400",children:"✓ Transferido"}):m.jsx("span",{className:"text-xs text-gray-400",children:"Disponível"})})]})});LS.displayName="TableRow";const T8=({parseResult:e,transferredIds:t,className:r=""})=>{const[n,a]=ms("banking_table_filters",{dateFilter:"",typeFilter:"all",statusFilter:"all",searchText:""}),{filteredData:s,stats:i,isEmpty:o,hasFilters:l}=b8(e,t,n),c=j.useMemo(()=>{if(!(e!=null&&e.data))return{paymentTypes:[],statuses:[]};const p=[...new Set(e.data.map(x=>x.paymentType))].sort(),_=[...new Set(e.data.map(x=>x.validationStatus||"unknown"))].sort();return{paymentTypes:p,statuses:_}},[e==null?void 0:e.data]),u=j.useMemo(()=>({items:s,transferredIds:t}),[s,t]),d=j.useCallback((p,_)=>{a(x=>({...x,[p]:_}))},[a]),h=j.useCallback(()=>{a({dateFilter:"",typeFilter:"all",statusFilter:"all",searchText:""})},[a]);if(!(e!=null&&e.data))return m.jsx("div",{className:`bg-gray-800 border border-gray-700 rounded-lg ${r}`,children:m.jsx("div",{className:"p-8 text-center text-gray-400",children:"Carregue uma planilha para visualizar os dados bancários"})});const v=60,y=Math.min(600,Math.max(300,s.length*v+50));return m.jsxs("div",{className:`bg-gray-800 border border-gray-700 rounded-lg ${r}`,children:[m.jsxs("div",{className:"p-4 border-b border-gray-700",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-200",children:"Dados Bancários"}),m.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-400",children:[m.jsxs("span",{children:["Total: ",i.totalItems]}),m.jsxs("span",{children:["Filtrados: ",i.filteredCount]}),m.jsxs("span",{children:["Valor: ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.filteredValue)]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[m.jsx("input",{type:"text",placeholder:"Buscar...",value:n.searchText,onChange:p=>d("searchText",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),m.jsxs("select",{value:n.typeFilter,onChange:p=>d("typeFilter",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[m.jsx("option",{value:"all",children:"Todos os tipos"}),c.paymentTypes.map(p=>m.jsx("option",{value:p,children:p},p))]}),m.jsxs("select",{value:n.statusFilter,onChange:p=>d("statusFilter",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[m.jsx("option",{value:"all",children:"Todos os status"}),c.statuses.map(p=>m.jsx("option",{value:p,children:p==="valid"?"Válido":p==="warning"?"Aviso":p==="error"?"Erro":p},p))]}),l&&m.jsx("button",{onClick:h,className:"px-3 py-2 text-sm text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar Filtros"})]})]}),m.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 bg-gray-750 border-b border-gray-700 text-sm font-semibold text-gray-300",children:[m.jsx("div",{className:"col-span-1",children:"#"}),m.jsx("div",{className:"col-span-2",children:"Data"}),m.jsx("div",{className:"col-span-2",children:"Tipo"}),m.jsx("div",{className:"col-span-2",children:"CPF"}),m.jsx("div",{className:"col-span-2 text-right",children:"Valor"}),m.jsx("div",{className:"col-span-2",children:"Status"}),m.jsx("div",{className:"col-span-1 text-center",children:"Situação"})]}),o?m.jsx("div",{className:"p-8 text-center text-gray-400",children:l?"Nenhum resultado encontrado com os filtros aplicados":"Nenhum dado disponível"}):m.jsx(_0,{height:y,itemCount:s.length,itemSize:v,itemData:u,className:"custom-scrollbar",children:LS}),!o&&m.jsx("div",{className:"p-3 border-t border-gray-700 bg-gray-750",children:m.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[m.jsxs("div",{children:["Média: ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.averageValue)]}),m.jsx("div",{children:Object.entries(i.itemsByType).slice(0,3).map(([p,_])=>m.jsxs("span",{className:"mr-4",children:[p,": ",_]},p))})]})})]})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var C8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N8=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),qi=(e,t)=>{const r=j.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},u)=>j.createElement("svg",{ref:u,...C8,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${N8(e)}`,o].join(" "),...c},[...t.map(([d,h])=>j.createElement(d,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A8=qi("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O8=qi("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=qi("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=qi("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=qi("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=qi("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=qi("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=qi("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),MS=Jt.memo(({index:e,style:t,data:r})=>{const n=r.items[e],a=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),s=l=>new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(l),i=l=>{const u={"PIX RECEBIDO":"bg-green-900 text-green-200","PIX ENVIADO":"bg-red-900 text-red-200",TED:"bg-blue-900 text-blue-200",DOC:"bg-purple-900 text-purple-200",CARTÃO:"bg-indigo-900 text-indigo-200",DINHEIRO:"bg-yellow-900 text-yellow-200",BOLETO:"bg-orange-900 text-orange-200",MANUAL:"bg-pink-900 text-pink-200"}[l]||"bg-gray-700 text-gray-300";return m.jsx("span",{className:`px-2 py-1 text-xs rounded ${u}`,children:l})},o=j.useCallback(()=>{r.onRemoveItem(n.conferredId)},[r.onRemoveItem,n.conferredId]);return m.jsxs("div",{style:t,className:`grid grid-cols-12 gap-2 px-4 py-3 border-b border-gray-700 text-sm ${e%2===0?"bg-gray-900":"bg-gray-850"} hover:bg-gray-800 transition-colors`,children:[m.jsx("div",{className:"col-span-1 text-gray-400 font-mono flex items-center",children:e+1}),m.jsxs("div",{className:"col-span-2 text-gray-300 flex items-center",children:[m.jsx(A8,{className:"h-4 w-4 mr-1 text-gray-500"}),m.jsx("span",{className:"text-xs",children:s(n.conferredAt)})]}),m.jsx("div",{className:"col-span-2 flex items-center",children:i(n.paymentType)}),m.jsx("div",{className:"col-span-2 text-gray-300 font-mono flex items-center",children:n.cpf?`${n.cpf.slice(0,3)}.${n.cpf.slice(3,6)}.${n.cpf.slice(6,9)}-${n.cpf.slice(9)}`:"-"}),m.jsx("div",{className:"col-span-2 text-right font-semibold flex items-center justify-end",children:m.jsx("span",{className:n.value>=0?"text-green-400":"text-red-400",children:a(n.value)})}),m.jsx("div",{className:"col-span-2 text-gray-300 flex items-center",children:m.jsx("span",{className:"truncate",title:n.originalHistory,children:n.originalHistory||n.description||"-"})}),m.jsx("div",{className:"col-span-1 flex items-center justify-center",children:m.jsx("button",{onClick:o,className:"p-1 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded transition-colors",title:"Remover da conferência de caixa",children:m.jsx(j8,{className:"h-4 w-4"})})})]})});MS.displayName="CashTableRow";const F8=({conferredItems:e,onRemoveItem:t,className:r=""})=>{const[n,a]=ms("cash_table_filters",{dateFilter:"",typeFilter:"all",statusFilter:"all",searchText:""}),{filteredData:s,stats:i,isEmpty:o,hasFilters:l}=S8(e,n),c=j.useMemo(()=>({paymentTypes:[...new Set(e.map(_=>_.paymentType))].sort()}),[e]),u=j.useMemo(()=>({items:s,onRemoveItem:t}),[s,t]),d=j.useCallback((p,_)=>{a(x=>({...x,[p]:_}))},[a]),h=j.useCallback(()=>{a({dateFilter:"",typeFilter:"all",statusFilter:"all",searchText:""})},[a]),v=70,y=Math.min(600,Math.max(300,s.length*v+50));return m.jsxs("div",{className:`bg-gray-800 border border-gray-700 rounded-lg ${r}`,children:[m.jsxs("div",{className:"p-4 border-b border-gray-700",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-200",children:"Conferência de Caixa"}),m.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-400",children:[m.jsxs("span",{children:["Total: ",i.totalItems]}),m.jsxs("span",{children:["Filtrados: ",i.filteredCount]}),m.jsxs("span",{children:["Valor: ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.filteredValue)]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsx("input",{type:"text",placeholder:"Buscar por descrição, CPF, valor...",value:n.searchText,onChange:p=>d("searchText",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),m.jsxs("select",{value:n.typeFilter,onChange:p=>d("typeFilter",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[m.jsx("option",{value:"all",children:"Todos os tipos"}),c.paymentTypes.map(p=>m.jsx("option",{value:p,children:p},p))]}),l&&m.jsx("button",{onClick:h,className:"px-3 py-2 text-sm text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar Filtros"})]})]}),m.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 bg-gray-750 border-b border-gray-700 text-sm font-semibold text-gray-300",children:[m.jsx("div",{className:"col-span-1",children:"#"}),m.jsx("div",{className:"col-span-2",children:"Conferido em"}),m.jsx("div",{className:"col-span-2",children:"Tipo"}),m.jsx("div",{className:"col-span-2",children:"CPF"}),m.jsx("div",{className:"col-span-2 text-right",children:"Valor"}),m.jsx("div",{className:"col-span-2",children:"Descrição"}),m.jsx("div",{className:"col-span-1 text-center",children:"Ações"})]}),o?m.jsx("div",{className:"p-8 text-center text-gray-400",children:l?"Nenhum resultado encontrado com os filtros aplicados":"Nenhum item conferido ainda"}):m.jsx(_0,{height:y,itemCount:s.length,itemSize:v,itemData:u,className:"custom-scrollbar",children:MS}),!o&&m.jsx("div",{className:"p-3 border-t border-gray-700 bg-gray-750",children:m.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[m.jsxs("div",{children:["Média: ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.averageValue)]}),m.jsx("div",{className:"flex space-x-4",children:Object.entries(i.itemsByType).slice(0,3).map(([p,_])=>m.jsxs("span",{children:[p,": ",_]},p))})]})})]})};function vh(e){if(typeof e=="number")return Math.round(e*100)/100;if(!e||typeof e!="string")return 0;let t=e.trim().replace(/[R$\s]/g,"").replace(/[^\d,.-]/g,"");const r=t.lastIndexOf(","),n=t.lastIndexOf(".");r>n?t=t.replace(/\./g,"").replace(",","."):n>r&&(t=t.replace(/,/g,""));const a=parseFloat(t);return isNaN(a)?0:Math.round(a*100)/100}const yh=new WeakMap;function Mw(e){const t=new Map;return e.forEach((r,n)=>{let a=yh.get(r);a===void 0&&(a=vh(r.value),yh.set(r,a)),a!==0&&(t.has(a)||t.set(a,[]),t.get(a).push({id:`row-${n}-${r.date}-${r.value}`,date:r.date,paymentType:r.paymentType,cpf:r.cpf,value:r.value,originalHistory:r.originalHistory,rowIndex:n}))}),t}function L8(e,t,r){const n=vh(e);if(n===0)return{hasMatches:!1,matches:[],normalizedInput:0};if(r){const s=r.get(n)||[];return{hasMatches:s.length>0,matches:s,normalizedInput:n}}const a=[];return t.forEach((s,i)=>{let o=yh.get(s);o===void 0&&(o=vh(s.value),yh.set(s,o)),o===n&&a.push({id:`row-${i}-${s.date}-${s.value}`,date:s.date,paymentType:s.paymentType,cpf:s.cpf,value:s.value,originalHistory:s.originalHistory,rowIndex:i})}),{hasMatches:a.length>0,matches:a,normalizedInput:n}}function M8(e){if(!e||e.trim()==="")return{isValid:!1,error:"Digite um valor para conferir"};const t=vh(e);return t===0?{isValid:!1,error:"Informe um valor válido (ex.: 123,45)"}:t<0?{isValid:!1,error:"O valor deve ser positivo"}:{isValid:!0}}function Bw(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const tv=(e,t=!0)=>{const r=j.useCallback(n=>{if(!t)return;const a=n.target,s=a.tagName==="INPUT"||a.tagName==="TEXTAREA"||a.contentEditable==="true";for(const i of e){const o=n.key.toLowerCase()===i.key.toLowerCase(),l=!!i.ctrlKey===n.ctrlKey,c=!!i.altKey===n.altKey,u=!!i.shiftKey===n.shiftKey;if(o&&l&&c&&u){if(i.key.toLowerCase()==="enter"&&s)continue;if(i.key.toLowerCase()==="escape"){i.preventDefault!==!1&&n.preventDefault(),i.stopPropagation!==!1&&n.stopPropagation(),i.action();return}if(i.ctrlKey||i.altKey||i.shiftKey){i.preventDefault!==!1&&n.preventDefault(),i.stopPropagation!==!1&&n.stopPropagation(),i.action();return}if(!s){i.preventDefault!==!1&&n.preventDefault(),i.stopPropagation!==!1&&n.stopPropagation(),i.action();return}}}},[e,t]);j.useEffect(()=>{if(t)return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}},[r,t])},B8=()=>{const e=j.useRef({}),t=j.useCallback((a,s)=>{e.current[a]=s},[]),r=j.useCallback(a=>{var i;const s=e.current[a];s&&(s.focus(),(i=s.select)==null||i.call(s))},[]),n=j.useCallback(a=>e.current[a],[]);return{registerFocusTarget:t,focusTarget:r,getFocusTarget:n}},BS=()=>{const e=j.useRef(null),t=j.useCallback(()=>{e.current=document.activeElement},[]),r=j.useCallback(()=>{e.current&&typeof e.current.focus=="function"&&setTimeout(()=>{e.current&&e.current.focus()},0)},[]);return{saveFocus:t,restoreFocus:r}},$8=(e,t)=>{const r=[{key:"l",ctrlKey:!0,action:()=>{e.valueInput?(e.valueInput.focus(),e.valueInput.select()):e.conferenceValue&&(e.conferenceValue.focus(),e.conferenceValue.select())},description:"Focar no campo de valor (Ctrl+L)"},{key:"f",ctrlKey:!0,action:()=>{t.openDateFilter?t.openDateFilter():e.dateFilter&&e.dateFilter.focus()},description:"Abrir filtro de data (Ctrl+F)"},{key:"Escape",action:()=>{t.closeModals&&t.closeModals()},description:"Fechar modais (Esc)"},{key:"Enter",action:()=>{t.confirmAction&&t.confirmAction()},description:"Confirmar ação (Enter)"}];return tv(r,!0),r},U8=({isOpen:e,matches:t,searchValue:r,onSelect:n,onClose:a})=>{if(tv([{key:"Escape",action:a,description:"Fechar modal (Esc)"},{key:"Enter",action:()=>{t.length>0&&n(t[0])},description:"Selecionar primeiro item (Enter)"}],e),!e)return null;const i=c=>c?c.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):"-",o=c=>{c.target===c.currentTarget&&a()},l=c=>{c.key==="Escape"&&a()};return m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:o,onKeyDown:l,children:m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 w-full max-w-4xl mx-4 max-h-[80vh] overflow-hidden",children:[m.jsx("div",{className:"bg-gray-900 px-6 py-4 border-b border-gray-700",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Múltiplas Correspondências Encontradas"}),m.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Valor pesquisado: ",m.jsx("span",{className:"text-indigo-400 font-mono",children:Bw(r)}),"- Encontrados ",t.length," registros"]})]}),m.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-100 hover:bg-gray-700 rounded-md transition-colors","aria-label":"Fechar modal",children:m.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),m.jsxs("div",{className:"p-6",children:[m.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Selecione qual registro deseja transferir para a Conferência de Caixa:"}),m.jsx("div",{className:"overflow-auto max-h-96",children:m.jsx("div",{className:"space-y-2",children:t.map((c,u)=>m.jsxs("button",{onClick:()=>n(c),className:"w-full p-4 bg-gray-700 hover:bg-gray-600 border border-gray-600 hover:border-indigo-500 rounded-lg transition-colors text-left focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-800",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Data"}),m.jsx("p",{className:"text-sm text-gray-100 font-medium",children:c.date})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Tipo de Pagamento"}),m.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${c.paymentType==="PIX RECEBIDO"?"bg-green-900/50 text-green-300 border border-green-700":c.paymentType==="PIX ENVIADO"?"bg-red-900/50 text-red-300 border border-red-700":c.paymentType==="TED"?"bg-blue-900/50 text-blue-300 border border-blue-700":c.paymentType==="CARTÃO"?"bg-purple-900/50 text-purple-300 border border-purple-700":"bg-gray-600 text-gray-300 border border-gray-500"}`,children:c.paymentType})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"CPF"}),m.jsx("p",{className:"text-sm text-gray-100 font-mono",children:i(c.cpf)})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Valor"}),m.jsx("p",{className:`text-sm font-mono font-semibold ${c.value>=0?"text-green-400":"text-red-400"}`,children:Bw(c.value)})]})]}),c.originalHistory&&m.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-600",children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Histórico Original"}),m.jsx("p",{className:"text-xs text-gray-300 truncate",title:c.originalHistory,children:c.originalHistory})]}),m.jsx("div",{className:"mt-3 flex items-center justify-end",children:m.jsxs("div",{className:"flex items-center text-indigo-400",children:[m.jsx("span",{className:"text-xs",children:"Clique para selecionar"}),m.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]},c.id))})})]}),m.jsx("div",{className:"bg-gray-900 px-6 py-4 border-t border-gray-700 flex justify-end space-x-3",children:m.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-indigo-500 transition-colors",children:"Cancelar"})})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var _h={};_h.version="0.18.5";var $S=1252,z8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},nv=function(e){z8.indexOf(e)!=-1&&($S=rv[0]=e)};function V8(){nv(1252)}var Xa=function(e){nv(e)};function av(){Xa(1200),V8()}function $w(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function W8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function US(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var $c=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?W8(e.slice(2)):t==254&&r==255?US(e.slice(2)):t==65279?e.slice(1):e},ad=function(t){return String.fromCharCode(t)},Uw=function(t){return String.fromCharCode(t)},wi,bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pu(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=bi.charAt(s)+bi.charAt(i)+bi.charAt(o)+bi.charAt(l);return t}function ga(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=bi.indexOf(e.charAt(c++)),i=bi.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=bi.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=bi.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Pt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ji(e){return Pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function zw(e){return Pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ua=function(t){return Pt?Qs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function w0(e){if(typeof ArrayBuffer>"u")return ua(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Gi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function H8(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function sv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return sv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var sn=Pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Qs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function K8(e){for(var t=[],r=0,n=e.length+250,a=ji(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ji(65535),n=65530)}return t.push(a.slice(0,r)),sn(t)}var Hn=/\u0000/g,Uc=/[\u0001-\u0006]/g;function Pl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Za(e,t){var r=""+e;return r.length>=t?r:Ar("0",t-r.length)+r}function iv(e,t){var r=""+e;return r.length>=t?r:Ar(" ",t-r.length)+r}function wh(e,t){var r=""+e;return r.length>=t?r:r+Ar(" ",t-r.length)}function q8(e,t){var r=""+Math.round(e);return r.length>=t?r:Ar("0",t-r.length)+r}function G8(e,t){var r=""+e;return r.length>=t?r:Ar("0",t-r.length)+r}var Vw=Math.pow(2,32);function al(e,t){if(e>Vw||e<-Vw)return q8(e,t);var r=Math.round(e);return G8(r,t)}function xh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ww=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Up=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function X8(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var _t={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Hw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Z8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function kh(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,u=0,d=Math.floor(a);c<t&&(d=Math.floor(a),o=d*i+s,u=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function ho(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=rj(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var zS=new Date(1899,11,31,0,0,0),Y8=zS.getTime(),J8=new Date(1900,2,1,0,0,0);function VS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=J8&&(r+=24*60*60*1e3),(r-(Y8+(e.getTimezoneOffset()-zS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ov(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Q8(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ej(e){var t=e<0?12:11,r=ov(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function tj(e){var t=ov(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ru(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=ej(e):t===10?r=e.toFixed(10).substr(0,12):r=tj(e),ov(Q8(r.toUpperCase()))}function Co(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ru(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ja(14,VS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function rj(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function nj(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Up[r.m-1][1];case 5:return Up[r.m-1][0];default:return Up[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Ww[r.q][0];default:return Ww[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Za(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Za(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Za(l,c):"";return u}function Si(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var WS=/%/g;function aj(e,t,r){var n=t.replace(WS,""),a=t.length-n.length;return Us(e,n,r*Math.pow(10,2*a))+Ar("%",a)}function sj(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Us(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function HS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+HS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var KS=/# (\?+)( ?)\/( ?)(\d+)/;function ij(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Ar(" ",e[1].length+1+e[4].length):iv(i,e[1].length)+e[2]+"/"+e[3]+Za(o,e[4].length))}function oj(e,t,r){return r+(t===0?"":""+t)+Ar(" ",e[1].length+2+e[4].length)}var qS=/^#*0*\.([0#]+)/,GS=/\).*[0#]/,XS=/\(###\) ###\\?-####/;function zn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Kw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function qw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function lj(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function cj(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ba(e,t,r){if(e.charCodeAt(0)===40&&!t.match(GS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ba("n",n,r):"("+ba("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sj(e,t,r);if(t.indexOf("%")!==-1)return aj(e,t,r);if(t.indexOf("E")!==-1)return HS(t,r);if(t.charCodeAt(0)===36)return"$"+ba(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+al(l,t.length);if(t.match(/^[#?]+$/))return a=al(r,0),a==="0"&&(a=""),a.length>t.length?a:zn(t.substr(0,t.length-a.length))+a;if(s=t.match(KS))return ij(s,l,c);if(t.match(/^#+0+$/))return c+al(l,t.length-t.indexOf("0"));if(s=t.match(qS))return a=Kw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+zn(s[1])).replace(/\.$/,"."+zn(s[1])).replace(/\.(\d*)$/,function(y,p){return"."+p+Ar("0",zn(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Kw(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Si(al(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ba(e,t,-r):Si(""+(Math.floor(r)+lj(r,s[1].length)))+"."+Za(qw(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ba(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Pl(ba(e,t.replace(/[\\-]/g,""),r)),i=0,Pl(Pl(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return i<a.length?a.charAt(i++):y==="0"?"0":""}));if(t.match(XS))return a=ba(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=kh(l,Math.pow(10,i)-1,!1),a=""+c,u=Us("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=wh(o[2],i),u.length<s[4].length&&(u=zn(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=kh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?iv(o[1],i)+s[2]+"/"+s[3]+wh(o[2],i):Ar(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=al(r,0),t.length<=a.length?a:zn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return zn(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=qw(r,s[1].length),r<0?"-"+ba(e,t,-r):Si(cj(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Za(0,3-y.length):"")+y})+"."+Za(i,s[1].length);switch(t){case"###,##0.00":return ba(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Si(al(l,0));return v!=="0"?c+v:"";case"###,###.00":return ba(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ba(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function uj(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Us(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function fj(e,t,r){var n=t.replace(WS,""),a=t.length-n.length;return Us(e,n,r*Math.pow(10,2*a))+Ar("%",a)}function ZS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ZS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function cs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(GS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cs("n",n,r):"("+cs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return uj(e,t,r);if(t.indexOf("%")!==-1)return fj(e,t,r);if(t.indexOf("E")!==-1)return ZS(t,r);if(t.charCodeAt(0)===36)return"$"+cs(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Za(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:zn(t.substr(0,t.length-a.length))+a;if(s=t.match(KS))return oj(s,l,c);if(t.match(/^#+0+$/))return c+Za(l,t.length-t.indexOf("0"));if(s=t.match(qS))return a=(""+r).replace(/^([^\.]+)$/,"$1."+zn(s[1])).replace(/\.$/,"."+zn(s[1])),a=a.replace(/\.(\d*)$/,function(y,p){return"."+p+Ar("0",zn(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Si(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cs(e,t,-r):Si(""+r)+"."+Ar("0",s[1].length);if(s=t.match(/^#,#*,#0/))return cs(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Pl(cs(e,t.replace(/[\\-]/g,""),r)),i=0,Pl(Pl(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return i<a.length?a.charAt(i++):y==="0"?"0":""}));if(t.match(XS))return a=cs(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=kh(l,Math.pow(10,i)-1,!1),a=""+c,u=Us("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=wh(o[2],i),u.length<s[4].length&&(u=zn(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=kh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?iv(o[1],i)+s[2]+"/"+s[3]+wh(o[2],i):Ar(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:zn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return zn(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+cs(e,t,-r):Si(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Za(0,3-y.length):"")+y})+"."+Za(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Si(""+l);return v!=="0"?c+v:"";default:if(t.match(/\.[0#?]*$/))return cs(e,t.slice(0,t.lastIndexOf(".")),r)+zn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Us(e,t,r){return(r|0)===r?cs(e,t,r):ba(e,t,r)}function dj(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var YS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ac(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":xh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(YS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function hj(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,u,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!xh(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var v=e.charAt(++i),y=v==="("||v===")"?v:"t";a[a.length]={t:y,v},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=ho(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ho(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(c==null&&(c=ho(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(c!=null&&(p.v=c.H>=12?"下午":"上午"),p.t="T",i+=5,h="h"):(p.t="t",++i),c==null&&p.t==="T")return"";a[a.length]=p,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(YS)){if(c==null&&(c=ho(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ac(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var _=0,x=0,k;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",_<1&&(_=1);break;case"s":(k=a[i].v.match(/\.0+$/))&&(x=Math.max(x,k[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[i].v.match(/[Hh]/)&&(_=1),_<2&&a[i].v.match(/[Mm]/)&&(_=2),_<3&&a[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",E;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=nj(a[i].t.charCodeAt(0),a[i].v,c,x),a[i].t="t";break;case"n":case"?":for(E=i+1;a[E]!=null&&((o=a[E].t)==="?"||o==="D"||(o===" "||o==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[i].v+=a[E].v,a[E]={v:"",t:";"},++E;w+=a[i].v,i=E-1;break;case"G":a[i].t="t",a[i].v=Co(t,r);break}var I="",D,C;if(w.length>0){w.charCodeAt(0)==40?(D=t<0&&w.charCodeAt(0)===45?-t:t,C=Us("n",w,D)):(D=t<0&&n>1?-t:t,C=Us("n",w,D),D<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),E=C.length-1;var V=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){V=i;break}var z=a.length;if(V===a.length&&C.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(E>=a[i].v.length-1?(E-=a[i].v.length,a[i].v=C.substr(E+1,a[i].v.length)):E<0?a[i].v="":(a[i].v=C.substr(0,E+1),E=-1),a[i].t="t",z=i);E>=0&&z<a.length&&(a[z].v=C.substr(0,E+1)+a[z].v)}else if(V!==a.length&&C.indexOf("E")===-1){for(E=C.indexOf(".")-1,i=V;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(u=a[i].v.indexOf(".")>-1&&i===V?a[i].v.indexOf(".")-1:a[i].v.length-1,I=a[i].v.substr(u+1);u>=0;--u)E>=0&&(a[i].v.charAt(u)==="0"||a[i].v.charAt(u)==="#")&&(I=C.charAt(E--)+I);a[i].v=I,a[i].t="t",z=i}for(E>=0&&z<a.length&&(a[z].v=C.substr(0,E+1)+a[z].v),E=C.indexOf(".")+1,i=V;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==V)){for(u=a[i].v.indexOf(".")>-1&&i===V?a[i].v.indexOf(".")+1:0,I=a[i].v.substr(0,u);u<a[i].v.length;++u)E<C.length&&(I+=C.charAt(E++));a[i].v=I,a[i].t="t",z=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(D=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=Us(a[i].t,a[i].v,D),a[i].t="t");var ee="";for(i=0;i!==a.length;++i)a[i]!=null&&(ee+=a[i].v);return ee}var Gw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Xw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function pj(e,t){var r=dj(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Gw),o=r[1].match(Gw);return Xw(t,i)?[n,r[0]]:Xw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function ja(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:_t)[e],n==null&&(n=r.table&&r.table[Hw[e]]||_t[Hw[e]]),n==null&&(n=Z8[e]||"General");break}if(xh(n,0))return Co(t,r);t instanceof Date&&(t=VS(t,r.date1904));var a=pj(n,t);if(xh(a[1]))return Co(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return hj(a[1],t,r,a[0])}function zs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(_t[r]==null){t<0&&(t=r);continue}if(_t[r]==e){t=r;break}}t<0&&(t=391)}return _t[t]=e,t}function x0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&zs(e[t],t)}function sc(){_t=X8()}var mj={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},JS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function gj(e){var t=typeof e=="number"?_t[e]:e;return t=t.replace(JS,"(\\d+)"),new RegExp("^"+t+"$")}function vj(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(JS)||[]).forEach(function(d,h){var v=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=v;break;case"d":s=v;break;case"h":i=v;break;case"s":l=v;break;case"m":i>=0?o=v:a=v;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?u:c+"T"+u}var yj=function(){var e={};e.version="1.2.0";function t(){for(var C=0,V=new Array(256),z=0;z!=256;++z)C=z,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,V[z]=C;return typeof Int32Array<"u"?new Int32Array(V):V}var r=t();function n(C){var V=0,z=0,ee=0,re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)re[ee]=C[ee];for(ee=0;ee!=256;++ee)for(z=C[ee],V=256+ee;V<4096;V+=256)z=re[V]=z>>>8^C[z&255];var G=[];for(ee=1;ee!=16;++ee)G[ee-1]=typeof Int32Array<"u"?re.subarray(ee*256,ee*256+256):re.slice(ee*256,ee*256+256);return G}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],u=a[5],d=a[6],h=a[7],v=a[8],y=a[9],p=a[10],_=a[11],x=a[12],k=a[13],w=a[14];function E(C,V){for(var z=V^-1,ee=0,re=C.length;ee<re;)z=z>>>8^r[(z^C.charCodeAt(ee++))&255];return~z}function I(C,V){for(var z=V^-1,ee=C.length-15,re=0;re<ee;)z=w[C[re++]^z&255]^k[C[re++]^z>>8&255]^x[C[re++]^z>>16&255]^_[C[re++]^z>>>24]^p[C[re++]]^y[C[re++]]^v[C[re++]]^h[C[re++]]^d[C[re++]]^u[C[re++]]^c[C[re++]]^l[C[re++]]^o[C[re++]]^i[C[re++]]^s[C[re++]]^r[C[re++]];for(ee+=15;re<ee;)z=z>>>8^r[(z^C[re++])&255];return~z}function D(C,V){for(var z=V^-1,ee=0,re=C.length,G=0,me=0;ee<re;)G=C.charCodeAt(ee++),G<128?z=z>>>8^r[(z^G)&255]:G<2048?(z=z>>>8^r[(z^(192|G>>6&31))&255],z=z>>>8^r[(z^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,me=C.charCodeAt(ee++)&1023,z=z>>>8^r[(z^(240|G>>8&7))&255],z=z>>>8^r[(z^(128|G>>2&63))&255],z=z>>>8^r[(z^(128|me>>6&15|(G&3)<<4))&255],z=z>>>8^r[(z^(128|me&63))&255]):(z=z>>>8^r[(z^(224|G>>12&15))&255],z=z>>>8^r[(z^(128|G>>6&63))&255],z=z>>>8^r[(z^(128|G&63))&255]);return~z}return e.table=r,e.bstr=E,e.buf=I,e.str=D,e}(),ht=function(){var t={};t.version="1.2.1";function r(O,M){for(var P=O.split("/"),R=M.split("/"),F=0,U=0,de=Math.min(P.length,R.length);F<de;++F){if(U=P[F].length-R[F].length)return U;if(P[F]!=R[F])return P[F]<R[F]?-1:1}return P.length-R.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var M=O.lastIndexOf("/");return M===-1?O:O.slice(0,M+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var M=O.lastIndexOf("/");return M===-1?O:O.slice(M+1)}function s(O,M){typeof M=="string"&&(M=new Date(M));var P=M.getHours();P=P<<6|M.getMinutes(),P=P<<5|M.getSeconds()>>>1,O.write_shift(2,P);var R=M.getFullYear()-1980;R=R<<4|M.getMonth()+1,R=R<<5|M.getDate(),O.write_shift(2,R)}function i(O){var M=O.read_shift(2)&65535,P=O.read_shift(2)&65535,R=new Date,F=P&31;P>>>=5;var U=P&15;P>>>=4,R.setMilliseconds(0),R.setFullYear(P+1980),R.setMonth(U-1),R.setDate(F);var de=M&31;M>>>=5;var be=M&63;return M>>>=6,R.setHours(M),R.setMinutes(be),R.setSeconds(de<<1),R}function o(O){mn(O,0);for(var M={},P=0;O.l<=O.length-4;){var R=O.read_shift(2),F=O.read_shift(2),U=O.l+F,de={};switch(R){case 21589:P=O.read_shift(1),P&1&&(de.mtime=O.read_shift(4)),F>5&&(P&2&&(de.atime=O.read_shift(4)),P&4&&(de.ctime=O.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}O.l=U,M[R]=de}return M}var l;function c(){return l||(l={})}function u(O,M){if(O[0]==80&&O[1]==75)return Qe(O,M);if((O[0]|32)==109&&(O[1]|32)==105)return ft(O,M);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var P=3,R=512,F=0,U=0,de=0,be=0,fe=0,pe=[],he=O.slice(0,512);mn(he,0);var Le=d(he);switch(P=Le[0],P){case 3:R=512;break;case 4:R=4096;break;case 0:if(Le[1]==0)return Qe(O,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}R!==512&&(he=O.slice(0,R),mn(he,28));var Ye=O.slice(0,R);h(he,P);var He=he.read_shift(4,"i");if(P===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);he.l+=4,de=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),be=he.read_shift(4,"i"),F=he.read_shift(4,"i"),fe=he.read_shift(4,"i"),U=he.read_shift(4,"i");for(var $e=-1,Je=0;Je<109&&($e=he.read_shift(4,"i"),!($e<0));++Je)pe[Je]=$e;var bt=v(O,R);_(fe,U,bt,R,pe);var Xt=k(bt,de,pe,R);Xt[de].name="!Directory",F>0&&be!==me&&(Xt[be].name="!MiniFAT"),Xt[pe[0]].name="!FAT",Xt.fat_addrs=pe,Xt.ssz=R;var tr={},Br=[],Cs=[],sa=[];w(de,Xt,bt,Br,F,tr,Cs,be),y(Cs,sa,Br),Br.shift();var ai={FileIndex:Cs,FullPaths:sa};return M&&M.raw&&(ai.raw={header:Ye,sectors:bt}),ai}function d(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(Ee,"Header Signature: "),O.l+=16;var M=O.read_shift(2,"u");return[O.read_shift(2,"u"),M]}function h(O,M){var P=9;switch(O.l+=2,P=O.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function v(O,M){for(var P=Math.ceil(O.length/M)-1,R=[],F=1;F<P;++F)R[F-1]=O.slice(F*M,(F+1)*M);return R[P-1]=O.slice(P*M),R}function y(O,M,P){for(var R=0,F=0,U=0,de=0,be=0,fe=P.length,pe=[],he=[];R<fe;++R)pe[R]=he[R]=R,M[R]=P[R];for(;be<he.length;++be)R=he[be],F=O[R].L,U=O[R].R,de=O[R].C,pe[R]===R&&(F!==-1&&pe[F]!==F&&(pe[R]=pe[F]),U!==-1&&pe[U]!==U&&(pe[R]=pe[U])),de!==-1&&(pe[de]=R),F!==-1&&R!=pe[R]&&(pe[F]=pe[R],he.lastIndexOf(F)<be&&he.push(F)),U!==-1&&R!=pe[R]&&(pe[U]=pe[R],he.lastIndexOf(U)<be&&he.push(U));for(R=1;R<fe;++R)pe[R]===R&&(U!==-1&&pe[U]!==U?pe[R]=pe[U]:F!==-1&&pe[F]!==F&&(pe[R]=pe[F]));for(R=1;R<fe;++R)if(O[R].type!==0){if(be=R,be!=pe[be])do be=pe[be],M[R]=M[be]+"/"+M[R];while(be!==0&&pe[be]!==-1&&be!=pe[be]);pe[R]=-1}for(M[0]+="/",R=1;R<fe;++R)O[R].type!==2&&(M[R]+="/")}function p(O,M,P){for(var R=O.start,F=O.size,U=[],de=R;P&&F>0&&de>=0;)U.push(M.slice(de*G,de*G+G)),F-=G,de=io(P,de*4);return U.length===0?xe(0):sn(U).slice(0,O.size)}function _(O,M,P,R,F){var U=me;if(O===me){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var de=P[O],be=(R>>>2)-1;if(!de)return;for(var fe=0;fe<be&&(U=io(de,fe*4))!==me;++fe)F.push(U);_(io(de,R-4),M-1,P,R,F)}}function x(O,M,P,R,F){var U=[],de=[];F||(F=[]);var be=R-1,fe=0,pe=0;for(fe=M;fe>=0;){F[fe]=!0,U[U.length]=fe,de.push(O[fe]);var he=P[Math.floor(fe*4/R)];if(pe=fe*4&be,R<4+pe)throw new Error("FAT boundary crossed: "+fe+" 4 "+R);if(!O[he])break;fe=io(O[he],pe)}return{nodes:U,data:ox([de])}}function k(O,M,P,R){var F=O.length,U=[],de=[],be=[],fe=[],pe=R-1,he=0,Le=0,Ye=0,He=0;for(he=0;he<F;++he)if(be=[],Ye=he+M,Ye>=F&&(Ye-=F),!de[Ye]){fe=[];var $e=[];for(Le=Ye;Le>=0;){$e[Le]=!0,de[Le]=!0,be[be.length]=Le,fe.push(O[Le]);var Je=P[Math.floor(Le*4/R)];if(He=Le*4&pe,R<4+He)throw new Error("FAT boundary crossed: "+Le+" 4 "+R);if(!O[Je]||(Le=io(O[Je],He),$e[Le]))break}U[Ye]={nodes:be,data:ox([fe])}}return U}function w(O,M,P,R,F,U,de,be){for(var fe=0,pe=R.length?2:0,he=M[O].data,Le=0,Ye=0,He;Le<he.length;Le+=128){var $e=he.slice(Le,Le+128);mn($e,64),Ye=$e.read_shift(2),He=pv($e,0,Ye-pe),R.push(He);var Je={name:He,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},bt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);bt!==0&&(Je.ct=E($e,$e.l-8));var Xt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);Xt!==0&&(Je.mt=E($e,$e.l-8)),Je.start=$e.read_shift(4,"i"),Je.size=$e.read_shift(4,"i"),Je.size<0&&Je.start<0&&(Je.size=Je.type=0,Je.start=me,Je.name=""),Je.type===5?(fe=Je.start,F>0&&fe!==me&&(M[fe].name="!StreamData")):Je.size>=4096?(Je.storage="fat",M[Je.start]===void 0&&(M[Je.start]=x(P,Je.start,M.fat_addrs,M.ssz)),M[Je.start].name=Je.name,Je.content=M[Je.start].data.slice(0,Je.size)):(Je.storage="minifat",Je.size<0?Je.size=0:fe!==me&&Je.start!==me&&M[fe]&&(Je.content=p(Je,M[fe].data,(M[be]||{}).data))),Je.content&&mn(Je.content,0),U[He]=Je,de.push(Je)}}function E(O,M){return new Date((ca(O,M+4)/1e7*Math.pow(2,32)+ca(O,M)/1e7-11644473600)*1e3)}function I(O,M){return c(),u(l.readFileSync(O),M)}function D(O,M){var P=M&&M.type;switch(P||Pt&&Buffer.isBuffer(O)&&(P="buffer"),P||"base64"){case"file":return I(O,M);case"base64":return u(ua(ga(O)),M);case"binary":return u(ua(O),M)}return u(O,M)}function C(O,M){var P=M||{},R=P.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=R+"/",O.FileIndex[0]={name:R,type:5}),P.CLSID&&(O.FileIndex[0].clsid=P.CLSID),V(O)}function V(O){var M="Sh33tJ5";if(!ht.find(O,"/"+M)){var P=xe(4);P[0]=55,P[1]=P[3]=50,P[2]=54,O.FileIndex.push({name:M,type:2,content:P,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+M),z(O)}}function z(O,M){C(O);for(var P=!1,R=!1,F=O.FullPaths.length-1;F>=0;--F){var U=O.FileIndex[F];switch(U.type){case 0:R?P=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(U.R*U.L*U.C)&&(P=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!M)){var de=new Date(1987,1,19),be=0,fe=Object.create?Object.create(null):{},pe=[];for(F=0;F<O.FullPaths.length;++F)fe[O.FullPaths[F]]=!0,O.FileIndex[F].type!==0&&pe.push([O.FullPaths[F],O.FileIndex[F]]);for(F=0;F<pe.length;++F){var he=n(pe[F][0]);R=fe[he],R||(pe.push([he,{name:a(he).replace("/",""),type:1,clsid:ke,ct:de,mt:de,content:null}]),fe[he]=!0)}for(pe.sort(function(He,$e){return r(He[0],$e[0])}),O.FullPaths=[],O.FileIndex=[],F=0;F<pe.length;++F)O.FullPaths[F]=pe[F][0],O.FileIndex[F]=pe[F][1];for(F=0;F<pe.length;++F){var Le=O.FileIndex[F],Ye=O.FullPaths[F];if(Le.name=a(Ye).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||ke,F===0)Le.C=pe.length>1?1:-1,Le.size=0,Le.type=5;else if(Ye.slice(-1)=="/"){for(be=F+1;be<pe.length&&n(O.FullPaths[be])!=Ye;++be);for(Le.C=be>=pe.length?-1:be,be=F+1;be<pe.length&&n(O.FullPaths[be])!=n(Ye);++be);Le.R=be>=pe.length?-1:be,Le.type=1}else n(O.FullPaths[F+1]||"")==n(Ye)&&(Le.R=F+1),Le.type=2}}}function ee(O,M){var P=M||{};if(P.fileType=="mad")return Ft(O,P);switch(z(O),P.fileType){case"zip":return ri(O,P)}var R=function(He){for(var $e=0,Je=0,bt=0;bt<He.FileIndex.length;++bt){var Xt=He.FileIndex[bt];if(Xt.content){var tr=Xt.content.length;tr>0&&(tr<4096?$e+=tr+63>>6:Je+=tr+511>>9)}}for(var Br=He.FullPaths.length+3>>2,Cs=$e+7>>3,sa=$e+127>>7,ai=Cs+Je+Br+sa,wa=ai+127>>7,Ho=wa<=109?0:Math.ceil((wa-109)/127);ai+wa+Ho+127>>7>wa;)Ho=++wa<=109?0:Math.ceil((wa-109)/127);var Tt=[1,Ho,wa,sa,Br,Je,$e,0];return He.FileIndex[0].size=$e<<6,Tt[7]=(He.FileIndex[0].start=Tt[0]+Tt[1]+Tt[2]+Tt[3]+Tt[4]+Tt[5])+(Tt[6]+7>>3),Tt}(O),F=xe(R[7]<<9),U=0,de=0;{for(U=0;U<8;++U)F.write_shift(1,Ae[U]);for(U=0;U<8;++U)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),U=0;U<3;++U)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,R[2]),F.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:me),F.write_shift(4,R[3]),F.write_shift(-4,R[1]?R[0]-1:me),F.write_shift(4,R[1]),U=0;U<109;++U)F.write_shift(-4,U<R[2]?R[1]+U:-1)}if(R[1])for(de=0;de<R[1];++de){for(;U<236+de*127;++U)F.write_shift(-4,U<R[2]?R[1]+U:-1);F.write_shift(-4,de===R[1]-1?me:de+1)}var be=function(He){for(de+=He;U<de-1;++U)F.write_shift(-4,U+1);He&&(++U,F.write_shift(-4,me))};for(de=U=0,de+=R[1];U<de;++U)F.write_shift(-4,Oe.DIFSECT);for(de+=R[2];U<de;++U)F.write_shift(-4,Oe.FATSECT);be(R[3]),be(R[4]);for(var fe=0,pe=0,he=O.FileIndex[0];fe<O.FileIndex.length;++fe)he=O.FileIndex[fe],he.content&&(pe=he.content.length,!(pe<4096)&&(he.start=de,be(pe+511>>9)));for(be(R[6]+7>>3);F.l&511;)F.write_shift(-4,Oe.ENDOFCHAIN);for(de=U=0,fe=0;fe<O.FileIndex.length;++fe)he=O.FileIndex[fe],he.content&&(pe=he.content.length,!(!pe||pe>=4096)&&(he.start=de,be(pe+63>>6)));for(;F.l&511;)F.write_shift(-4,Oe.ENDOFCHAIN);for(U=0;U<R[4]<<2;++U){var Le=O.FullPaths[U];if(!Le||Le.length===0){for(fe=0;fe<17;++fe)F.write_shift(4,0);for(fe=0;fe<3;++fe)F.write_shift(4,-1);for(fe=0;fe<12;++fe)F.write_shift(4,0);continue}he=O.FileIndex[U],U===0&&(he.start=he.size?he.start-1:me);var Ye=U===0&&P.root||he.name;if(pe=2*(Ye.length+1),F.write_shift(64,Ye,"utf16le"),F.write_shift(2,pe),F.write_shift(1,he.type),F.write_shift(1,he.color),F.write_shift(-4,he.L),F.write_shift(-4,he.R),F.write_shift(-4,he.C),he.clsid)F.write_shift(16,he.clsid,"hex");else for(fe=0;fe<4;++fe)F.write_shift(4,0);F.write_shift(4,he.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,he.start),F.write_shift(4,he.size),F.write_shift(4,0)}for(U=1;U<O.FileIndex.length;++U)if(he=O.FileIndex[U],he.size>=4096)if(F.l=he.start+1<<9,Pt&&Buffer.isBuffer(he.content))he.content.copy(F,F.l,0,he.size),F.l+=he.size+511&-512;else{for(fe=0;fe<he.size;++fe)F.write_shift(1,he.content[fe]);for(;fe&511;++fe)F.write_shift(1,0)}for(U=1;U<O.FileIndex.length;++U)if(he=O.FileIndex[U],he.size>0&&he.size<4096)if(Pt&&Buffer.isBuffer(he.content))he.content.copy(F,F.l,0,he.size),F.l+=he.size+63&-64;else{for(fe=0;fe<he.size;++fe)F.write_shift(1,he.content[fe]);for(;fe&63;++fe)F.write_shift(1,0)}if(Pt)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function re(O,M){var P=O.FullPaths.map(function(fe){return fe.toUpperCase()}),R=P.map(function(fe){var pe=fe.split("/");return pe[pe.length-(fe.slice(-1)=="/"?2:1)]}),F=!1;M.charCodeAt(0)===47?(F=!0,M=P[0].slice(0,-1)+M):F=M.indexOf("/")!==-1;var U=M.toUpperCase(),de=F===!0?P.indexOf(U):R.indexOf(U);if(de!==-1)return O.FileIndex[de];var be=!U.match(Uc);for(U=U.replace(Hn,""),be&&(U=U.replace(Uc,"!")),de=0;de<P.length;++de)if((be?P[de].replace(Uc,"!"):P[de]).replace(Hn,"")==U||(be?R[de].replace(Uc,"!"):R[de]).replace(Hn,"")==U)return O.FileIndex[de];return null}var G=64,me=-2,Ee="d0cf11e0a1b11ae1",Ae=[208,207,17,224,161,177,26,225],ke="00000000000000000000000000000000",Oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ke,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ce(O,M,P){c();var R=ee(O,P);l.writeFileSync(M,R)}function Z(O){for(var M=new Array(O.length),P=0;P<O.length;++P)M[P]=String.fromCharCode(O[P]);return M.join("")}function Se(O,M){var P=ee(O,M);switch(M&&M.type||"buffer"){case"file":return c(),l.writeFileSync(M.filename,P),P;case"binary":return typeof P=="string"?P:Z(P);case"base64":return Pu(typeof P=="string"?P:Z(P));case"buffer":if(Pt)return Buffer.isBuffer(P)?P:Qs(P);case"array":return typeof P=="string"?ua(P):P}return P}var Ve;function B(O){try{var M=O.InflateRaw,P=new M;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)Ve=O;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function J(O,M){if(!Ve)return Ln(O,M);var P=Ve.InflateRaw,R=new P,F=R._processChunk(O.slice(O.l),R._finishFlushFlag);return O.l+=R.bytesRead,F}function K(O){return Ve?Ve.deflateRawSync(O):wt(O)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ge=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function je(O){var M=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(M>>16|M>>8|M)&255}for(var ce=typeof Uint8Array<"u",Te=ce?new Uint8Array(256):[],dt=0;dt<256;++dt)Te[dt]=je(dt);function N(O,M){var P=Te[O&255];return M<=8?P>>>8-M:(P=P<<8|Te[O>>8&255],M<=16?P>>>16-M:(P=P<<8|Te[O>>16&255],P>>>24-M))}function Ue(O,M){var P=M&7,R=M>>>3;return(O[R]|(P<=6?0:O[R+1]<<8))>>>P&3}function it(O,M){var P=M&7,R=M>>>3;return(O[R]|(P<=5?0:O[R+1]<<8))>>>P&7}function ct(O,M){var P=M&7,R=M>>>3;return(O[R]|(P<=4?0:O[R+1]<<8))>>>P&15}function mt(O,M){var P=M&7,R=M>>>3;return(O[R]|(P<=3?0:O[R+1]<<8))>>>P&31}function Fe(O,M){var P=M&7,R=M>>>3;return(O[R]|(P<=1?0:O[R+1]<<8))>>>P&127}function $t(O,M,P){var R=M&7,F=M>>>3,U=(1<<P)-1,de=O[F]>>>R;return P<8-R||(de|=O[F+1]<<8-R,P<16-R)||(de|=O[F+2]<<16-R,P<24-R)||(de|=O[F+3]<<24-R),de&U}function yr(O,M,P){var R=M&7,F=M>>>3;return R<=5?O[F]|=(P&7)<<R:(O[F]|=P<<R&255,O[F+1]=(P&7)>>8-R),M+3}function H(O,M,P){var R=M&7,F=M>>>3;return P=(P&1)<<R,O[F]|=P,M+1}function ae(O,M,P){var R=M&7,F=M>>>3;return P<<=R,O[F]|=P&255,P>>>=8,O[F+1]=P,M+8}function ye(O,M,P){var R=M&7,F=M>>>3;return P<<=R,O[F]|=P&255,P>>>=8,O[F+1]=P&255,O[F+2]=P>>>8,M+16}function Ke(O,M){var P=O.length,R=2*P>M?2*P:M+5,F=0;if(P>=M)return O;if(Pt){var U=zw(R);if(O.copy)O.copy(U);else for(;F<O.length;++F)U[F]=O[F];return U}else if(ce){var de=new Uint8Array(R);if(de.set)de.set(O);else for(;F<P;++F)de[F]=O[F];return de}return O.length=R,O}function Be(O){for(var M=new Array(O),P=0;P<O;++P)M[P]=0;return M}function Re(O,M,P){var R=1,F=0,U=0,de=0,be=0,fe=O.length,pe=ce?new Uint16Array(32):Be(32);for(U=0;U<32;++U)pe[U]=0;for(U=fe;U<P;++U)O[U]=0;fe=O.length;var he=ce?new Uint16Array(fe):Be(fe);for(U=0;U<fe;++U)pe[F=O[U]]++,R<F&&(R=F),he[U]=0;for(pe[0]=0,U=1;U<=R;++U)pe[U+16]=be=be+pe[U-1]<<1;for(U=0;U<fe;++U)be=O[U],be!=0&&(he[U]=pe[be+16]++);var Le=0;for(U=0;U<fe;++U)if(Le=O[U],Le!=0)for(be=N(he[U],R)>>R-Le,de=(1<<R+4-Le)-1;de>=0;--de)M[be|de<<Le]=Le&15|U<<4;return R}var nt=ce?new Uint16Array(512):Be(512),St=ce?new Uint16Array(32):Be(32);if(!ce){for(var gt=0;gt<512;++gt)nt[gt]=0;for(gt=0;gt<32;++gt)St[gt]=0}(function(){for(var O=[],M=0;M<32;M++)O.push(5);Re(O,St,32);var P=[];for(M=0;M<=143;M++)P.push(8);for(;M<=255;M++)P.push(9);for(;M<=279;M++)P.push(7);for(;M<=287;M++)P.push(8);Re(P,nt,288)})();var qt=function(){for(var M=ce?new Uint8Array(32768):[],P=0,R=0;P<Pe.length-1;++P)for(;R<Pe[P+1];++R)M[R]=P;for(;R<32768;++R)M[R]=29;var F=ce?new Uint8Array(259):[];for(P=0,R=0;P<ge.length-1;++P)for(;R<ge[P+1];++R)F[R]=P;function U(be,fe){for(var pe=0;pe<be.length;){var he=Math.min(65535,be.length-pe),Le=pe+he==be.length;for(fe.write_shift(1,+Le),fe.write_shift(2,he),fe.write_shift(2,~he&65535);he-- >0;)fe[fe.l++]=be[pe++]}return fe.l}function de(be,fe){for(var pe=0,he=0,Le=ce?new Uint16Array(32768):[];he<be.length;){var Ye=Math.min(65535,be.length-he);if(Ye<10){for(pe=yr(fe,pe,+(he+Ye==be.length)),pe&7&&(pe+=8-(pe&7)),fe.l=pe/8|0,fe.write_shift(2,Ye),fe.write_shift(2,~Ye&65535);Ye-- >0;)fe[fe.l++]=be[he++];pe=fe.l*8;continue}pe=yr(fe,pe,+(he+Ye==be.length)+2);for(var He=0;Ye-- >0;){var $e=be[he];He=(He<<5^$e)&32767;var Je=-1,bt=0;if((Je=Le[He])&&(Je|=he&-32768,Je>he&&(Je-=32768),Je<he))for(;be[Je+bt]==be[he+bt]&&bt<250;)++bt;if(bt>2){$e=F[bt],$e<=22?pe=ae(fe,pe,Te[$e+1]>>1)-1:(ae(fe,pe,3),pe+=5,ae(fe,pe,Te[$e-23]>>5),pe+=3);var Xt=$e<8?0:$e-4>>2;Xt>0&&(ye(fe,pe,bt-ge[$e]),pe+=Xt),$e=M[he-Je],pe=ae(fe,pe,Te[$e]>>3),pe-=3;var tr=$e<4?0:$e-2>>1;tr>0&&(ye(fe,pe,he-Je-Pe[$e]),pe+=tr);for(var Br=0;Br<bt;++Br)Le[He]=he&32767,He=(He<<5^be[he])&32767,++he;Ye-=bt-1}else $e<=143?$e=$e+48:pe=H(fe,pe,1),pe=ae(fe,pe,Te[$e]),Le[He]=he&32767,++he}pe=ae(fe,pe,0)-1}return fe.l=(pe+7)/8|0,fe.l}return function(fe,pe){return fe.length<8?U(fe,pe):de(fe,pe)}}();function wt(O){var M=xe(50+Math.floor(O.length*1.1)),P=qt(O,M);return M.slice(0,P)}var jt=ce?new Uint16Array(32768):Be(32768),lr=ce?new Uint16Array(32768):Be(32768),Gt=ce?new Uint16Array(128):Be(128),cn=1,Fn=1;function lt(O,M){var P=mt(O,M)+257;M+=5;var R=mt(O,M)+1;M+=5;var F=ct(O,M)+4;M+=4;for(var U=0,de=ce?new Uint8Array(19):Be(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,pe=ce?new Uint8Array(8):Be(8),he=ce?new Uint8Array(8):Be(8),Le=de.length,Ye=0;Ye<F;++Ye)de[X[Ye]]=U=it(O,M),fe<U&&(fe=U),pe[U]++,M+=3;var He=0;for(pe[0]=0,Ye=1;Ye<=fe;++Ye)he[Ye]=He=He+pe[Ye-1]<<1;for(Ye=0;Ye<Le;++Ye)(He=de[Ye])!=0&&(be[Ye]=he[He]++);var $e=0;for(Ye=0;Ye<Le;++Ye)if($e=de[Ye],$e!=0){He=Te[be[Ye]]>>8-$e;for(var Je=(1<<7-$e)-1;Je>=0;--Je)Gt[He|Je<<$e]=$e&7|Ye<<3}var bt=[];for(fe=1;bt.length<P+R;)switch(He=Gt[Fe(O,M)],M+=He&7,He>>>=3){case 16:for(U=3+Ue(O,M),M+=2,He=bt[bt.length-1];U-- >0;)bt.push(He);break;case 17:for(U=3+it(O,M),M+=3;U-- >0;)bt.push(0);break;case 18:for(U=11+Fe(O,M),M+=7;U-- >0;)bt.push(0);break;default:bt.push(He),fe<He&&(fe=He);break}var Xt=bt.slice(0,P),tr=bt.slice(P);for(Ye=P;Ye<286;++Ye)Xt[Ye]=0;for(Ye=R;Ye<30;++Ye)tr[Ye]=0;return cn=Re(Xt,jt,286),Fn=Re(tr,lr,30),M}function _a(O,M){if(O[0]==3&&!(O[1]&3))return[ji(M),2];for(var P=0,R=0,F=zw(M||1<<18),U=0,de=F.length>>>0,be=0,fe=0;!(R&1);){if(R=it(O,P),P+=3,R>>>1)R>>1==1?(be=9,fe=5):(P=lt(O,P),be=cn,fe=Fn);else{P&7&&(P+=8-(P&7));var pe=O[P>>>3]|O[(P>>>3)+1]<<8;if(P+=32,pe>0)for(!M&&de<U+pe&&(F=Ke(F,U+pe),de=F.length);pe-- >0;)F[U++]=O[P>>>3],P+=8;continue}for(;;){!M&&de<U+32767&&(F=Ke(F,U+32767),de=F.length);var he=$t(O,P,be),Le=R>>>1==1?nt[he]:jt[he];if(P+=Le&15,Le>>>=4,!(Le>>>8&255))F[U++]=Le;else{if(Le==256)break;Le-=257;var Ye=Le<8?0:Le-4>>2;Ye>5&&(Ye=0);var He=U+ge[Le];Ye>0&&(He+=$t(O,P,Ye),P+=Ye),he=$t(O,P,fe),Le=R>>>1==1?St[he]:lr[he],P+=Le&15,Le>>>=4;var $e=Le<4?0:Le-2>>1,Je=Pe[Le];for($e>0&&(Je+=$t(O,P,$e),P+=$e),!M&&de<He&&(F=Ke(F,He+100),de=F.length);U<He;)F[U]=F[U-Je],++U}}}return M?[F,P+7>>>3]:[F.slice(0,U),P+7>>>3]}function Ln(O,M){var P=O.slice(O.l||0),R=_a(P,M);return O.l+=R[1],R[0]}function Ts(O,M){if(O)typeof console<"u"&&console.error(M);else throw new Error(M)}function Qe(O,M){var P=O;mn(P,0);var R=[],F=[],U={FileIndex:R,FullPaths:F};C(U,{root:M.root});for(var de=P.length-4;(P[de]!=80||P[de+1]!=75||P[de+2]!=5||P[de+3]!=6)&&de>=0;)--de;P.l=de+4,P.l+=4;var be=P.read_shift(2);P.l+=6;var fe=P.read_shift(4);for(P.l=fe,de=0;de<be;++de){P.l+=20;var pe=P.read_shift(4),he=P.read_shift(4),Le=P.read_shift(2),Ye=P.read_shift(2),He=P.read_shift(2);P.l+=8;var $e=P.read_shift(4),Je=o(P.slice(P.l+Le,P.l+Le+Ye));P.l+=Le+Ye+He;var bt=P.l;P.l=$e+4,Ma(P,pe,he,U,Je),P.l=bt}return U}function Ma(O,M,P,R,F){O.l+=2;var U=O.read_shift(2),de=O.read_shift(2),be=i(O);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var fe=O.read_shift(4),pe=O.read_shift(4),he=O.read_shift(4),Le=O.read_shift(2),Ye=O.read_shift(2),He="",$e=0;$e<Le;++$e)He+=String.fromCharCode(O[O.l++]);if(Ye){var Je=o(O.slice(O.l,O.l+Ye));(Je[21589]||{}).mt&&(be=Je[21589].mt),((F||{})[21589]||{}).mt&&(be=F[21589].mt)}O.l+=Ye;var bt=O.slice(O.l,O.l+pe);switch(de){case 8:bt=J(O,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Xt=!1;U&8&&(fe=O.read_shift(4),fe==134695760&&(fe=O.read_shift(4),Xt=!0),pe=O.read_shift(4),he=O.read_shift(4)),pe!=M&&Ts(Xt,"Bad compressed size: "+M+" != "+pe),he!=P&&Ts(Xt,"Bad uncompressed size: "+P+" != "+he),Et(R,He,bt,{unsafe:!0,mt:be})}function ri(O,M){var P=M||{},R=[],F=[],U=xe(1),de=P.compression?8:0,be=0,fe=0,pe=0,he=0,Le=0,Ye=O.FullPaths[0],He=Ye,$e=O.FileIndex[0],Je=[],bt=0;for(fe=1;fe<O.FullPaths.length;++fe)if(He=O.FullPaths[fe].slice(Ye.length),$e=O.FileIndex[fe],!(!$e.size||!$e.content||He=="Sh33tJ5")){var Xt=he,tr=xe(He.length);for(pe=0;pe<He.length;++pe)tr.write_shift(1,He.charCodeAt(pe)&127);tr=tr.slice(0,tr.l),Je[Le]=yj.buf($e.content,0);var Br=$e.content;de==8&&(Br=K(Br)),U=xe(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,be),U.write_shift(2,de),$e.mt?s(U,$e.mt):U.write_shift(4,0),U.write_shift(-4,Je[Le]),U.write_shift(4,Br.length),U.write_shift(4,$e.content.length),U.write_shift(2,tr.length),U.write_shift(2,0),he+=U.length,R.push(U),he+=tr.length,R.push(tr),he+=Br.length,R.push(Br),U=xe(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,be),U.write_shift(2,de),U.write_shift(4,0),U.write_shift(-4,Je[Le]),U.write_shift(4,Br.length),U.write_shift(4,$e.content.length),U.write_shift(2,tr.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,Xt),bt+=U.l,F.push(U),bt+=tr.length,F.push(tr),++Le}return U=xe(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,Le),U.write_shift(2,Le),U.write_shift(4,bt),U.write_shift(4,he),U.write_shift(2,0),sn([sn(R),sn(F),U])}var as={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Vo(O,M){if(O.ctype)return O.ctype;var P=O.name||"",R=P.match(/\.([^\.]+)$/);return R&&as[R[1]]||M&&(R=(P=M).match(/[\.\\]([^\.\\])+$/),R&&as[R[1]])?as[R[1]]:"application/octet-stream"}function ni(O){for(var M=Pu(O),P=[],R=0;R<M.length;R+=76)P.push(M.slice(R,R+76));return P.join(`\r
`)+`\r
`}function Wo(O){var M=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var he=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],R=M.split(`\r
`),F=0;F<R.length;++F){var U=R[F];if(U.length==0){P.push("");continue}for(var de=0;de<U.length;){var be=76,fe=U.slice(de,de+be);fe.charAt(be-1)=="="?be--:fe.charAt(be-2)=="="?be-=2:fe.charAt(be-3)=="="&&(be-=3),fe=U.slice(de,de+be),de+=be,de<U.length&&(fe+="="),P.push(fe)}}return P.join(`\r
`)}function Ie(O){for(var M=[],P=0;P<O.length;++P){for(var R=O[P];P<=O.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+O[++P];M.push(R)}for(var F=0;F<M.length;++F)M[F]=M[F].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return ua(M.join(`\r
`))}function tt(O,M,P){for(var R="",F="",U="",de,be=0;be<10;++be){var fe=M[be];if(!fe||fe.match(/^\s*$/))break;var pe=fe.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":R=pe[2].trim();break;case"content-type":U=pe[2].trim();break;case"content-transfer-encoding":F=pe[2].trim();break}}switch(++be,F.toLowerCase()){case"base64":de=ua(ga(M.slice(be).join("")));break;case"quoted-printable":de=Ie(M.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var he=Et(O,R.slice(P.length),de,{unsafe:!0});U&&(he.ctype=U)}function ft(O,M){if(Z(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=M&&M.root||"",R=(Pt&&Buffer.isBuffer(O)?O.toString("binary"):Z(O)).split(`\r
`),F=0,U="";for(F=0;F<R.length;++F)if(U=R[F],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),P||(P=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),U.slice(0,P.length)!=P););var de=(R[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var be="--"+(de[1]||""),fe=[],pe=[],he={FileIndex:fe,FullPaths:pe};C(he);var Le,Ye=0;for(F=0;F<R.length;++F){var He=R[F];He!==be&&He!==be+"--"||(Ye++&&tt(he,R.slice(Le,F),P),Le=F)}return he}function Ft(O,M){var P=M||{},R=P.boundary||"SheetJS";R="------="+R;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],U=O.FullPaths[0],de=U,be=O.FileIndex[0],fe=1;fe<O.FullPaths.length;++fe)if(de=O.FullPaths[fe].slice(U.length),be=O.FileIndex[fe],!(!be.size||!be.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(bt){return"_x"+bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(bt){return"_u"+bt.charCodeAt(0).toString(16)+"_"});for(var pe=be.content,he=Pt&&Buffer.isBuffer(pe)?pe.toString("binary"):Z(pe),Le=0,Ye=Math.min(1024,he.length),He=0,$e=0;$e<=Ye;++$e)(He=he.charCodeAt($e))>=32&&He<128&&++Le;var Je=Le>=Ye*4/5;F.push(R),F.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+de),F.push("Content-Transfer-Encoding: "+(Je?"quoted-printable":"base64")),F.push("Content-Type: "+Vo(be,de)),F.push(""),F.push(Je?Wo(he):ni(he))}return F.push(R+`--\r
`),F.join(`\r
`)}function un(O){var M={};return C(M,O),M}function Et(O,M,P,R){var F=R&&R.unsafe;F||C(O);var U=!F&&ht.find(O,M);if(!U){var de=O.FullPaths[0];M.slice(0,de.length)==de?de=M:(de.slice(-1)!="/"&&(de+="/"),de=(de+M).replace("//","/")),U={name:a(M),type:2},O.FileIndex.push(U),O.FullPaths.push(de),F||ht.utils.cfb_gc(O)}return U.content=P,U.size=P?P.length:0,R&&(R.CLSID&&(U.clsid=R.CLSID),R.mt&&(U.mt=R.mt),R.ct&&(U.ct=R.ct)),U}function vt(O,M){C(O);var P=ht.find(O,M);if(P){for(var R=0;R<O.FileIndex.length;++R)if(O.FileIndex[R]==P)return O.FileIndex.splice(R,1),O.FullPaths.splice(R,1),!0}return!1}function fn(O,M,P){C(O);var R=ht.find(O,M);if(R){for(var F=0;F<O.FileIndex.length;++F)if(O.FileIndex[F]==R)return O.FileIndex[F].name=a(P),O.FullPaths[F]=P,!0}return!1}function _r(O){z(O,!0)}return t.find=re,t.read=D,t.parse=u,t.write=Se,t.writeFile=Ce,t.utils={cfb_new:un,cfb_add:Et,cfb_del:vt,cfb_mov:fn,cfb_gc:_r,ReadShift:au,CheckField:wE,prep_blob:mn,bconcat:sn,use_zlib:B,_deflateRaw:wt,_inflateRaw:Ln,consts:Oe},t}();function _j(e){return typeof e=="string"?w0(e):Array.isArray(e)?H8(e):e}function of(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=w0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ws(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([_j(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Gi(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function wj(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Dr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Zw(e,t){for(var r=[],n=Dr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function k0(e){for(var t=[],r=Dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function b0(e){for(var t=[],r=Dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function xj(e){for(var t=[],r=Dr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var bh=new Date(1899,11,30,0,0,0);function Qr(e,t){var r=e.getTime(),n=bh.getTime()+(e.getTimezoneOffset()-bh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var QS=new Date,kj=bh.getTime()+(QS.getTimezoneOffset()-bh.getTimezoneOffset())*6e4,Yw=QS.getTimezoneOffset();function S0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+kj),t.getTimezoneOffset()!==Yw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Yw)*6e4),t}function bj(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Jw=new Date("2017-02-19T19:06:09.000Z"),eE=isNaN(Jw.getFullYear())?new Date("2/19/17"):Jw,Sj=eE.getFullYear()==2017;function hr(e,t){var r=new Date(e);if(Sj)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(eE.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function No(e,t){if(Pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ws(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ws(US(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ws(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ws(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function pr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=pr(e[r]));return t}function Ar(e,t){for(var r="";r.length<t;)r+=e;return r}function Qa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Ej=["january","february","march","april","may","june","july","august","september","october","november","december"];function Hl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Ej.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Tj=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function tE(e){return e?e.content&&e.type?No(e.content,!0):e.data?$c(e.data):e.asNodeBuffer&&Pt?$c(e.asNodeBuffer().toString("binary")):e.asBinary?$c(e.asBinary()):e._data&&e._data.getContent?$c(No(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function rE(e){if(!e)return null;if(e.data)return $w(e.data);if(e.asNodeBuffer&&Pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?$w(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Cj(e){return e&&e.name.slice(-4)===".bin"?rE(e):tE(e)}function Ta(e,t){for(var r=e.FullPaths||Dr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function lv(e,t){var r=Ta(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function zr(e,t,r){if(!r)return Cj(lv(e,t));if(!t)return null;try{return zr(e,t)}catch{return null}}function fa(e,t,r){if(!r)return tE(lv(e,t));if(!t)return null;try{return fa(e,t)}catch{return null}}function Nj(e,t,r){return rE(lv(e,t))}function Qw(e){for(var t=e.FullPaths||Dr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Dt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Pt?n=Qs(r):n=K8(r),ht.utils.cfb_add(e,t,n)}ht.utils.cfb_add(e,t,r)}else e.file(t,r)}function cv(){return ht.utils.cfb_new()}function nE(e,t){switch(t.type){case"base64":return ht.read(e,{type:"base64"});case"binary":return ht.read(e,{type:"binary"});case"buffer":case"array":return ht.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function zc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Mr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Aj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ex=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Oj=/<[^>]*>/g,jn=Mr.match(ex)?ex:Oj,Ij=/<\w*:/,Dj=/<(\/?)\w+:/;function kt(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(Aj),o=0,l="",c=0,u="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(u=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var v=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[v]&&u.slice(o-3,o)=="ext")continue;n[v]=l,n[v.toLowerCase()]=l}}return n}function Ss(e){return e.replace(Dj,"<$1")}var aE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uv=k0(aE),Vt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return aE[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),fv=/[&<>'"]/g,Pj=/[\u0000-\u0008\u000b-\u001f]/g;function Qt(e){var t=e+"";return t.replace(fv,function(r){return uv[r]}).replace(Pj,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function tx(e){return Qt(e).replace(/ /g,"_x0020_")}var sE=/[\u0000-\u001f]/g;function dv(e){var t=e+"";return t.replace(fv,function(r){return uv[r]}).replace(/\n/g,"<br/>").replace(sE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Rj(e){var t=e+"";return t.replace(fv,function(r){return uv[r]}).replace(sE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var rx=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function jj(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function fr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function zp(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function nx(e){var t=ji(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function ax(e){return Qs(e,"binary").toString("utf8")}var sd="foo bar bazâð£",rr=Pt&&(ax(sd)==zp(sd)&&ax||nx(sd)==zp(sd)&&nx)||zp,ws=Pt?function(e){return Qs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},ju=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),iE=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Fj=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Lj=/<\/?(?:vt:)?variant>/g,Mj=/<(?:vt:)([^>]*)>([\s\S]*)</;function sx(e,t){var r=kt(e),n=e.match(Fj(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(Lj,"").match(Mj);i&&a.push({v:rr(i[2]),t:i[1]})}),a}var oE=/(^\s|\s$|\n)/;function gn(e,t){return"<"+e+(t.match(oE)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Fu(e){return Dr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ge(e,t,r){return"<"+e+(r!=null?Fu(r):"")+(t!=null?(t.match(oE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Bj(e,t){switch(typeof e){case"string":var r=Ge("vt:lpwstr",Qt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ge((e|0)==e?"vt:i4":"vt:r8",Qt(String(e)));case"boolean":return Ge("vt:bool",e?"true":"false")}if(e instanceof Date)return Ge("vt:filetime",xg(e));throw new Error("Unable to serialize "+e)}function hv(e){if(Pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return rr(Gi(sv(e)));throw new Error("Bad input format: expected Buffer or string")}var Lu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Yr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Lo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],la={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $j(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Uj(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var ix=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},ox=Pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Qs(t)})):ix(e)}:ix,lx=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ms(e,a)));return n.join("").replace(Hn,"")},pv=Pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Hn,""):lx(e,t,r)}:lx,cx=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},lE=Pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):cx(e,t,r)}:cx,ux=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(cl(e,a)));return n.join("")},lf=Pt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ux(t,r,n)}:ux,cE=function(e,t){var r=ca(e,t);return r>0?lf(e,t+4,t+4+r-1):""},uE=cE,fE=function(e,t){var r=ca(e,t);return r>0?lf(e,t+4,t+4+r-1):""},dE=fE,hE=function(e,t){var r=2*ca(e,t);return r>0?lf(e,t+4,t+4+r-1):""},pE=hE,mE=function(t,r){var n=ca(t,r);return n>0?pv(t,r+4,r+4+n):""},gE=mE,vE=function(e,t){var r=ca(e,t);return r>0?lf(e,t+4,t+4+r):""},yE=vE,_E=function(e,t){return $j(e,t)},Sh=_E,mv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Pt&&(uE=function(t,r){if(!Buffer.isBuffer(t))return cE(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},dE=function(t,r){if(!Buffer.isBuffer(t))return fE(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},pE=function(t,r){if(!Buffer.isBuffer(t))return hE(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},gE=function(t,r){if(!Buffer.isBuffer(t))return mE(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},yE=function(t,r){if(!Buffer.isBuffer(t))return vE(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Sh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_E(t,r)},mv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var cl=function(e,t){return e[t]},Ms=function(e,t){return e[t+1]*256+e[t]},zj=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ca=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},io=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Vj=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function au(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ms(this,c)),c+=2;e*=2;break;case"utf8":r=lf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=pv(this,this.l,this.l+e);break;case"wstr":return au.call(this,e,"dbcs");case"lpstr-ansi":r=uE(this,this.l),e=4+ca(this,this.l);break;case"lpstr-cp":r=dE(this,this.l),e=4+ca(this,this.l);break;case"lpwstr":r=pE(this,this.l),e=4+2*ca(this,this.l);break;case"lpp4":e=4+ca(this,this.l),r=gE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ca(this,this.l),r=yE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=cl(this,this.l+e++))!==0;)s.push(ad(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Ms(this,this.l+e))!==0;)s.push(ad(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=cl(this,c),this.l=c+1,o=au.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ad(Ms(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=cl(this,c),this.l=c+1,o=au.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ad(cl(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=cl(this,this.l),this.l++,n;case 2:return n=(t==="i"?zj:Ms)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?io:Vj)(this,this.l),this.l+=4,n):(a=ca(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Sh(this,this.l):a=Sh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=lE(this,this.l,e);break}}return this.l+=e,r}var Wj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Hj=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Kj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function qj(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)Kj(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Wj(this,t,this.l);break;case 8:if(n=8,r==="f"){Uj(this,t,this.l);break}case 16:break;case-4:n=4,Hj(this,t,this.l);break}return this.l+=n,this}function wE(e,t){var r=lE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function mn(e,t){e.l=t,e.read_shift=au,e.chk=wE,e.write_shift=qj}function Rn(e,t){e.l+=t}function xe(e){var t=ji(e);return mn(t,0),t}function ei(e,t,r){if(e){var n,a,s;mn(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Vu[o]||Vu[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function ra(){var e=[],t=Pt?256:2048,r=function(c){var u=xe(c);return mn(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),sn(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function De(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=Vu[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&mv(r)&&e.push(r)}}function su(e,t,r){var n=pr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function fx(e,t,r){var n=pr(e);return n.s=su(n.s,t.s,r),n.e=su(n.e,t.s,r),n}function iu(e,t){if(e.cRel&&e.c<0)for(e=pr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=pr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=xt(e);return!e.cRel&&e.cRel!=null&&(r=Zj(r)),!e.rRel&&e.rRel!=null&&(r=Gj(r)),r}function Vp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+xr(e.s.c)+":"+(e.e.cRel?"":"$")+xr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Lr(e.s.r)+":"+(e.e.rRel?"":"$")+Lr(e.e.r):iu(e.s,t.biff)+":"+iu(e.e,t.biff)}function gv(e){return parseInt(Xj(e),10)-1}function Lr(e){return""+(e+1)}function Gj(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Xj(e){return e.replace(/\$(\d+)$/,"$1")}function vv(e){for(var t=Yj(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function xr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Zj(e){return e.replace(/^([A-Z])/,"$$$1")}function Yj(e){return e.replace(/^\$([A-Z])/,"$1")}function Jj(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function xt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function na(e){var t=e.indexOf(":");return t==-1?{s:kr(e),e:kr(e)}:{s:kr(e.slice(0,t)),e:kr(e.slice(t+1))}}function It(e,t){return typeof t>"u"||typeof t=="number"?It(e.s,e.e):(typeof e!="string"&&(e=xt(e)),typeof t!="string"&&(t=xt(t)),e==t?e:e+":"+t)}function Wt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function dx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ja(e.z,r?Qr(t):t)}catch{}try{return e.w=ja((e.XF||{}).numFmtId||(r?14:0),r?Qr(t):t)}catch{return""+t}}function Ys(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ti[e.v]||e.v:t==null?dx(e,e.v):dx(e,t))}function Xi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function xE(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?kr(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Wt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var v={v:t[d][h]},y=i+d,p=o+h;if(c.s.r>y&&(c.s.r=y),c.s.c>p&&(c.s.c=p),c.e.r<y&&(c.e.r=y),c.e.c<p&&(c.e.c=p),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))v=t[d][h];else if(Array.isArray(v.v)&&(v.f=t[d][h][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||_t[14],n.cellDates?(v.t="d",v.w=ja(v.z,Qr(v.v))):(v.t="n",v.v=Qr(v.v),v.w=ja(v.z,v.v))):v.t="s";if(a)s[y]||(s[y]=[]),s[y][p]&&s[y][p].z&&(v.z=s[y][p].z),s[y][p]=v;else{var _=xt({c:p,r:y});s[_]&&s[_].z&&(v.z=s[_].z),s[_]=v}}}return c.s.c<1e7&&(s["!ref"]=It(c)),s}function ic(e,t){return xE(null,e,t)}function Qj(e){return e.read_shift(4,"i")}function es(e,t){return t||(t=xe(4)),t.write_shift(4,e),t}function Dn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function on(e,t){var r=!1;return t==null&&(r=!0,t=xe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function eF(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function tF(e,t){return t||(t=xe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function yv(e,t){var r=e.l,n=e.read_shift(1),a=Dn(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(eF(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function rF(e,t){var r=!1;return t==null&&(r=!0,t=xe(15+4*e.t.length)),t.write_shift(1,0),on(e.t,t),r?t.slice(0,t.l):t}var nF=yv;function aF(e,t){var r=!1;return t==null&&(r=!0,t=xe(23+4*e.t.length)),t.write_shift(1,1),on(e.t,t),t.write_shift(4,1),tF({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function La(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Mo(e,t){return t==null&&(t=xe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Bo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function $o(e,t){return t==null&&(t=xe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var sF=Dn,kE=on;function _v(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Eh(e,t){var r=!1;return t==null&&(r=!0,t=xe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var iF=Dn,kg=_v,wv=Eh;function xv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Sh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):io(t,0)>>2;return r?a/100:a}function bE(e,t){t==null&&(t=xe(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function SE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function oF(e,t){return t||(t=xe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Uo=SE,oc=oF;function An(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ao(e,t){return(t||xe(8)).write_shift(8,e,"f")}function lF(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=go[a];c&&(t.rgb=Bu(c));break;case 2:t.rgb=Bu([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Th(e,t){if(t||(t=xe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function cF(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function uF(e,t){t||(t=xe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function EE(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function fF(e){return EE(e,1)}function dF(e){return EE(e,2)}var kv=2,Xn=3,id=11,hx=12,Ch=19,od=64,hF=65,pF=71,mF=4108,gF=4126,nn=80,TE=81,vF=[nn,TE],bg={1:{n:"CodePage",t:kv},2:{n:"Category",t:nn},3:{n:"PresentationFormat",t:nn},4:{n:"ByteCount",t:Xn},5:{n:"LineCount",t:Xn},6:{n:"ParagraphCount",t:Xn},7:{n:"SlideCount",t:Xn},8:{n:"NoteCount",t:Xn},9:{n:"HiddenCount",t:Xn},10:{n:"MultimediaClipCount",t:Xn},11:{n:"ScaleCrop",t:id},12:{n:"HeadingPairs",t:mF},13:{n:"TitlesOfParts",t:gF},14:{n:"Manager",t:nn},15:{n:"Company",t:nn},16:{n:"LinksUpToDate",t:id},17:{n:"CharacterCount",t:Xn},19:{n:"SharedDoc",t:id},22:{n:"HyperlinksChanged",t:id},23:{n:"AppVersion",t:Xn,p:"version"},24:{n:"DigSig",t:hF},26:{n:"ContentType",t:nn},27:{n:"ContentStatus",t:nn},28:{n:"Language",t:nn},29:{n:"Version",t:nn},255:{},2147483648:{n:"Locale",t:Ch},2147483651:{n:"Behavior",t:Ch},1919054434:{}},Sg={1:{n:"CodePage",t:kv},2:{n:"Title",t:nn},3:{n:"Subject",t:nn},4:{n:"Author",t:nn},5:{n:"Keywords",t:nn},6:{n:"Comments",t:nn},7:{n:"Template",t:nn},8:{n:"LastAuthor",t:nn},9:{n:"RevNumber",t:nn},10:{n:"EditTime",t:od},11:{n:"LastPrinted",t:od},12:{n:"CreatedDate",t:od},13:{n:"ModifiedDate",t:od},14:{n:"PageCount",t:Xn},15:{n:"WordCount",t:Xn},16:{n:"CharCount",t:Xn},17:{n:"Thumbnail",t:pF},18:{n:"Application",t:nn},19:{n:"DocSecurity",t:Xn},255:{},2147483648:{n:"Locale",t:Ch},2147483651:{n:"Behavior",t:Ch},1919054434:{}},px={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},yF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _F(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var wF=_F([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),go=pr(wF),ti={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},CE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Eg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ld={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function bv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xF(e){var t=bv();if(!e||!e.match)return t;var r={};if((e.match(jn)||[]).forEach(function(n){var a=kt(n);switch(a[0].replace(Ij,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Eg[a.ContentType]]!==void 0&&t[Eg[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Yr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function NE(e,t){var r=xj(Eg),n=[],a;n[n.length]=Mr,n[n.length]=Ge("Types",null,{xmlns:Yr.CT,"xmlns:xsd":Yr.xsd,"xmlns:xsi":Yr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ge("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Ge("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:ld[l][t.bookType]||ld[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Ge("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:ld[l][t.bookType]||ld[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Ge("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Mu(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ou(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(jn)||[]).forEach(function(a){var s=kt(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:zc(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function Rl(e){var t=[Mr,Ge("Relationships",null,{xmlns:Yr.RELS})];return Dr(e["!id"]).forEach(function(r){t[t.length]=Ge("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Yt(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Rt.HLINK,Rt.XPATH,Rt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var kF="application/vnd.oasis.opendocument.spreadsheet";function bF(e,t){for(var r=hv(e),n,a;n=Lu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=kt(n[0],!1),a.path=="/"&&a.type!==kF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function SF(e){var t=[Mr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function mx(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function EF(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function TF(e){var t=[Mr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(mx(e[r][0],e[r][1])),t.push(EF("",e[r][0]));return t.push(mx("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function AE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_h.version+"</meta:generator></office:meta></office:document-meta>"}var Da=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CF=function(){for(var e=new Array(Da.length),t=0;t<Da.length;++t){var r=Da[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function OE(e){var t={};e=rr(e);for(var r=0;r<Da.length;++r){var n=Da[r],a=e.match(CF[r]);a!=null&&a.length>0&&(t[n[1]]=Vt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=hr(t[n[1]]))}return t}function Wp(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Qt(t),n[n.length]=r?Ge(e,t,r):gn(e,t))}function IE(e,t){var r=t||{},n=[Mr,Ge("cp:coreProperties",null,{"xmlns:cp":Yr.CORE_PROPS,"xmlns:dc":Yr.dc,"xmlns:dcterms":Yr.dcterms,"xmlns:dcmitype":Yr.dcmitype,"xmlns:xsi":Yr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Wp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:xg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Wp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:xg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Da.length;++s){var i=Da[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Wp(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var vo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],DE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function PE(e,t,r,n){var a=[];if(typeof e=="string")a=sx(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var i=typeof t=="string"?sx(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function NF(e,t,r){var n={};return t||(t={}),e=rr(e),vo.forEach(function(a){var s=(e.match(ju(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=Vt(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&PE(n.HeadingPairs,n.TitlesOfParts,t,r),t}function RE(e){var t=[],r=Ge;return e||(e={}),e.Application="SheetJS",t[t.length]=Mr,t[t.length]=Ge("Properties",null,{xmlns:Yr.EXT_PROPS,"xmlns:vt":Yr.vt}),vo.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Qt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Qt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var AF=/<[^>]+>[^<]*/g;function OF(e,t){var r={},n="",a=e.match(AF);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=kt(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Vt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Vt(u);break;case"bool":r[n]=fr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=hr(u);break;case"cy":case"error":r[n]=Vt(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function jE(e){var t=[Mr,Ge("Properties",null,{xmlns:Yr.CUST_PROPS,"xmlns:vt":Yr.vt})];if(!e)return t.join("");var r=1;return Dr(e).forEach(function(a){++r,t[t.length]=Ge("property",Bj(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Qt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Tg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hp;function IF(e,t,r){Hp||(Hp=k0(Tg)),t=Hp[t]||t,e[t]=r}function DF(e,t){var r=[];return Dr(Tg).map(function(n){for(var a=0;a<Da.length;++a)if(Da[a][1]==n)return Da[a];for(a=0;a<vo.length;++a)if(vo[a][1]==n)return vo[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(gn(Tg[n[1]]||n[1],a))}}),Ge("DocumentProperties",r.join(""),{xmlns:la.o})}function PF(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Dr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<Da.length;++i)if(s==Da[i][1])return;for(i=0;i<vo.length;++i)if(s==vo[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(Ge(tx(s),o,{"dt:dt":l}))}}),t&&Dr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(Ge(tx(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+la.o+'">'+a.join("")+"</"+n+">"}function Sv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function RF(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=xe(8);return i.write_shift(4,n),i.write_shift(4,a),i}function FE(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function LE(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function ME(e,t,r){return t===31?LE(e):FE(e,t,r)}function Cg(e,t,r){return ME(e,t,r===!1?0:4)}function jF(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ME(e,t,0)}function FF(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Hn,""),e.l-a&2&&(e.l+=2)}return r}function LF(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Hn,"");return r}function MF(e){var t=e.l,r=Nh(e,TE);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Nh(e,Xn);return[r,n]}function BF(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(MF(e));return r}function gx(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Hn,"").replace(Uc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function BE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function $F(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Nh(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==hx&&n!==t&&vF.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===hx?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return FE(e,n,4).replace(Hn,"");case 31:return LE(e);case 64:return Sv(e);case 65:return BE(e);case 71:return $F(e);case 80:return Cg(e,n,!s.raw).replace(Hn,"");case 81:return jF(e,n).replace(Hn,"");case 4108:return BF(e);case 4126:case 4127:return n==4127?FF(e):LF(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function vx(e,t){var r=xe(4),n=xe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=xe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=RF(t);break;case 31:case 80:for(n=xe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return sn([r,n])}function yx(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),d=e.read_shift(4);s[i]=[u,d+r]}s.sort(function(k,w){return k[1]-w[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var v=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,v=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],v=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],v=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(v=!1,e.l=s[i][1]),v)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var y=t[s[i][0]];if(h[y.n]=Nh(e,y.t,{raw:!0}),y.p==="version"&&(h[y.n]=String(h[y.n]>>16)+"."+("0000"+String(h[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(h[y.n]){case 0:h[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xa(o=h[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[y.n])}}else if(s[i][0]===1){if(o=h.CodePage=Nh(e,kv),Xa(o),l!==-1){var p=e.l;e.l=s[l][1],c=gx(e,o),e.l=p}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=gx(e,o)}else{var _=c[s[i][0]],x;switch(e[e.l]){case 65:e.l+=4,x=BE(e);break;case 30:e.l+=4,x=Cg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Cg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Rr(e,4);break;case 64:e.l+=4,x=hr(Sv(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[_]=x}}return e.l=r+n,h}var $E=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function UF(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function _x(e,t,r){var n=xe(8),a=[],s=[],i=8,o=0,l=xe(8),c=xe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),a.push(c),i+=8+l.length,!t){c=xe(8),c.write_shift(4,0),a.unshift(c);var u=[xe(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=xe(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=sn(u),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!($E.indexOf(e[o][0])>-1||DE.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],v=0;if(t){v=+t[e[o][0]];var y=r[v];if(y.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=vx(y.t,h)}else{var _=UF(h);_==-1&&(_=31,h=String(h)),l=vx(_,h)}s.push(l),c=xe(8),c.write_shift(4,t?v:2+o),a.push(c),i+=8+l.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),sn([n].concat(a).concat(s))}function wx(e,t,r){var n=e.content;if(!n)return{};mn(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==ht.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=yx(n,t),h={SystemIdentifier:c};for(var v in d)h[v]=d[v];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=yx(n,null)}catch{}for(v in y)h[v]=y[v];return h.FMTID=[s,i],h}function xx(e,t,r,n,a,s){var i=xe(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,ht.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=_x(e,r,n);if(o.push(l),a){var c=_x(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return sn(o)}function ui(e,t){return e.read_shift(t),null}function zF(e,t){t||(t=xe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function VF(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Rr(e,t){return e.read_shift(t)===1}function Vn(e,t){return t||(t=xe(2)),t.write_shift(2,+!!e),t}function Vr(e){return e.read_shift(2,"u")}function Ca(e,t){return t||(t=xe(2)),t.write_shift(2,e),t}function UE(e,t){return VF(e,t,Vr)}function WF(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function zE(e,t,r){return r||(r=xe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function cf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function HF(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function KF(e){var t=e.t||"",r=xe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=xe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return sn(a)}function Oo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function uf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Oo(e,n,r)}function zo(e,t,r){if(r.biff>5)return uf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function VE(e,t,r){return r||(r=xe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function qF(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function GF(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Hn,"");return n&&(e.l+=24),a}function XF(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Hn,"");return r+i}function ZF(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return GF(e);case"0303000000000000c000000000000046":return XF(e);default:throw new Error("Unsupported Moniker "+r)}}function cd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Hn,""):"";return r}function kx(e,t){t||(t=xe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function YF(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",u,d;a&16&&(s=cd(e,r-e.l)),a&128&&(i=cd(e,r-e.l)),(a&257)===257&&(o=cd(e,r-e.l)),(a&257)===1&&(l=ZF(e,r-e.l)),a&8&&(c=cd(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(d=Sv(e)),e.l=r;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var v={Target:h};return u&&(v.guid=u),d&&(v.time=d),s&&(v.Tooltip=s),v}function JF(e){var t=xe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),kx(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&kx(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function WE(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function HE(e,t){var r=WE(e);return r[3]=0,r}function Es(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Io(e,t,r,n){return n||(n=xe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function QF(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function eL(e,t,r){return t===0?"":zo(e,t,r)}function tL(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function KE(e){var t=e.read_shift(2),r=xv(e);return[t,r]}function rL(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=cf(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function E0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function qE(e,t){return t||(t=xe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function GE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var nL=GE;function XE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function aL(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function sL(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Sn(e){e.l+=2,e.l+=e.read_shift(2)}var iL={0:Sn,4:Sn,5:Sn,6:Sn,7:sL,8:Sn,9:Sn,10:Sn,11:Sn,12:Sn,13:aL,14:Sn,15:Sn,16:Sn,17:Sn,18:Sn,19:Sn,20:Sn,21:XE};function oL(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(iL[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ud(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ev(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=xe(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function lL(e,t){return t===0||e.read_shift(2),1200}function cL(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=zo(e,0,r);return e.read_shift(t+n-e.l),a}function uL(e,t){var r=!t||t.biff==8,n=xe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function fL(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function dL(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=cf(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function hL(e,t){var r=!t||t.biff>=8?2:1,n=xe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function pL(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(HF(e));return s.Count=n,s.Unique=a,s}function mL(e,t){var r=xe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=KF(e[a]);var s=sn([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function gL(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function vL(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function yL(e){var t=QF(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function _L(e){return e.read_shift(2),e.read_shift(4)}function bx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function wL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function xL(){var e=xe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function kL(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function bL(e){var t=xe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function SL(){}function EL(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=cf(e,0,r),n}function TL(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=xe(a);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function CL(e){var t=Es(e);return t.isst=e.read_shift(4),t}function NL(e,t,r,n){var a=xe(10);return Io(e,t,n,a),a.write_shift(4,r),a}function AL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Es(e);r.biff==2&&e.l++;var s=uf(e,n-e.l,r);return a.val=s,a}function OL(e,t,r,n,a){var s=!a||a.biff==8,i=xe(8+ +s+(1+s)*r.length);return Io(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function IL(e,t,r){var n=e.read_shift(2),a=zo(e,0,r);return[n,a]}function DL(e,t,r,n){var a=r&&r.biff==5;n||(n=xe(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var PL=zo;function Sx(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function RL(e,t){var r=t.biff==8||!t.biff?4:2,n=xe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function jL(e){var t=e.read_shift(2),r=e.read_shift(2),n=KE(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function FL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(KE(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function LL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function ML(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=yF[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function BL(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=ML(e,t,n.fStyle,r),n}function Ex(e,t,r,n){var a=r&&r.biff==5;n||(n=xe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function $L(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function UL(e){var t=xe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Tx(e,t,r){var n=Es(e);(r.biff==2||t==9)&&++e.l;var a=WF(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function zL(e,t,r,n,a,s){var i=xe(8);return Io(e,t,n,i),zE(r,s,i),i}function VL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Es(e),a=An(e);return n.val=a,n}function WL(e,t,r,n){var a=xe(14);return Io(e,t,n,a),Ao(r,a),a}var Cx=eL;function HL(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Oo(e,s),o=[];n>e.l;)o.push(uf(e));return[s,a,i,o]}function Nx(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=rL(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var KL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ax(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Oo(e,i,r);a&32&&(c=KL[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var d=n==e.l||o===0||!(u>0)?[]:o$(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function ZE(e,t,r){if(r.biff<8)return qL(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(tL(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function qL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=cf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function GL(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Oo(e,n,r),i=Oo(e,a,r);return[s,i]}function XL(e,t,r){var n=GE(e);e.l++;var a=e.read_shift(1);return t-=8,[l$(e,t,r),a,n]}function Ox(e,t,r){var n=nL(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,s$(e,t,r)]}function ZL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function YL(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=zo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function JL(e,t,r){return YL(e,t,r)}function QL(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(E0(e));return r}function e7(e){var t=xe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)qE(e[r],t);return t}function t7(e,t,r){if(r&&r.biff<8)return n7(e,t,r);var n=XE(e),a=oL(e,t-22,n[1]);return{cmo:n,ft:a}}var r7={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function n7(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((r7[n]||Rn)(e,t,r)),{cmo:[a,n,s],ft:i}}function a7(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=qF(e,6,r);var o=e.read_shift(2);e.read_shift(2),Vr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],d=Oo(e,e.lens[c+1]-e.lens[c]-1);if(a+=d,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function s7(e,t){var r=E0(e);e.l+=16;var n=YF(e,t-24);return[r,n]}function i7(e){var t=xe(24),r=kr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return sn([t,JF(e[1])])}function o7(e,t){e.read_shift(2);var r=E0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Hn,""),[r,n]}function l7(e){var t=e[1].Tooltip,r=xe(10+2*(t.length+1));r.write_shift(2,2048);var n=kr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function c7(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=px[r]||r,r=e.read_shift(2),t[1]=px[r]||r,t}function u7(e){return e||(e=xe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function f7(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(HE(e));return r}function d7(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(HE(e));return r}function h7(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function YE(e,t,r){if(!r.cellStyles)return Rn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function p7(e,t){var r=xe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function m7(e,t){var r={};return t<32||(e.l+=16,r.header=An(e),r.footer=An(e),e.l+=2),r}function g7(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function v7(e){for(var t=xe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var y7=Es,_7=UE,w7=uf;function x7(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function k7(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Es(e);++e.l;var a=zo(e,t-7,r);return n.t="str",n.val=a,n}function b7(e){var t=Es(e);++e.l;var r=An(e);return t.t="n",t.val=r,t}function S7(e,t,r){var n=xe(15);return pf(n,e,t),n.write_shift(8,r,"f"),n}function E7(e){var t=Es(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function T7(e,t,r){var n=xe(9);return pf(n,e,t),n.write_shift(2,r),n}function C7(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function N7(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function A7(e,t,r){var n=e.l+t,a=Es(e),s=e.read_shift(2),i=Oo(e,s,r);return e.l=n,a.t="str",a.val=i,a}var O7=[2,3,48,49,131,139,140,245],Ng=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=k0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=ji(1);switch(l.type){case"base64":u=ua(ga(o));break;case"binary":u=ua(o);break;case"buffer":case"array":u=o;break}mn(u,0);var d=u.read_shift(1),h=!!(d&136),v=!1,y=!1;switch(d){case 2:break;case 3:break;case 48:v=!0,h=!0;break;case 49:v=!0,h=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,_=521;d==2&&(p=u.read_shift(2)),u.l+=3,d!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(_=u.read_shift(2));var x=u.read_shift(2),k=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(k=e[u[u.l]]),u.l+=1,u.l+=2),y&&(u.l+=36);for(var w=[],E={},I=Math.min(u.length,d==2?521:_-10-(v?264:0)),D=y?32:11;u.l<I&&u[u.l]!=13;)switch(E={},E.name=wi.utils.decode(k,u.slice(u.l,u.l+D)).replace(/[\u0000\r\n].*$/g,""),u.l+=D,E.type=String.fromCharCode(u.read_shift(1)),d!=2&&!y&&(E.offset=u.read_shift(4)),E.len=u.read_shift(1),d==2&&(E.offset=u.read_shift(2)),E.dec=u.read_shift(1),E.name.length&&w.push(E),d!=2&&(u.l+=y?13:14),E.type){case"B":(!v||E.len!=8)&&l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var C=0,V=0;for(c[0]=[],V=0;V!=w.length;++V)c[0][V]=w[V].name;for(;p-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++C]=[],V=0,V=0;V!=w.length;++V){var z=u.slice(u.l,u.l+w[V].len);u.l+=w[V].len,mn(z,0);var ee=wi.utils.decode(k,z);switch(w[V].type){case"C":ee.trim().length&&(c[C][V]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?c[C][V]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):c[C][V]=ee;break;case"F":c[C][V]=parseFloat(ee.trim());break;case"+":case"I":c[C][V]=y?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":c[C][V]=!0;break;case"N":case"F":c[C][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[C][V]="##MEMO##"+(y?parseInt(ee.trim(),10):z.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(c[C][V]=+ee||0);break;case"@":c[C][V]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":c[C][V]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":c[C][V]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][V]=-z.read_shift(-8,"f");break;case"B":if(v&&w[V].len==8){c[C][V]=z.read_shift(8,"f");break}case"G":case"P":z.l+=w[V].len;break;case"0":if(w[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[V].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=ic(r(o,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function a(o,l){try{return Xi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Xa(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=ra(),d=Dh(o,{header:1,raw:!0,cellDates:!0}),h=d[0],v=d.slice(1),y=o["!cols"]||[],p=0,_=0,x=0,k=1;for(p=0;p<h.length;++p){if(((y[p]||{}).DBF||{}).name){h[p]=y[p].DBF.name,++x;continue}if(h[p]!=null){if(++x,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(_=0;_<1024;++_)if(h.indexOf(h[p]+"_"+_)==-1){h[p]+="_"+_;break}}}}var w=Wt(o["!ref"]),E=[],I=[],D=[];for(p=0;p<=w.e.c-w.s.c;++p){var C="",V="",z=0,ee=[];for(_=0;_<v.length;++_)v[_][p]!=null&&ee.push(v[_][p]);if(ee.length==0||h[p]==null){E[p]="?";continue}for(_=0;_<ee.length;++_){switch(typeof ee[_]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=ee[_]instanceof Date?"D":"C";break;default:V="C"}z=Math.max(z,String(ee[_]).length),C=C&&C!=V?"C":V}z>250&&(z=250),V=((y[p]||{}).DBF||{}).type,V=="C"&&y[p].DBF.len>z&&(z=y[p].DBF.len),C=="B"&&V=="N"&&(C="N",D[p]=y[p].DBF.dec,z=y[p].DBF.len),I[p]=C=="C"||V=="N"?z:s[C]||0,k+=I[p],E[p]=C}var re=u.next(32);for(re.write_shift(4,318902576),re.write_shift(4,v.length),re.write_shift(2,296+32*x),re.write_shift(2,k),p=0;p<4;++p)re.write_shift(4,0);for(re.write_shift(4,0|(+t[$S]||3)<<8),p=0,_=0;p<h.length;++p)if(h[p]!=null){var G=u.next(32),me=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,me,"sbcs"),G.write_shift(1,E[p]=="?"?"C":E[p],"sbcs"),G.write_shift(4,_),G.write_shift(1,I[p]||s[E[p]]||0),G.write_shift(1,D[p]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),_+=I[p]||s[E[p]]||0}var Ee=u.next(264);for(Ee.write_shift(4,13),p=0;p<65;++p)Ee.write_shift(4,0);for(p=0;p<v.length;++p){var Ae=u.next(k);for(Ae.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(E[_]){case"L":Ae.write_shift(1,v[p][_]==null?63:v[p][_]?84:70);break;case"B":Ae.write_shift(8,v[p][_]||0,"f");break;case"N":var ke="0";for(typeof v[p][_]=="number"&&(ke=v[p][_].toFixed(D[_]||0)),x=0;x<I[_]-ke.length;++x)Ae.write_shift(1,32);Ae.write_shift(1,ke,"sbcs");break;case"D":v[p][_]?(Ae.write_shift(4,("0000"+v[p][_].getFullYear()).slice(-4),"sbcs"),Ae.write_shift(2,("00"+(v[p][_].getMonth()+1)).slice(-2),"sbcs"),Ae.write_shift(2,("00"+v[p][_].getDate()).slice(-2),"sbcs")):Ae.write_shift(8,"00000000","sbcs");break;case"C":var Oe=String(v[p][_]!=null?v[p][_]:"").slice(0,I[_]);for(Ae.write_shift(1,Oe,"sbcs"),x=0;x<I[_]-Oe.length;++x)Ae.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),JE=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Dr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,v){var y=e[v];return typeof y=="number"?Uw(y):y},n=function(h,v,y){var p=v.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return p==59?h:Uw(p)};e["|"]=254;function a(h,v){switch(v.type){case"base64":return s(ga(h),v);case"binary":return s(h,v);case"buffer":return s(Pt&&Buffer.isBuffer(h)?h.toString("binary"):Gi(h),v);case"array":return s(No(h),v)}throw new Error("Unrecognized type "+v.type)}function s(h,v){var y=h.split(/[\n\r]+/),p=-1,_=-1,x=0,k=0,w=[],E=[],I=null,D={},C=[],V=[],z=[],ee=0,re;for(+v.codepage>=0&&Xa(+v.codepage);x!==y.length;++x){ee=0;var G=y[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),me=G.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),Ee=me[0],Ae;if(G.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&E.push(G.slice(3).replace(/;;/g,";"));break;case"C":var ke=!1,Oe=!1,Ce=!1,Z=!1,Se=-1,Ve=-1;for(k=1;k<me.length;++k)switch(me[k].charAt(0)){case"A":break;case"X":_=parseInt(me[k].slice(1))-1,Oe=!0;break;case"Y":for(p=parseInt(me[k].slice(1))-1,Oe||(_=0),re=w.length;re<=p;++re)w[re]=[];break;case"K":Ae=me[k].slice(1),Ae.charAt(0)==='"'?Ae=Ae.slice(1,Ae.length-1):Ae==="TRUE"?Ae=!0:Ae==="FALSE"?Ae=!1:isNaN(Qa(Ae))?isNaN(Hl(Ae).getDate())||(Ae=hr(Ae)):(Ae=Qa(Ae),I!==null&&ac(I)&&(Ae=S0(Ae))),ke=!0;break;case"E":Z=!0;var B=jl(me[k].slice(1),{r:p,c:_});w[p][_]=[w[p][_],B];break;case"S":Ce=!0,w[p][_]=[w[p][_],"S5S"];break;case"G":break;case"R":Se=parseInt(me[k].slice(1))-1;break;case"C":Ve=parseInt(me[k].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}if(ke&&(w[p][_]&&w[p][_].length==2?w[p][_][0]=Ae:w[p][_]=Ae,I=null),Ce){if(Z)throw new Error("SYLK shared formula cannot have own formula");var J=Se>-1&&w[Se][Ve];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");w[p][_][1]=g4(J[1],{r:p-Se,c:_-Ve})}break;case"F":var K=0;for(k=1;k<me.length;++k)switch(me[k].charAt(0)){case"X":_=parseInt(me[k].slice(1))-1,++K;break;case"Y":for(p=parseInt(me[k].slice(1))-1,re=w.length;re<=p;++re)w[re]=[];break;case"M":ee=parseInt(me[k].slice(1))/20;break;case"F":break;case"G":break;case"P":I=E[parseInt(me[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=me[k].slice(1).split(" "),re=parseInt(z[0],10);re<=parseInt(z[1],10);++re)ee=parseInt(z[2],10),V[re-1]=ee===0?{hidden:!0}:{wch:ee},Fi(V[re-1]);break;case"C":_=parseInt(me[k].slice(1))-1,V[_]||(V[_]={});break;case"R":p=parseInt(me[k].slice(1))-1,C[p]||(C[p]={}),ee>0?(C[p].hpt=ee,C[p].hpx=ql(ee)):ee===0&&(C[p].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}K<1&&(I=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}}return C.length>0&&(D["!rows"]=C),V.length>0&&(D["!cols"]=V),v&&v.sheetRows&&(w=w.slice(0,v.sheetRows)),[w,D]}function i(h,v){var y=a(h,v),p=y[0],_=y[1],x=ic(p,v);return Dr(_).forEach(function(k){x[k]=_[k]}),x}function o(h,v){return Xi(i(h,v),v)}function l(h,v,y,p){var _="C;Y"+(y+1)+";X"+(p+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+Iv(h.f,{r:y,c:p}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(h,v){v.forEach(function(y,p){var _="F;W"+(p+1)+" "+(p+1)+" ";y.hidden?_+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=$u(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Uu(y.wpx)),typeof y.wch=="number"&&(_+=Math.round(y.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function u(h,v){v.forEach(function(y,p){var _="F;";y.hidden?_+="M0;":y.hpt?_+="M"+20*y.hpt+";":y.hpx&&(_+="M"+20*zu(y.hpx)+";"),_.length>2&&h.push(_+"R"+(p+1))})}function d(h,v){var y=["ID;PWXL;N;E"],p=[],_=Wt(h["!ref"]),x,k=Array.isArray(h),w=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),h["!cols"]&&c(y,h["!cols"]),h["!rows"]&&u(y,h["!rows"]),y.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var E=_.s.r;E<=_.e.r;++E)for(var I=_.s.c;I<=_.e.c;++I){var D=xt({r:E,c:I});x=k?(h[E]||[])[I]:h[D],!(!x||x.v==null&&(!x.f||x.F))&&p.push(l(x,h,E,I))}return y.join(w)+w+p.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),QE=function(){function e(s,i){switch(i.type){case"base64":return t(ga(s),i);case"binary":return t(s,i);case"buffer":return t(Pt&&Buffer.isBuffer(s)?s.toString("binary"):Gi(s),i);case"array":return t(No(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,u=0,d=[];u!==o.length;++u){if(o[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),v=h[0],y=h[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+v){case-1:if(p==="BOT"){d[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[l][c]=!0:p==="FALSE"?d[l][c]=!1:isNaN(Qa(y))?isNaN(Hl(y).getDate())?d[l][c]=y:d[l][c]=hr(y):d[l][c]=Qa(y),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return ic(e(s,i),i)}function n(s,i){return Xi(r(s,i),i)}var a=function(){var s=function(l,c,u,d,h){l.push(c),l.push(u+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=Wt(l["!ref"]),d,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var v=u.s.r;v<=u.e.r;++v){i(c,-1,0,"BOT");for(var y=u.s.c;y<=u.e.c;++y){var p=xt({r:v,c:y});if(d=h?(l[v]||[])[y]:l[p],!d){i(c,1,0,"");continue}switch(d.t){case"n":var _=d.w;!_&&d.v!=null&&(_=d.v),_==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,_,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=ja(d.z||_t[14],Qr(hr(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var x=`\r
`,k=c.join(x);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),e4=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var v=d.split(`
`),y=-1,p=-1,_=0,x=[];_!==v.length;++_){var k=v[_].trim().split(":");if(k[0]==="cell"){var w=kr(k[1]);if(x.length<=w.r)for(y=x.length;y<=w.r;++y)x[y]||(x[y]=[]);switch(y=w.r,p=w.c,k[2]){case"t":x[y][p]=e(k[3]);break;case"v":x[y][p]=+k[3];break;case"vtf":var E=k[k.length-1];case"vtc":switch(k[3]){case"nl":x[y][p]=!!+k[4];break;default:x[y][p]=+k[4];break}k[2]=="vtf"&&(x[y][p]=[x[y][p],E])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(d,h){return ic(r(d,h),h)}function a(d,h){return Xi(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],v=[],y,p="",_=na(d["!ref"]),x=Array.isArray(d),k=_.s.r;k<=_.e.r;++k)for(var w=_.s.c;w<=_.e.c;++w)if(p=xt({r:k,c:w}),y=x?(d[k]||[])[w]:d[p],!(!y||y.v==null||y.t==="z")){switch(v=["cell",p,"t"],y.t){case"s":case"str":v.push(t(y.v));break;case"n":y.f?(v[2]="vtf",v[3]="n",v[4]=y.v,v[5]=t(y.f)):(v[2]="v",v[3]=y.v);break;case"b":v[2]="vt"+(y.f?"f":"c"),v[3]="nl",v[4]=y.v?"1":"0",v[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var E=Qr(hr(y.v));v[2]="vtc",v[3]="nd",v[4]=""+E,v[5]=y.w||ja(y.z||_t[14],E);break;case"e":continue}h.push(v.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(d){return[s,i,o,i,c(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Kl=function(){function e(u,d,h,v,y){y.raw?d[h][v]=u:u===""||(u==="TRUE"?d[h][v]=!0:u==="FALSE"?d[h][v]=!1:isNaN(Qa(u))?isNaN(Hl(u).getDate())?d[h][v]=u:d[h][v]=hr(u):d[h][v]=Qa(u))}function t(u,d){var h=d||{},v=[];if(!u||u.length===0)return v;for(var y=u.split(/[\r\n]/),p=y.length-1;p>=0&&y[p].length===0;)--p;for(var _=10,x=0,k=0;k<=p;++k)x=y[k].indexOf(" "),x==-1?x=y[k].length:x++,_=Math.max(_,x);for(k=0;k<=p;++k){v[k]=[];var w=0;for(e(y[k].slice(0,_).trim(),v,k,w,h),w=1;w<=(y[k].length-_)/10+1;++w)e(y[k].slice(_+(w-1)*10,_+w*10).trim(),v,k,w,h)}return h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var d={},h=!1,v=0,y=0;v<u.length;++v)(y=u.charCodeAt(v))==34?h=!h:!h&&y in r&&(d[y]=(d[y]||0)+1);y=[];for(v in d)Object.prototype.hasOwnProperty.call(d,v)&&y.push([d[v],v]);if(!y.length){d=n;for(v in d)Object.prototype.hasOwnProperty.call(d,v)&&y.push([d[v],v])}return y.sort(function(p,_){return p[0]-_[0]||n[p[1]]-n[_[1]]}),r[y.pop()[1]]||44}function s(u,d){var h=d||{},v="",y=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(v=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(v=u.charAt(4),u=u.slice(6)):v=a(u.slice(0,1024)):h&&h.FS?v=h.FS:v=a(u.slice(0,1024));var _=0,x=0,k=0,w=0,E=0,I=v.charCodeAt(0),D=!1,C=0,V=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var z=h.dateNF!=null?gj(h.dateNF):null;function ee(){var re=u.slice(w,E),G={};if(re.charAt(0)=='"'&&re.charAt(re.length-1)=='"'&&(re=re.slice(1,-1).replace(/""/g,'"')),re.length===0)G.t="z";else if(h.raw)G.t="s",G.v=re;else if(re.trim().length===0)G.t="s",G.v=re;else if(re.charCodeAt(0)==61)re.charCodeAt(1)==34&&re.charCodeAt(re.length-1)==34?(G.t="s",G.v=re.slice(2,-1).replace(/""/g,'"')):HM(re)?(G.t="n",G.f=re.slice(1)):(G.t="s",G.v=re);else if(re=="TRUE")G.t="b",G.v=!0;else if(re=="FALSE")G.t="b",G.v=!1;else if(!isNaN(k=Qa(re)))G.t="n",h.cellText!==!1&&(G.w=re),G.v=k;else if(!isNaN(Hl(re).getDate())||z&&re.match(z)){G.z=h.dateNF||_t[14];var me=0;z&&re.match(z)&&(re=vj(re,h.dateNF,re.match(z)||[]),me=1),h.cellDates?(G.t="d",G.v=hr(re,me)):(G.t="n",G.v=Qr(hr(re,me))),h.cellText!==!1&&(G.w=ja(G.z,G.v instanceof Date?Qr(G.v):G.v)),h.cellNF||delete G.z}else G.t="s",G.v=re;if(G.t=="z"||(h.dense?(y[_]||(y[_]=[]),y[_][x]=G):y[xt({c:x,r:_})]=G),w=E+1,V=u.charCodeAt(w),p.e.c<x&&(p.e.c=x),p.e.r<_&&(p.e.r=_),C==I)++x;else if(x=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;E<u.length;++E)switch(C=u.charCodeAt(E)){case 34:V===34&&(D=!D);break;case I:case 10:case 13:if(!D&&ee())break e;break}return E-w>0&&ee(),y["!ref"]=It(p),y}function i(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):ic(t(u,d),d)}function o(u,d){var h="",v=d.type=="string"?[0,0,0,0]:Bv(u,d);switch(d.type){case"base64":h=ga(u);break;case"binary":h=u;break;case"buffer":d.codepage==65001?h=u.toString("utf8"):d.codepage&&typeof wi<"u"?h=wi.utils.decode(d.codepage,u):h=Pt&&Buffer.isBuffer(u)?u.toString("binary"):Gi(u);break;case"array":h=No(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+d.type)}return v[0]==239&&v[1]==187&&v[2]==191?h=rr(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=rr(h):d.type=="binary"&&typeof wi<"u"&&d.codepage&&(h=wi.utils.decode(d.codepage,wi.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?e4.to_sheet(d.type=="string"?h:rr(h),d):i(h,d)}function l(u,d){return Xi(o(u,d),d)}function c(u){for(var d=[],h=Wt(u["!ref"]),v,y=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var _=[],x=h.s.c;x<=h.e.c;++x){var k=xt({r:p,c:x});if(v=y?(u[p]||[])[x]:u[k],!v||v.v==null){_.push("          ");continue}for(var w=(v.w||(Ys(v),v.w)||"").slice(0,10);w.length<10;)w+=" ";_.push(w+(x===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function I7(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=JE.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Kl.to_workbook(e,t)}}var yo=function(){function e(B,J,K){if(B){mn(B,B.l||0);for(var X=K.Enum||Se;B.l<B.length;){var ge=B.read_shift(2),Pe=X[ge]||X[65535],je=B.read_shift(2),ce=B.l+je,Te=Pe.f&&Pe.f(B,je,K);if(B.l=ce,J(Te,Pe,ge))return}}}function t(B,J){switch(J.type){case"base64":return r(ua(ga(B)),J);case"binary":return r(ua(B),J);case"buffer":case"array":return r(B,J)}throw"Unsupported type "+J.type}function r(B,J){if(!B)return B;var K=J||{},X=K.dense?[]:{},ge="Sheet1",Pe="",je=0,ce={},Te=[],dt=[],N={s:{r:0,c:0},e:{r:0,c:0}},Ue=K.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)K.Enum=Se,e(B,function(Fe,$t,yr){switch(yr){case 0:K.vers=Fe,Fe>=4096&&(K.qpro=!0);break;case 6:N=Fe;break;case 204:Fe&&(Pe=Fe);break;case 222:Pe=Fe;break;case 15:case 51:K.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:yr==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=K.dateNF||_t[14],K.cellDates&&(Fe[1].t="d",Fe[1].v=S0(Fe[1].v))),K.qpro&&Fe[3]>je&&(X["!ref"]=It(N),ce[ge]=X,Te.push(ge),X=K.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},je=Fe[3],ge=Pe||"Sheet"+(je+1),Pe="");var H=K.dense?(X[Fe[0].r]||[])[Fe[0].c]:X[xt(Fe[0])];if(H){H.t=Fe[1].t,H.v=Fe[1].v,Fe[1].z!=null&&(H.z=Fe[1].z),Fe[1].f!=null&&(H.f=Fe[1].f);break}K.dense?(X[Fe[0].r]||(X[Fe[0].r]=[]),X[Fe[0].r][Fe[0].c]=Fe[1]):X[xt(Fe[0])]=Fe[1];break}},K);else if(B[2]==26||B[2]==14)K.Enum=Ve,B[2]==14&&(K.qpro=!0,B.l=0),e(B,function(Fe,$t,yr){switch(yr){case 204:ge=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>je&&(X["!ref"]=It(N),ce[ge]=X,Te.push(ge),X=K.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},je=Fe[3],ge="Sheet"+(je+1)),Ue>0&&Fe[0].r>=Ue)break;K.dense?(X[Fe[0].r]||(X[Fe[0].r]=[]),X[Fe[0].r][Fe[0].c]=Fe[1]):X[xt(Fe[0])]=Fe[1],N.e.c<Fe[0].c&&(N.e.c=Fe[0].c),N.e.r<Fe[0].r&&(N.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(dt[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:dt[Fe[0]]=Fe[1],Fe[0]==je&&(ge=Fe[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(X["!ref"]=It(N),ce[Pe||ge]=X,Te.push(Pe||ge),!dt.length)return{SheetNames:Te,Sheets:ce};for(var it={},ct=[],mt=0;mt<dt.length;++mt)ce[Te[mt]]?(ct.push(dt[mt]||Te[mt]),it[dt[mt]]=ce[dt[mt]]||ce[Te[mt]]):(ct.push(dt[mt]),it[dt[mt]]={"!ref":"A1"});return{SheetNames:ct,Sheets:it}}function n(B,J){var K=J||{};if(+K.codepage>=0&&Xa(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var X=ra(),ge=Wt(B["!ref"]),Pe=Array.isArray(B),je=[];Xe(X,0,s(1030)),Xe(X,6,l(ge));for(var ce=Math.min(ge.e.r,8191),Te=ge.s.r;Te<=ce;++Te)for(var dt=Lr(Te),N=ge.s.c;N<=ge.e.c;++N){Te===ge.s.r&&(je[N]=xr(N));var Ue=je[N]+dt,it=Pe?(B[Te]||[])[N]:B[Ue];if(!(!it||it.t=="z"))if(it.t=="n")(it.v|0)==it.v&&it.v>=-32768&&it.v<=32767?Xe(X,13,v(Te,N,it.v)):Xe(X,14,p(Te,N,it.v));else{var ct=Ys(it);Xe(X,15,d(Te,N,ct.slice(0,239)))}}return Xe(X,1),X.end()}function a(B,J){var K=J||{};if(+K.codepage>=0&&Xa(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var X=ra();Xe(X,0,i(B));for(var ge=0,Pe=0;ge<B.SheetNames.length;++ge)(B.Sheets[B.SheetNames[ge]]||{})["!ref"]&&Xe(X,27,Z(B.SheetNames[ge],Pe++));var je=0;for(ge=0;ge<B.SheetNames.length;++ge){var ce=B.Sheets[B.SheetNames[ge]];if(!(!ce||!ce["!ref"])){for(var Te=Wt(ce["!ref"]),dt=Array.isArray(ce),N=[],Ue=Math.min(Te.e.r,8191),it=Te.s.r;it<=Ue;++it)for(var ct=Lr(it),mt=Te.s.c;mt<=Te.e.c;++mt){it===Te.s.r&&(N[mt]=xr(mt));var Fe=N[mt]+ct,$t=dt?(ce[it]||[])[mt]:ce[Fe];if(!(!$t||$t.t=="z"))if($t.t=="n")Xe(X,23,ee(it,mt,je,$t.v));else{var yr=Ys($t);Xe(X,22,C(it,mt,je,yr.slice(0,239)))}}++je}}return Xe(X,1),X.end()}function s(B){var J=xe(2);return J.write_shift(2,B),J}function i(B){var J=xe(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var K=0,X=0,ge=0,Pe=0;Pe<B.SheetNames.length;++Pe){var je=B.SheetNames[Pe],ce=B.Sheets[je];if(!(!ce||!ce["!ref"])){++ge;var Te=na(ce["!ref"]);K<Te.e.r&&(K=Te.e.r),X<Te.e.c&&(X=Te.e.c)}}return K>8191&&(K=8191),J.write_shift(2,K),J.write_shift(1,ge),J.write_shift(1,X),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function o(B,J,K){var X={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&K.qpro?(X.s.c=B.read_shift(1),B.l++,X.s.r=B.read_shift(2),X.e.c=B.read_shift(1),B.l++,X.e.r=B.read_shift(2),X):(X.s.c=B.read_shift(2),X.s.r=B.read_shift(2),J==12&&K.qpro&&(B.l+=2),X.e.c=B.read_shift(2),X.e.r=B.read_shift(2),J==12&&K.qpro&&(B.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function l(B){var J=xe(8);return J.write_shift(2,B.s.c),J.write_shift(2,B.s.r),J.write_shift(2,B.e.c),J.write_shift(2,B.e.r),J}function c(B,J,K){var X=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(X[0].c=B.read_shift(1),X[3]=B.read_shift(1),X[0].r=B.read_shift(2),B.l+=2):(X[2]=B.read_shift(1),X[0].c=B.read_shift(2),X[0].r=B.read_shift(2)),X}function u(B,J,K){var X=B.l+J,ge=c(B,J,K);if(ge[1].t="s",K.vers==20768){B.l++;var Pe=B.read_shift(1);return ge[1].v=B.read_shift(Pe,"utf8"),ge}return K.qpro&&B.l++,ge[1].v=B.read_shift(X-B.l,"cstr"),ge}function d(B,J,K){var X=xe(7+K.length);X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,B),X.write_shift(1,39);for(var ge=0;ge<X.length;++ge){var Pe=K.charCodeAt(ge);X.write_shift(1,Pe>=128?95:Pe)}return X.write_shift(1,0),X}function h(B,J,K){var X=c(B,J,K);return X[1].v=B.read_shift(2,"i"),X}function v(B,J,K){var X=xe(7);return X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,B),X.write_shift(2,K,"i"),X}function y(B,J,K){var X=c(B,J,K);return X[1].v=B.read_shift(8,"f"),X}function p(B,J,K){var X=xe(13);return X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,B),X.write_shift(8,K,"f"),X}function _(B,J,K){var X=B.l+J,ge=c(B,J,K);if(ge[1].v=B.read_shift(8,"f"),K.qpro)B.l=X;else{var Pe=B.read_shift(2);E(B.slice(B.l,B.l+Pe),ge),B.l+=Pe}return ge}function x(B,J,K){var X=J&32768;return J&=-32769,J=(X?B:0)+(J>=8192?J-16384:J),(X?"":"$")+(K?xr(J):Lr(J))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(B,J){mn(B,0);for(var K=[],X=0,ge="",Pe="",je="",ce="";B.l<B.length;){var Te=B[B.l++];switch(Te){case 0:K.push(B.read_shift(8,"f"));break;case 1:Pe=x(J[0].c,B.read_shift(2),!0),ge=x(J[0].r,B.read_shift(2),!1),K.push(Pe+ge);break;case 2:{var dt=x(J[0].c,B.read_shift(2),!0),N=x(J[0].r,B.read_shift(2),!1);Pe=x(J[0].c,B.read_shift(2),!0),ge=x(J[0].r,B.read_shift(2),!1),K.push(dt+N+":"+Pe+ge)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(B.read_shift(2));break;case 6:{for(var Ue="";Te=B[B.l++];)Ue+=String.fromCharCode(Te);K.push('"'+Ue.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:ce=K.pop(),je=K.pop(),K.push(["AND","OR"][Te-20]+"("+je+","+ce+")");break;default:if(Te<32&&w[Te])ce=K.pop(),je=K.pop(),K.push(je+w[Te]+ce);else if(k[Te]){if(X=k[Te][1],X==69&&(X=B[B.l++]),X>K.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+K.join("|")+"|");return}var it=K.slice(-X);K.length-=X,K.push(k[Te][0]+"("+it.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}K.length==1?J[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function I(B){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=B.read_shift(2),J[3]=B[B.l++],J[0].c=B[B.l++],J}function D(B,J){var K=I(B);return K[1].t="s",K[1].v=B.read_shift(J-4,"cstr"),K}function C(B,J,K,X){var ge=xe(6+X.length);ge.write_shift(2,B),ge.write_shift(1,K),ge.write_shift(1,J),ge.write_shift(1,39);for(var Pe=0;Pe<X.length;++Pe){var je=X.charCodeAt(Pe);ge.write_shift(1,je>=128?95:je)}return ge.write_shift(1,0),ge}function V(B,J){var K=I(B);K[1].v=B.read_shift(2);var X=K[1].v>>1;if(K[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return K[1].v=X,K}function z(B,J){var K=I(B),X=B.read_shift(4),ge=B.read_shift(4),Pe=B.read_shift(2);if(Pe==65535)return X===0&&ge===3221225472?(K[1].t="e",K[1].v=15):X===0&&ge===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var je=Pe&32768;return Pe=(Pe&32767)-16446,K[1].v=(1-je*2)*(ge*Math.pow(2,Pe+32)+X*Math.pow(2,Pe)),K}function ee(B,J,K,X){var ge=xe(14);if(ge.write_shift(2,B),ge.write_shift(1,K),ge.write_shift(1,J),X==0)return ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(2,65535),ge;var Pe=0,je=0,ce=0,Te=0;return X<0&&(Pe=1,X=-X),je=Math.log2(X)|0,X/=Math.pow(2,je-31),Te=X>>>0,Te&2147483648||(X/=2,++je,Te=X>>>0),X-=Te,Te|=2147483648,Te>>>=0,X*=Math.pow(2,32),ce=X>>>0,ge.write_shift(4,ce),ge.write_shift(4,Te),je+=16383+(Pe?32768:0),ge.write_shift(2,je),ge}function re(B,J){var K=z(B);return B.l+=J-14,K}function G(B,J){var K=I(B),X=B.read_shift(4);return K[1].v=X>>6,K}function me(B,J){var K=I(B),X=B.read_shift(8,"f");return K[1].v=X,K}function Ee(B,J){var K=me(B);return B.l+=J-10,K}function Ae(B,J){return B[B.l+J-1]==0?B.read_shift(J,"cstr"):""}function ke(B,J){var K=B[B.l++];K>J-1&&(K=J-1);for(var X="";X.length<K;)X+=String.fromCharCode(B[B.l++]);return X}function Oe(B,J,K){if(!(!K.qpro||J<21)){var X=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ge=B.read_shift(J-21,"cstr");return[X,ge]}}function Ce(B,J){for(var K={},X=B.l+J;B.l<X;){var ge=B.read_shift(2);if(ge==14e3){for(K[ge]=[0,""],K[ge][0]=B.read_shift(2);B[B.l];)K[ge][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return K}function Z(B,J){var K=xe(5+B.length);K.write_shift(2,14e3),K.write_shift(2,J);for(var X=0;X<B.length;++X){var ge=B.charCodeAt(X);K[K.l++]=ge>127?95:ge}return K[K.l++]=0,K}var Se={0:{n:"BOF",f:Vr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ae},222:{n:"SHEETNAMELP",f:ke},65535:{n:""}},Ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function D7(e){var t={},r=e.match(jn),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=kt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=rv[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var P7=function(){var e=ju("t"),t=ju("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Vt(i[1])},l=s.match(t);return l&&(o.s=D7(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),R7=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),j7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,F7=/<(?:\w+:)?r>/,L7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Tv(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Vt(rr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=rr(e),r&&(n.h=dv(n.t))):e.match(F7)&&(n.r=rr(e),n.t=Vt(rr((e.replace(L7,"").match(j7)||[]).join("").replace(jn,""))),r&&(n.h=R7(P7(n.r)))),n):{t:""}}var M7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,B7=/<(?:\w+:)?(?:si|sstItem)>/g,$7=/<\/(?:\w+:)?(?:si|sstItem)>/;function U7(e,t){var r=[],n="";if(!e)return r;var a=e.match(M7);if(a){n=a[2].replace(B7,"").split($7);for(var s=0;s!=n.length;++s){var i=Tv(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=kt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var z7=/^\s|\s$|[\t\n\r]/;function t4(e,t){if(!t.bookSST)return"";var r=[Mr];r[r.length]=Ge("sst",null,{xmlns:Lo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(z7)&&(s+=' xml:space="preserve"'),s+=">"+Qt(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function V7(e){return[e.read_shift(4),e.read_shift(4)]}function W7(e,t){var r=[],n=!1;return ei(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function H7(e,t){return t||(t=xe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var K7=rF;function q7(e){var t=ra();De(t,159,H7(e));for(var r=0;r<e.length;++r)De(t,19,K7(e[r]));return De(t,160),t.end()}function r4(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Vs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function G7(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Vs(e,4),t.U=Vs(e,4),t.W=Vs(e,4),t}function X7(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Z7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(X7(e));return t}function Y7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function J7(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Vs(e,4),t.U=Vs(e,4),t.W=Vs(e,4),t}function Q7(e){var t=J7(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function n4(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function a4(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function e9(e){var t=Vs(e);switch(t.Minor){case 2:return[t.Minor,t9(e)];case 3:return[t.Minor,r9()];case 4:return[t.Minor,n9(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function t9(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=n4(e,r),a=a4(e,e.length-e.l);return{t:"Std",h:n,v:a}}function r9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function n9(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(jn,function(s){var i=kt(s);switch(Ss(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function a9(e,t){var r={},n=r.EncryptionVersionInfo=Vs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=n4(e,a),t-=a,r.EncryptionVerifier=a4(e,t),r}function s9(e){var t={},r=t.EncryptionVersionInfo=Vs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Cv(e){var t=0,r,n=r4(e),a=n.length+1,s,i,o,l,c;for(r=ji(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var s4=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],d=0;d!=7;++d)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=r4(i),l=s(o),c=o.length,u=ji(16),d=0;d!=16;++d)u[d]=0;var h,v,y;for((c&1)===1&&(h=l>>8,u[c]=a(e[0],h),--c,h=l&255,v=o[o.length-1],u[c]=a(v,h));c>0;)--c,h=l>>8,u[c]=a(o[c],h),--c,h=l&255,u[c]=a(o[c],h);for(c=15,y=15-o.length;y>0;)h=l>>8,u[c]=a(e[y],h),--c,--y,h=l&255,u[c]=a(o[c],h),--c,--y;return u}}(),i9=function(e,t,r,n,a){a||(a=t),n||(n=s4(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},o9=function(e){var t=0,r=s4(e);return function(n){var a=i9("",n,t,r);return t=a[1],a[0]}};function l9(e,t,r,n){var a={key:Vr(e),verificationBytes:Vr(e)};return r.password&&(a.verifier=Cv(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=o9(r.password)),a}function c9(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=s9(e):n.Data=a9(e,t),n}function u9(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?c9(e,t-2,n):l9(e,r.biff>=8?t:t-2,r,n),n}var i4=function(){function e(a,s){switch(s.type){case"base64":return t(ga(a),s);case"binary":return t(a,s);case"buffer":return t(Pt&&Buffer.isBuffer(a)?a.toString("binary"):Gi(a),s);case"array":return t(No(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,v=0,y,p=-1;y=h.exec(u);){switch(y[0]){case"\\cell":var _=u.slice(v,h.lastIndex-y[0].length);if(_[0]==" "&&(_=_.slice(1)),++p,_.length){var x={v:_,t:"s"};Array.isArray(o)?o[d][p]=x:o[xt({r:d,c:p})]=x}break}v=h.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=It(c),o}function r(a,s){return Xi(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Wt(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var d=xt({r:c,c:u});o=l?(a[c]||[])[u]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ys(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function f9(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Bu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function d9(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function h9(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Ah(e,t){if(t===0)return e;var r=d9(f9(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Bu(h9(r))}var o4=6,p9=15,m9=1,Nn=o4;function $u(e){return Math.floor((e+Math.round(128/Nn)/256)*Nn)}function Uu(e){return Math.floor((e-5)/Nn*100+.5)/100}function Oh(e){return Math.round((e*Nn+5)/Nn*256)/256}function Kp(e){return Oh(Uu($u(e)))}function Nv(e){var t=Math.abs(e-Kp(e)),r=Nn;if(t>.005)for(Nn=m9;Nn<p9;++Nn)Math.abs(e-Kp(e))<=t&&(t=Math.abs(e-Kp(e)),r=Nn);Nn=r}function Fi(e){e.width?(e.wpx=$u(e.width),e.wch=Uu(e.wpx),e.MDW=Nn):e.wpx?(e.wch=Uu(e.wpx),e.width=Oh(e.wch),e.MDW=Nn):typeof e.wch=="number"&&(e.width=Oh(e.wch),e.wpx=$u(e.width),e.MDW=Nn),e.customWidth&&delete e.customWidth}var g9=96,l4=g9;function zu(e){return e*96/l4}function ql(e){return e*l4/96}var v9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function y9(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(jn)||[]).forEach(function(i){var o=kt(i);switch(Ss(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=fr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=fr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function _9(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(jn)||[]).forEach(function(i){var o=kt(i);switch(Ss(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function w9(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(jn)||[]).forEach(function(i){var o=kt(i);switch(Ss(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=rr(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?fr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?fr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?fr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?fr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?fr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?fr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?fr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=rv[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=fr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=go[a.color.index];a.color.index==81&&(l=go[1]),l||(l=go[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Ah(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function x9(e,t,r){t.NumberFmt=[];for(var n=Dr(_t),a=0;a<n.length;++a)t.NumberFmt[n[a]]=_t[n[a]];var s=e[0].match(jn);if(s)for(a=0;a<s.length;++a){var i=kt(s[a]);switch(Ss(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Vt(rr(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}zs(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function k9(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ge("numFmt",null,{numFmtId:n,formatCode:Qt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ge("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var fd=["numFmtId","fillId","fontId","borderId","xfId"],dd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function b9(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(jn)||[]).forEach(function(s){var i=kt(s),o=0;switch(Ss(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<fd.length;++o)n[fd[o]]&&(n[fd[o]]=parseInt(n[fd[o]],10));for(o=0;o<dd.length;++o)n[dd[o]]&&(n[dd[o]]=fr(n[dd[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=fr(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function S9(e){var t=[];return t[t.length]=Ge("cellXfs",null),e.forEach(function(r){t[t.length]=Ge("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ge("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var E9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&x9(d,u,c),(d=o.match(a))&&w9(d,u,l,c),(d=o.match(n))&&_9(d,u,l,c),(d=o.match(s))&&y9(d,u,l,c),(d=o.match(r))&&b9(d,u,c),u}}();function c4(e,t){var r=[Mr,Ge("styleSheet",null,{xmlns:Lo[0],"xmlns:vt":Yr.vt})],n;return e.SSF&&(n=k9(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=S9(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function T9(e,t){var r=e.read_shift(2),n=Dn(e);return[r,n]}function C9(e,t,r){r||(r=xe(6+4*t.length)),r.write_shift(2,e),on(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function N9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=cF(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=lF(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Dn(e),n}function A9(e,t){t||(t=xe(25+4*32)),t.write_shift(2,e.sz*20),uF(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Th(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),on(e.name,t),t.length>t.l?t.slice(0,t.l):t}var O9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],qp,I9=Rn;function Ix(e,t){t||(t=xe(4*3+8*7+16*1)),qp||(qp=k0(O9));var r=qp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Th({auto:1},t),Th({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function D9(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function u4(e,t,r){r||(r=xe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Oc(e,t){return t||(t=xe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var P9=Rn;function R9(e,t){return t||(t=xe(51)),t.write_shift(1,0),Oc(null,t),Oc(null,t),Oc(null,t),Oc(null,t),Oc(null,t),t.length>t.l?t.slice(0,t.l):t}function j9(e,t){return t||(t=xe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Eh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function F9(e,t,r){var n=xe(2052);return n.write_shift(4,e),Eh(t,n),Eh(r,n),n.length>n.l?n.slice(0,n.l):n}function L9(e,t,r){var n={};n.NumberFmt=[];for(var a in _t)n.NumberFmt[a]=_t[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return ei(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],zs(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Ah(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function M9(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(De(e,615,es(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&De(e,44,C9(a,t[a]))}),De(e,616))}}function B9(e){var t=1;De(e,611,es(t)),De(e,43,A9({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),De(e,612)}function $9(e){var t=2;De(e,603,es(t)),De(e,45,Ix({patternType:"none"})),De(e,45,Ix({patternType:"gray125"})),De(e,604)}function U9(e){var t=1;De(e,613,es(t)),De(e,46,R9()),De(e,614)}function z9(e){var t=1;De(e,626,es(t)),De(e,47,u4({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),De(e,627)}function V9(e,t){De(e,617,es(t.length)),t.forEach(function(r){De(e,47,u4(r,0))}),De(e,618)}function W9(e){var t=1;De(e,619,es(t)),De(e,48,j9({xfId:0,builtinId:0,name:"Normal"})),De(e,620)}function H9(e){var t=0;De(e,505,es(t)),De(e,506)}function K9(e){var t=0;De(e,508,F9(t,"TableStyleMedium9","PivotStyleMedium4")),De(e,509)}function q9(e,t){var r=ra();return De(r,278),M9(r,e.SSF),B9(r),$9(r),U9(r),z9(r),V9(r,t.cellXfs),W9(r),H9(r),K9(r),De(r,279),r.end()}var G9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function X9(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(jn)||[]).forEach(function(a){var s=kt(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[G9.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Z9(){}function Y9(){}var J9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Q9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tM(e,t,r){t.themeElements={};var n;[["clrScheme",J9,X9],["fontScheme",Q9,Z9],["fmtScheme",eM,Y9]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var rM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function f4(e,t){(!e||e.length===0)&&(e=Av());var r,n={};if(!(r=e.match(rM)))throw new Error("themeElements not found in theme");return tM(r[0],n,t),n.raw=e,n}function Av(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Mr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function nM(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=nE(s,{type:"array"})}catch{return}var o=fa(i,"theme/theme/theme1.xml",!0);if(o)return f4(o,r)}}function aM(e){return e.read_shift(4)}function sM(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=iM(e,4);break;case 2:t.xclrValue=WE(e);break;case 3:t.xclrValue=aM(e);break;case 4:e.l+=4;break}return e.l+=8,t}function iM(e,t){return Rn(e,t)}function oM(e,t){return Rn(e,t)}function lM(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=sM(e);break;case 6:n[1]=oM(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function cM(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(lM(e,r-e.l));return{ixfe:n,ext:s}}function uM(e,t){t.forEach(function(r){switch(r[0]){}})}function fM(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Dn(e)}}function dM(e){var t=xe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),on(e.name,t),t.slice(0,t.l)}function hM(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function pM(e){var t=xe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function mM(e,t){var r=xe(8+2*t.length);return r.write_shift(4,e),on(t,r),r.slice(0,r.l)}function gM(e){return e.l+=4,e.read_shift(4)!=0}function vM(e,t){var r=xe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function yM(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return ei(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function _M(){var e=ra();return De(e,332),De(e,334,es(1)),De(e,335,dM({name:"XLDAPR",version:12e4,flags:3496657072})),De(e,336),De(e,339,mM(1,"XLDAPR")),De(e,52),De(e,35,es(514)),De(e,4096,es(0)),De(e,4097,Ca(1)),De(e,36),De(e,53),De(e,340),De(e,337,vM(1)),De(e,51,pM([[1,0]])),De(e,338),De(e,333),e.end()}function wM(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(jn,function(o){var l=kt(o);switch(Ss(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function d4(){var e=[Mr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function xM(e){var t=[];if(!e)return t;var r=1;return(e.match(jn)||[]).forEach(function(n){var a=kt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function kM(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=xt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function bM(e,t,r){var n=[];return ei(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function SM(e,t,r,n){if(!e)return e;var a=n||{},s=!1;ei(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function EM(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Sl=1024;function h4(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ge("xml",null,{"xmlns:v":la.v,"xmlns:o":la.o,"xmlns:x":la.x,"xmlns:mv":la.mv}).replace(/\/>/,">"),Ge("o:shapelayout",Ge("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ge("v:shapetype",[Ge("v:stroke",null,{joinstyle:"miter"}),Ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Sl<e*1e3;)Sl+=1e3;return t.forEach(function(s){var i=kr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ge("v:fill",l,o),u={on:"t",obscured:"t"};++Sl,a=a.concat(["<v:shape"+Fu({id:"_x0000_s"+Sl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ge("v:shadow",null,u),Ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",gn("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),gn("x:AutoFill","False"),gn("x:Row",String(i.r)),gn("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Dx(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=kr(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=Wt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=It(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}s.c.push(u)})}function TM(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=kt(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=kr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Tv(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function p4(e){var t=[Mr,Ge("comments",null,{xmlns:Lo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Qt(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(Qt(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(gn("t",Qt(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(gn("t",Qt(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function CM(e,t){var r=[],n=!1,a={},s=0;return e.replace(jn,function(o,l){var c=kt(o);switch(Ss(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function NM(e,t,r){var n=[Mr,Ge("ThreadedComments",null,{xmlns:Yr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Ge("threadedComment",gn("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function AM(e,t){var r=[],n=!1;return e.replace(jn,function(s){var i=kt(s);switch(Ss(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function OM(e){var t=[Mr,Ge("personList",null,{xmlns:Yr.TCMNT,"xmlns:x":Lo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function IM(e){var t={};t.iauthor=e.read_shift(4);var r=Uo(e);return t.rfx=r.s,t.ref=xt(r.s),e.l+=16,t}function DM(e,t){return t==null&&(t=xe(36)),t.write_shift(4,e[1].iauthor),oc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var PM=Dn;function RM(e){return on(e.slice(0,54))}function jM(e,t){var r=[],n=[],a={},s=!1;return ei(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function FM(e){var t=ra(),r=[];return De(t,628),De(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),De(t,632,RM(a.a)))})}),De(t,631),De(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:kr(n[0]),e:kr(n[0])};De(t,635,DM([s,a])),a.t&&a.t.length>0&&De(t,637,aF(a)),De(t,636),delete a.iauthor})}),De(t,634),De(t,629),t.end()}var LM="application/vnd.ms-office.vbaProject";function MM(e){var t=ht.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ht.utils.cfb_add(t,a,e.FileIndex[n].content)}}),ht.write(t)}function BM(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&ht.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var m4=["xlsb","xlsm","xlam","biff8","xla"];function $M(){return{"!type":"dialog"}}function UM(){return{"!type":"dialog"}}function zM(){return{"!type":"macro"}}function VM(){return{"!type":"macro"}}var jl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+xr(u)+(l?"":"$")+Lr(c)}return function(a,s){return t=s,a.replace(e,r)}}(),Ov=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Iv=function(){return function(t,r){return t.replace(Ov,function(n,a,s,i,o,l){var c=vv(i)-(s?0:r.c),u=gv(l)-(o?0:r.r),d=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+d+"C"+h})}}();function g4(e,t){return e.replace(Ov,function(r,n,a,s,i,o){return n+(a=="$"?a+s:xr(vv(s)+t.c))+(i=="$"?i+o:Lr(gv(o)+t.r))})}function WM(e,t,r){var n=na(t),a=n.s,s=kr(r),i={r:s.r-a.r,c:s.c-a.c};return g4(e,i)}function HM(e){return e.length!=1}function Px(e){return e.replace(/_xlfn\./g,"")}function $r(e){e.l+=1}function Li(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function v4(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return y4(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Li(e),o=Li(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function y4(e){var t=Li(e),r=Li(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function KM(e,t,r){if(r.biff<8)return y4(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Li(e),i=Li(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function _4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return qM(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Li(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function qM(e){var t=Li(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function GM(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function XM(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ZM(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function ZM(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function YM(e,t,r){var n=(e[e.l++]&96)>>5,a=v4(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function JM(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=v4(e,s,r);return[n,a,i]}function QM(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function eB(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function tB(e,t,r){var n=(e[e.l++]&96)>>5,a=KM(e,t-1,r);return[n,a]}function rB(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Rx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function nB(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function aB(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function sB(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function iB(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function oB(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function w4(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function lB(e){return e.read_shift(2),w4(e)}function cB(e){return e.read_shift(2),w4(e)}function uB(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=_4(e,0,r);return[n,a]}function fB(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=XM(e,0,r);return[n,a]}function dB(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=_4(e,0,r);return[n,a,s]}function hB(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[g$[a],b4[a],n]}function pB(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:mB(e);return[a,(s[0]===0?b4:m$)[s[1]]]}function mB(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function gB(e,t,r){e.l+=r&&r.biff==2?3:4}function vB(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function yB(e){return e.l++,ti[e.read_shift(1)]}function _B(e){return e.l++,e.read_shift(2)}function wB(e){return e.l++,e.read_shift(1)!==0}function xB(e){return e.l++,An(e)}function kB(e,t,r){return e.l++,cf(e,t-1,r)}function bB(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Rr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ti[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=An(e);break;case 2:r[1]=zo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function SB(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Uo:E0)(e));return a}function EB(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=bB(e,r.biff);return i}function TB(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function CB(e,t,r){if(r.biff==5)return NB(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function NB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function AB(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function OB(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function IB(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function DB(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var PB=Rn,RB=Rn,jB=Rn;function ff(e,t,r){return e.l+=2,[GM(e)]}function Dv(e){return e.l+=6,[]}var FB=ff,LB=Dv,MB=Dv,BB=ff;function x4(e){return e.l+=2,[Vr(e),e.read_shift(2)&1]}var $B=ff,UB=x4,zB=Dv,VB=ff,WB=ff,HB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function KB(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=HB[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function qB(e){return e.l+=2,[e.read_shift(4)]}function GB(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function XB(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ZB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function YB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function JB(e){return e.l+=4,[0,0]}var jx={1:{n:"PtgExp",f:vB},2:{n:"PtgTbl",f:jB},3:{n:"PtgAdd",f:$r},4:{n:"PtgSub",f:$r},5:{n:"PtgMul",f:$r},6:{n:"PtgDiv",f:$r},7:{n:"PtgPower",f:$r},8:{n:"PtgConcat",f:$r},9:{n:"PtgLt",f:$r},10:{n:"PtgLe",f:$r},11:{n:"PtgEq",f:$r},12:{n:"PtgGe",f:$r},13:{n:"PtgGt",f:$r},14:{n:"PtgNe",f:$r},15:{n:"PtgIsect",f:$r},16:{n:"PtgUnion",f:$r},17:{n:"PtgRange",f:$r},18:{n:"PtgUplus",f:$r},19:{n:"PtgUminus",f:$r},20:{n:"PtgPercent",f:$r},21:{n:"PtgParen",f:$r},22:{n:"PtgMissArg",f:$r},23:{n:"PtgStr",f:kB},26:{n:"PtgSheet",f:GB},27:{n:"PtgEndSheet",f:XB},28:{n:"PtgErr",f:yB},29:{n:"PtgBool",f:wB},30:{n:"PtgInt",f:_B},31:{n:"PtgNum",f:xB},32:{n:"PtgArray",f:rB},33:{n:"PtgFunc",f:hB},34:{n:"PtgFuncVar",f:pB},35:{n:"PtgName",f:TB},36:{n:"PtgRef",f:uB},37:{n:"PtgArea",f:YM},38:{n:"PtgMemArea",f:AB},39:{n:"PtgMemErr",f:PB},40:{n:"PtgMemNoMem",f:RB},41:{n:"PtgMemFunc",f:OB},42:{n:"PtgRefErr",f:IB},43:{n:"PtgAreaErr",f:QM},44:{n:"PtgRefN",f:fB},45:{n:"PtgAreaN",f:tB},46:{n:"PtgMemAreaN",f:ZB},47:{n:"PtgMemNoMemN",f:YB},57:{n:"PtgNameX",f:CB},58:{n:"PtgRef3d",f:dB},59:{n:"PtgArea3d",f:JM},60:{n:"PtgRefErr3d",f:DB},61:{n:"PtgAreaErr3d",f:eB},255:{}},QB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},e$={1:{n:"PtgElfLel",f:x4},2:{n:"PtgElfRw",f:VB},3:{n:"PtgElfCol",f:FB},6:{n:"PtgElfRwV",f:WB},7:{n:"PtgElfColV",f:BB},10:{n:"PtgElfRadical",f:$B},11:{n:"PtgElfRadicalS",f:zB},13:{n:"PtgElfColS",f:LB},15:{n:"PtgElfColSV",f:MB},16:{n:"PtgElfRadicalLel",f:UB},25:{n:"PtgList",f:KB},29:{n:"PtgSxName",f:qB},255:{}},t$={0:{n:"PtgAttrNoop",f:JB},1:{n:"PtgAttrSemi",f:oB},2:{n:"PtgAttrIf",f:sB},4:{n:"PtgAttrChoose",f:nB},8:{n:"PtgAttrGoto",f:aB},16:{n:"PtgAttrSum",f:gB},32:{n:"PtgAttrBaxcel",f:Rx},33:{n:"PtgAttrBaxcel",f:Rx},64:{n:"PtgAttrSpace",f:lB},65:{n:"PtgAttrSpaceSemi",f:cB},128:{n:"PtgAttrIfError",f:iB},255:{}};function df(e,t,r,n){if(n.biff<8)return Rn(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=EB(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=SB(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Rn(e,t)),s}function hf(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=jx[s]||jx[QB[s]],(s===24||s===25)&&(a=(s===24?e$:t$)[e[e.l+1]]),!a||!a.f?Rn(e,t):i.push([a.n,a.f(e,t,r)]);return i}function r$(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var n$={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function a$(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function k4(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Fx(e,t,r){var n=k4(e,t,r);return n=="#REF"?n:a$(n,r)}function Tn(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,d=0,h=0,v,y="";if(!e[0]||!e[0][0])return"";for(var p=-1,_="",x=0,k=e[0].length;x<k;++x){var w=e[0][x];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:_=Ar(" ",e[0][p][1][1]);break;case 1:_=Ar("\r",e[0][p][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+_,p=-1}o.push(c+n$[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=su(w[1][1],i,a),o.push(iu(u,s));break;case"PtgRefN":u=r?su(w[1][1],r,a):w[1][1],o.push(iu(u,s));break;case"PtgRef3d":d=w[1][1],u=su(w[1][2],i,a),y=Fx(n,d,a),o.push(y+"!"+iu(u,s));break;case"PtgFunc":case"PtgFuncVar":var E=w[1][0],I=w[1][1];E||(E=0),E&=127;var D=E==0?[]:o.slice(-E);o.length-=E,I==="User"&&(I=D.shift()),o.push(I+"("+D.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":v=fx(w[1][1],r?{s:r}:i,a),o.push(Vp(v,a));break;case"PtgArea":v=fx(w[1][1],i,a),o.push(Vp(v,a));break;case"PtgArea3d":d=w[1][1],v=w[1][2],y=Fx(n,d,a),o.push(y+"!"+Vp(v,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var C=(n.names||[])[h-1]||(n[0]||[])[h],V=C?C.Name:"SH33TJSNAME"+String(h);V&&V.slice(0,6)=="_xlfn."&&!a.xlfn&&(V=V.slice(6)),o.push(V);break;case"PtgNameX":var z=w[1][1];h=w[1][2];var ee;if(a.biff<=5)z<0&&(z=-z),n[z]&&(ee=n[z][h]);else{var re="";if(((n[z]||[])[0]||[])[0]==14849||(((n[z]||[])[0]||[])[0]==1025?n[z][h]&&n[z][h].itab>0&&(re=n.SheetNames[n[z][h].itab-1]+"!"):re=n.SheetNames[h-1]+"!"),n[z]&&n[z][h])re+=n[z][h].Name;else if(n[0]&&n[0][h])re+=n[0][h].Name;else{var G=(k4(n,z,a)||"").split(";;");G[h-1]?re=G[h-1]:re+="SH33TJSERRX"}o.push(re);break}ee||(ee={Name:"SH33TJSERRY"}),o.push(ee.Name);break;case"PtgParen":var me="(",Ee=")";if(p>=0){switch(_="",e[0][p][1][0]){case 2:me=Ar(" ",e[0][p][1][1])+me;break;case 3:me=Ar("\r",e[0][p][1][1])+me;break;case 4:Ee=Ar(" ",e[0][p][1][1])+Ee;break;case 5:Ee=Ar("\r",e[0][p][1][1])+Ee;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(me+o.pop()+Ee);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var Ae={c:r.c,r:r.r};if(n.sharedf[xt(u)]){var ke=n.sharedf[xt(u)];o.push(Tn(ke,i,Ae,n,a))}else{var Oe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Tn(c[1],i,Ae,n,a)),Oe=!0;break}Oe||o.push(w[1])}break;case"PtgArray":o.push("{"+r$(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&Ce.indexOf(e[0][x][0])==-1){w=e[0][p];var Z=!0;switch(w[1][0]){case 4:Z=!1;case 0:_=Ar(" ",w[1][1]);break;case 5:Z=!1;case 1:_=Ar("\r",w[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((Z?_:"")+o.pop()+(Z?"":_)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function s$(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Rn(e,t-2)];var o=hf(e,i,r);return t!==i+a&&(s=df(e,t-i-a,o,r)),e.l=n,[o,s]}function i$(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Rn(e,t-2)];var o=hf(e,i,r);return t!==i+a&&(s=df(e,t-i-a,o,r)),e.l=n,[o,s]}function o$(e,t,r,n){var a=e.l+t,s=hf(e,n,r),i;return a!==e.l&&(i=df(e,a-e.l,s,r)),[s,i]}function l$(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=hf(e,s,r);return s==65535?[[],Rn(e,t-2)]:(t!==s+2&&(a=df(e,n-s-2,i,r)),[i,a])}function c$(e){var t;if(Ms(e,e.l+6)!==65535)return[An(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function u$(e){if(e==null){var t=xe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ao(e);return Ao(0)}function Gp(e,t,r){var n=e.l+t,a=Es(e);r.biff==2&&++e.l;var s=c$(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=i$(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function f$(e,t,r,n,a){var s=Io(t,r,a),i=u$(e.v),o=xe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=xe(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var d=sn([s,i,o,c]);return d}function T0(e,t,r){var n=e.read_shift(4),a=hf(e,n,r),s=e.read_shift(4),i=s>0?df(e,s,a,r):null;return[a,i]}var d$=T0,C0=T0,h$=T0,p$=T0,m$={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},b4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},g$={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Lx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function v$(e){var t="of:="+e.replace(Ov,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Xp(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function y$(e){return e.replace(/\./,"!")}var lu={},Fl={},cu=typeof Map<"u";function Pv(e,t,r){var n=0,a=e.length;if(r){if(cu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=cu?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(cu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function N0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Nn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Uu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Oh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function _o(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Zi(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){zs(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function S4(e,t,r,n,a,s){try{n.cellNF&&(e.z=_t[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=hr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(_t[t]==null&&zs(mj[t]||"General",t),e.t==="e")e.w=e.w||ti[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ru(e.v);else if(e.t==="d"){var i=Qr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Ru(i)}else{if(e.v===void 0)return"";e.w=Co(e.v,Fl)}else e.t==="d"?e.w=ja(t,Qr(e.v),Fl):e.w=ja(t,e.v,Fl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ah(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ah(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function _$(e,t,r){if(e&&e["!ref"]){var n=Wt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function w$(e,t){var r=Wt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=It(r))}var x$=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,k$=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,b$=/<(?:\w:)?hyperlink [^>]*>/mg,S$=/"(\w*:\w*)"/,E$=/<(?:\w:)?col\b[^>]*[\/]?>/g,T$=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,C$=/<(?:\w:)?pageMargins[^>]*\/>/g,E4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,N$=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,A$=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function O$(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(k$);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(E4);h?Rv(h[0],o,a,r):(h=c.match(N$))&&D$(h[0],h[1]||"",o,a,r);var v=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var y=c.slice(v,v+50).match(S$);y&&w$(o,y[1])}var p=c.match(A$);p&&p[1]&&H$(p[1],a);var _=[];if(t.cellStyles){var x=c.match(E$);x&&$$(_,x)}d&&G$(d[1],o,t,l,s,i);var k=u.match(T$);k&&(o["!autofilter"]=z$(k[0]));var w=[],E=u.match(x$);if(E)for(v=0;v!=E.length;++v)w[v]=Wt(E[v].slice(E[v].indexOf('"')+1));var I=u.match(b$);I&&L$(o,I,n);var D=u.match(C$);if(D&&(o["!margins"]=M$(kt(D[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=It(l)),t.sheetRows>0&&o["!ref"]){var C=Wt(o["!ref"]);t.sheetRows<=+C.e.r&&(C.e.r=t.sheetRows-1,C.e.r>l.e.r&&(C.e.r=l.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>l.e.c&&(C.e.c=l.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),o["!fullref"]=o["!ref"],o["!ref"]=It(C))}return _.length>0&&(o["!cols"]=_),w.length>0&&(o["!merges"]=w),o}function I$(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+It(e[r])+'"/>';return t+"</mergeCells>"}function Rv(e,t,r,n){var a=kt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Vt(rr(a.codeName)))}function D$(e,t,r,n,a){Rv(e.slice(0,e.indexOf(">")),r,n,a)}function P$(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,i.codeName=ws(Qt(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Ge("outlinePr",null,c)}!s&&!o||(a[a.length]=Ge("sheetPr",o,i))}var R$=["objects","scenarios","selectLockedCells","selectUnlockedCells"],j$=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function F$(e){var t={sheet:1};return R$.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),j$.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Cv(e.password).toString(16).toUpperCase()),Ge("sheetProtection",null,t)}function L$(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=kt(rr(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Vt(s.location))):(s.Target="#"+Vt(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Wt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=xt({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function M$(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function B$(e){return _o(e),Ge("pageMargins",null,e)}function $$(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=kt(t[n],!0);a.hidden&&(a.hidden=fr(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Nv(a.width)),Fi(a);s<=i;)e[s++]=pr(a)}}function U$(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ge("col",null,N0(a,n)));return r[r.length]="</cols>",r.join("")}function z$(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function V$(e,t,r,n){var a=typeof e.ref=="string"?e.ref:It(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=na(a);i.s.r==i.e.r&&(i.e.r=na(t["!ref"]).e.r,a=It(i));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ge("autoFilter",null,{ref:a})}var W$=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function H$(e,t){t.Views||(t.Views=[{}]),(e.match(W$)||[]).forEach(function(r,n){var a=kt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),fr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function K$(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ge("sheetViews",Ge("sheetView",null,a),{})}function q$(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=ti[e.v];break;case"d":n&&n.cellDates?a=hr(e.v,-1).toISOString():(e=pr(e),e.t="n",a=""+(e.v=Qr(hr(e.v)))),typeof e.z>"u"&&(e.z=_t[14]);break;default:a=e.v;break}var o=gn("v",Qt(a)),l={r:t},c=Zi(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=gn("v",""+Pv(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ge("f",Qt(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Ge("c",o,l)}var G$=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=ju("v"),i=ju("f");return function(l,c,u,d,h,v){for(var y=0,p="",_=[],x=[],k=0,w=0,E=0,I="",D,C,V=0,z=0,ee,re,G=0,me=0,Ee=Array.isArray(v.CellXf),Ae,ke=[],Oe=[],Ce=Array.isArray(c),Z=[],Se={},Ve=!1,B=!!u.sheetStubs,J=l.split(t),K=0,X=J.length;K!=X;++K){p=J[K].trim();var ge=p.length;if(ge!==0){var Pe=0;e:for(y=0;y<ge;++y)switch(p[y]){case">":if(p[y-1]!="/"){++y;break e}if(u&&u.cellStyles){if(C=kt(p.slice(Pe,y),!0),V=C.r!=null?parseInt(C.r,10):V+1,z=-1,u.sheetRows&&u.sheetRows<V)continue;Se={},Ve=!1,C.ht&&(Ve=!0,Se.hpt=parseFloat(C.ht),Se.hpx=ql(Se.hpt)),C.hidden=="1"&&(Ve=!0,Se.hidden=!0),C.outlineLevel!=null&&(Ve=!0,Se.level=+C.outlineLevel),Ve&&(Z[V-1]=Se)}break;case"<":Pe=y;break}if(Pe>=y)break;if(C=kt(p.slice(Pe,y),!0),V=C.r!=null?parseInt(C.r,10):V+1,z=-1,!(u.sheetRows&&u.sheetRows<V)){d.s.r>V-1&&(d.s.r=V-1),d.e.r<V-1&&(d.e.r=V-1),u&&u.cellStyles&&(Se={},Ve=!1,C.ht&&(Ve=!0,Se.hpt=parseFloat(C.ht),Se.hpx=ql(Se.hpt)),C.hidden=="1"&&(Ve=!0,Se.hidden=!0),C.outlineLevel!=null&&(Ve=!0,Se.level=+C.outlineLevel),Ve&&(Z[V-1]=Se)),_=p.slice(y).split(e);for(var je=0;je!=_.length&&_[je].trim().charAt(0)=="<";++je);for(_=_.slice(je),y=0;y!=_.length;++y)if(p=_[y].trim(),p.length!==0){if(x=p.match(r),k=y,w=0,E=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,x!=null&&x.length===2){for(k=0,I=x[1],w=0;w!=I.length&&!((E=I.charCodeAt(w)-64)<1||E>26);++w)k=26*k+E;--k,z=k}else++z;for(w=0;w!=p.length&&p.charCodeAt(w)!==62;++w);if(++w,C=kt(p.slice(0,w),!0),C.r||(C.r=xt({r:V-1,c:z})),I=p.slice(w),D={t:""},(x=I.match(s))!=null&&x[1]!==""&&(D.v=Vt(x[1])),u.cellFormula){if((x=I.match(i))!=null&&x[1]!==""){if(D.f=Vt(rr(x[1])).replace(/\r\n/g,`
`),u.xlfn||(D.f=Px(D.f)),x[0].indexOf('t="array"')>-1)D.F=(I.match(a)||[])[1],D.F.indexOf(":")>-1&&ke.push([Wt(D.F),D.F]);else if(x[0].indexOf('t="shared"')>-1){re=kt(x[0]);var ce=Vt(rr(x[1]));u.xlfn||(ce=Px(ce)),Oe[parseInt(re.si,10)]=[re,ce,C.r]}}else(x=I.match(/<f[^>]*\/>/))&&(re=kt(x[0]),Oe[re.si]&&(D.f=WM(Oe[re.si][1],Oe[re.si][2],C.r)));var Te=kr(C.r);for(w=0;w<ke.length;++w)Te.r>=ke[w][0].s.r&&Te.r<=ke[w][0].e.r&&Te.c>=ke[w][0].s.c&&Te.c<=ke[w][0].e.c&&(D.F=ke[w][1])}if(C.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(B)D.t="z";else continue;else D.t=C.t||"n";switch(d.s.c>z&&(d.s.c=z),d.e.c<z&&(d.e.c=z),D.t){case"n":if(D.v==""||D.v==null){if(!B)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!B)continue;D.t="z"}else ee=lu[parseInt(D.v,10)],D.v=ee.t,D.r=ee.r,u.cellHTML&&(D.h=ee.h);break;case"str":D.t="s",D.v=D.v!=null?rr(D.v):"",u.cellHTML&&(D.h=dv(D.v));break;case"inlineStr":x=I.match(n),D.t="s",x!=null&&(ee=Tv(x[1]))?(D.v=ee.t,u.cellHTML&&(D.h=ee.h)):D.v="";break;case"b":D.v=fr(D.v);break;case"d":u.cellDates?D.v=hr(D.v,1):(D.v=Qr(hr(D.v,1)),D.t="n");break;case"e":(!u||u.cellText!==!1)&&(D.w=D.v),D.v=CE[D.v];break}if(G=me=0,Ae=null,Ee&&C.s!==void 0&&(Ae=v.CellXf[C.s],Ae!=null&&(Ae.numFmtId!=null&&(G=Ae.numFmtId),u.cellStyles&&Ae.fillId!=null&&(me=Ae.fillId))),S4(D,G,me,u,h,v),u.cellDates&&Ee&&D.t=="n"&&ac(_t[G])&&(D.t="d",D.v=S0(D.v)),C.cm&&u.xlmeta){var dt=(u.xlmeta.Cell||[])[+C.cm-1];dt&&dt.type=="XLDAPR"&&(D.D=!0)}if(Ce){var N=kr(C.r);c[N.r]||(c[N.r]=[]),c[N.r][N.c]=D}else c[C.r]=D}}}}Z.length>0&&(c["!rows"]=Z)}}();function X$(e,t,r,n){var a=[],s=[],i=Wt(e["!ref"]),o="",l,c="",u=[],d=0,h=0,v=e["!rows"],y=Array.isArray(e),p={r:c},_,x=-1;for(h=i.s.c;h<=i.e.c;++h)u[h]=xr(h);for(d=i.s.r;d<=i.e.r;++d){for(s=[],c=Lr(d),h=i.s.c;h<=i.e.c;++h){l=u[h]+c;var k=y?(e[d]||[])[h]:e[l];k!==void 0&&(o=q$(k,l,e,t))!=null&&s.push(o)}(s.length>0||v&&v[d])&&(p={r:c},v&&v[d]&&(_=v[d],_.hidden&&(p.hidden=1),x=-1,_.hpx?x=zu(_.hpx):_.hpt&&(x=_.hpt),x>-1&&(p.ht=x,p.customHeight=1),_.level&&(p.outlineLevel=_.level)),a[a.length]=Ge("row",s.join(""),p))}if(v)for(;d<v.length;++d)v&&v[d]&&(p={r:d+1},_=v[d],_.hidden&&(p.hidden=1),x=-1,_.hpx?x=zu(_.hpx):_.hpt&&(x=_.hpt),x>-1&&(p.ht=x,p.customHeight=1),_.level&&(p.outlineLevel=_.level),a[a.length]=Ge("row","",p));return a.join("")}function T4(e,t,r,n){var a=[Mr,Ge("worksheet",null,{xmlns:Lo[0],"xmlns:r":Yr.r})],s=r.SheetNames[e],i=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=Wt(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=It(u)}n||(n={}),l["!comments"]=[];var d=[];P$(l,r,e,t,a),a[a.length]=Ge("dimension",null,{ref:c}),a[a.length]=K$(l,t,e,r),t.sheetFormat&&(a[a.length]=Ge("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=U$(l,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=X$(l,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=F$(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=V$(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=I$(l["!merges"]));var h=-1,v,y=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(v={ref:p[0]},p[1].Target.charAt(0)!="#"&&(y=Yt(n,-1,Qt(p[1].Target).replace(/#.*$/,""),Rt.HLINK),v["r:id"]="rId"+y),(h=p[1].Target.indexOf("#"))>-1&&(v.location=Qt(p[1].Target.slice(h+1))),p[1].Tooltip&&(v.tooltip=Qt(p[1].Tooltip)),a[a.length]=Ge("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=B$(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=gn("ignoredErrors",Ge("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(y=Yt(n,-1,"../drawings/drawing"+(e+1)+".xml",Rt.DRAW),a[a.length]=Ge("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=d),l["!comments"].length>0&&(y=Yt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Rt.VML),a[a.length]=Ge("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Z$(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function Y$(e,t,r){var n=xe(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=zu(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,v=u<<10;v<u+1<<10;++v){c.c=v;var y=Array.isArray(r)?(r[c.r]||[])[c.c]:r[xt(c)];y&&(d<0&&(d=v),h=v)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function J$(e,t,r,n){var a=Y$(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&De(e,0,a)}var Q$=Uo,eU=oc;function tU(){}function rU(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=sF(e),r}function nU(e,t,r){r==null&&(r=xe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Th({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),kE(e,r),r.slice(0,r.l)}function aU(e){var t=La(e);return[t]}function sU(e,t,r){return r==null&&(r=xe(8)),Mo(t,r)}function iU(e){var t=Bo(e);return[t]}function oU(e,t,r){return r==null&&(r=xe(4)),$o(t,r)}function lU(e){var t=La(e),r=e.read_shift(1);return[t,r,"b"]}function cU(e,t,r){return r==null&&(r=xe(9)),Mo(t,r),r.write_shift(1,e.v?1:0),r}function uU(e){var t=Bo(e),r=e.read_shift(1);return[t,r,"b"]}function fU(e,t,r){return r==null&&(r=xe(5)),$o(t,r),r.write_shift(1,e.v?1:0),r}function dU(e){var t=La(e),r=e.read_shift(1);return[t,r,"e"]}function hU(e,t,r){return r==null&&(r=xe(9)),Mo(t,r),r.write_shift(1,e.v),r}function pU(e){var t=Bo(e),r=e.read_shift(1);return[t,r,"e"]}function mU(e,t,r){return r==null&&(r=xe(8)),$o(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function gU(e){var t=La(e),r=e.read_shift(4);return[t,r,"s"]}function vU(e,t,r){return r==null&&(r=xe(12)),Mo(t,r),r.write_shift(4,t.v),r}function yU(e){var t=Bo(e),r=e.read_shift(4);return[t,r,"s"]}function _U(e,t,r){return r==null&&(r=xe(8)),$o(t,r),r.write_shift(4,t.v),r}function wU(e){var t=La(e),r=An(e);return[t,r,"n"]}function xU(e,t,r){return r==null&&(r=xe(16)),Mo(t,r),Ao(e.v,r),r}function C4(e){var t=Bo(e),r=An(e);return[t,r,"n"]}function kU(e,t,r){return r==null&&(r=xe(12)),$o(t,r),Ao(e.v,r),r}function bU(e){var t=La(e),r=xv(e);return[t,r,"n"]}function SU(e,t,r){return r==null&&(r=xe(12)),Mo(t,r),bE(e.v,r),r}function EU(e){var t=Bo(e),r=xv(e);return[t,r,"n"]}function TU(e,t,r){return r==null&&(r=xe(8)),$o(t,r),bE(e.v,r),r}function CU(e){var t=La(e),r=yv(e);return[t,r,"is"]}function NU(e){var t=La(e),r=Dn(e);return[t,r,"str"]}function AU(e,t,r){return r==null&&(r=xe(12+4*e.v.length)),Mo(t,r),on(e.v,r),r.length>r.l?r.slice(0,r.l):r}function OU(e){var t=Bo(e),r=Dn(e);return[t,r,"str"]}function IU(e,t,r){return r==null&&(r=xe(8+4*e.v.length)),$o(t,r),on(e.v,r),r.length>r.l?r.slice(0,r.l):r}function DU(e,t,r){var n=e.l+t,a=La(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=C0(e,n-e.l,r);i[3]=Tn(o,null,a,r.supbooks,r)}else e.l=n;return i}function PU(e,t,r){var n=e.l+t,a=La(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=C0(e,n-e.l,r);i[3]=Tn(o,null,a,r.supbooks,r)}else e.l=n;return i}function RU(e,t,r){var n=e.l+t,a=La(e);a.r=r["!row"];var s=An(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=C0(e,n-e.l,r);i[3]=Tn(o,null,a,r.supbooks,r)}else e.l=n;return i}function jU(e,t,r){var n=e.l+t,a=La(e);a.r=r["!row"];var s=Dn(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=C0(e,n-e.l,r);i[3]=Tn(o,null,a,r.supbooks,r)}else e.l=n;return i}var FU=Uo,LU=oc;function MU(e,t){return t==null&&(t=xe(4)),t.write_shift(4,e),t}function BU(e,t){var r=e.l+t,n=Uo(e),a=_v(e),s=Dn(e),i=Dn(e),o=Dn(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function $U(e,t){var r=xe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));oc({s:kr(e[0]),e:kr(e[0])},r),wv("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return on(a||"",r),on(e[1].Tooltip||"",r),on("",r),r.slice(0,r.l)}function UU(){}function zU(e,t,r){var n=e.l+t,a=SE(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=d$(e,n-e.l,r);i[1]=o}else e.l=n;return i}function VU(e,t,r){var n=e.l+t,a=Uo(e),s=[a];if(r.cellFormula){var i=p$(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function WU(e,t,r){r==null&&(r=xe(18));var n=N0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var N4=["left","right","top","bottom","header","footer"];function HU(e){var t={};return N4.forEach(function(r){t[r]=An(e)}),t}function KU(e,t){return t==null&&(t=xe(6*8)),_o(e),N4.forEach(function(r){Ao(e[r],t)}),t}function qU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function GU(e,t,r){r==null&&(r=xe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function XU(e){var t=xe(24);return t.write_shift(4,4),t.write_shift(4,1),oc(e,t),t}function ZU(e,t){return t==null&&(t=xe(16*4+2)),t.write_shift(2,e.password?Cv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function YU(){}function JU(){}function QU(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,v,y,p,_,x,k,w,E,I,D=[];o.biff=12,o["!row"]=0;var C=0,V=!1,z=[],ee={},re=o.supbooks||a.supbooks||[[]];if(re.sharedf=ee,re.arrayf=z,re.SheetNames=a.SheetNames||a.Sheets.map(function(Ce){return Ce.name}),!o.supbooks&&(o.supbooks=re,a.Names))for(var G=0;G<a.Names.length;++G)re[0][G+1]=a.Names[G];var me=[],Ee=[],Ae=!1;Vu[16]={n:"BrtShortReal",f:C4};var ke;if(ei(e,function(Z,Se,Ve){if(!h)switch(Ve){case 148:c=Z;break;case 0:v=Z,o.sheetRows&&o.sheetRows<=v.r&&(h=!0),E=Lr(_=v.r),o["!row"]=v.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=ql(Z.hpt)),Ee[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Z[2]},Z[2]){case"n":y.v=Z[1];break;case"s":w=lu[Z[1]],y.v=w.t,y.r=w.r;break;case"b":y.v=!!Z[1];break;case"e":y.v=Z[1],o.cellText!==!1&&(y.w=ti[y.v]);break;case"str":y.t="s",y.v=Z[1];break;case"is":y.t="s",y.v=Z[1].t;break}if((p=i.CellXf[Z[0].iStyleRef])&&S4(y,p.numFmtId,null,o,s,i),x=Z[0].c==-1?x+1:Z[0].c,o.dense?(l[_]||(l[_]=[]),l[_][x]=y):l[xr(x)+E]=y,o.cellFormula){for(V=!1,C=0;C<z.length;++C){var B=z[C];v.r>=B[0].s.r&&v.r<=B[0].e.r&&x>=B[0].s.c&&x<=B[0].e.c&&(y.F=It(B[0]),V=!0)}!V&&Z.length>3&&(y.f=Z[3])}if(u.s.r>v.r&&(u.s.r=v.r),u.s.c>x&&(u.s.c=x),u.e.r<v.r&&(u.e.r=v.r),u.e.c<x&&(u.e.c=x),o.cellDates&&p&&y.t=="n"&&ac(_t[p.numFmtId])){var J=ho(y.v);J&&(y.t="d",y.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}ke&&(ke.type=="XLDAPR"&&(y.D=!0),ke=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;y={t:"z",v:void 0},x=Z[0].c==-1?x+1:Z[0].c,o.dense?(l[_]||(l[_]=[]),l[_][x]=y):l[xr(x)+E]=y,u.s.r>v.r&&(u.s.r=v.r),u.s.c>x&&(u.s.c=x),u.e.r<v.r&&(u.e.r=v.r),u.e.c<x&&(u.e.c=x),ke&&(ke.type=="XLDAPR"&&(y.D=!0),ke=void 0);break;case 176:D.push(Z);break;case 49:ke=((o.xlmeta||{}).Cell||[])[Z-1];break;case 494:var K=n["!id"][Z.relId];for(K?(Z.Target=K.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=K):Z.relId==""&&(Z.Target="#"+Z.loc),_=Z.rfx.s.r;_<=Z.rfx.e.r;++_)for(x=Z.rfx.s.c;x<=Z.rfx.e.c;++x)o.dense?(l[_]||(l[_]=[]),l[_][x]||(l[_][x]={t:"z",v:void 0}),l[_][x].l=Z):(k=xt({c:x,r:_}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=Z);break;case 426:if(!o.cellFormula)break;z.push(Z),I=o.dense?l[_][x]:l[xr(x)+E],I.f=Tn(Z[1],u,{r:v.r,c:x},re,o),I.F=It(Z[0]);break;case 427:if(!o.cellFormula)break;ee[xt(Z[0].s)]=Z[1],I=o.dense?l[_][x]:l[xr(x)+E],I.f=Tn(Z[1],u,{r:v.r,c:x},re,o);break;case 60:if(!o.cellStyles)break;for(;Z.e>=Z.s;)me[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},Ae||(Ae=!0,Nv(Z.w/256)),Fi(me[Z.e+1]);break;case 161:l["!autofilter"]={ref:It(Z)};break;case 476:l["!margins"]=Z;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),Z.name&&(a.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(l["!outline"]={above:Z.above,left:Z.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Z.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!Se.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+Ve.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=It(c||u)),o.sheetRows&&l["!ref"]){var Oe=Wt(l["!ref"]);o.sheetRows<=+Oe.e.r&&(Oe.e.r=o.sheetRows-1,Oe.e.r>u.e.r&&(Oe.e.r=u.e.r),Oe.e.r<Oe.s.r&&(Oe.s.r=Oe.e.r),Oe.e.c>u.e.c&&(Oe.e.c=u.e.c),Oe.e.c<Oe.s.c&&(Oe.s.c=Oe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=It(Oe))}return D.length>0&&(l["!merges"]=D),me.length>0&&(l["!cols"]=me),Ee.length>0&&(l["!rows"]=Ee),l}function ez(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=pr(t),t.z=t.z||_t[14],t.v=Qr(hr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Zi(a.cellXfs,t,a),t.l&&s["!links"].push([xt(l),t.l]),t.c&&s["!comments"].push([xt(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Pv(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?De(e,18,_U(t,l)):De(e,7,vU(t,l))):(l.t="str",i?De(e,17,IU(t,l)):De(e,6,AU(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?De(e,13,TU(t,l)):De(e,2,SU(t,l)):i?De(e,16,kU(t,l)):De(e,5,xU(t,l)),!0;case"b":return l.t="b",i?De(e,15,fU(t,l)):De(e,4,cU(t,l)),!0;case"e":return l.t="e",i?De(e,14,mU(t,l)):De(e,3,hU(t,l)),!0}return i?De(e,12,oU(t,l)):De(e,1,sU(t,l)),!0}function tz(e,t,r,n){var a=Wt(t["!ref"]||"A1"),s,i="",o=[];De(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u){i=Lr(u),J$(e,t,a,u);var d=!1;if(u<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){u===a.s.r&&(o[h]=xr(h)),s=o[h]+i;var v=l?(t[u]||[])[h]:t[s];if(!v){d=!1;continue}d=ez(e,v,u,h,n,t,d)}}De(e,146)}function rz(e,t){!t||!t["!merges"]||(De(e,177,MU(t["!merges"].length)),t["!merges"].forEach(function(r){De(e,176,LU(r))}),De(e,178))}function nz(e,t){!t||!t["!cols"]||(De(e,390),t["!cols"].forEach(function(r,n){r&&De(e,60,WU(n,r))}),De(e,391))}function az(e,t){!t||!t["!ref"]||(De(e,648),De(e,649,XU(Wt(t["!ref"]))),De(e,650))}function sz(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Yt(r,-1,n[1].Target.replace(/#.*$/,""),Rt.HLINK);De(e,494,$U(n,a))}}),delete t["!links"]}function iz(e,t,r,n){if(t["!comments"].length>0){var a=Yt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Rt.VML);De(e,551,wv("rId"+a)),t["!legacy"]=a}}function oz(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:It(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=na(s);o.s.r==o.e.r&&(o.e.r=na(t["!ref"]).e.r,s=It(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),De(e,161,oc(Wt(s))),De(e,162)}}function lz(e,t,r){De(e,133),De(e,137,GU(t,r)),De(e,138),De(e,134)}function cz(e,t){t["!protect"]&&De(e,535,ZU(t["!protect"]))}function uz(e,t,r,n){var a=ra(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=Wt(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],De(a,129),(r.vbaraw||i["!outline"])&&De(a,147,nU(o,i["!outline"])),De(a,148,eU(l)),lz(a,i,r.Workbook),nz(a,i),tz(a,i,e,t),cz(a,i),oz(a,i,r,e),rz(a,i),sz(a,i,n),i["!margins"]&&De(a,476,KU(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&az(a,i),iz(a,i,e,n),De(a,130),a.end()}function fz(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=Vt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function dz(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=fz(d);u.s.r=u.s.c=0,u.e.c=o,c=xr(o),h[0].forEach(function(v,y){i[c+Lr(y)]={t:"n",v,z:h[1]},l=y}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=It(u)),i}function hz(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(E4);return o&&Rv(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function pz(e,t){e.l+=10;var r=Dn(e);return{name:r}}function mz(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ei(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var jv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],gz=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],vz=[],yz=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Mx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=fr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Bx(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=fr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function A4(e){Bx(e.WBProps,jv),Bx(e.CalcPr,yz),Mx(e.WBView,gz),Mx(e.Sheets,vz),Fl.date1904=fr(e.WBProps.date1904)}function _z(e){return!e.Workbook||!e.Workbook.WBProps?"false":fr(e.Workbook.WBProps.date1904)?"true":"false"}var wz="][*?/\\".split("");function O4(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return wz.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function xz(e,t,r){e.forEach(function(n,a){O4(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function kz(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];xz(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)_$(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var bz=/<\w+:workbook/;function Sz(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(jn,function(l,c){var u=kt(l);switch(Ss(u[0])){case"<?xml":break;case"<workbook":l.match(bz)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jv.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=fr(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=rr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Vt(rr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=rr(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),fr(u.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=Vt(rr(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Lo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return A4(r),r}function I4(e){var t=[Mr];t[t.length]=Ge("workbook",null,{xmlns:Lo[0],"xmlns:r":Yr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(jv.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ge("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:Qt(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Ge("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Ge("definedName",Qt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Ez(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=kg(e),r.name=Dn(e),r}function Tz(e,t){return t||(t=xe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),wv(e.strRelID,t),on(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Cz(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Dn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Nz(e,t){t||(t=xe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),kE(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Az(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Oz(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=iF(e),i=h$(e,0,r),o=_v(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function Iz(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Vu[16]={n:"BrtFRTArchID$",f:Az},ei(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Tn(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),A4(r),r.Names=s,r.supbooks=i,r}function Dz(e,t){De(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};De(e,156,Tz(a))}De(e,144)}function Pz(e,t){t||(t=xe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return on("SheetJS",t),on(_h.version,t),on(_h.version,t),on("7262",t),t.length>t.l?t.slice(0,t.l):t}function Rz(e,t){t||(t=xe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function jz(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(De(e,135),De(e,158,Rz(a)),De(e,136))}}function Fz(e,t){var r=ra();return De(r,131),De(r,128,Pz()),De(r,153,Nz(e.Workbook&&e.Workbook.WBProps||null)),jz(r,e),Dz(r,e),De(r,132),r.end()}function Lz(e,t,r){return t.slice(-4)===".bin"?Iz(e,r):Sz(e,r)}function Mz(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?QU(e,n,r,a,s,i,o):O$(e,n,r,a,s,i,o)}function Bz(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?mz(e,n,r,a,s):hz(e,n,r,a,s)}function $z(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?zM():VM()}function Uz(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?$M():UM()}function zz(e,t,r,n){return t.slice(-4)===".bin"?L9(e,r,n):E9(e,r,n)}function Vz(e,t,r){return f4(e,r)}function Wz(e,t,r){return t.slice(-4)===".bin"?W7(e,r):U7(e,r)}function Hz(e,t,r){return t.slice(-4)===".bin"?jM(e,r):TM(e,r)}function Kz(e,t,r){return t.slice(-4)===".bin"?bM(e):xM(e)}function qz(e,t,r,n){return r.slice(-4)===".bin"?SM(e,t,r,n):void 0}function Gz(e,t,r){return t.slice(-4)===".bin"?yM(e,t,r):wM(e,t,r)}function Xz(e,t,r){return(t.slice(-4)===".bin"?Fz:I4)(e)}function Zz(e,t,r,n,a){return(t.slice(-4)===".bin"?uz:T4)(e,r,n,a)}function Yz(e,t,r){return(t.slice(-4)===".bin"?q9:c4)(e,r)}function Jz(e,t,r){return(t.slice(-4)===".bin"?q7:t4)(e,r)}function Qz(e,t,r){return(t.slice(-4)===".bin"?FM:p4)(e)}function eV(e){return(e.slice(-4)===".bin"?_M:d4)()}var D4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,P4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $a(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(D4),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(P4),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function tV(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(D4),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(P4),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var uu;function rV(e,t){var r=uu[e]||Vt(e);return r==="General"?Co(t):ja(r,t)}function nV(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=fr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Vt(t)]=a}function aV(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ti[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ru(e.v):e.w=Co(e.v):e.w=rV(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=uu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ac(n)){var a=ho(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function sV(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=v9[n.Pattern]||n.Pattern)}e[t.ID]=t}function iV(e,t,r,n,a,s,i,o,l,c){var u="General",d=n.StyleID,h={};c=c||{};var v=[],y=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(u=s[d].nf),s[d].Interior&&v.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=fr(e);break;case"String":n.t="s",n.r=rx(Vt(e)),n.v=e.indexOf("<")>-1?Vt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(hr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Vt(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=CE[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=rx(t||e));break}if(aV(n,u,c),c.cellFormula!==!1)if(n.Formula){var p=Vt(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=jl(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=jl("RC:RC",a):n.ArrayRange&&(n.F=jl(n.ArrayRange,a),l.push([Wt(n.F),n.F]))}else for(y=0;y<l.length;++y)a.r>=l[y][0].s.r&&a.r<=l[y][0].e.r&&a.c>=l[y][0].s.c&&a.c<=l[y][0].e.c&&(n.F=l[y][1]);c.cellStyles&&(v.forEach(function(_){!h.patternType&&_.patternType&&(h.patternType=_.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function oV(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Zp(e,t){var r=t||{};sc();var n=$c(hv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=rr(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=pr(r);return i.type="string",Kl.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($t){a.indexOf("<"+$t)>=0&&(s=!0)}),s)return KV(n,r);uu={"General Number":"General","General Date":_t[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":_t[15],"Short Date":_t[14],"Long Time":_t[19],"Medium Time":_t[18],"Short Time":_t[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:_t[2],Standard:_t[4],Percent:_t[10],Scientific:_t[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},d=[],h=r.dense?[]:{},v="",y={},p={},_=$a('<Data ss:Type="String">'),x=0,k=0,w=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},D={},C="",V=0,z=[],ee={},re={},G=0,me=[],Ee=[],Ae={},ke=[],Oe,Ce=!1,Z=[],Se=[],Ve={},B=0,J=0,K={Sheets:[],WBProps:{date1904:!1}},X={};Lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ge="";o=Lu.exec(n);)switch(o[3]=(ge=o[3]).toLowerCase()){case"data":if(ge=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?iV(n.slice(x,o.index),C,_,l[l.length-1][0]=="comment"?Ae:y,{c:k,r:w},I,ke[k],p,Z,r):(C="",_=$a(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ee.length>0&&(y.c=Ee),(!r.sheetRows||r.sheetRows>w)&&y.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][k]=y):h[xr(k)+Lr(w)]=y),y.HRef&&(y.l={Target:Vt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(B=k+(parseInt(y.MergeAcross,10)|0),J=w+(parseInt(y.MergeDown,10)|0),z.push({s:{c:k,r:w},e:{c:B,r:J}})),!r.sheetStubs)y.MergeAcross?k=B+1:++k;else if(y.MergeAcross||y.MergeDown){for(var Pe=k;Pe<=B;++Pe)for(var je=w;je<=J;++je)(Pe>k||je>w)&&(r.dense?(h[je]||(h[je]=[]),h[je][Pe]={t:"z"}):h[xr(Pe)+Lr(je)]={t:"z"});k=B+1}else++k;else y=tV(o[0]),y.Index&&(k=+y.Index-1),k<E.s.c&&(E.s.c=k),k>E.e.c&&(E.e.c=k),o[0].slice(-2)==="/>"&&++k,Ee=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<E.s.r&&(E.s.r=w),w>E.e.r&&(E.e.r=w),o[0].slice(-2)==="/>"&&(p=$a(o[0]),p.Index&&(w=+p.Index-1)),k=0,++w):(p=$a(o[0]),p.Index&&(w=+p.Index-1),Ve={},(p.AutoFitHeight=="0"||p.Height)&&(Ve.hpx=parseInt(p.Height,10),Ve.hpt=zu(Ve.hpx),Se[w]=Ve),p.Hidden=="1"&&(Ve.hidden=!0,Se[w]=Ve));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(v),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(h["!ref"]=It(E),r.sheetRows&&r.sheetRows<=E.e.r&&(h["!fullref"]=h["!ref"],E.e.r=r.sheetRows-1,h["!ref"]=It(E))),z.length&&(h["!merges"]=z),ke.length>0&&(h["!cols"]=ke),Se.length>0&&(h["!rows"]=Se),u[v]=h}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=k=0,l.push([o[3],!1]),c=$a(o[0]),v=Vt(c.Name),h=r.dense?[]:{},z=[],Z=[],Se=[],X={name:v,Hidden:0},K.Sheets.push(X);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ke=[],Ce=!1}break;case"style":o[1]==="/"?sV(I,D,r):D=$a(o[0]);break;case"numberformat":D.nf=Vt($a(o[0]).Format||"General"),uu[D.nf]&&(D.nf=uu[D.nf]);for(var ce=0;ce!=392&&_t[ce]!=D.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(_t[ce]==null){zs(D.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Oe=$a(o[0]),Oe.Hidden&&(Oe.hidden=!0,delete Oe.Hidden),Oe.Width&&(Oe.wpx=parseInt(Oe.Width,10)),!Ce&&Oe.wpx>10){Ce=!0,Nn=o4;for(var Te=0;Te<ke.length;++Te)ke[Te]&&Fi(ke[Te])}Ce&&Fi(Oe),ke[Oe.Index-1||ke.length]=Oe;for(var dt=0;dt<+Oe.Span;++dt)ke[ke.length]=pr(Oe);break;case"namedrange":if(o[1]==="/")break;K.Names||(K.Names=[]);var N=kt(o[0]),Ue={Name:N.Name,Ref:jl(N.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(Ue.Sheet=K.Sheets.length-1),K.Names.push(Ue);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?C+=n.slice(V,o.index):V=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=$a(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?IF(ee,ge,n.slice(G,o.index)):G=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));oV(Ae),Ee.push(Ae)}else l.push([o[3],!1]),c=$a(o[0]),Ae={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var it=$a(o[0]);h["!autofilter"]={ref:jl(it.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Wx(n,r);var ct=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ct=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ct=!1}break;case"excelworkbook":switch(o[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ct=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ct=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(G,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else G=o.index+o[0].length;break;case"header":h["!margins"]||_o(h["!margins"]={},"xlml"),isNaN(+kt(o[0]).Margin)||(h["!margins"].header=+kt(o[0]).Margin);break;case"footer":h["!margins"]||_o(h["!margins"]={},"xlml"),isNaN(+kt(o[0]).Margin)||(h["!margins"].footer=+kt(o[0]).Margin);break;case"pagemargins":var mt=kt(o[0]);h["!margins"]||_o(h["!margins"]={},"xlml"),isNaN(+mt.Top)||(h["!margins"].top=+mt.Top),isNaN(+mt.Left)||(h["!margins"].left=+mt.Left),isNaN(+mt.Right)||(h["!margins"].right=+mt.Right),isNaN(+mt.Bottom)||(h["!margins"].bottom=+mt.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ct=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ct=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ct=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ct=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ct=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ct=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ct=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ct=!1}break;case"smarttags":break;default:ct=!1;break}if(ct||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?nV(re,ge,me,n.slice(G,o.index)):(me=o,G=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Fe={};return!r.bookSheets&&!r.bookProps&&(Fe.Sheets=u),Fe.SheetNames=d,Fe.Workbook=K,Fe.SSF=pr(_t),Fe.Props=ee,Fe.Custprops=re,Fe}function Ag(e,t){switch(Lv(t=t||{}),t.type||"base64"){case"base64":return Zp(ga(e),t);case"binary":case"buffer":case"file":return Zp(e,t);case"array":return Zp(Gi(e),t)}}function lV(e,t){var r=[];return e.Props&&r.push(DF(e.Props,t)),e.Custprops&&r.push(PF(e.Props,e.Custprops)),r.join("")}function cV(){return""}function uV(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Ge("NumberFormat",null,{"ss:Format":Qt(_t[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(Ge("Style",s.join(""),i))}),Ge("Styles",r.join(""))}function R4(e){return Ge("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Iv(e.Ref,{r:0,c:0})})}function fV(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(R4(a)))}return Ge("Names",r.join(""))}function dV(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(R4(o)))}return s.join("")}function hV(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ge("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ge("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ge("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(gn("ProtectContents","True")),e["!protect"].objects&&a.push(gn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(gn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(gn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(gn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":Ge("WorksheetOptions",a.join(""),{xmlns:la.x})}function pV(e){return e.map(function(t){var r=jj(t.t||""),n=Ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ge("Comment",n,{"ss:Author":t.a})}).join("")}function mV(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Qt(Iv(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=kr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Qt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Qt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=i.c||c[u].s.r!=i.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=ti[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||_t[14]);break;case"s":d="String",h=Rj(e.v||"");break}var v=Zi(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+v),o["ss:Index"]=i.c+1;var y=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+d+'">'+y+"</Data>";return(e.c||[]).length>0&&(p+=pV(e.c)),Ge("Cell",p,o)}function gV(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ql(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function vV(e,t,r,n){if(!e["!ref"])return"";var a=Wt(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(_,x){Fi(_);var k=!!_.width,w=N0(x,_),E={"ss:Index":x+1};k&&(E["ss:Width"]=$u(w.width)),_.hidden&&(E["ss:Hidden"]="1"),o.push(Ge("Column",null,E))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var u=[gV(c,(e["!rows"]||[])[c])],d=a.s.c;d<=a.e.c;++d){var h=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>d)&&!(s[i].s.r>c)&&!(s[i].e.c<d)&&!(s[i].e.r<c)){(s[i].s.c!=d||s[i].s.r!=c)&&(h=!0);break}if(!h){var v={r:c,c:d},y=xt(v),p=l?(e[c]||[])[d]:e[y];u.push(mV(p,y,e,t,r,n,v))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function yV(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?dV(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?vV(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(hV(s,t,e,r)),n.join("")}function _V(e,t){t||(t={}),e.SSF||(e.SSF=pr(_t)),e.SSF&&(sc(),x0(e.SSF),t.revssf=b0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Zi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(lV(e,t)),r.push(cV()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ge("Worksheet",yV(n,t,e),{"ss:Name":Qt(e.SheetNames[n])}));return r[2]=uV(e,t),r[3]=fV(e),Mr+Ge("Workbook",r.join(""),{xmlns:la.ss,"xmlns:o":la.o,"xmlns:x":la.x,"xmlns:ss":la.ss,"xmlns:dt":la.dt,"xmlns:html":la.html})}function wV(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=fF(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=dF(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var xV=[60,1084,2066,2165,2175];function kV(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Ms(r,r.l),c=Og[l],u=0;c!=null&&xV.indexOf(l)>-1;)s=Ms(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),i.push(o),r.l+=4+s,c=Og[l=Ms(r,r.l)];var d=sn(i);mn(d,0);var h=0;d.lens=[];for(var v=0;v<i.length;++v)d.lens.push(h),h+=i[v].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function ls(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=_t[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ti[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ru(e.v):e.w=Co(e.v):e.w=ja(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&ac(_t[n]||String(n))){var a=ho(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function hd(e,t,r){return{v:e,ixfe:t,t:r}}function bV(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",u={},d,h="",v,y,p,_,x={},k=[],w,E,I=[],D=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},z=function(wt){return wt<8?go[wt]:wt<64&&D[wt-8]||go[wt]},ee=function(wt,jt,lr){var Gt=jt.XF.data;if(!(!Gt||!Gt.patternType||!lr||!lr.cellStyles)){jt.s={},jt.s.patternType=Gt.patternType;var cn;(cn=Bu(z(Gt.icvFore)))&&(jt.s.fgColor={rgb:cn}),(cn=Bu(z(Gt.icvBack)))&&(jt.s.bgColor={rgb:cn})}},re=function(wt,jt,lr){if(!(Ve>1)&&!(lr.sheetRows&&wt.r>=lr.sheetRows)){if(lr.cellStyles&&jt.XF&&jt.XF.data&&ee(wt,jt,lr),delete jt.ixfe,delete jt.XF,d=wt,h=xt(wt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),wt.r<i.s.r&&(i.s.r=wt.r),wt.c<i.s.c&&(i.s.c=wt.c),wt.r+1>i.e.r&&(i.e.r=wt.r+1),wt.c+1>i.e.c&&(i.e.c=wt.c+1),lr.cellFormula&&jt.f){for(var Gt=0;Gt<k.length;++Gt)if(!(k[Gt][0].s.c>wt.c||k[Gt][0].s.r>wt.r)&&!(k[Gt][0].e.c<wt.c||k[Gt][0].e.r<wt.r)){jt.F=It(k[Gt][0]),(k[Gt][0].s.c!=wt.c||k[Gt][0].s.r!=wt.r)&&delete jt.f,jt.f&&(jt.f=""+Tn(k[Gt][1],i,wt,Z,G));break}}lr.dense?(a[wt.r]||(a[wt.r]=[]),a[wt.r][wt.c]=jt):a[h]=jt}},G={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(G.password=t.password);var me,Ee=[],Ae=[],ke=[],Oe=[],Ce=!1,Z=[];Z.SheetNames=G.snames,Z.sharedf=G.sharedf,Z.arrayf=G.arrayf,Z.names=[],Z.XTI=[];var Se=0,Ve=0,B=0,J=[],K=[],X;G.codepage=1200,Xa(1200);for(var ge=!1;e.l<e.length-1;){var Pe=e.l,je=e.read_shift(2);if(je===0&&Se===10)break;var ce=e.l===e.length?0:e.read_shift(2),Te=Og[je];if(Te&&Te.f){if(t.bookSheets&&Se===133&&je!==133)break;if(Se=je,Te.r===2||Te.r==12){var dt=e.read_shift(2);if(ce-=2,!G.enc&&dt!==je&&((dt&255)<<8|dt>>8)!==je)throw new Error("rt mismatch: "+dt+"!="+je);Te.r==12&&(e.l+=10,ce-=10)}var N={};if(je===10?N=Te.f(e,ce,G):N=kV(je,Te,e,ce,G),Ve==0&&[9,521,1033,2057].indexOf(Se)===-1)continue;switch(je){case 34:r.opts.Date1904=C.WBProps.date1904=N;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(G.enc||(e.l=0),G.enc=N,!t.password)throw new Error("File is password-protected");if(N.valid==null)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:G.lastuser=N;break;case 66:var Ue=Number(N);switch(Ue){case 21010:Ue=1200;break;case 32768:Ue=1e4;break;case 32769:Ue=1252;break}Xa(G.codepage=Ue),ge=!0;break;case 317:G.rrtabid=N;break;case 25:G.winlocked=N;break;case 439:r.opts.RefreshAll=N;break;case 12:r.opts.CalcCount=N;break;case 16:r.opts.CalcDelta=N;break;case 17:r.opts.CalcIter=N;break;case 13:r.opts.CalcMode=N;break;case 14:r.opts.CalcPrecision=N;break;case 95:r.opts.CalcSaveRecalc=N;break;case 15:G.CalcRefMode=N;break;case 2211:r.opts.FullCalc=N;break;case 129:N.fDialog&&(a["!type"]="dialog"),N.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),N.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(N);break;case 430:Z.push([N]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(N);break;case 24:case 536:X={Name:N.Name,Ref:Tn(N.rgce,i,null,Z,G)},N.itab>0&&(X.Sheet=N.itab-1),Z.names.push(X),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(N),N.Name=="_xlnm._FilterDatabase"&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&N.rgce[0][0][0]=="PtgArea3d"&&(K[N.itab-1]={ref:It(N.rgce[0][0][1][2])});break;case 22:G.ExternCount=N;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(N),Z.XTI=Z.XTI.concat(N);break;case 2196:if(G.biff<8)break;X!=null&&(X.Comment=N[1]);break;case 18:a["!protect"]=N;break;case 19:N!==0&&G.WTF&&console.error("Password verifier: "+N);break;case 133:s[N.pos]=N,G.snames.push(N.name);break;case 10:{if(--Ve)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=It(i),t.sheetRows&&t.sheetRows<=i.e.r){var it=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=It(i),i.e.r=it}i.e.r++,i.e.c++}Ee.length>0&&(a["!merges"]=Ee),Ae.length>0&&(a["!objects"]=Ae),ke.length>0&&(a["!cols"]=ke),Oe.length>0&&(a["!rows"]=Oe),C.Sheets.push(V)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(G.biff===8&&(G.biff={9:2,521:3,1033:4}[je]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),G.biffguess=N.BIFFVer==0,N.BIFFVer==0&&N.dt==4096&&(G.biff=5,ge=!0,Xa(G.codepage=28591)),G.biff==8&&N.BIFFVer==0&&N.dt==16&&(G.biff=2),Ve++)break;if(a=t.dense?[]:{},G.biff<8&&!ge&&(ge=!0,Xa(G.codepage=t.codepage||1252)),G.biff<5||N.BIFFVer==0&&N.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var ct={pos:e.l-ce,name:c};s[ct.pos]=ct,G.snames.push(c)}else c=(s[Pe]||{name:""}).name;N.dt==32&&(a["!type"]="chart"),N.dt==64&&(a["!type"]="macro"),Ee=[],Ae=[],G.arrayf=k=[],ke=[],Oe=[],Ce=!1,V={Hidden:(s[Pe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[N.r]||[])[N.c]:a[xt({c:N.c,r:N.r})])&&++N.c,w={ixfe:N.ixfe,XF:I[N.ixfe]||{},v:N.val,t:"n"},B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re({c:N.c,r:N.r},w,t);break;case 5:case 517:w={ixfe:N.ixfe,XF:I[N.ixfe],v:N.val,t:N.t},B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re({c:N.c,r:N.r},w,t);break;case 638:w={ixfe:N.ixfe,XF:I[N.ixfe],v:N.rknum,t:"n"},B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re({c:N.c,r:N.r},w,t);break;case 189:for(var mt=N.c;mt<=N.C;++mt){var Fe=N.rkrec[mt-N.c][0];w={ixfe:Fe,XF:I[Fe],v:N.rkrec[mt-N.c][1],t:"n"},B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re({c:mt,r:N.r},w,t)}break;case 6:case 518:case 1030:{if(N.val=="String"){o=N;break}if(w=hd(N.val,N.cell.ixfe,N.tt),w.XF=I[w.ixfe],t.cellFormula){var $t=N.formula;if($t&&$t[0]&&$t[0][0]&&$t[0][0][0]=="PtgExp"){var yr=$t[0][0][1][0],H=$t[0][0][1][1],ae=xt({r:yr,c:H});x[ae]?w.f=""+Tn(N.formula,i,N.cell,Z,G):w.F=((t.dense?(a[yr]||[])[H]:a[ae])||{}).F}else w.f=""+Tn(N.formula,i,N.cell,Z,G)}B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re(N.cell,w,t),o=N}break;case 7:case 519:if(o)o.val=N,w=hd(N,o.cell.ixfe,"s"),w.XF=I[w.ixfe],t.cellFormula&&(w.f=""+Tn(o.formula,i,o.cell,Z,G)),B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(N);var ye=xt(N[0].s);if(v=t.dense?(a[N[0].s.r]||[])[N[0].s.c]:a[ye],t.cellFormula&&v){if(!o||!ye||!v)break;v.f=""+Tn(N[1],i,N[0],Z,G),v.F=It(N[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;x[xt(o.cell)]=N[0],v=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[xt(o.cell)],(v||{}).f=""+Tn(N[0],i,d,Z,G)}}break;case 253:w=hd(l[N.isst].t,N.ixfe,"s"),l[N.isst].h&&(w.h=l[N.isst].h),w.XF=I[w.ixfe],B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re({c:N.c,r:N.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:N.ixfe,XF:I[N.ixfe],t:"z"},B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re({c:N.c,r:N.r},w,t));break;case 190:if(t.sheetStubs)for(var Ke=N.c;Ke<=N.C;++Ke){var Be=N.ixfe[Ke-N.c];w={ixfe:Be,XF:I[Be],t:"z"},B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re({c:Ke,r:N.r},w,t)}break;case 214:case 516:case 4:w=hd(N.val,N.ixfe,"s"),w.XF=I[w.ixfe],B>0&&(w.z=J[w.ixfe>>8&63]),ls(w,t,r.opts.Date1904),re({c:N.c,r:N.r},w,t);break;case 0:case 512:Ve===1&&(i=N);break;case 252:l=N;break;case 1054:if(G.biff==4){J[B++]=N[1];for(var Re=0;Re<B+163&&_t[Re]!=N[1];++Re);Re>=163&&zs(N[1],B+163)}else zs(N[1],N[0]);break;case 30:{J[B++]=N;for(var nt=0;nt<B+163&&_t[nt]!=N;++nt);nt>=163&&zs(N,B+163)}break;case 229:Ee=Ee.concat(N);break;case 93:Ae[N.cmo[0]]=G.lastobj=N;break;case 438:G.lastobj.TxO=N;break;case 127:G.lastobj.ImData=N;break;case 440:for(_=N[0].s.r;_<=N[0].e.r;++_)for(p=N[0].s.c;p<=N[0].e.c;++p)v=t.dense?(a[_]||[])[p]:a[xt({c:p,r:_})],v&&(v.l=N[1]);break;case 2048:for(_=N[0].s.r;_<=N[0].e.r;++_)for(p=N[0].s.c;p<=N[0].e.c;++p)v=t.dense?(a[_]||[])[p]:a[xt({c:p,r:_})],v&&v.l&&(v.l.Tooltip=N[1]);break;case 28:{if(G.biff<=5&&G.biff>=2)break;v=t.dense?(a[N[0].r]||[])[N[0].c]:a[xt(N[0])];var St=Ae[N[2]];v||(t.dense?(a[N[0].r]||(a[N[0].r]=[]),v=a[N[0].r][N[0].c]={t:"z"}):v=a[xt(N[0])]={t:"z"},i.e.r=Math.max(i.e.r,N[0].r),i.s.r=Math.min(i.s.r,N[0].r),i.e.c=Math.max(i.e.c,N[0].c),i.s.c=Math.min(i.s.c,N[0].c)),v.c||(v.c=[]),y={a:N[1],t:St.TxO.t},v.c.push(y)}break;case 2173:uM(I[N.ixfe],N.ext);break;case 125:{if(!G.cellStyles)break;for(;N.e>=N.s;)ke[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(N.flags&1)},Ce||(Ce=!0,Nv(N.w/256)),Fi(ke[N.e+1])}break;case 520:{var gt={};N.level!=null&&(Oe[N.r]=gt,gt.level=N.level),N.hidden&&(Oe[N.r]=gt,gt.hidden=!0),N.hpt&&(Oe[N.r]=gt,gt.hpt=N.hpt,gt.hpx=ql(N.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||_o(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[je]]=N;break;case 161:a["!margins"]||_o(a["!margins"]={}),a["!margins"].header=N.header,a["!margins"].footer=N.footer;break;case 574:N.RTL&&(C.Views[0].RTL=!0);break;case 146:D=N;break;case 2198:me=N;break;case 140:E=N;break;case 442:c?V.CodeName=N||V.name:C.WBProps.CodeName=N||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+je.toString(16)),e.l+=ce}return r.SheetNames=Dr(s).sort(function(qt,wt){return Number(qt)-Number(wt)}).map(function(qt){return s[qt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&K.forEach(function(qt,wt){r.Sheets[r.SheetNames[wt]]["!autofilter"]=qt}),r.Strings=l,r.SSF=pr(_t),G.enc&&(r.Encryption=G.enc),me&&(r.Themes=me),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),Z.names.length>0&&(C.Names=Z.names),r.Workbook=C,r}var fu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function SV(e,t,r){var n=ht.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=wx(n,bg,fu.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=ht.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=wx(i,Sg,fu.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(PE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function EV(e,t){var r=[],n=[],a=[],s=0,i,o=Zw(bg,"n"),l=Zw(Sg,"n");if(e.Props)for(i=Dr(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Dr(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var c=[];for(s=0;s<a.length;++s)$E.indexOf(a[s][0])>-1||DE.indexOf(a[s][0])>-1||a[s][1]!=null&&c.push(a[s]);n.length&&ht.utils.cfb_add(t,"/SummaryInformation",xx(n,fu.SI,l,Sg)),(r.length||c.length)&&ht.utils.cfb_add(t,"/DocumentSummaryInformation",xx(r,fu.DSI,o,bg,c.length?c:null,fu.UDI))}function j4(e,t){t||(t={}),Lv(t),av(),t.codepage&&nv(t.codepage);var r,n;if(e.FullPaths){if(ht.find(e,"/encryption"))throw new Error("File is password-protected");r=ht.find(e,"!CompObj"),n=ht.find(e,"/Workbook")||ht.find(e,"/Book")}else{switch(t.type){case"base64":e=ua(ga(e));break;case"binary":e=ua(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}mn(e,0),n={content:e}}var a,s;if(r&&wV(r),t.bookProps&&!t.bookSheets)a={};else{var i=Pt?"buffer":"array";if(n&&n.content)a=bV(n.content,t);else if((s=ht.find(e,"PerfectOffice_MAIN"))&&s.content)a=yo.to_workbook(s.content,(t.type=i,t));else if((s=ht.find(e,"NativeContent_MAIN"))&&s.content)a=yo.to_workbook(s.content,(t.type=i,t));else throw(s=ht.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ht.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=MM(e))}var o={};return e.FullPaths&&SV(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function TV(e,t){var r=t||{},n=ht.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ht.utils.cfb_add(n,a,F4(e,r)),r.biff==8&&(e.Props||e.Custprops)&&EV(e,n),r.biff==8&&e.vbaraw&&BM(n,ht.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Vu={0:{f:Z$},1:{f:aU},2:{f:bU},3:{f:dU},4:{f:lU},5:{f:wU},6:{f:NU},7:{f:gU},8:{f:jU},9:{f:RU},10:{f:DU},11:{f:PU},12:{f:iU},13:{f:EU},14:{f:pU},15:{f:uU},16:{f:C4},17:{f:OU},18:{f:yU},19:{f:yv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Oz},40:{},42:{},43:{f:N9},44:{f:T9},45:{f:I9},46:{f:P9},47:{f:D9},48:{},49:{f:Qj},50:{},51:{f:hM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:YE},62:{f:CU},63:{f:kM},64:{f:YU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:qU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:rU},148:{f:Q$,p:16},151:{f:UU},152:{},153:{f:Cz},154:{},155:{},156:{f:Ez},157:{},158:{},159:{T:1,f:V7},160:{T:-1},161:{T:1,f:Uo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:FU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fM},336:{T:-1},337:{f:gM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:kg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ZE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:zU},427:{f:VU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:HU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:tU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:BU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:kg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:PM},633:{T:1},634:{T:-1},635:{T:1,f:IM},636:{T:-1},637:{f:nF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pz},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:JU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Og={6:{f:Gp},10:{f:ui},12:{f:Vr},13:{f:Vr},14:{f:Rr},15:{f:Rr},16:{f:An},17:{f:Rr},18:{f:Rr},19:{f:Vr},20:{f:Cx},21:{f:Cx},23:{f:ZE},24:{f:Ax},25:{f:Rr},26:{},27:{},28:{f:JL},29:{},34:{f:Rr},35:{f:Nx},38:{f:An},39:{f:An},40:{f:An},41:{f:An},42:{f:Rr},43:{f:Rr},47:{f:u9},49:{f:EL},51:{f:Vr},60:{},61:{f:wL},64:{f:Rr},65:{f:SL},66:{f:Vr},77:{},80:{},81:{},82:{},85:{f:Vr},89:{},90:{},91:{},92:{f:cL},93:{f:t7},94:{},95:{f:Rr},96:{},97:{},99:{f:Rr},125:{f:YE},128:{f:$L},129:{f:fL},130:{f:Vr},131:{f:Rr},132:{f:Rr},133:{f:dL},134:{},140:{f:c7},141:{f:Vr},144:{},146:{f:d7},151:{},152:{},153:{},154:{},155:{},156:{f:Vr},157:{},158:{},160:{f:_7},161:{f:m7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:FL},190:{f:LL},193:{f:ui},197:{},198:{},199:{},200:{},201:{},202:{f:Rr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Vr},220:{},221:{f:Rr},222:{},224:{f:BL},225:{f:lL},226:{f:ui},227:{},229:{f:QL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pL},253:{f:CL},255:{f:gL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:UE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Rr},353:{f:ui},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:HL},431:{f:Rr},432:{},433:{},434:{},437:{},438:{f:a7},439:{f:Rr},440:{f:s7},441:{},442:{f:uf},443:{},444:{f:Vr},445:{},446:{},448:{f:ui},449:{f:_L,r:2},450:{f:ui},512:{f:Sx},513:{f:y7},515:{f:VL},516:{f:AL},517:{f:Tx},519:{f:w7},520:{f:vL},523:{},545:{f:Ox},549:{f:bx},566:{},574:{f:kL},638:{f:jL},659:{},1048:{},1054:{f:IL},1084:{},1212:{f:XL},2048:{f:o7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ud},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ui},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:h7,r:12},2173:{f:cM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Rr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:GL,r:12},2197:{},2198:{f:nM,r:12},2199:{},2200:{},2201:{},2202:{f:ZL,r:12},2203:{f:ui},2204:{},2205:{},2206:{},2207:{},2211:{f:yL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Vr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:g7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:f7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Sx},1:{},2:{f:E7},3:{f:b7},4:{f:k7},5:{f:Tx},7:{f:C7},8:{},9:{f:ud},11:{},22:{f:Vr},30:{f:PL},31:{},32:{},33:{f:Ox},36:{},37:{f:bx},50:{f:N7},62:{},52:{},67:{},68:{f:Vr},69:{},86:{},126:{},127:{f:x7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:A7},223:{},234:{},354:{},421:{},518:{f:Gp},521:{f:ud},536:{f:Ax},547:{f:Nx},561:{},579:{},1030:{f:Gp},1033:{f:ud},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xe(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&mv(r)&&e.push(r)}}function CV(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Xe(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function pf(e,t,r){return e||(e=xe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function NV(e,t,r,n){var a=xe(9);return pf(a,e,t),zE(r,n||"b",a),a}function AV(e,t,r){var n=xe(8+2*r.length);return pf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function OV(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Qr(hr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Xe(e,2,T7(r,n,a)):Xe(e,3,S7(r,n,a));return;case"b":case"e":Xe(e,5,NV(r,n,t.v,t.t));return;case"s":case"str":Xe(e,4,AV(r,n,(t.v||"").slice(0,255)));return}Xe(e,1,pf(null,r,n))}function IV(e,t,r,n){var a=Array.isArray(t),s=Wt(t["!ref"]||"A1"),i,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=It(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Lr(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=xr(u)),i=l[u]+o;var d=a?(t[c]||[])[u]:t[i];d&&OV(e,d,c,u)}}}function DV(e,t){for(var r=t||{},n=ra(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Xe(n,r.biff==4?1033:r.biff==3?521:9,Ev(e,16,r)),IV(n,e.Sheets[e.SheetNames[a]],a,r),Xe(n,10),n.end()}function PV(e,t,r){Xe(e,49,TL({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function RV(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Xe(e,1054,DL(a,t[a],r))})}function jV(e,t){var r=xe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Xe(e,2151,r),r=xe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),qE(Wt(t["!ref"]||"A1"),r),r.write_shift(4,4),Xe(e,2152,r)}function FV(e,t){for(var r=0;r<16;++r)Xe(e,224,Ex({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Xe(e,224,Ex(n,0,t))})}function LV(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Xe(e,440,i7(n)),n[1].Tooltip&&Xe(e,2048,l7(n))}delete t["!links"]}function MV(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Xe(e,125,p7(N0(a,n),a))})}}function BV(e,t,r,n,a){var s=16+Zi(a.cellXfs,t,a);if(t.v==null&&!t.bf){Xe(e,513,Io(r,n,s));return}if(t.bf)Xe(e,6,f$(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?Qr(hr(t.v)):t.v;Xe(e,515,WL(r,n,i,s));break;case"b":case"e":Xe(e,517,zL(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Pv(a.Strings,t.v,a.revStrings);Xe(e,253,NL(r,n,o,s))}else Xe(e,516,OL(r,n,(t.v||"").slice(0,255),s,a));break;default:Xe(e,513,Io(r,n,s))}}function $V(e,t,r){var n=ra(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,d="",h=[],v=Wt(s["!ref"]||"A1"),y=c?65536:16384;if(v.e.c>255||v.e.r>=y){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,y-1)}Xe(n,2057,Ev(r,16,t)),Xe(n,13,Ca(1)),Xe(n,12,Ca(100)),Xe(n,15,Vn(!0)),Xe(n,17,Vn(!1)),Xe(n,16,Ao(.001)),Xe(n,95,Vn(!0)),Xe(n,42,Vn(!1)),Xe(n,43,Vn(!1)),Xe(n,130,Ca(1)),Xe(n,128,UL()),Xe(n,131,Vn(!1)),Xe(n,132,Vn(!1)),c&&MV(n,s["!cols"]),Xe(n,512,RL(v,t)),c&&(s["!links"]=[]);for(var p=v.s.r;p<=v.e.r;++p){d=Lr(p);for(var _=v.s.c;_<=v.e.c;++_){p===v.s.r&&(h[_]=xr(_)),u=h[_]+d;var x=l?(s[p]||[])[_]:s[u];x&&(BV(n,x,p,_,t),c&&x.l&&s["!links"].push([u,x.l]))}}var k=o.CodeName||o.name||a;return c&&Xe(n,574,bL((i.Views||[])[0])),c&&(s["!merges"]||[]).length&&Xe(n,229,e7(s["!merges"])),c&&LV(n,s),Xe(n,442,VE(k)),c&&jV(n,s),Xe(n,10),n.end()}function UV(e,t,r){var n=ra(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(Xe(n,2057,Ev(e,5,r)),r.bookType=="xla"&&Xe(n,135),Xe(n,225,o?Ca(1200):null),Xe(n,193,zF(2)),l&&Xe(n,191),l&&Xe(n,192),Xe(n,226),Xe(n,92,uL("SheetJS",r)),Xe(n,66,Ca(o?1200:1252)),o&&Xe(n,353,Ca(0)),o&&Xe(n,448),Xe(n,317,v7(e.SheetNames.length)),o&&e.vbaraw&&Xe(n,211),o&&e.vbaraw){var c=i.CodeName||"ThisWorkbook";Xe(n,442,VE(c))}Xe(n,156,Ca(17)),Xe(n,25,Vn(!1)),Xe(n,18,Vn(!1)),Xe(n,19,Ca(0)),o&&Xe(n,431,Vn(!1)),o&&Xe(n,444,Ca(0)),Xe(n,61,xL()),Xe(n,64,Vn(!1)),Xe(n,141,Ca(0)),Xe(n,34,Vn(_z(e)=="true")),Xe(n,14,Vn(!0)),o&&Xe(n,439,Vn(!1)),Xe(n,218,Ca(0)),PV(n,e,r),RV(n,e.SSF,r),FV(n,r),o&&Xe(n,352,Vn(!1));var u=n.end(),d=ra();o&&Xe(d,140,u7()),o&&r.Strings&&CV(d,252,mL(r.Strings)),Xe(d,10);var h=d.end(),v=ra(),y=0,p=0;for(p=0;p<e.SheetNames.length;++p)y+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var _=u.length+y+h.length;for(p=0;p<e.SheetNames.length;++p){var x=s[p]||{};Xe(v,133,hL({pos:_,hs:x.Hidden||0,dt:0,name:e.SheetNames[p]},r)),_+=t[p].length}var k=v.end();if(y!=k.length)throw new Error("BS8 "+y+" != "+k.length);var w=[];return u.length&&w.push(u),k.length&&w.push(k),h.length&&w.push(h),sn(w)}function zV(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=pr(_t)),e&&e.SSF&&(sc(),x0(e.SSF),r.revssf=b0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Mv(r),r.cellXfs=[],Zi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=$V(a,r,e);return n.unshift(UV(e,n,r)),sn(n)}function F4(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=na(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return zV(e,t);case 4:case 3:case 2:return DV(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function $x(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=Tj(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(i=0;i<l.length;++i){var p=l[i].trim(),_=p.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(_!="<td"&&_!="<th")){var x=p.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var k=x[o].trim();if(k.match(/<t[dh]/i)){for(var w=k,E=0;w.charAt(0)=="<"&&(E=w.indexOf(">"))>-1;)w=w.slice(E+1);for(var I=0;I<y.length;++I){var D=y[I];D.s.c==u&&D.s.r<c&&c<=D.e.r&&(u=D.e.c+1,I=-1)}var C=kt(k.slice(0,k.indexOf(">")));h=C.colspan?+C.colspan:1,((d=+C.rowspan)>1||h>1)&&y.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var V=C.t||C["data-t"]||"";if(!w.length){u+=h;continue}if(w=iE(w),v.s.r>c&&(v.s.r=c),v.e.r<c&&(v.e.r=c),v.s.c>u&&(v.s.c=u),v.e.c<u&&(v.e.c=u),!w.length){u+=h;continue}var z={t:"s",v:w};r.raw||!w.trim().length||V=="s"||(w==="TRUE"?z={t:"b",v:!0}:w==="FALSE"?z={t:"b",v:!1}:isNaN(Qa(w))?isNaN(Hl(w).getDate())||(z={t:"d",v:hr(w)},r.cellDates||(z={t:"n",v:Qr(z.v)}),z.z=r.dateNF||_t[14]):z={t:"n",v:Qa(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=z):n[xt({r:c,c:u})]=z,u+=h}}}}return n["!ref"]=It(v),y.length&&(n["!merges"]=y),n}function VV(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=xt({r,c:i}),d=n.dense?(e[r]||[])[i]:e[u],h=d&&d.v!=null&&(d.h||dv(d.w||(Ys(d),d.w)||""))||"",v={};o>1&&(v.rowspan=o),l>1&&(v.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(v["data-t"]=d&&d.t||"z",d.v!=null&&(v["data-v"]=d.v),d.z!=null&&(v["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),v.id=(n.id||"sjs")+"-"+u,s.push(Ge("td",h,v))}}var y="<tr>";return y+s.join("")+"</tr>"}var WV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HV="</body></html>";function KV(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Xi($x(r[0],t),t);var n=zv();return r.forEach(function(a,s){Vv(n,$x(a,t),"Sheet"+(s+1))}),n}function qV(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function L4(e,t){var r=t||{},n=r.header!=null?r.header:WV,a=r.footer!=null?r.footer:HV,s=[n],i=na(e["!ref"]);r.dense=Array.isArray(e),s.push(qV(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(VV(e,i,o,r));return s.push("</table>"+a),s.join("")}function M4(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?kr(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=na(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var d=[],h=0,v=e["!rows"]||(e["!rows"]=[]),y=0,p=0,_=0,x=0,k=0,w=0;for(e["!cols"]||(e["!cols"]=[]);y<o.length&&p<l;++y){var E=o[y];if(Ux(E)){if(n.display)continue;v[p]={hidden:!0}}var I=E.children;for(_=x=0;_<I.length;++_){var D=I[_];if(!(n.display&&Ux(D))){var C=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):iE(D.innerHTML),V=D.getAttribute("data-z")||D.getAttribute("z");for(h=0;h<d.length;++h){var z=d[h];z.s.c==x+s&&z.s.r<p+a&&p+a<=z.e.r&&(x=z.e.c+1-s,h=-1)}w=+D.getAttribute("colspan")||1,((k=+D.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:p+a,c:x+s},e:{r:p+a+(k||1)-1,c:x+s+(w||1)-1}});var ee={t:"s",v:C},re=D.getAttribute("data-t")||D.getAttribute("t")||"";C!=null&&(C.length==0?ee.t=re||"z":n.raw||C.trim().length==0||re=="s"||(C==="TRUE"?ee={t:"b",v:!0}:C==="FALSE"?ee={t:"b",v:!1}:isNaN(Qa(C))?isNaN(Hl(C).getDate())||(ee={t:"d",v:hr(C)},n.cellDates||(ee={t:"n",v:Qr(ee.v)}),ee.z=n.dateNF||_t[14]):ee={t:"n",v:Qa(C)})),ee.z===void 0&&V!=null&&(ee.z=V);var G="",me=D.getElementsByTagName("A");if(me&&me.length)for(var Ee=0;Ee<me.length&&!(me[Ee].hasAttribute("href")&&(G=me[Ee].getAttribute("href"),G.charAt(0)!="#"));++Ee);G&&G.charAt(0)!="#"&&(ee.l={Target:G}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][x+s]=ee):e[xt({c:x+s,r:p+a})]=ee,c.e.c<x+s&&(c.e.c=x+s),x+=w}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,p-1+a),e["!ref"]=It(c),p>=l&&(e["!fullref"]=It((c.e.r=o.length-y+p-1+a,c))),e}function B4(e,t){var r=t||{},n=r.dense?[]:{};return M4(n,e,t)}function GV(e,t){return Xi(B4(e,t),t)}function Ux(e){var t="",r=XV(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function XV(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function ZV(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Vt(t.replace(/<[^>]*>/g,""));return[r]}var zx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $4(e,t){var r=t||{},n=hv(e),a=[],s,i,o={name:""},l="",c=0,u,d,h={},v=[],y=r.dense?[]:{},p,_,x={value:""},k="",w=0,E=[],I=-1,D=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,z={},ee=[],re={},G=0,me=0,Ee=[],Ae=1,ke=1,Oe=[],Ce={Names:[]},Z={},Se=["",""],Ve=[],B={},J="",K=0,X=!1,ge=!1,Pe=0;for(Lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Lu.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?y["!ref"]=It(C):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(y["!fullref"]=y["!ref"],C.e.r=r.sheetRows-1,y["!ref"]=It(C)),ee.length&&(y["!merges"]=ee),Ee.length&&(y["!rows"]=Ee),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),v.push(u.name),h[u.name]=y,ge=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=kt(p[0],!1),I=D=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,y=r.dense?[]:{},ee=[],Ee=[],ge=!0);break;case"table-row-group":p[1]==="/"?--V:++V;break;case"table-row":case"行":if(p[1]==="/"){I+=Ae,Ae=1;break}if(d=kt(p[0],!1),d.行号?I=d.行号-1:I==-1&&(I=0),Ae=+d["number-rows-repeated"]||1,Ae<10)for(Pe=0;Pe<Ae;++Pe)V>0&&(Ee[I+Pe]={level:V});D=-1;break;case"covered-table-cell":p[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(y[I]||(y[I]=[]),y[I][D]={t:"z"}):y[xt({r:I,c:D})]={t:"z"}),k="",E=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++D,x=kt(p[0],!1),ke=parseInt(x["number-columns-repeated"]||"1",10),_={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(_.f=Lx(Vt(x.formula))),(x.数据类型||x["value-type"])=="string"&&(_.t="s",_.v=Vt(x["string-value"]||""),r.dense?(y[I]||(y[I]=[]),y[I][D]=_):y[xt({r:I,c:D})]=_),D+=ke-1;else if(p[1]!=="/"){++D,k="",w=0,E=[],ke=1;var je=Ae?I+Ae-1:I;if(D>C.e.c&&(C.e.c=D),D<C.s.c&&(C.s.c=D),I<C.s.r&&(C.s.r=I),je>C.e.r&&(C.e.r=je),x=kt(p[0],!1),Ve=[],B={},_={t:x.数据类型||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Vt(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(G=parseInt(x["number-matrix-rows-spanned"],10)||0,me=parseInt(x["number-matrix-columns-spanned"],10)||0,re={s:{r:I,c:D},e:{r:I+G-1,c:D+me-1}},_.F=It(re),Oe.push([re,_.F])),x.formula)_.f=Lx(x.formula);else for(Pe=0;Pe<Oe.length;++Pe)I>=Oe[Pe][0].s.r&&I<=Oe[Pe][0].e.r&&D>=Oe[Pe][0].s.c&&D<=Oe[Pe][0].e.c&&(_.F=Oe[Pe][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(G=parseInt(x["number-rows-spanned"],10)||0,me=parseInt(x["number-columns-spanned"],10)||0,re={s:{r:I,c:D},e:{r:I+G-1,c:D+me-1}},ee.push(re)),x["number-columns-repeated"]&&(ke=parseInt(x["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=fr(x["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(x.value);break;case"percentage":_.t="n",_.v=parseFloat(x.value);break;case"currency":_.t="n",_.v=parseFloat(x.value);break;case"date":_.t="d",_.v=hr(x["date-value"]),r.cellDates||(_.t="n",_.v=Qr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=bj(x["time-value"])/86400,r.cellDates&&(_.t="d",_.v=S0(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(x.数据数值);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",x["string-value"]!=null&&(k=Vt(x["string-value"]),E=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(X=!1,_.t==="s"&&(_.v=k||"",E.length&&(_.R=E),X=w==0),Z.Target&&(_.l=Z),Ve.length>0&&(_.c=Ve,Ve=[]),k&&r.cellText!==!1&&(_.w=k),X&&(_.t="z",delete _.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var ce=0;ce<Ae;++ce){if(ke=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(y[I+ce]||(y[I+ce]=[]),y[I+ce][D]=ce==0?_:pr(_);--ke>0;)y[I+ce][D+ke]=pr(_);else for(y[xt({r:I+ce,c:D})]=_;--ke>0;)y[xt({r:I+ce,c:D+ke})]=pr(_);C.e.c<=D&&(C.e.c=D)}ke=parseInt(x["number-columns-repeated"]||"1",10),D+=ke-1,ke=0,_={},k="",E=[]}Z={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;B.t=k,E.length&&(B.R=E),B.a=J,Ve.push(B)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);J="",K=0,k="",w=0,E=[];break;case"creator":p[1]==="/"?J=n.slice(K,p.index):K=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);k="",w=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(z[o.name]=l,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=kt(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=kt(p[0],!1),l+=zx[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=kt(p[0],!1),l+=zx[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,p.index);break}else c=p.index+p[0].length;break;case"named-range":i=kt(p[0],!1),Se=Xp(i["cell-range-address"]);var Te={Name:i.name,Ref:Se[0]+"!"+Se[1]};ge&&(Te.Sheet=v.length),Ce.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!x||!x["string-value"])){var dt=ZV(n.slice(w,p.index));k=(k.length>0?k+`
`:"")+dt[0]}else kt(p[0],!1),w=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{Se=Xp(kt(p[0])["target-range-address"]),h[Se[0]]["!autofilter"]={ref:Se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Z=kt(p[0],!1),!Z.href)break;Z.Target=Vt(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(Se=Xp(Z.Target.slice(1)),Z.Target="#"+Se[0]+"!"+Se[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var N={Sheets:h,SheetNames:v,Workbook:Ce};return r.bookSheets&&delete N.Sheets,N}function Vx(e,t){t=t||{},Ta(e,"META-INF/manifest.xml")&&bF(zr(e,"META-INF/manifest.xml"),t);var r=fa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=$4(rr(r),t);return Ta(e,"meta.xml")&&(n.Props=OE(zr(e,"meta.xml"))),n}function Wx(e,t){return $4(e,t)}var YV=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Fu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Mr+t}}(),Hx=function(){var e=function(s){return Qt(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var l=[];l.push('      <table:table table:name="'+Qt(i.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,d=na(s["!ref"]||"A1"),h=s["!merges"]||[],v=0,y=Array.isArray(s);if(s["!cols"])for(u=0;u<=d.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",_=s["!rows"]||[];for(c=0;c<d.s.r;++c)p=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=d.e.r;++c){for(p=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<d.s.c;++u)l.push(t);for(;u<=d.e.c;++u){var x=!1,k={},w="";for(v=0;v!=h.length;++v)if(!(h[v].s.c>u)&&!(h[v].s.r>c)&&!(h[v].e.c<u)&&!(h[v].e.r<c)){(h[v].s.c!=u||h[v].s.r!=c)&&(x=!0),k["table:number-columns-spanned"]=h[v].e.c-h[v].s.c+1,k["table:number-rows-spanned"]=h[v].e.r-h[v].s.r+1;break}if(x){l.push(r);continue}var E=xt({r:c,c:u}),I=y?(s[c]||[])[u]:s[E];if(I&&I.f&&(k["table:formula"]=Qt(v$(I.f)),I.F&&I.F.slice(0,E.length)==E)){var D=na(I.F);k["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,k["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!I){l.push(t);continue}switch(I.t){case"b":w=I.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=I.v?"true":"false";break;case"n":w=I.w||String(I.v||0),k["office:value-type"]="float",k["office:value"]=I.v||0;break;case"s":case"str":w=I.v==null?"":I.v,k["office:value-type"]="string";break;case"d":w=I.w||hr(I.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=hr(I.v).toISOString(),k["table:style-name"]="ce1";break;default:l.push(t);continue}var C=e(w);if(I.l&&I.l.Target){var V=I.l.Target;V=V.charAt(0)=="#"?"#"+y$(V.slice(1)):V,V.charAt(0)!="#"&&!V.match(/^\w+:/)&&(V="../"+V),C=Ge("text:a",C,{"xlink:href":V.replace(/&/g,"&amp;")})}l.push("          "+Ge("table:table-cell",Ge("text:p",C,{}),k)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var d=c["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Fi(d),d.ods=o;var h=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var d=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var l=[Mr],c=Fu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Fu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(AE().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),a(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)l.push(n(i.Sheets[i.SheetNames[d]],i,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function U4(e,t){if(t.bookType=="fods")return Hx(e,t);var r=cv(),n="",a=[],s=[];return n="mimetype",Dt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Dt(r,n,Hx(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Dt(r,n,YV(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Dt(r,n,Mr+AE()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Dt(r,n,TF(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Dt(r,n,SF(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Do(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ig(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):rr(Gi(e))}function JV(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ua(ws(e))}function QV(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Mi(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Kx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function eW(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function tW(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Wu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Zt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ir(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Kt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Wu(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Wu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function dn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Zt(n*8+a.type)),a.type==2&&t.push(Zt(a.data.length)),t.push(a.data))})}),Mi(t)}function Fv(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Sa(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Wu(e,n),s=Kt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Ir(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Kt(o.data),c=Ir(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=Ir(s[3][0].data)>>>0>0),r.push(i)}return r}function sl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Zt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Zt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:Zt(i.data.length)}],n[2].push({data:dn(i.meta),type:2})});var s=dn(n);t.push(Zt(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),Mi(t)}function rW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Wu(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Mi(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=Mi(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Ea(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(rW(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Mi(t)}function il(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Zt(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return Mi(t)}function nW(e,t,r,n){var a=Do(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Kx(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=Kx(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function aW(e,t,r){var n=Do(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=eW(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function Yp(e,t){var r=new Uint8Array(32),n=Do(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,tW(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Jp(e,t){var r=new Uint8Array(32),n=Do(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function sW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return nW(e,t,r,e[0]);case 5:return aW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function En(e){var t=Kt(e);return Wu(t[1][0].data)}function qx(e,t){var r=Kt(t.data),n=Ir(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=Kt(i.data),l=Ir(o[1][0].data)>>>0;switch(n){case 1:s[l]=Ig(o[3][0].data);break;case 8:{var c=e[En(o[9][0].data)][0],u=Kt(c.data),d=e[En(u[1][0].data)][0],h=Ir(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var v=Kt(d.data);s[l]=v[3].map(function(y){return Ig(y.data)}).join("")}break}}),s}function iW(e,t){var r,n,a,s,i,o,l,c,u,d,h,v,y,p,_=Kt(e),x=Ir(_[1][0].data)>>>0,k=Ir(_[2][0].data)>>>0,w=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Ir(_[8][0].data)>0||!1,E,I;if((s=(a=_[7])==null?void 0:a[0])!=null&&s.data&&t!=0)E=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,I=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=_[4])==null?void 0:u[0])!=null&&d.data&&t!=1)E=(v=(h=_[4])==null?void 0:h[0])==null?void 0:v.data,I=(p=(y=_[3])==null?void 0:y[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=w?4:1,C=Do(E),V=[],z=0;z<E.length/2;++z){var ee=C.getUint16(z*2,!0);ee<65535&&V.push([z,ee])}if(V.length!=k)throw"Expected ".concat(k," cells, found ").concat(V.length);var re=[];for(z=0;z<V.length-1;++z)re[V[z][0]]=I.subarray(V[z][1]*D,V[z+1][1]*D);return V.length>=1&&(re[V[V.length-1][0]]=I.subarray(V[V.length-1][1]*D)),{R:x,cells:re}}function oW(e,t){var r,n=Kt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ir(n[7][0].data)>>>0>0?1:0:-1,s=Fv(n[5],function(i){return iW(i,a)});return{nrows:Ir(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function lW(e,t,r){var n,a=Kt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ir(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ir(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=It(s);var i=Kt(a[4][0].data),o=qx(e,e[En(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?qx(e,e[En(i[17][0].data)][0]):[],c=Kt(i[3][0].data),u=0;c[1].forEach(function(d){var h=Kt(d.data),v=e[En(h[2][0].data)][0],y=Ir(v.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var p=oW(e,v);p.data.forEach(function(_,x){_.forEach(function(k,w){var E=xt({r:u+x,c:w}),I=sW(k,o,l);I&&(r[E]=I)})}),u+=p.nrows})}function cW(e,t){var r=Kt(t.data),n={"!ref":"A1"},a=e[En(r[2][0].data)],s=Ir(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return lW(e,a[0],n),n}function uW(e,t){var r,n=Kt(t.data),a={name:(r=n[1])!=null&&r[0]?Ig(n[1][0].data):"",sheets:[]},s=Fv(n[2],En);return s.forEach(function(i){e[i].forEach(function(o){var l=Ir(o.meta[1][0].data);l==6e3&&a.sheets.push(cW(e,o))})}),a}function fW(e,t){var r=zv(),n=Kt(t.data),a=Fv(n[1],En);if(a.forEach(function(s){e[s].forEach(function(i){var o=Ir(i.meta[1][0].data);if(o==2){var l=uW(e,i);l.sheets.forEach(function(c,u){Vv(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Qp(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Ea(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=Sa(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ir(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var u=Ir(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return fW(s,o)}function dW(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Ir(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Do(e[7][0].data),u=0,d=[],h=Do(e[4][0].data),v=0,y=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),h.setUint16(p*2,v,!0);var _,x;switch(typeof t[p]){case"string":_=Yp({t:"s",v:t[p]},r),x=Jp({t:"s",v:t[p]},r);break;case"number":_=Yp({t:"n",v:t[p]},r),x=Jp({t:"n",v:t[p]},r);break;case"boolean":_=Yp({t:"b",v:t[p]},r),x=Jp({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}d.push(_),u+=_.length,y.push(x),v+=x.length,++l}for(e[2][0].data=Zt(l);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=Mi(d),e[3][0].data=Mi(y),l}function hW(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=na(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(It(n)));var s=Dh(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(J){return J.forEach(function(K){typeof K=="string"&&i.push(K)})});var o={},l=[],c=ht.read(t.numbers,{type:"base64"});c.FileIndex.map(function(J,K){return[J,c.FullPaths[K]]}).forEach(function(J){var K=J[0],X=J[1];if(K.type==2&&K.name.match(/\.iwa/)){var ge=K.content,Pe=Ea(ge),je=Sa(Pe);je.forEach(function(ce){l.push(ce.id),o[ce.id]={deps:[],location:X,type:Ir(ce.messages[0].meta[1][0].data)}})}}),l.sort(function(J,K){return J-K});var u=l.filter(function(J){return J>1}).map(function(J){return[J,Zt(J)]});c.FileIndex.map(function(J,K){return[J,c.FullPaths[K]]}).forEach(function(J){var K=J[0];if(J[1],!!K.name.match(/\.iwa/)){var X=Sa(Ea(K.content));X.forEach(function(ge){ge.messages.forEach(function(Pe){u.forEach(function(je){ge.messages.some(function(ce){return Ir(ce.meta[1][0].data)!=11006&&QV(ce.data,je[1])})&&o[je[0]].deps.push(ge.id)})})})}});for(var d=ht.find(c,o[1].location),h=Sa(Ea(d.content)),v,y=0;y<h.length;++y){var p=h[y];p.id==1&&(v=p)}var _=En(Kt(v.messages[0].data)[1][0].data);for(d=ht.find(c,o[_].location),h=Sa(Ea(d.content)),y=0;y<h.length;++y)p=h[y],p.id==_&&(v=p);for(_=En(Kt(v.messages[0].data)[2][0].data),d=ht.find(c,o[_].location),h=Sa(Ea(d.content)),y=0;y<h.length;++y)p=h[y],p.id==_&&(v=p);for(_=En(Kt(v.messages[0].data)[2][0].data),d=ht.find(c,o[_].location),h=Sa(Ea(d.content)),y=0;y<h.length;++y)p=h[y],p.id==_&&(v=p);var x=Kt(v.messages[0].data);{x[6][0].data=Zt(n.e.r+1),x[7][0].data=Zt(n.e.c+1);var k=En(x[46][0].data),w=ht.find(c,o[k].location),E=Sa(Ea(w.content));{for(var I=0;I<E.length&&E[I].id!=k;++I);if(E[I].id!=k)throw"Bad ColumnRowUIDMapArchive";var D=Kt(E[I].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var C=0;C<=n.e.c;++C){var V=[];V[1]=V[2]=[{type:0,data:Zt(C+420690)}],D[1].push({type:2,data:dn(V)}),D[2].push({type:0,data:Zt(C)}),D[3].push({type:0,data:Zt(C)})}D[4]=[],D[5]=[],D[6]=[];for(var z=0;z<=n.e.r;++z)V=[],V[1]=V[2]=[{type:0,data:Zt(z+726270)}],D[4].push({type:2,data:dn(V)}),D[5].push({type:0,data:Zt(z)}),D[6].push({type:0,data:Zt(z)});E[I].messages[0].data=dn(D)}w.content=il(sl(E)),w.size=w.content.length,delete x[46];var ee=Kt(x[4][0].data);{ee[7][0].data=Zt(n.e.r+1);var re=Kt(ee[1][0].data),G=En(re[2][0].data);w=ht.find(c,o[G].location),E=Sa(Ea(w.content));{if(E[0].id!=G)throw"Bad HeaderStorageBucket";var me=Kt(E[0].messages[0].data);for(z=0;z<s.length;++z){var Ee=Kt(me[2][0].data);Ee[1][0].data=Zt(z),Ee[4][0].data=Zt(s[z].length),me[2][z]={type:me[2][0].type,data:dn(Ee)}}E[0].messages[0].data=dn(me)}w.content=il(sl(E)),w.size=w.content.length;var Ae=En(ee[2][0].data);w=ht.find(c,o[Ae].location),E=Sa(Ea(w.content));{if(E[0].id!=Ae)throw"Bad HeaderStorageBucket";for(me=Kt(E[0].messages[0].data),C=0;C<=n.e.c;++C)Ee=Kt(me[2][0].data),Ee[1][0].data=Zt(C),Ee[4][0].data=Zt(n.e.r+1),me[2][C]={type:me[2][0].type,data:dn(Ee)};E[0].messages[0].data=dn(me)}w.content=il(sl(E)),w.size=w.content.length;var ke=En(ee[4][0].data);(function(){for(var J=ht.find(c,o[ke].location),K=Sa(Ea(J.content)),X,ge=0;ge<K.length;++ge){var Pe=K[ge];Pe.id==ke&&(X=Pe)}var je=Kt(X.messages[0].data);{je[3]=[];var ce=[];i.forEach(function(N,Ue){ce[1]=[{type:0,data:Zt(Ue)}],ce[2]=[{type:0,data:Zt(1)}],ce[3]=[{type:2,data:JV(N)}],je[3].push({type:2,data:dn(ce)})})}X.messages[0].data=dn(je);var Te=sl(K),dt=il(Te);J.content=dt,J.size=J.content.length})();var Oe=Kt(ee[3][0].data);{var Ce=Oe[1][0];delete Oe[2];var Z=Kt(Ce.data);{var Se=En(Z[2][0].data);(function(){for(var J=ht.find(c,o[Se].location),K=Sa(Ea(J.content)),X,ge=0;ge<K.length;++ge){var Pe=K[ge];Pe.id==Se&&(X=Pe)}var je=Kt(X.messages[0].data);{delete je[6],delete Oe[7];var ce=new Uint8Array(je[5][0].data);je[5]=[];for(var Te=0,dt=0;dt<=n.e.r;++dt){var N=Kt(ce);Te+=dW(N,s[dt],i),N[1][0].data=Zt(dt),je[5].push({data:dn(N),type:2})}je[1]=[{type:0,data:Zt(n.e.c+1)}],je[2]=[{type:0,data:Zt(n.e.r+1)}],je[3]=[{type:0,data:Zt(Te)}],je[4]=[{type:0,data:Zt(n.e.r+1)}]}X.messages[0].data=dn(je);var Ue=sl(K),it=il(Ue);J.content=it,J.size=J.content.length})()}Ce.data=dn(Z)}ee[3][0].data=dn(Oe)}x[4][0].data=dn(ee)}v.messages[0].data=dn(x);var Ve=sl(h),B=il(Ve);return d.content=B,d.size=d.content.length,c}function z4(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Lv(e){z4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Mv(e){z4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function pW(e){return Rt.WS.indexOf(e)>-1?"sheet":e==Rt.CS?"chart":e==Rt.DS?"dialog":e==Rt.MS?"macro":e&&e.length?e:"sheet"}function mW(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,pW(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function gW(e,t,r,n,a,s,i,o,l,c,u,d){try{s[n]=ou(fa(e,r,!0),t);var h=zr(e,t),v;switch(o){case"sheet":v=Mz(h,t,a,l,s[n],c,u,d);break;case"chart":if(v=Bz(h,t,a,l,s[n],c,u,d),!v||!v["!drawel"])break;var y=zc(v["!drawel"].Target,t),p=Mu(y),_=EM(fa(e,y,!0),ou(fa(e,p,!0),y)),x=zc(_,y),k=Mu(x);v=dz(fa(e,x,!0),x,l,ou(fa(e,k,!0),x),c,v);break;case"macro":v=$z(h,t,a,l,s[n],c,u,d);break;case"dialog":v=Uz(h,t,a,l,s[n],c,u,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=v;var w=[];s&&s[n]&&Dr(s[n]).forEach(function(E){var I="";if(s[n][E].Type==Rt.CMNT){I=zc(s[n][E].Target,t);var D=Hz(zr(e,I,!0),I,l);if(!D||!D.length)return;Dx(v,D,!1)}s[n][E].Type==Rt.TCMNT&&(I=zc(s[n][E].Target,t),w=w.concat(CM(zr(e,I,!0),l)))}),w&&w.length&&Dx(v,w,!0,l.people||[])}catch(E){if(l.WTF)throw E}}function ka(e){return e.charAt(0)=="/"?e.slice(1):e}function vW(e,t){if(sc(),t=t||{},Lv(t),Ta(e,"META-INF/manifest.xml")||Ta(e,"objectdata.xml"))return Vx(e,t);if(Ta(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Qp<"u"){if(e.FileIndex)return Qp(e);var r=ht.utils.cfb_new();return Qw(e).forEach(function(Ee){Dt(r,Ee,Nj(e,Ee))}),Qp(r)}throw new Error("Unsupported NUMBERS file")}if(!Ta(e,"[Content_Types].xml"))throw Ta(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ta(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Qw(e),a=xF(fa(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",zr(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!zr(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(lu=[],a.sst)try{lu=Wz(zr(e,ka(a.sst)),a.sst,t)}catch(Ee){if(t.WTF)throw Ee}t.cellStyles&&a.themes.length&&(l=Vz(fa(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=zz(zr(e,ka(a.style)),a.style,l,t))}a.links.map(function(Ee){try{var Ae=ou(fa(e,Mu(ka(Ee))),Ee);return qz(zr(e,ka(Ee)),Ae,Ee,t)}catch{}});var u=Lz(zr(e,ka(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=zr(e,ka(a.coreprops[0]),!0),h&&(d=OE(h)),a.extprops.length!==0&&(h=zr(e,ka(a.extprops[0]),!0),h&&NF(h,d,t)));var v={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=fa(e,ka(a.custprops[0]),!0),h&&(v=OF(h,t)));var y={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(Ae){return Ae.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(y.Props=d,y.Custprops=v),t.bookSheets&&typeof i<"u"&&(y.SheetNames=i),t.bookSheets?y.SheetNames:t.bookProps))return y;i={};var p={};t.bookDeps&&a.calcchain&&(p=Kz(zr(e,ka(a.calcchain)),a.calcchain));var _=0,x={},k,w;{var E=u.Sheets;d.Worksheets=E.length,d.SheetNames=[];for(var I=0;I!=E.length;++I)d.SheetNames[I]=E[I].name}var D=s?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),V=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Ta(e,V)||(V="xl/_rels/workbook."+D+".rels");var z=ou(fa(e,V,!0),V.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Gz(zr(e,ka(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=AM(zr(e,ka(a.people[0])),t)),z&&(z=mW(z,u.Sheets));var ee=zr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=d.Worksheets;++_){var re="sheet";if(z&&z[_]?(k="xl/"+z[_][1].replace(/[\/]?xl\//,""),Ta(e,k)||(k=z[_][1]),Ta(e,k)||(k=V.replace(/_rels\/.*$/,"")+z[_][1]),re=z[_][2]):(k="xl/worksheets/sheet"+(_+1-ee)+"."+D,k=k.replace(/sheet0\./,"sheet.")),w=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(d.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var G=!1,me=0;me!=t.sheets.length;++me)typeof t.sheets[me]=="number"&&t.sheets[me]==_&&(G=1),typeof t.sheets[me]=="string"&&t.sheets[me].toLowerCase()==d.SheetNames[_].toLowerCase()&&(G=1);if(!G)continue e}}gW(e,k,w,d.SheetNames[_],_,x,i,re,t,u,l,c)}return y={Directory:a,Workbook:u,Props:d,Custprops:v,Deps:p,Sheets:i,SheetNames:d.SheetNames,Strings:lu,Styles:c,Themes:l,SSF:pr(_t)},t&&t.bookFiles&&(e.files?(y.keys=n,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(Ee,Ae){Ee=Ee.replace(/^Root Entry[\/]/,""),y.keys.push(Ee),y.files[Ee]=e.FileIndex[Ae]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=zr(e,ka(a.vba[0]),!0):a.defaults&&a.defaults.bin===LM&&(y.vbaraw=zr(e,"xl/vbaProject.bin",!0))),y}function yW(e,t){var r=t||{},n="Workbook",a=ht.find(e,n);try{if(n="/!DataSpaces/Version",a=ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(G7(a.content),n="/!DataSpaces/DataSpaceMap",a=ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Z7(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Y7(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Q7(a.content)}catch{}if(n="/EncryptionInfo",a=ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=e9(a.content);if(n="/EncryptedPackage",a=ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function _W(e,t){return t.bookType=="ods"?U4(e,t):t.bookType=="numbers"?hW(e,t):t.bookType=="xlsb"?wW(e,t):xW(e,t)}function wW(e,t){Sl=1024,e&&!e.SSF&&(e.SSF=pr(_t)),e&&e.SSF&&(sc(),x0(e.SSF),t.revssf=b0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,cu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=m4.indexOf(t.bookType)>-1,a=bv();Mv(t=t||{});var s=cv(),i="",o=0;if(t.cellXfs=[],Zi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Dt(s,i,IE(e.Props,t)),a.coreprops.push(i),Yt(t.rels,2,i,Rt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Dt(s,i,RE(e.Props)),a.extprops.push(i),Yt(t.rels,3,i,Rt.EXT_PROPS),e.Custprops!==e.Props&&Dr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Dt(s,i,jE(e.Custprops)),a.custprops.push(i),Yt(t.rels,4,i,Rt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Dt(s,i,Zz(o-1,i,t,e,u)),a.sheets.push(i),Yt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Rt.WS[0])}if(d){var v=d["!comments"],y=!1,p="";v&&v.length>0&&(p="xl/comments"+o+"."+r,Dt(s,p,Qz(v,p)),a.comments.push(p),Yt(u,-1,"../comments"+o+"."+r,Rt.CMNT),y=!0),d["!legacy"]&&y&&Dt(s,"xl/drawings/vmlDrawing"+o+".vml",h4(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Dt(s,Mu(i),Rl(u))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Dt(s,i,Jz(t.Strings,i,t)),a.strs.push(i),Yt(t.wbrels,-1,"sharedStrings."+r,Rt.SST)),i="xl/workbook."+r,Dt(s,i,Xz(e,i)),a.workbooks.push(i),Yt(t.rels,1,i,Rt.WB),i="xl/theme/theme1.xml",Dt(s,i,Av(e.Themes,t)),a.themes.push(i),Yt(t.wbrels,-1,"theme/theme1.xml",Rt.THEME),i="xl/styles."+r,Dt(s,i,Yz(e,i,t)),a.styles.push(i),Yt(t.wbrels,-1,"styles."+r,Rt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Dt(s,i,e.vbaraw),a.vba.push(i),Yt(t.wbrels,-1,"vbaProject.bin",Rt.VBA)),i="xl/metadata."+r,Dt(s,i,eV(i)),a.metadata.push(i),Yt(t.wbrels,-1,"metadata."+r,Rt.XLMETA),Dt(s,"[Content_Types].xml",NE(a,t)),Dt(s,"_rels/.rels",Rl(t.rels)),Dt(s,"xl/_rels/workbook."+r+".rels",Rl(t.wbrels)),delete t.revssf,delete t.ssf,s}function xW(e,t){Sl=1024,e&&!e.SSF&&(e.SSF=pr(_t)),e&&e.SSF&&(sc(),x0(e.SSF),t.revssf=b0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,cu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=m4.indexOf(t.bookType)>-1,a=bv();Mv(t=t||{});var s=cv(),i="",o=0;if(t.cellXfs=[],Zi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Dt(s,i,IE(e.Props,t)),a.coreprops.push(i),Yt(t.rels,2,i,Rt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Dt(s,i,RE(e.Props)),a.extprops.push(i),Yt(t.rels,3,i,Rt.EXT_PROPS),e.Custprops!==e.Props&&Dr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Dt(s,i,jE(e.Custprops)),a.custprops.push(i),Yt(t.rels,4,i,Rt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],v=(h||{})["!type"]||"sheet";switch(v){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Dt(s,i,T4(o-1,t,e,d)),a.sheets.push(i),Yt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Rt.WS[0])}if(h){var y=h["!comments"],p=!1,_="";if(y&&y.length>0){var x=!1;y.forEach(function(k){k[1].forEach(function(w){w.T==!0&&(x=!0)})}),x&&(_="xl/threadedComments/threadedComment"+o+"."+r,Dt(s,_,NM(y,u,t)),a.threadedcomments.push(_),Yt(d,-1,"../threadedComments/threadedComment"+o+"."+r,Rt.TCMNT)),_="xl/comments"+o+"."+r,Dt(s,_,p4(y)),a.comments.push(_),Yt(d,-1,"../comments"+o+"."+r,Rt.CMNT),p=!0}h["!legacy"]&&p&&Dt(s,"xl/drawings/vmlDrawing"+o+".vml",h4(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Dt(s,Mu(i),Rl(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Dt(s,i,t4(t.Strings,t)),a.strs.push(i),Yt(t.wbrels,-1,"sharedStrings."+r,Rt.SST)),i="xl/workbook."+r,Dt(s,i,I4(e)),a.workbooks.push(i),Yt(t.rels,1,i,Rt.WB),i="xl/theme/theme1.xml",Dt(s,i,Av(e.Themes,t)),a.themes.push(i),Yt(t.wbrels,-1,"theme/theme1.xml",Rt.THEME),i="xl/styles."+r,Dt(s,i,c4(e,t)),a.styles.push(i),Yt(t.wbrels,-1,"styles."+r,Rt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Dt(s,i,e.vbaraw),a.vba.push(i),Yt(t.wbrels,-1,"vbaProject.bin",Rt.VBA)),i="xl/metadata."+r,Dt(s,i,d4()),a.metadata.push(i),Yt(t.wbrels,-1,"metadata."+r,Rt.XLMETA),u.length>1&&(i="xl/persons/person.xml",Dt(s,i,OM(u)),a.people.push(i),Yt(t.wbrels,-1,"persons/person.xml",Rt.PEOPLE)),Dt(s,"[Content_Types].xml",NE(a,t)),Dt(s,"_rels/.rels",Rl(t.rels)),Dt(s,"xl/_rels/workbook."+r+".rels",Rl(t.wbrels)),delete t.revssf,delete t.ssf,s}function Bv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ga(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function kW(e,t){return ht.find(e,"EncryptedPackage")?yW(e,t):j4(e,t)}function bW(e,t){var r,n=e,a=t||{};return a.type||(a.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),r=nE(n,a),vW(r,a)}function V4(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ag(e.slice(r),t);default:break e}return Kl.to_workbook(e,t)}function SW(e,t){var r="",n=Bv(e,t);switch(t.type){case"base64":r=ga(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=No(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=rr(r)),t.type="binary",V4(r,t)}function EW(e,t){var r=e;return t.type=="base64"&&(r=ga(r)),r=wi.utils.decode(1200,r.slice(2),"str"),t.type="binary",V4(r,t)}function TW(e){return e.match(/[^\x00-\x7F]/)?ws(e):e}function em(e,t,r,n){return n?(r.type="string",Kl.to_workbook(e,r)):Kl.to_workbook(t,r)}function Ih(e,t){av();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ih(new Uint8Array(e),(r=pr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Fl={},r.dateNF&&(Fl.dateNF=r.dateNF),r.type||(r.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Pt?"buffer":"binary",n=wj(e),typeof Uint8Array<"u"&&!Pt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=TW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=pr(r),r.type="array",Ih(sv(n),r)}switch((a=Bv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return kW(ht.read(n,r),r);break;case 9:if(a[1]<=8)return j4(n,r);break;case 60:return Ag(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return I7(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return QE.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?bW(n,r):em(e,n,r,s);case 239:return a[3]===60?Ag(n,r):em(e,n,r,s);case 255:if(a[1]===254)return EW(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return yo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return yo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Ng.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return i4.to_workbook(n,r);break;case 10:case 13:case 32:return SW(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return O7.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Ng.to_workbook(n,r):em(e,n,r,s)}function W4(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return of(t.file,ht.write(e,{type:Pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ht.write(e,t)}function CW(e,t){var r=pr(t||{}),n=_W(e,r);return NW(n,r)}function NW(e,t){var r={},n=Pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?ht.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(w0(a))}return t.password&&typeof encrypt_agile<"u"?W4(encrypt_agile(a,t.password),t):t.type==="file"?of(t.file,a):t.type=="string"?rr(a):a}function AW(e,t){var r=t||{},n=TV(e,r);return W4(n,r)}function us(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Pu(ws(n));case"binary":return ws(n);case"string":return e;case"file":return of(t.file,n,"utf8");case"buffer":return Pt?Qs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):us(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function OW(e,t){switch(t.type){case"base64":return Pu(e);case"binary":return e;case"string":return e;case"file":return of(t.file,e,"binary");case"buffer":return Pt?Qs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function pd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Pu(r):t.type=="string"?rr(r):r;case"file":return of(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function $v(e,t){av(),kz(e);var r=pr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=$v(e,r);return r.type="array",w0(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return us(_V(e,r),r);case"slk":case"sylk":return us(JE.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return us(L4(e.Sheets[e.SheetNames[a]],r),r);case"txt":return OW(H4(e.Sheets[e.SheetNames[a]],r),r);case"csv":return us(Uv(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return us(QE.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return pd(Ng.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return us(Kl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return us(i4.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return us(e4.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return us(U4(e,r),r);case"wk1":return pd(yo.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return pd(yo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),pd(F4(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),AW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return CW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function IW(e,t,r,n,a,s,i,o){var l=Lr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var v=t.s.c;v<=t.e.c;++v){var y=i?e[r][v]:e[n[v]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[v]!=null&&(h[s[v]]=c);continue}var p=y.v;switch(y.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[v]!=null){if(p==null)if(y.t=="e"&&p===null)h[s[v]]=null;else if(c!==void 0)h[s[v]]=c;else if(u&&p===null)h[s[v]]=null;else continue;else h[s[v]]=u&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?p:Ys(y,p,o);p!=null&&(d=!1)}}return{row:h,isempty:d}}function Dh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Wt(u);break;case"number":l=Wt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var d=Lr(l.s.r),h=[],v=[],y=0,p=0,_=Array.isArray(e),x=l.s.r,k=0,w={};_&&!e[x]&&(e[x]=[]);var E=c.skipHidden&&e["!cols"]||[],I=c.skipHidden&&e["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(E[k]||{}).hidden)switch(h[k]=xr(k),r=_?e[x][k]:e[h[k]+d],n){case 1:s[k]=k-l.s.c;break;case 2:s[k]=h[k];break;case 3:s[k]=c.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Ys(r,null,c),p=w[i]||0,!p)w[i]=1;else{do o=i+"_"+p++;while(w[o]);w[i]=p,w[o]=1}s[k]=o}for(x=l.s.r+a;x<=l.e.r;++x)if(!(I[x]||{}).hidden){var D=IW(e,l,x,h,n,s,_,c);(D.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(v[y++]=D.row)}return v.length=y,v}var Gx=/"/g;function DW(e,t,r,n,a,s,i,o){for(var l=!0,c=[],u="",d=Lr(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var v=o.dense?(e[r]||[])[h]:e[n[h]+d];if(v==null)u="";else if(v.v!=null){l=!1,u=""+(o.rawNumbers&&v.t=="n"?v.v:Ys(v,null,o));for(var y=0,p=0;y!==u.length;++y)if((p=u.charCodeAt(y))===a||p===s||p===34||o.forceQuotes){u='"'+u.replace(Gx,'""')+'"';break}u=="ID"&&(u='"ID"')}else v.f!=null&&!v.F?(l=!1,u="="+v.f,u.indexOf(",")>=0&&(u='"'+u.replace(Gx,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function Uv(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Wt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(h[y]||{}).hidden||(d[y]=xr(y));for(var p=0,_=a.s.r;_<=a.e.r;++_)(v[_]||{}).hidden||(u=DW(e,a,_,d,i,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function H4(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Uv(e,t);return r}function PW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Wt(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=xr(o);for(var u=a.s.r;u<=a.e.r;++u)for(s=Lr(u),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function K4(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?kr(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=Wt(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(i=d.e.r+1,u.e.r=i+t.length-1+a)}else i==-1&&(i=0,u.e.r=t.length-1+a);var h=n.header||[],v=0;t.forEach(function(p,_){Dr(p).forEach(function(x){(v=h.indexOf(x))==-1&&(h[v=h.length]=x);var k=p[x],w="z",E="",I=xt({c:o+v,r:i+_+a});c=Hu(s,I),k&&typeof k=="object"&&!(k instanceof Date)?s[I]=k:(typeof k=="number"?w="n":typeof k=="boolean"?w="b":typeof k=="string"?w="s":k instanceof Date?(w="d",n.cellDates||(w="n",k=Qr(k)),E=n.dateNF||_t[14]):k===null&&n.nullError&&(w="e",k=0),c?(c.t=w,c.v=k,delete c.w,delete c.R,E&&(c.z=E)):s[I]=c={t:w,v:k},E&&(c.z=E))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var y=Lr(i);if(a)for(v=0;v<h.length;++v)s[xr(v+o)+y]={t:"s",v:h[v]};return s["!ref"]=It(u),s}function RW(e,t){return K4(null,e,t)}function Hu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=kr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Hu(e,xt(t)):Hu(e,xt({r:t,c:r||0}))}function jW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function zv(){return{SheetNames:[],Sheets:{}}}function Vv(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(O4(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function FW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=jW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function LW(e,t){return e.z=t,e}function q4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function MW(e,t,r){return q4(e,"#"+t,r)}function BW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function $W(e,t,r,n){for(var a=typeof t!="string"?t:Wt(t),s=typeof t=="string"?t:It(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=Hu(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var ar={encode_col:xr,encode_row:Lr,encode_cell:xt,encode_range:It,decode_col:vv,decode_row:gv,split_cell:Jj,decode_cell:kr,decode_range:na,format_cell:Ys,sheet_add_aoa:xE,sheet_add_json:K4,sheet_add_dom:M4,aoa_to_sheet:ic,json_to_sheet:RW,table_to_sheet:B4,table_to_book:GV,sheet_to_csv:Uv,sheet_to_txt:H4,sheet_to_json:Dh,sheet_to_html:L4,sheet_to_formulae:PW,sheet_to_row_object_array:Dh,sheet_get_cell:Hu,book_new:zv,book_append_sheet:Vv,book_set_sheet_visibility:FW,cell_set_number_format:LW,cell_set_hyperlink:q4,cell_set_internal_link:MW,cell_add_comment:BW,sheet_set_array_formula:$W,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function In(e){if(!e)return"";try{let t;if(typeof e=="string")if(e.includes("/")){const[s,i,o]=e.split("/");s.length===4?t=new Date(parseInt(s),parseInt(i)-1,parseInt(o)):o.length===4?t=new Date(parseInt(o),parseInt(i)-1,parseInt(s)):t=new Date(e)}else if(e.includes("-")){const[s,i,o]=e.split("-");s.length===4?t=new Date(e):t=new Date(parseInt(o),parseInt(i)-1,parseInt(s))}else t=new Date(e);else typeof e=="number"?e<1e5?t=new Date((e-25569)*86400*1e3):t=new Date(e):t=new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return`${r}-${n}-${a}`}catch{return""}}function G4(e){if(!e)return null;try{const[t,r,n]=e.split("-").map(s=>parseInt(s,10));if(!t||!r||!n||t<1||t>31||r<1||r>12)return null;const a=new Date(n,r-1,t);return a.getDate()!==t||a.getMonth()!==r-1||a.getFullYear()!==n?null:a}catch{return null}}function Gl(e){if(!e)return"";try{let t;if(typeof e=="string")if(e.includes("-")&&e.split("-")[0].length===2){if(t=G4(e),!t)return""}else t=new Date(e);else t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]}catch{return""}}function gs(e){if(!e)return"";try{let t;if(typeof e=="string")if(e.includes("-")&&e.split("-")[0].length===2){if(t=G4(e),!t)return""}else t=new Date(e);else t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return""}}function El(e){if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}}function Vc(){return In(new Date)}const UW={"PIX RECEBIDO":/pix\s*recebid/i,"PIX ENVIADO":/pix\s*enviad/i,TED:/\bted\b/i,DOC:/\bdoc\b/i,CARTÃO:/cart[aã]o/i,DINHEIRO:/dinheiro/i,BOLETO:/boleto/i,TRANSFERÊNCIA:/transfer[eê]ncia/i,DEPÓSITO:/dep[oó]sito/i,SAQUE:/saque/i},Ic={date:["data","date","data do lançamento","data do lancamento","dt","data mov","data movimento"],history:["histórico","historico","descrição","descricao","histórico/descrição","historico/descricao","descrição/histórico","descricao/historico","desc"],value:["valor","valor (r$)","valor r$","vlr","val"],credit:["crédito","credito","entrada","receita"],debit:["débito","debito","saída","saida","despesa"]};async function zW(e){console.log("parseExcelFile: Starting to parse file:",e.name);try{console.log("parseExcelFile: Reading file as arrayBuffer...");const t=await e.arrayBuffer();console.log("parseExcelFile: ArrayBuffer size:",t.byteLength),console.log("parseExcelFile: Reading workbook with XLSX...");const r=Ih(t,{type:"array"});if(console.log("parseExcelFile: Workbook sheet names:",r.SheetNames),r.SheetNames.length===0)return{success:!1,data:[],errors:["Arquivo não contém planilhas"],warnings:[],stats:{totalRows:0,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}};const n=r.Sheets[r.SheetNames[0]],a=ar.sheet_to_json(n,{header:1});if(a.length<2)return{success:!1,data:[],errors:["Arquivo não contém dados suficientes"],warnings:[],stats:{totalRows:0,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}};const s=VW(a);if(!s)return{success:!1,data:[],errors:["Não foi possível encontrar cabeçalhos válidos. Verifique se o arquivo contém colunas: Data, Histórico e Valor"],warnings:[],stats:{totalRows:0,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}};const{headerRowIndex:i,columnIndexes:o}=s,l=[];if(o.date===-1&&l.push("Data"),o.history===-1&&l.push("Histórico"),o.value===-1&&(o.credit===-1||o.debit===-1)&&l.push("Valor (ou Crédito/Débito)"),l.length>0)return{success:!1,data:[],errors:[`Colunas essenciais não encontradas: ${l.join(", ")}. Sugestões de nomes aceitos: Data/Date, Histórico/Descrição, Valor/Valor(R$)`],warnings:[],stats:{totalRows:a.length-i-1,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}};const c=[],u=[];let d=0,h=0,v=0,y=0;for(let p=i+1;p<a.length;p++){const _=a[p];if(!_||_.every(k=>!k||String(k).trim()===""))continue;const x=HW(_,o,p+1);c.push(x),x.validationStatus==="valid"?(h++,d+=x.value):x.validationStatus==="warning"?(v++,d+=x.value,x.validationMessage&&u.push(`Linha ${p+1}: ${x.validationMessage}`)):y++}return{success:!0,data:c,errors:[],warnings:u,stats:{totalRows:c.length,validRows:h,rowsWithWarnings:v,rowsWithErrors:y,totalValue:d}}}catch(t){return{success:!1,data:[],errors:[`Erro ao processar arquivo: ${t instanceof Error?t.message:"Erro desconhecido"}`],warnings:[],stats:{totalRows:0,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}}}}function VW(e){for(let t=0;t<Math.min(10,e.length);t++){const r=e[t];if(!r)continue;const n=r.map(s=>String(s||"").toLowerCase().trim()),a=WW(n);if(a.date!==-1&&a.history!==-1&&(a.value!==-1||a.credit!==-1&&a.debit!==-1))return{headerRowIndex:t,columnIndexes:a}}return null}function WW(e){const t={date:-1,history:-1,value:-1,credit:-1,debit:-1};return e.forEach((r,n)=>{const a=r.toLowerCase().trim();a&&(t.date===-1&&Ic.date.some(s=>a.includes(s))&&(t.date=n),t.history===-1&&Ic.history.some(s=>a.includes(s))&&(t.history=n),t.value===-1&&Ic.value.some(s=>a.includes(s))&&(t.value=n),t.credit===-1&&Ic.credit.some(s=>a.includes(s))&&(t.credit=n),t.debit===-1&&Ic.debit.some(s=>a.includes(s))&&(t.debit=n))}),t}function HW(e,t,r){const n=[];let a="valid";const s=e[t.date],i=KW(s);i||(n.push("Data inválida"),a="warning");const o=String(e[t.history]||""),l=qW(o),c=GW(o);c||(n.push("CPF não encontrado"),a==="valid"&&(a="warning"));let u=0;if(t.value!==-1)u=tm(e[t.value]);else if(t.credit!==-1&&t.debit!==-1){const d=tm(e[t.credit]),h=tm(e[t.debit]);u=d-h}return isNaN(u)&&(n.push("Valor inválido"),a="error",u=0),{date:i||"Data inválida",paymentType:l||"OUTROS",cpf:c||"",value:Math.round(u*100)/100,originalHistory:o,validationStatus:a,validationMessage:n.length>0?n.join(", "):void 0}}function KW(e){if(!e)return null;try{let t;if(typeof e=="number")t=new Date((e-25569)*86400*1e3);else{const r=String(e).trim();if(r.match(/^\d{2}\/\d{2}\/\d{4}$/)){const[n,a,s]=r.split("/");t=new Date(parseInt(s),parseInt(a)-1,parseInt(n))}else if(r.match(/^\d{4}-\d{2}-\d{2}$/))t=new Date(r);else if(r.match(/^\d{2}-\d{2}-\d{4}$/)){const[n,a,s]=r.split("-");t=new Date(parseInt(s),parseInt(a)-1,parseInt(n))}else t=new Date(r)}return isNaN(t.getTime())?null:In(t)}catch{return null}}function qW(e){const t=e.toUpperCase();for(const[r,n]of Object.entries(UW))if(n.test(e))return r;return t.includes("PIX")?t.includes("ENVIO")||t.includes("TRANSF")?"PIX ENVIADO":"PIX RECEBIDO":null}function GW(e){const r=e.replace(/\D/g,"").match(/\d{11}/);if(r){const a=r[0];if(!/^(\d)\1{10}$/.test(a))return a}const n=e.match(/\d{3}\.?\d{3}\.?\d{3}-?\d{2}/);return n?n[0].replace(/\D/g,""):null}function tm(e){if(typeof e=="number")return e;if(typeof e=="string"){let t=e.replace(/[R$\s]/g,"");t=t.replace(",","."),t=t.replace(/[^\d.-]/g,"");const r=parseFloat(t);return isNaN(r)?0:r}return 0}const XW=({selectedFile:e,onDateSelected:t,className:r=""})=>{const[n,a]=j.useState("automatic"),[s,i]=j.useState(Gl(new Date)),[o,l]=j.useState(null),[c,u]=j.useState(!1),[d,h]=j.useState(null);j.useEffect(()=>{e&&n==="automatic"&&v()},[e,n]);const v=async()=>{if(e){u(!0),h(null);try{const x=await zW(e);if(x.success&&x.data.length>0){const k=x.data.map(w=>w.date).filter(w=>w&&w!=="Invalid Date");if(k.length>0){const w=k.reduce((D,C)=>(D[C]=(D[C]||0)+1,D),{}),E=Object.entries(w).sort(([,D],[,C])=>C-D)[0][0],I=In(E);l(I),t(I,"automatic")}else{const w=Vc();l(w),h("Nenhuma data válida encontrada no arquivo. Usando data atual."),t(w,"automatic")}}else{const k=Vc();l(k),h("Não foi possível detectar data do arquivo. Usando data atual."),t(k,"automatic")}}catch(x){console.error("Error detecting date from file:",x);const k=Vc();l(k),h("Erro ao detectar data. Usando data atual."),t(k,"automatic")}finally{u(!1)}}},y=x=>{if(a(x),h(null),x==="automatic"&&o)t(o,"automatic");else if(x==="manual"){const k=In(s);t(k,"manual")}},p=x=>{if(i(x),n==="manual"){const k=In(x);t(k,"manual")}},_=()=>n==="automatic"?o||Vc():In(s);return m.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border border-gray-700 ${r}`,children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"2"}),"Selecionar Dia"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"flex items-center cursor-pointer group",children:[m.jsx("input",{type:"radio",name:"dateMode",value:"automatic",checked:n==="automatic",onChange:()=>y("automatic"),className:"mr-2 text-indigo-600 focus:ring-indigo-500"}),m.jsxs("div",{className:"flex-1",children:[m.jsx("span",{className:"text-sm text-gray-300 group-hover:text-gray-100",children:"Data Automática"}),n==="automatic"&&o&&m.jsxs("span",{className:"ml-2 text-xs text-indigo-400",children:["(",gs(o),")"]})]})]}),m.jsxs("label",{className:"flex items-center cursor-pointer group",children:[m.jsx("input",{type:"radio",name:"dateMode",value:"manual",checked:n==="manual",onChange:()=>y("manual"),className:"mr-2 text-indigo-600 focus:ring-indigo-500"}),m.jsx("span",{className:"text-sm text-gray-300 group-hover:text-gray-100",children:"Selecionar Manualmente"})]})]}),n==="manual"&&m.jsxs("div",{className:"mt-2",children:[m.jsx("label",{htmlFor:"manual-date-input",className:"sr-only",children:"Data manual"}),m.jsx("input",{id:"manual-date-input",type:"date",value:s,onChange:x=>p(x.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Selecionar data manualmente"})]}),c&&m.jsx("div",{className:"p-2 bg-indigo-900/20 border border-indigo-600 rounded-md",children:m.jsxs("div",{className:"flex items-center",children:[m.jsxs("svg",{className:"animate-spin h-4 w-4 text-indigo-400 mr-2",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),m.jsx("span",{className:"text-xs text-indigo-400",children:"Detectando data do arquivo..."})]})}),d&&m.jsx("div",{className:"p-2 bg-yellow-900/20 border border-yellow-600 rounded-md",children:m.jsx("p",{className:"text-xs text-yellow-400",children:d})}),m.jsx("div",{className:"bg-gray-900 rounded p-3 border border-gray-600",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-xs text-gray-400",children:"Data selecionada:"}),m.jsxs("div",{className:"text-right",children:[m.jsx("span",{className:"text-sm text-indigo-400 font-medium",children:gs(_())}),m.jsxs("span",{className:"block text-xs text-gray-500 mt-1",children:["Modo: ",n==="automatic"?"Automático":"Manual"]})]})]})}),m.jsx("div",{className:"p-2 bg-gray-700 rounded-md",children:m.jsx("p",{className:"text-xs text-gray-400",children:n==="automatic"?"A data será detectada automaticamente do arquivo carregado.":"Você está selecionando a data manualmente."})})]})]})},ZW="00000000-0000-0000-0000-000000000001",Cr=yt;async function fs(){var t;const{data:e}=await yt.auth.getUser();return((t=e==null?void 0:e.user)==null?void 0:t.id)||ZW}var X4={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(pa,function(){var r=function(f,g){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,S){b.__proto__=S}||function(b,S){for(var T in S)Object.prototype.hasOwnProperty.call(S,T)&&(b[T]=S[T])})(f,g)},n=function(){return(n=Object.assign||function(f){for(var g,b=1,S=arguments.length;b<S;b++)for(var T in g=arguments[b])Object.prototype.hasOwnProperty.call(g,T)&&(f[T]=g[T]);return f}).apply(this,arguments)};function a(f,g,b){for(var S,T=0,A=g.length;T<A;T++)!S&&T in g||((S=S||Array.prototype.slice.call(g,0,T))[T]=g[T]);return f.concat(S||Array.prototype.slice.call(g))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:globalThis,i=Object.keys,o=Array.isArray;function l(f,g){return typeof g!="object"||i(g).forEach(function(b){f[b]=g[b]}),f}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(f,g){return u.call(f,g)}function h(f,g){typeof g=="function"&&(g=g(c(f))),(typeof Reflect>"u"?i:Reflect.ownKeys)(g).forEach(function(b){y(f,b,g[b])})}var v=Object.defineProperty;function y(f,g,b,S){v(f,g,l(b&&d(b,"get")&&typeof b.get=="function"?{get:b.get,set:b.set,configurable:!0}:{value:b,configurable:!0,writable:!0},S))}function p(f){return{from:function(g){return f.prototype=Object.create(g.prototype),y(f.prototype,"constructor",f),{extend:h.bind(null,f.prototype)}}}}var _=Object.getOwnPropertyDescriptor,x=[].slice;function k(f,g,b){return x.call(f,g,b)}function w(f,g){return g(f)}function E(f){if(!f)throw new Error("Assertion Failed")}function I(f){s.setImmediate?setImmediate(f):setTimeout(f,0)}function D(f,g){if(typeof g=="string"&&d(f,g))return f[g];if(!g)return f;if(typeof g!="string"){for(var b=[],S=0,T=g.length;S<T;++S){var A=D(f,g[S]);b.push(A)}return b}var L=g.indexOf(".");if(L!==-1){var W=f[g.substr(0,L)];return W==null?void 0:D(W,g.substr(L+1))}}function C(f,g,b){if(f&&g!==void 0&&!("isFrozen"in Object&&Object.isFrozen(f)))if(typeof g!="string"&&"length"in g){E(typeof b!="string"&&"length"in b);for(var S=0,T=g.length;S<T;++S)C(f,g[S],b[S])}else{var A,L,W=g.indexOf(".");W!==-1?(A=g.substr(0,W),(L=g.substr(W+1))===""?b===void 0?o(f)&&!isNaN(parseInt(A))?f.splice(A,1):delete f[A]:f[A]=b:C(W=!(W=f[A])||!d(f,A)?f[A]={}:W,L,b)):b===void 0?o(f)&&!isNaN(parseInt(g))?f.splice(g,1):delete f[g]:f[g]=b}}function V(f){var g,b={};for(g in f)d(f,g)&&(b[g]=f[g]);return b}var z=[].concat;function ee(f){return z.apply([],f)}var nt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ee([8,16,32,64].map(function(f){return["Int","Uint","Float"].map(function(g){return g+f+"Array"})}))).filter(function(f){return s[f]}),re=new Set(nt.map(function(f){return s[f]})),G=null;function me(f){return G=new WeakMap,f=function g(b){if(!b||typeof b!="object")return b;var S=G.get(b);if(S)return S;if(o(b)){S=[],G.set(b,S);for(var T=0,A=b.length;T<A;++T)S.push(g(b[T]))}else if(re.has(b.constructor))S=b;else{var L,W=c(b);for(L in S=W===Object.prototype?{}:Object.create(W),G.set(b,S),b)d(b,L)&&(S[L]=g(b[L]))}return S}(f),G=null,f}var Ee={}.toString;function Ae(f){return Ee.call(f).slice(8,-1)}var ke=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Oe=typeof ke=="symbol"?function(f){var g;return f!=null&&(g=f[ke])&&g.apply(f)}:function(){return null};function Ce(f,g){return g=f.indexOf(g),0<=g&&f.splice(g,1),0<=g}var Z={};function Se(f){var g,b,S,T;if(arguments.length===1){if(o(f))return f.slice();if(this===Z&&typeof f=="string")return[f];if(T=Oe(f)){for(b=[];!(S=T.next()).done;)b.push(S.value);return b}if(f==null)return[f];if(typeof(g=f.length)!="number")return[f];for(b=new Array(g);g--;)b[g]=f[g];return b}for(g=arguments.length,b=new Array(g);g--;)b[g]=arguments[g];return b}var Ve=typeof Symbol<"u"?function(f){return f[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Re=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xa=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Re),B={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function J(f,g){this.name=f,this.message=g}function K(f,g){return f+". Errors: "+Object.keys(g).map(function(b){return g[b].toString()}).filter(function(b,S,T){return T.indexOf(b)===S}).join(`
`)}function X(f,g,b,S){this.failures=g,this.failedKeys=S,this.successCount=b,this.message=K(f,g)}function ge(f,g){this.name="BulkError",this.failures=Object.keys(g).map(function(b){return g[b]}),this.failuresByPos=g,this.message=K(f,this.failures)}p(J).from(Error).extend({toString:function(){return this.name+": "+this.message}}),p(X).from(J),p(ge).from(J);var Pe=xa.reduce(function(f,g){return f[g]=g+"Error",f},{}),je=J,ce=xa.reduce(function(f,g){var b=g+"Error";function S(T,A){this.name=b,T?typeof T=="string"?(this.message="".concat(T).concat(A?`
 `+A:""),this.inner=A||null):typeof T=="object"&&(this.message="".concat(T.name," ").concat(T.message),this.inner=T):(this.message=B[g]||b,this.inner=null)}return p(S).from(je),f[g]=S,f},{});ce.Syntax=SyntaxError,ce.Type=TypeError,ce.Range=RangeError;var Te=Re.reduce(function(f,g){return f[g+"Error"]=ce[g],f},{}),dt=xa.reduce(function(f,g){return["Syntax","Type","Range"].indexOf(g)===-1&&(f[g+"Error"]=ce[g]),f},{});function N(){}function Ue(f){return f}function it(f,g){return f==null||f===Ue?g:function(b){return g(f(b))}}function ct(f,g){return function(){f.apply(this,arguments),g.apply(this,arguments)}}function mt(f,g){return f===N?g:function(){var b=f.apply(this,arguments);b!==void 0&&(arguments[0]=b);var S=this.onsuccess,T=this.onerror;this.onsuccess=null,this.onerror=null;var A=g.apply(this,arguments);return S&&(this.onsuccess=this.onsuccess?ct(S,this.onsuccess):S),T&&(this.onerror=this.onerror?ct(T,this.onerror):T),A!==void 0?A:b}}function Fe(f,g){return f===N?g:function(){f.apply(this,arguments);var b=this.onsuccess,S=this.onerror;this.onsuccess=this.onerror=null,g.apply(this,arguments),b&&(this.onsuccess=this.onsuccess?ct(b,this.onsuccess):b),S&&(this.onerror=this.onerror?ct(S,this.onerror):S)}}function $t(f,g){return f===N?g:function(b){var S=f.apply(this,arguments);l(b,S);var T=this.onsuccess,A=this.onerror;return this.onsuccess=null,this.onerror=null,b=g.apply(this,arguments),T&&(this.onsuccess=this.onsuccess?ct(T,this.onsuccess):T),A&&(this.onerror=this.onerror?ct(A,this.onerror):A),S===void 0?b===void 0?void 0:b:l(S,b)}}function yr(f,g){return f===N?g:function(){return g.apply(this,arguments)!==!1&&f.apply(this,arguments)}}function H(f,g){return f===N?g:function(){var b=f.apply(this,arguments);if(b&&typeof b.then=="function"){for(var S=this,T=arguments.length,A=new Array(T);T--;)A[T]=arguments[T];return b.then(function(){return g.apply(S,A)})}return g.apply(this,arguments)}}dt.ModifyError=X,dt.DexieError=J,dt.BulkError=ge;var ae=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ye(f){ae=f}var Ke={},Be=100,nt=typeof Promise>"u"?[]:function(){var f=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[f,c(f),f];var g=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[g,c(g),f]}(),Re=nt[0],xa=nt[1],nt=nt[2],xa=xa&&xa.then,St=Re&&Re.constructor,gt=!!nt,qt=function(f,g){_a.push([f,g]),jt&&(queueMicrotask(Ie),jt=!1)},wt=!0,jt=!0,lr=[],Gt=[],cn=Ue,Fn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:N,pgp:!1,env:{},finalize:N},lt=Fn,_a=[],Ln=0,Ts=[];function Qe(f){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var g=this._PSD=lt;if(typeof f!="function"){if(f!==Ke)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&as(this,this._value))}this._state=null,this._value=null,++g.ref,function b(S,T){try{T(function(A){if(S._state===null){if(A===S)throw new TypeError("A promise cannot be resolved with itself.");var L=S._lib&&tt();A&&typeof A.then=="function"?b(S,function(W,Y){A instanceof Qe?A._then(W,Y):A.then(W,Y)}):(S._state=!0,S._value=A,Vo(S)),L&&ft()}},as.bind(null,S))}catch(A){as(S,A)}}(this,f)}var Ma={get:function(){var f=lt,g=M;function b(S,T){var A=this,L=!f.global&&(f!==lt||g!==M),W=L&&!U(),Y=new Qe(function(te,se){ni(A,new ri(Le(S,f,L,W),Le(T,f,L,W),te,se,f))});return this._consoleTask&&(Y._consoleTask=this._consoleTask),Y}return b.prototype=Ke,b},set:function(f){y(this,"then",f&&f.prototype===Ke?Ma:{get:function(){return f},set:Ma.set})}};function ri(f,g,b,S,T){this.onFulfilled=typeof f=="function"?f:null,this.onRejected=typeof g=="function"?g:null,this.resolve=b,this.reject=S,this.psd=T}function as(f,g){var b,S;Gt.push(g),f._state===null&&(b=f._lib&&tt(),g=cn(g),f._state=!1,f._value=g,S=f,lr.some(function(T){return T._value===S._value})||lr.push(S),Vo(f),b&&ft())}function Vo(f){var g=f._listeners;f._listeners=[];for(var b=0,S=g.length;b<S;++b)ni(f,g[b]);var T=f._PSD;--T.ref||T.finalize(),Ln===0&&(++Ln,qt(function(){--Ln==0&&Ft()},[]))}function ni(f,g){if(f._state!==null){var b=f._state?g.onFulfilled:g.onRejected;if(b===null)return(f._state?g.resolve:g.reject)(f._value);++g.psd.ref,++Ln,qt(Wo,[b,f,g])}else f._listeners.push(g)}function Wo(f,g,b){try{var S,T=g._value;!g._state&&Gt.length&&(Gt=[]),S=ae&&g._consoleTask?g._consoleTask.run(function(){return f(T)}):f(T),g._state||Gt.indexOf(T)!==-1||function(A){for(var L=lr.length;L;)if(lr[--L]._value===A._value)return lr.splice(L,1)}(g),b.resolve(S)}catch(A){b.reject(A)}finally{--Ln==0&&Ft(),--b.psd.ref||b.psd.finalize()}}function Ie(){he(Fn,function(){tt()&&ft()})}function tt(){var f=wt;return jt=wt=!1,f}function ft(){var f,g,b;do for(;0<_a.length;)for(f=_a,_a=[],b=f.length,g=0;g<b;++g){var S=f[g];S[0].apply(null,S[1])}while(0<_a.length);jt=wt=!0}function Ft(){var f=lr;lr=[],f.forEach(function(S){S._PSD.onunhandled.call(null,S._value,S)});for(var g=Ts.slice(0),b=g.length;b;)g[--b]()}function un(f){return new Qe(Ke,!1,f)}function Et(f,g){var b=lt;return function(){var S=tt(),T=lt;try{return fe(b,!0),f.apply(this,arguments)}catch(A){g&&g(A)}finally{fe(T,!1),S&&ft()}}}h(Qe.prototype,{then:Ma,_then:function(f,g){ni(this,new ri(null,null,f,g,lt))},catch:function(f){if(arguments.length===1)return this.then(null,f);var g=f,b=arguments[1];return typeof g=="function"?this.then(null,function(S){return(S instanceof g?b:un)(S)}):this.then(null,function(S){return(S&&S.name===g?b:un)(S)})},finally:function(f){return this.then(function(g){return Qe.resolve(f()).then(function(){return g})},function(g){return Qe.resolve(f()).then(function(){return un(g)})})},timeout:function(f,g){var b=this;return f<1/0?new Qe(function(S,T){var A=setTimeout(function(){return T(new ce.Timeout(g))},f);b.then(S,T).finally(clearTimeout.bind(null,A))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y(Qe.prototype,Symbol.toStringTag,"Dexie.Promise"),Fn.env=pe(),h(Qe,{all:function(){var f=Se.apply(null,arguments).map(de);return new Qe(function(g,b){f.length===0&&g([]);var S=f.length;f.forEach(function(T,A){return Qe.resolve(T).then(function(L){f[A]=L,--S||g(f)},b)})})},resolve:function(f){return f instanceof Qe?f:f&&typeof f.then=="function"?new Qe(function(g,b){f.then(g,b)}):new Qe(Ke,!0,f)},reject:un,race:function(){var f=Se.apply(null,arguments).map(de);return new Qe(function(g,b){f.map(function(S){return Qe.resolve(S).then(g,b)})})},PSD:{get:function(){return lt},set:function(f){return lt=f}},totalEchoes:{get:function(){return M}},newPSD:R,usePSD:he,scheduler:{get:function(){return qt},set:function(f){qt=f}},rejectionMapper:{get:function(){return cn},set:function(f){cn=f}},follow:function(f,g){return new Qe(function(b,S){return R(function(T,A){var L=lt;L.unhandleds=[],L.onunhandled=A,L.finalize=ct(function(){var W,Y=this;W=function(){Y.unhandleds.length===0?T():A(Y.unhandleds[0])},Ts.push(function te(){W(),Ts.splice(Ts.indexOf(te),1)}),++Ln,qt(function(){--Ln==0&&Ft()},[])},L.finalize),f()},g,b,S)})}}),St&&(St.allSettled&&y(Qe,"allSettled",function(){var f=Se.apply(null,arguments).map(de);return new Qe(function(g){f.length===0&&g([]);var b=f.length,S=new Array(b);f.forEach(function(T,A){return Qe.resolve(T).then(function(L){return S[A]={status:"fulfilled",value:L}},function(L){return S[A]={status:"rejected",reason:L}}).then(function(){return--b||g(S)})})})}),St.any&&typeof AggregateError<"u"&&y(Qe,"any",function(){var f=Se.apply(null,arguments).map(de);return new Qe(function(g,b){f.length===0&&b(new AggregateError([]));var S=f.length,T=new Array(S);f.forEach(function(A,L){return Qe.resolve(A).then(function(W){return g(W)},function(W){T[L]=W,--S||b(new AggregateError(T))})})})}),St.withResolvers&&(Qe.withResolvers=St.withResolvers));var vt={awaits:0,echoes:0,id:0},fn=0,_r=[],O=0,M=0,P=0;function R(f,g,b,S){var T=lt,A=Object.create(T);return A.parent=T,A.ref=0,A.global=!1,A.id=++P,Fn.env,A.env=gt?{Promise:Qe,PromiseProp:{value:Qe,configurable:!0,writable:!0},all:Qe.all,race:Qe.race,allSettled:Qe.allSettled,any:Qe.any,resolve:Qe.resolve,reject:Qe.reject}:{},g&&l(A,g),++T.ref,A.finalize=function(){--this.parent.ref||this.parent.finalize()},S=he(A,f,b,S),A.ref===0&&A.finalize(),S}function F(){return vt.id||(vt.id=++fn),++vt.awaits,vt.echoes+=Be,vt.id}function U(){return!!vt.awaits&&(--vt.awaits==0&&(vt.id=0),vt.echoes=vt.awaits*Be,!0)}function de(f){return vt.echoes&&f&&f.constructor===St?(F(),f.then(function(g){return U(),g},function(g){return U(),He(g)})):f}function be(){var f=_r[_r.length-1];_r.pop(),fe(f,!1)}function fe(f,g){var b,S=lt;(g?!vt.echoes||O++&&f===lt:!O||--O&&f===lt)||queueMicrotask(g?(function(T){++M,vt.echoes&&--vt.echoes!=0||(vt.echoes=vt.awaits=vt.id=0),_r.push(lt),fe(T,!0)}).bind(null,f):be),f!==lt&&(lt=f,S===Fn&&(Fn.env=pe()),gt&&(b=Fn.env.Promise,g=f.env,(S.global||f.global)&&(Object.defineProperty(s,"Promise",g.PromiseProp),b.all=g.all,b.race=g.race,b.resolve=g.resolve,b.reject=g.reject,g.allSettled&&(b.allSettled=g.allSettled),g.any&&(b.any=g.any))))}function pe(){var f=s.Promise;return gt?{Promise:f,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:f.all,race:f.race,allSettled:f.allSettled,any:f.any,resolve:f.resolve,reject:f.reject}:{}}function he(f,g,b,S,T){var A=lt;try{return fe(f,!0),g(b,S,T)}finally{fe(A,!1)}}function Le(f,g,b,S){return typeof f!="function"?f:function(){var T=lt;b&&F(),fe(g,!0);try{return f.apply(this,arguments)}finally{fe(T,!1),S&&queueMicrotask(U)}}}function Ye(f){Promise===St&&vt.echoes===0?O===0?f():enqueueNativeMicroTask(f):setTimeout(f,0)}(""+xa).indexOf("[native code]")===-1&&(F=U=N);var He=Qe.reject,$e="￿",Je="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",bt="String expected.",Xt=[],tr="__dbnames",Br="readonly",Cs="readwrite";function sa(f,g){return f?g?function(){return f.apply(this,arguments)&&g.apply(this,arguments)}:f:g}var ai={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function wa(f){return typeof f!="string"||/\./.test(f)?function(g){return g}:function(g){return g[f]===void 0&&f in g&&delete(g=me(g))[f],g}}function Ho(){throw ce.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Tt(f,g){try{var b=Hv(f),S=Hv(g);if(b!==S)return b==="Array"?1:S==="Array"?-1:b==="binary"?1:S==="binary"?-1:b==="string"?1:S==="string"?-1:b==="Date"?1:S!=="Date"?NaN:-1;switch(b){case"number":case"Date":case"string":return g<f?1:f<g?-1:0;case"binary":return function(T,A){for(var L=T.length,W=A.length,Y=L<W?L:W,te=0;te<Y;++te)if(T[te]!==A[te])return T[te]<A[te]?-1:1;return L===W?0:L<W?-1:1}(Kv(f),Kv(g));case"Array":return function(T,A){for(var L=T.length,W=A.length,Y=L<W?L:W,te=0;te<Y;++te){var se=Tt(T[te],A[te]);if(se!==0)return se}return L===W?0:L<W?-1:1}(f,g)}}catch{}return NaN}function Hv(f){var g=typeof f;return g!="object"?g:ArrayBuffer.isView(f)?"binary":(f=Ae(f),f==="ArrayBuffer"?"binary":f)}function Kv(f){return f instanceof Uint8Array?f:ArrayBuffer.isView(f)?new Uint8Array(f.buffer,f.byteOffset,f.byteLength):new Uint8Array(f)}function mf(f,g,b){var S=f.schema.yProps;return S?(g&&0<b.numFailures&&(g=g.filter(function(T,A){return!b.failures[A]})),Promise.all(S.map(function(T){return T=T.updatesTable,g?f.db.table(T).where("k").anyOf(g).delete():f.db.table(T).clear()})).then(function(){return b})):b}var qv=(cr.prototype._trans=function(f,g,b){var S=this._tx||lt.trans,T=this.name,A=ae&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(f==="readonly"?"read":"write"," ").concat(this.name));function L(te,se,q){if(!q.schema[T])throw new ce.NotFound("Table "+T+" not part of transaction");return g(q.idbtrans,q)}var W=tt();try{var Y=S&&S.db._novip===this.db._novip?S===lt.trans?S._promise(f,L,b):R(function(){return S._promise(f,L,b)},{trans:S,transless:lt.transless||lt}):function te(se,q,le,Q){if(se.idbdb&&(se._state.openComplete||lt.letThrough||se._vip)){var ne=se._createTransaction(q,le,se._dbSchema);try{ne.create(),se._state.PR1398_maxLoop=3}catch(oe){return oe.name===Pe.InvalidState&&se.isOpen()&&0<--se._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),se.close({disableAutoOpen:!1}),se.open().then(function(){return te(se,q,le,Q)})):He(oe)}return ne._promise(q,function(oe,ie){return R(function(){return lt.trans=ne,Q(oe,ie,ne)})}).then(function(oe){if(q==="readwrite")try{ne.idbtrans.commit()}catch{}return q==="readonly"?oe:ne._completion.then(function(){return oe})})}if(se._state.openComplete)return He(new ce.DatabaseClosed(se._state.dbOpenError));if(!se._state.isBeingOpened){if(!se._state.autoOpen)return He(new ce.DatabaseClosed);se.open().catch(N)}return se._state.dbReadyPromise.then(function(){return te(se,q,le,Q)})}(this.db,f,[this.name],L);return A&&(Y._consoleTask=A,Y=Y.catch(function(te){return console.trace(te),He(te)})),Y}finally{W&&ft()}},cr.prototype.get=function(f,g){var b=this;return f&&f.constructor===Object?this.where(f).first(g):f==null?He(new ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(S){return b.core.get({trans:S,key:f}).then(function(T){return b.hook.reading.fire(T)})}).then(g)},cr.prototype.where=function(f){if(typeof f=="string")return new this.db.WhereClause(this,f);if(o(f))return new this.db.WhereClause(this,"[".concat(f.join("+"),"]"));var g=i(f);if(g.length===1)return this.where(g[0]).equals(f[g[0]]);var b=this.schema.indexes.concat(this.schema.primKey).filter(function(W){if(W.compound&&g.every(function(te){return 0<=W.keyPath.indexOf(te)})){for(var Y=0;Y<g.length;++Y)if(g.indexOf(W.keyPath[Y])===-1)return!1;return!0}return!1}).sort(function(W,Y){return W.keyPath.length-Y.keyPath.length})[0];if(b&&this.db._maxKey!==$e){var A=b.keyPath.slice(0,g.length);return this.where(A).equals(A.map(function(Y){return f[Y]}))}!b&&ae&&console.warn("The query ".concat(JSON.stringify(f)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(g.join("+"),"]"));var S=this.schema.idxByName;function T(W,Y){return Tt(W,Y)===0}var L=g.reduce(function(q,Y){var te=q[0],se=q[1],q=S[Y],le=f[Y];return[te||q,te||!q?sa(se,q&&q.multi?function(Q){return Q=D(Q,Y),o(Q)&&Q.some(function(ne){return T(le,ne)})}:function(Q){return T(le,D(Q,Y))}):se]},[null,null]),A=L[0],L=L[1];return A?this.where(A.name).equals(f[A.keyPath]).filter(L):b?this.filter(L):this.where(g).equals("")},cr.prototype.filter=function(f){return this.toCollection().and(f)},cr.prototype.count=function(f){return this.toCollection().count(f)},cr.prototype.offset=function(f){return this.toCollection().offset(f)},cr.prototype.limit=function(f){return this.toCollection().limit(f)},cr.prototype.each=function(f){return this.toCollection().each(f)},cr.prototype.toArray=function(f){return this.toCollection().toArray(f)},cr.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},cr.prototype.orderBy=function(f){return new this.db.Collection(new this.db.WhereClause(this,o(f)?"[".concat(f.join("+"),"]"):f))},cr.prototype.reverse=function(){return this.toCollection().reverse()},cr.prototype.mapToClass=function(f){var g,b=this.db,S=this.name;function T(){return g!==null&&g.apply(this,arguments)||this}(this.schema.mappedClass=f).prototype instanceof Ho&&(function(Y,te){if(typeof te!="function"&&te!==null)throw new TypeError("Class extends value "+String(te)+" is not a constructor or null");function se(){this.constructor=Y}r(Y,te),Y.prototype=te===null?Object.create(te):(se.prototype=te.prototype,new se)}(T,g=f),Object.defineProperty(T.prototype,"db",{get:function(){return b},enumerable:!1,configurable:!0}),T.prototype.table=function(){return S},f=T);for(var A=new Set,L=f.prototype;L;L=c(L))Object.getOwnPropertyNames(L).forEach(function(Y){return A.add(Y)});function W(Y){if(!Y)return Y;var te,se=Object.create(f.prototype);for(te in Y)if(!A.has(te))try{se[te]=Y[te]}catch{}return se}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=W,this.hook("reading",W),f},cr.prototype.defineClass=function(){return this.mapToClass(function(f){l(this,f)})},cr.prototype.add=function(f,g){var b=this,S=this.schema.primKey,T=S.auto,A=S.keyPath,L=f;return A&&T&&(L=wa(A)(f)),this._trans("readwrite",function(W){return b.core.mutate({trans:W,type:"add",keys:g!=null?[g]:null,values:[L]})}).then(function(W){return W.numFailures?Qe.reject(W.failures[0]):W.lastResult}).then(function(W){if(A)try{C(f,A,W)}catch{}return W})},cr.prototype.update=function(f,g){return typeof f!="object"||o(f)?this.where(":id").equals(f).modify(g):(f=D(f,this.schema.primKey.keyPath),f===void 0?He(new ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(f).modify(g))},cr.prototype.put=function(f,g){var b=this,S=this.schema.primKey,T=S.auto,A=S.keyPath,L=f;return A&&T&&(L=wa(A)(f)),this._trans("readwrite",function(W){return b.core.mutate({trans:W,type:"put",values:[L],keys:g!=null?[g]:null})}).then(function(W){return W.numFailures?Qe.reject(W.failures[0]):W.lastResult}).then(function(W){if(A)try{C(f,A,W)}catch{}return W})},cr.prototype.delete=function(f){var g=this;return this._trans("readwrite",function(b){return g.core.mutate({trans:b,type:"delete",keys:[f]}).then(function(S){return mf(g,[f],S)}).then(function(S){return S.numFailures?Qe.reject(S.failures[0]):void 0})})},cr.prototype.clear=function(){var f=this;return this._trans("readwrite",function(g){return f.core.mutate({trans:g,type:"deleteRange",range:ai}).then(function(b){return mf(f,null,b)})}).then(function(g){return g.numFailures?Qe.reject(g.failures[0]):void 0})},cr.prototype.bulkGet=function(f){var g=this;return this._trans("readonly",function(b){return g.core.getMany({keys:f,trans:b}).then(function(S){return S.map(function(T){return g.hook.reading.fire(T)})})})},cr.prototype.bulkAdd=function(f,g,b){var S=this,T=Array.isArray(g)?g:void 0,A=(b=b||(T?void 0:g))?b.allKeys:void 0;return this._trans("readwrite",function(L){var te=S.schema.primKey,W=te.auto,te=te.keyPath;if(te&&T)throw new ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(T&&T.length!==f.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var Y=f.length,te=te&&W?f.map(wa(te)):f;return S.core.mutate({trans:L,type:"add",keys:T,values:te,wantResults:A}).then(function(ne){var q=ne.numFailures,le=ne.results,Q=ne.lastResult,ne=ne.failures;if(q===0)return A?le:Q;throw new ge("".concat(S.name,".bulkAdd(): ").concat(q," of ").concat(Y," operations failed"),ne)})})},cr.prototype.bulkPut=function(f,g,b){var S=this,T=Array.isArray(g)?g:void 0,A=(b=b||(T?void 0:g))?b.allKeys:void 0;return this._trans("readwrite",function(L){var te=S.schema.primKey,W=te.auto,te=te.keyPath;if(te&&T)throw new ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(T&&T.length!==f.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var Y=f.length,te=te&&W?f.map(wa(te)):f;return S.core.mutate({trans:L,type:"put",keys:T,values:te,wantResults:A}).then(function(ne){var q=ne.numFailures,le=ne.results,Q=ne.lastResult,ne=ne.failures;if(q===0)return A?le:Q;throw new ge("".concat(S.name,".bulkPut(): ").concat(q," of ").concat(Y," operations failed"),ne)})})},cr.prototype.bulkUpdate=function(f){var g=this,b=this.core,S=f.map(function(L){return L.key}),T=f.map(function(L){return L.changes}),A=[];return this._trans("readwrite",function(L){return b.getMany({trans:L,keys:S,cache:"clone"}).then(function(W){var Y=[],te=[];f.forEach(function(q,le){var Q=q.key,ne=q.changes,oe=W[le];if(oe){for(var ie=0,ue=Object.keys(ne);ie<ue.length;ie++){var ve=ue[ie],_e=ne[ve];if(ve===g.schema.primKey.keyPath){if(Tt(_e,Q)!==0)throw new ce.Constraint("Cannot update primary key in bulkUpdate()")}else C(oe,ve,_e)}A.push(le),Y.push(Q),te.push(oe)}});var se=Y.length;return b.mutate({trans:L,type:"put",keys:Y,values:te,updates:{keys:S,changeSpecs:T}}).then(function(q){var le=q.numFailures,Q=q.failures;if(le===0)return se;for(var ne=0,oe=Object.keys(Q);ne<oe.length;ne++){var ie,ue=oe[ne],ve=A[Number(ue)];ve!=null&&(ie=Q[ue],delete Q[ue],Q[ve]=ie)}throw new ge("".concat(g.name,".bulkUpdate(): ").concat(le," of ").concat(se," operations failed"),Q)})})})},cr.prototype.bulkDelete=function(f){var g=this,b=f.length;return this._trans("readwrite",function(S){return g.core.mutate({trans:S,type:"delete",keys:f}).then(function(T){return mf(g,f,T)})}).then(function(L){var T=L.numFailures,A=L.lastResult,L=L.failures;if(T===0)return A;throw new ge("".concat(g.name,".bulkDelete(): ").concat(T," of ").concat(b," operations failed"),L)})},cr);function cr(){}function cc(f){function g(L,W){if(W){for(var Y=arguments.length,te=new Array(Y-1);--Y;)te[Y-1]=arguments[Y];return b[L].subscribe.apply(null,te),f}if(typeof L=="string")return b[L]}var b={};g.addEventType=A;for(var S=1,T=arguments.length;S<T;++S)A(arguments[S]);return g;function A(L,W,Y){if(typeof L!="object"){var te;W=W||yr;var se={subscribers:[],fire:Y=Y||N,subscribe:function(q){se.subscribers.indexOf(q)===-1&&(se.subscribers.push(q),se.fire=W(se.fire,q))},unsubscribe:function(q){se.subscribers=se.subscribers.filter(function(le){return le!==q}),se.fire=se.subscribers.reduce(W,Y)}};return b[L]=g[L]=se}i(te=L).forEach(function(q){var le=te[q];if(o(le))A(q,te[q][0],te[q][1]);else{if(le!=="asap")throw new ce.InvalidArgument("Invalid event config");var Q=A(q,Ue,function(){for(var ne=arguments.length,oe=new Array(ne);ne--;)oe[ne]=arguments[ne];Q.subscribers.forEach(function(ie){I(function(){ie.apply(null,oe)})})})}})}}function uc(f,g){return p(g).from({prototype:f}),g}function Ko(f,g){return!(f.filter||f.algorithm||f.or)&&(g?f.justLimit:!f.replayFilter)}function O0(f,g){f.filter=sa(f.filter,g)}function I0(f,g,b){var S=f.replayFilter;f.replayFilter=S?function(){return sa(S(),g())}:g,f.justLimit=b&&!S}function gf(f,g){if(f.isPrimKey)return g.primaryKey;var b=g.getIndexByKeyPath(f.index);if(!b)throw new ce.Schema("KeyPath "+f.index+" on object store "+g.name+" is not indexed");return b}function Gv(f,g,b){var S=gf(f,g.schema);return g.openCursor({trans:b,values:!f.keysOnly,reverse:f.dir==="prev",unique:!!f.unique,query:{index:S,range:f.range}})}function vf(f,g,b,S){var T=f.replayFilter?sa(f.filter,f.replayFilter()):f.filter;if(f.or){var A={},L=function(W,Y,te){var se,q;T&&!T(Y,te,function(le){return Y.stop(le)},function(le){return Y.fail(le)})||((q=""+(se=Y.primaryKey))=="[object ArrayBuffer]"&&(q=""+new Uint8Array(se)),d(A,q)||(A[q]=!0,g(W,Y,te)))};return Promise.all([f.or._iterate(L,b),Xv(Gv(f,S,b),f.algorithm,L,!f.keysOnly&&f.valueMapper)])}return Xv(Gv(f,S,b),sa(f.algorithm,T),g,!f.keysOnly&&f.valueMapper)}function Xv(f,g,b,S){var T=Et(S?function(A,L,W){return b(S(A),L,W)}:b);return f.then(function(A){if(A)return A.start(function(){var L=function(){return A.continue()};g&&!g(A,function(W){return L=W},function(W){A.stop(W),L=N},function(W){A.fail(W),L=N})||T(A.value,A,function(W){return L=W}),L()})})}var fc=(Zv.prototype.execute=function(f){var g=this["@@propmod"];if(g.add!==void 0){var b=g.add;if(o(b))return a(a([],o(f)?f:[],!0),b).sort();if(typeof b=="number")return(Number(f)||0)+b;if(typeof b=="bigint")try{return BigInt(f)+b}catch{return BigInt(0)+b}throw new TypeError("Invalid term ".concat(b))}if(g.remove!==void 0){var S=g.remove;if(o(S))return o(f)?f.filter(function(T){return!S.includes(T)}).sort():[];if(typeof S=="number")return Number(f)-S;if(typeof S=="bigint")try{return BigInt(f)-S}catch{return BigInt(0)-S}throw new TypeError("Invalid subtrahend ".concat(S))}return b=(b=g.replacePrefix)===null||b===void 0?void 0:b[0],b&&typeof f=="string"&&f.startsWith(b)?g.replacePrefix[1]+f.substring(b.length):f},Zv);function Zv(f){this["@@propmod"]=f}var fT=(Ht.prototype._read=function(f,g){var b=this._ctx;return b.error?b.table._trans(null,He.bind(null,b.error)):b.table._trans("readonly",f).then(g)},Ht.prototype._write=function(f){var g=this._ctx;return g.error?g.table._trans(null,He.bind(null,g.error)):g.table._trans("readwrite",f,"locked")},Ht.prototype._addAlgorithm=function(f){var g=this._ctx;g.algorithm=sa(g.algorithm,f)},Ht.prototype._iterate=function(f,g){return vf(this._ctx,f,g,this._ctx.table.core)},Ht.prototype.clone=function(f){var g=Object.create(this.constructor.prototype),b=Object.create(this._ctx);return f&&l(b,f),g._ctx=b,g},Ht.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ht.prototype.each=function(f){var g=this._ctx;return this._read(function(b){return vf(g,f,b,g.table.core)})},Ht.prototype.count=function(f){var g=this;return this._read(function(b){var S=g._ctx,T=S.table.core;if(Ko(S,!0))return T.count({trans:b,query:{index:gf(S,T.schema),range:S.range}}).then(function(L){return Math.min(L,S.limit)});var A=0;return vf(S,function(){return++A,!1},b,T).then(function(){return A})}).then(f)},Ht.prototype.sortBy=function(f,g){var b=f.split(".").reverse(),S=b[0],T=b.length-1;function A(Y,te){return te?A(Y[b[te]],te-1):Y[S]}var L=this._ctx.dir==="next"?1:-1;function W(Y,te){return Tt(A(Y,T),A(te,T))*L}return this.toArray(function(Y){return Y.sort(W)}).then(g)},Ht.prototype.toArray=function(f){var g=this;return this._read(function(b){var S=g._ctx;if(S.dir==="next"&&Ko(S,!0)&&0<S.limit){var T=S.valueMapper,A=gf(S,S.table.core.schema);return S.table.core.query({trans:b,limit:S.limit,values:!0,query:{index:A,range:S.range}}).then(function(W){return W=W.result,T?W.map(T):W})}var L=[];return vf(S,function(W){return L.push(W)},b,S.table.core).then(function(){return L})},f)},Ht.prototype.offset=function(f){var g=this._ctx;return f<=0||(g.offset+=f,Ko(g)?I0(g,function(){var b=f;return function(S,T){return b===0||(b===1?--b:T(function(){S.advance(b),b=0}),!1)}}):I0(g,function(){var b=f;return function(){return--b<0}})),this},Ht.prototype.limit=function(f){return this._ctx.limit=Math.min(this._ctx.limit,f),I0(this._ctx,function(){var g=f;return function(b,S,T){return--g<=0&&S(T),0<=g}},!0),this},Ht.prototype.until=function(f,g){return O0(this._ctx,function(b,S,T){return!f(b.value)||(S(T),g)}),this},Ht.prototype.first=function(f){return this.limit(1).toArray(function(g){return g[0]}).then(f)},Ht.prototype.last=function(f){return this.reverse().first(f)},Ht.prototype.filter=function(f){var g;return O0(this._ctx,function(b){return f(b.value)}),(g=this._ctx).isMatch=sa(g.isMatch,f),this},Ht.prototype.and=function(f){return this.filter(f)},Ht.prototype.or=function(f){return new this.db.WhereClause(this._ctx.table,f,this)},Ht.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ht.prototype.desc=function(){return this.reverse()},Ht.prototype.eachKey=function(f){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(b,S){f(S.key,S)})},Ht.prototype.eachUniqueKey=function(f){return this._ctx.unique="unique",this.eachKey(f)},Ht.prototype.eachPrimaryKey=function(f){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(b,S){f(S.primaryKey,S)})},Ht.prototype.keys=function(f){var g=this._ctx;g.keysOnly=!g.isMatch;var b=[];return this.each(function(S,T){b.push(T.key)}).then(function(){return b}).then(f)},Ht.prototype.primaryKeys=function(f){var g=this._ctx;if(g.dir==="next"&&Ko(g,!0)&&0<g.limit)return this._read(function(S){var T=gf(g,g.table.core.schema);return g.table.core.query({trans:S,values:!1,limit:g.limit,query:{index:T,range:g.range}})}).then(function(S){return S.result}).then(f);g.keysOnly=!g.isMatch;var b=[];return this.each(function(S,T){b.push(T.primaryKey)}).then(function(){return b}).then(f)},Ht.prototype.uniqueKeys=function(f){return this._ctx.unique="unique",this.keys(f)},Ht.prototype.firstKey=function(f){return this.limit(1).keys(function(g){return g[0]}).then(f)},Ht.prototype.lastKey=function(f){return this.reverse().firstKey(f)},Ht.prototype.distinct=function(){var f=this._ctx,f=f.index&&f.table.schema.idxByName[f.index];if(!f||!f.multi)return this;var g={};return O0(this._ctx,function(T){var S=T.primaryKey.toString(),T=d(g,S);return g[S]=!0,!T}),this},Ht.prototype.modify=function(f){var g=this,b=this._ctx;return this._write(function(S){var T,A,L;L=typeof f=="function"?f:(T=i(f),A=T.length,function(ue){for(var ve=!1,_e=0;_e<A;++_e){var we=T[_e],Me=f[we],Ze=D(ue,we);Me instanceof fc?(C(ue,we,Me.execute(Ze)),ve=!0):Ze!==Me&&(C(ue,we,Me),ve=!0)}return ve});var W=b.table.core,q=W.schema.primaryKey,Y=q.outbound,te=q.extractKey,se=200,q=g.db._options.modifyChunkSize;q&&(se=typeof q=="object"?q[W.name]||q["*"]||200:q);function le(ue,we){var _e=we.failures,we=we.numFailures;ne+=ue-we;for(var Me=0,Ze=i(_e);Me<Ze.length;Me++){var We=Ze[Me];Q.push(_e[We])}}var Q=[],ne=0,oe=[],ie=f===Yv;return g.clone().primaryKeys().then(function(ue){function ve(we){var Me=Math.min(se,ue.length-we),Ze=ue.slice(we,we+Me);return(ie?Promise.resolve([]):W.getMany({trans:S,keys:Ze,cache:"immutable"})).then(function(We){var qe=[],rt=[],et=Y?[]:null,at=ie?Ze:[];if(!ie)for(var At=0;At<Me;++At){var Ut=We[At],Nt={value:me(Ut),primKey:ue[we+At]};L.call(Nt,Nt.value,Nt)!==!1&&(Nt.value==null?at.push(ue[we+At]):Y||Tt(te(Ut),te(Nt.value))===0?(rt.push(Nt.value),Y&&et.push(ue[we+At])):(at.push(ue[we+At]),qe.push(Nt.value)))}return Promise.resolve(0<qe.length&&W.mutate({trans:S,type:"add",values:qe}).then(function(Tr){for(var Ct in Tr.failures)at.splice(parseInt(Ct),1);le(qe.length,Tr)})).then(function(){return(0<rt.length||_e&&typeof f=="object")&&W.mutate({trans:S,type:"put",keys:et,values:rt,criteria:_e,changeSpec:typeof f!="function"&&f,isAdditionalChunk:0<we}).then(function(Tr){return le(rt.length,Tr)})}).then(function(){return(0<at.length||_e&&ie)&&W.mutate({trans:S,type:"delete",keys:at,criteria:_e,isAdditionalChunk:0<we}).then(function(Tr){return mf(b.table,at,Tr)}).then(function(Tr){return le(at.length,Tr)})}).then(function(){return ue.length>we+Me&&ve(we+se)})})}var _e=Ko(b)&&b.limit===1/0&&(typeof f!="function"||ie)&&{index:b.index,range:b.range};return ve(0).then(function(){if(0<Q.length)throw new X("Error modifying one or more objects",Q,ne,oe);return ue.length})})})},Ht.prototype.delete=function(){var f=this._ctx,g=f.range;return!Ko(f)||f.table.schema.yProps||!f.isPrimKey&&g.type!==3?this.modify(Yv):this._write(function(b){var S=f.table.core.schema.primaryKey,T=g;return f.table.core.count({trans:b,query:{index:S,range:T}}).then(function(A){return f.table.core.mutate({trans:b,type:"deleteRange",range:T}).then(function(Y){var W=Y.failures,Y=Y.numFailures;if(Y)throw new X("Could not delete some values",Object.keys(W).map(function(te){return W[te]}),A-Y);return A-Y})})})},Ht);function Ht(){}var Yv=function(f,g){return g.value=null};function dT(f,g){return f<g?-1:f===g?0:1}function hT(f,g){return g<f?-1:f===g?0:1}function ia(f,g,b){return f=f instanceof Qv?new f.Collection(f):f,f._ctx.error=new(b||TypeError)(g),f}function qo(f){return new f.Collection(f,function(){return Jv("")}).limit(0)}function yf(f,g,b,S){var T,A,L,W,Y,te,se,q=b.length;if(!b.every(function(ne){return typeof ne=="string"}))return ia(f,bt);function le(ne){T=ne==="next"?function(ie){return ie.toUpperCase()}:function(ie){return ie.toLowerCase()},A=ne==="next"?function(ie){return ie.toLowerCase()}:function(ie){return ie.toUpperCase()},L=ne==="next"?dT:hT;var oe=b.map(function(ie){return{lower:A(ie),upper:T(ie)}}).sort(function(ie,ue){return L(ie.lower,ue.lower)});W=oe.map(function(ie){return ie.upper}),Y=oe.map(function(ie){return ie.lower}),se=(te=ne)==="next"?"":S}le("next"),f=new f.Collection(f,function(){return si(W[0],Y[q-1]+S)}),f._ondirectionchange=function(ne){le(ne)};var Q=0;return f._addAlgorithm(function(ne,oe,ie){var ue=ne.key;if(typeof ue!="string")return!1;var ve=A(ue);if(g(ve,Y,Q))return!0;for(var _e=null,we=Q;we<q;++we){var Me=function(Ze,We,qe,rt,et,at){for(var At=Math.min(Ze.length,rt.length),Ut=-1,Nt=0;Nt<At;++Nt){var Tr=We[Nt];if(Tr!==rt[Nt])return et(Ze[Nt],qe[Nt])<0?Ze.substr(0,Nt)+qe[Nt]+qe.substr(Nt+1):et(Ze[Nt],rt[Nt])<0?Ze.substr(0,Nt)+rt[Nt]+qe.substr(Nt+1):0<=Ut?Ze.substr(0,Ut)+We[Ut]+qe.substr(Ut+1):null;et(Ze[Nt],Tr)<0&&(Ut=Nt)}return At<rt.length&&at==="next"?Ze+qe.substr(Ze.length):At<Ze.length&&at==="prev"?Ze.substr(0,qe.length):Ut<0?null:Ze.substr(0,Ut)+rt[Ut]+qe.substr(Ut+1)}(ue,ve,W[we],Y[we],L,te);Me===null&&_e===null?Q=we+1:(_e===null||0<L(_e,Me))&&(_e=Me)}return oe(_e!==null?function(){ne.continue(_e+se)}:ie),!1}),f}function si(f,g,b,S){return{type:2,lower:f,upper:g,lowerOpen:b,upperOpen:S}}function Jv(f){return{type:1,lower:f,upper:f}}var Qv=(Object.defineProperty(tn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),tn.prototype.between=function(f,g,b,S){b=b!==!1,S=S===!0;try{return 0<this._cmp(f,g)||this._cmp(f,g)===0&&(b||S)&&(!b||!S)?qo(this):new this.Collection(this,function(){return si(f,g,!b,!S)})}catch{return ia(this,Je)}},tn.prototype.equals=function(f){return f==null?ia(this,Je):new this.Collection(this,function(){return Jv(f)})},tn.prototype.above=function(f){return f==null?ia(this,Je):new this.Collection(this,function(){return si(f,void 0,!0)})},tn.prototype.aboveOrEqual=function(f){return f==null?ia(this,Je):new this.Collection(this,function(){return si(f,void 0,!1)})},tn.prototype.below=function(f){return f==null?ia(this,Je):new this.Collection(this,function(){return si(void 0,f,!1,!0)})},tn.prototype.belowOrEqual=function(f){return f==null?ia(this,Je):new this.Collection(this,function(){return si(void 0,f)})},tn.prototype.startsWith=function(f){return typeof f!="string"?ia(this,bt):this.between(f,f+$e,!0,!0)},tn.prototype.startsWithIgnoreCase=function(f){return f===""?this.startsWith(f):yf(this,function(g,b){return g.indexOf(b[0])===0},[f],$e)},tn.prototype.equalsIgnoreCase=function(f){return yf(this,function(g,b){return g===b[0]},[f],"")},tn.prototype.anyOfIgnoreCase=function(){var f=Se.apply(Z,arguments);return f.length===0?qo(this):yf(this,function(g,b){return b.indexOf(g)!==-1},f,"")},tn.prototype.startsWithAnyOfIgnoreCase=function(){var f=Se.apply(Z,arguments);return f.length===0?qo(this):yf(this,function(g,b){return b.some(function(S){return g.indexOf(S)===0})},f,$e)},tn.prototype.anyOf=function(){var f=this,g=Se.apply(Z,arguments),b=this._cmp;try{g.sort(b)}catch{return ia(this,Je)}if(g.length===0)return qo(this);var S=new this.Collection(this,function(){return si(g[0],g[g.length-1])});S._ondirectionchange=function(A){b=A==="next"?f._ascending:f._descending,g.sort(b)};var T=0;return S._addAlgorithm(function(A,L,W){for(var Y=A.key;0<b(Y,g[T]);)if(++T===g.length)return L(W),!1;return b(Y,g[T])===0||(L(function(){A.continue(g[T])}),!1)}),S},tn.prototype.notEqual=function(f){return this.inAnyRange([[-1/0,f],[f,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},tn.prototype.noneOf=function(){var f=Se.apply(Z,arguments);if(f.length===0)return new this.Collection(this);try{f.sort(this._ascending)}catch{return ia(this,Je)}var g=f.reduce(function(b,S){return b?b.concat([[b[b.length-1][1],S]]):[[-1/0,S]]},null);return g.push([f[f.length-1],this.db._maxKey]),this.inAnyRange(g,{includeLowers:!1,includeUppers:!1})},tn.prototype.inAnyRange=function(ue,g){var b=this,S=this._cmp,T=this._ascending,A=this._descending,L=this._min,W=this._max;if(ue.length===0)return qo(this);if(!ue.every(function(ve){return ve[0]!==void 0&&ve[1]!==void 0&&T(ve[0],ve[1])<=0}))return ia(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ce.InvalidArgument);var Y=!g||g.includeLowers!==!1,te=g&&g.includeUppers===!0,se,q=T;function le(ve,_e){return q(ve[0],_e[0])}try{(se=ue.reduce(function(ve,_e){for(var we=0,Me=ve.length;we<Me;++we){var Ze=ve[we];if(S(_e[0],Ze[1])<0&&0<S(_e[1],Ze[0])){Ze[0]=L(Ze[0],_e[0]),Ze[1]=W(Ze[1],_e[1]);break}}return we===Me&&ve.push(_e),ve},[])).sort(le)}catch{return ia(this,Je)}var Q=0,ne=te?function(ve){return 0<T(ve,se[Q][1])}:function(ve){return 0<=T(ve,se[Q][1])},oe=Y?function(ve){return 0<A(ve,se[Q][0])}:function(ve){return 0<=A(ve,se[Q][0])},ie=ne,ue=new this.Collection(this,function(){return si(se[0][0],se[se.length-1][1],!Y,!te)});return ue._ondirectionchange=function(ve){q=ve==="next"?(ie=ne,T):(ie=oe,A),se.sort(le)},ue._addAlgorithm(function(ve,_e,we){for(var Me,Ze=ve.key;ie(Ze);)if(++Q===se.length)return _e(we),!1;return!ne(Me=Ze)&&!oe(Me)||(b._cmp(Ze,se[Q][1])===0||b._cmp(Ze,se[Q][0])===0||_e(function(){q===T?ve.continue(se[Q][0]):ve.continue(se[Q][1])}),!1)}),ue},tn.prototype.startsWithAnyOf=function(){var f=Se.apply(Z,arguments);return f.every(function(g){return typeof g=="string"})?f.length===0?qo(this):this.inAnyRange(f.map(function(g){return[g,g+$e]})):ia(this,"startsWithAnyOf() only works with strings")},tn);function tn(){}function ss(f){return Et(function(g){return dc(g),f(g.target.error),!1})}function dc(f){f.stopPropagation&&f.stopPropagation(),f.preventDefault&&f.preventDefault()}var hc="storagemutated",D0="x-storagemutated-1",ii=cc(null,hc),pT=(is.prototype._lock=function(){return E(!lt.global),++this._reculock,this._reculock!==1||lt.global||(lt.lockOwnerFor=this),this},is.prototype._unlock=function(){if(E(!lt.global),--this._reculock==0)for(lt.global||(lt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var f=this._blockedFuncs.shift();try{he(f[1],f[0])}catch{}}return this},is.prototype._locked=function(){return this._reculock&&lt.lockOwnerFor!==this},is.prototype.create=function(f){var g=this;if(!this.mode)return this;var b=this.db.idbdb,S=this.db._state.dbOpenError;if(E(!this.idbtrans),!f&&!b)switch(S&&S.name){case"DatabaseClosedError":throw new ce.DatabaseClosed(S);case"MissingAPIError":throw new ce.MissingAPI(S.message,S);default:throw new ce.OpenFailed(S)}if(!this.active)throw new ce.TransactionInactive;return E(this._completion._state===null),(f=this.idbtrans=f||(this.db.core||b).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Et(function(T){dc(T),g._reject(f.error)}),f.onabort=Et(function(T){dc(T),g.active&&g._reject(new ce.Abort(f.error)),g.active=!1,g.on("abort").fire(T)}),f.oncomplete=Et(function(){g.active=!1,g._resolve(),"mutatedParts"in f&&ii.storagemutated.fire(f.mutatedParts)}),this},is.prototype._promise=function(f,g,b){var S=this;if(f==="readwrite"&&this.mode!=="readwrite")return He(new ce.ReadOnly("Transaction is readonly"));if(!this.active)return He(new ce.TransactionInactive);if(this._locked())return new Qe(function(A,L){S._blockedFuncs.push([function(){S._promise(f,g,b).then(A,L)},lt])});if(b)return R(function(){var A=new Qe(function(L,W){S._lock();var Y=g(L,W,S);Y&&Y.then&&Y.then(L,W)});return A.finally(function(){return S._unlock()}),A._lib=!0,A});var T=new Qe(function(A,L){var W=g(A,L,S);W&&W.then&&W.then(A,L)});return T._lib=!0,T},is.prototype._root=function(){return this.parent?this.parent._root():this},is.prototype.waitFor=function(f){var g,b=this._root(),S=Qe.resolve(f);b._waitingFor?b._waitingFor=b._waitingFor.then(function(){return S}):(b._waitingFor=S,b._waitingQueue=[],g=b.idbtrans.objectStore(b.storeNames[0]),function A(){for(++b._spinCount;b._waitingQueue.length;)b._waitingQueue.shift()();b._waitingFor&&(g.get(-1/0).onsuccess=A)}());var T=b._waitingFor;return new Qe(function(A,L){S.then(function(W){return b._waitingQueue.push(Et(A.bind(null,W)))},function(W){return b._waitingQueue.push(Et(L.bind(null,W)))}).finally(function(){b._waitingFor===T&&(b._waitingFor=null)})})},is.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ce.Abort))},is.prototype.table=function(f){var g=this._memoizedTables||(this._memoizedTables={});if(d(g,f))return g[f];var b=this.schema[f];if(!b)throw new ce.NotFound("Table "+f+" not part of transaction");return b=new this.db.Table(f,b,this),b.core=this.db.core.table(f),g[f]=b},is);function is(){}function P0(f,g,b,S,T,A,L,W){return{name:f,keyPath:g,unique:b,multi:S,auto:T,compound:A,src:(b&&!L?"&":"")+(S?"*":"")+(T?"++":"")+ey(g),type:W}}function ey(f){return typeof f=="string"?f:f?"["+[].join.call(f,"+")+"]":""}function R0(f,g,b){return{name:f,primKey:g,indexes:b,mappedClass:null,idxByName:(S=function(T){return[T.name,T]},b.reduce(function(T,A,L){return L=S(A,L),L&&(T[L[0]]=L[1]),T},{}))};var S}var pc=function(f){try{return f.only([[]]),pc=function(){return[[]]},[[]]}catch{return pc=function(){return $e},$e}};function j0(f){return f==null?function(){}:typeof f=="string"?(g=f).split(".").length===1?function(b){return b[g]}:function(b){return D(b,g)}:function(b){return D(b,f)};var g}function ty(f){return[].slice.call(f)}var mT=0;function mc(f){return f==null?":id":typeof f=="string"?f:"[".concat(f.join("+"),"]")}function gT(f,g,Y){function S(ie){if(ie.type===3)return null;if(ie.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Q=ie.lower,ne=ie.upper,oe=ie.lowerOpen,ie=ie.upperOpen;return Q===void 0?ne===void 0?null:g.upperBound(ne,!!ie):ne===void 0?g.lowerBound(Q,!!oe):g.bound(Q,ne,!!oe,!!ie)}function T(le){var Q,ne=le.name;return{name:ne,schema:le,mutate:function(oe){var ie=oe.trans,ue=oe.type,ve=oe.keys,_e=oe.values,we=oe.range;return new Promise(function(Me,Ze){Me=Et(Me);var We=ie.objectStore(ne),qe=We.keyPath==null,rt=ue==="put"||ue==="add";if(!rt&&ue!=="delete"&&ue!=="deleteRange")throw new Error("Invalid operation type: "+ue);var et,at=(ve||_e||{length:1}).length;if(ve&&_e&&ve.length!==_e.length)throw new Error("Given keys array must have same length as given values array.");if(at===0)return Me({numFailures:0,failures:{},results:[],lastResult:void 0});function At(Mn){++Tr,dc(Mn)}var Ut=[],Nt=[],Tr=0;if(ue==="deleteRange"){if(we.type===4)return Me({numFailures:Tr,failures:Nt,results:[],lastResult:void 0});we.type===3?Ut.push(et=We.clear()):Ut.push(et=We.delete(S(we)))}else{var qe=rt?qe?[_e,ve]:[_e,null]:[ve,null],Ct=qe[0],wn=qe[1];if(rt)for(var xn=0;xn<at;++xn)Ut.push(et=wn&&wn[xn]!==void 0?We[ue](Ct[xn],wn[xn]):We[ue](Ct[xn])),et.onerror=At;else for(xn=0;xn<at;++xn)Ut.push(et=We[ue](Ct[xn])),et.onerror=At}function Of(Mn){Mn=Mn.target.result,Ut.forEach(function(Qi,Q0){return Qi.error!=null&&(Nt[Q0]=Qi.error)}),Me({numFailures:Tr,failures:Nt,results:ue==="delete"?ve:Ut.map(function(Qi){return Qi.result}),lastResult:Mn})}et.onerror=function(Mn){At(Mn),Of(Mn)},et.onsuccess=Of})},getMany:function(oe){var ie=oe.trans,ue=oe.keys;return new Promise(function(ve,_e){ve=Et(ve);for(var we,Me=ie.objectStore(ne),Ze=ue.length,We=new Array(Ze),qe=0,rt=0,et=function(Ut){Ut=Ut.target,We[Ut._pos]=Ut.result,++rt===qe&&ve(We)},at=ss(_e),At=0;At<Ze;++At)ue[At]!=null&&((we=Me.get(ue[At]))._pos=At,we.onsuccess=et,we.onerror=at,++qe);qe===0&&ve(We)})},get:function(oe){var ie=oe.trans,ue=oe.key;return new Promise(function(ve,_e){ve=Et(ve);var we=ie.objectStore(ne).get(ue);we.onsuccess=function(Me){return ve(Me.target.result)},we.onerror=ss(_e)})},query:(Q=te,function(oe){return new Promise(function(ie,ue){ie=Et(ie);var ve,_e,we,qe=oe.trans,Me=oe.values,Ze=oe.limit,et=oe.query,We=Ze===1/0?void 0:Ze,rt=et.index,et=et.range,qe=qe.objectStore(ne),rt=rt.isPrimaryKey?qe:qe.index(rt.name),et=S(et);if(Ze===0)return ie({result:[]});Q?((We=Me?rt.getAll(et,We):rt.getAllKeys(et,We)).onsuccess=function(at){return ie({result:at.target.result})},We.onerror=ss(ue)):(ve=0,_e=!Me&&"openKeyCursor"in rt?rt.openKeyCursor(et):rt.openCursor(et),we=[],_e.onsuccess=function(at){var At=_e.result;return At?(we.push(Me?At.value:At.primaryKey),++ve===Ze?ie({result:we}):void At.continue()):ie({result:we})},_e.onerror=ss(ue))})}),openCursor:function(oe){var ie=oe.trans,ue=oe.values,ve=oe.query,_e=oe.reverse,we=oe.unique;return new Promise(function(Me,Ze){Me=Et(Me);var rt=ve.index,We=ve.range,qe=ie.objectStore(ne),qe=rt.isPrimaryKey?qe:qe.index(rt.name),rt=_e?we?"prevunique":"prev":we?"nextunique":"next",et=!ue&&"openKeyCursor"in qe?qe.openKeyCursor(S(We),rt):qe.openCursor(S(We),rt);et.onerror=ss(Ze),et.onsuccess=Et(function(at){var At,Ut,Nt,Tr,Ct=et.result;Ct?(Ct.___id=++mT,Ct.done=!1,At=Ct.continue.bind(Ct),Ut=(Ut=Ct.continuePrimaryKey)&&Ut.bind(Ct),Nt=Ct.advance.bind(Ct),Tr=function(){throw new Error("Cursor not stopped")},Ct.trans=ie,Ct.stop=Ct.continue=Ct.continuePrimaryKey=Ct.advance=function(){throw new Error("Cursor not started")},Ct.fail=Et(Ze),Ct.next=function(){var wn=this,xn=1;return this.start(function(){return xn--?wn.continue():wn.stop()}).then(function(){return wn})},Ct.start=function(wn){function xn(){if(et.result)try{wn()}catch(Mn){Ct.fail(Mn)}else Ct.done=!0,Ct.start=function(){throw new Error("Cursor behind last entry")},Ct.stop()}var Of=new Promise(function(Mn,Qi){Mn=Et(Mn),et.onerror=ss(Qi),Ct.fail=Qi,Ct.stop=function(Q0){Ct.stop=Ct.continue=Ct.continuePrimaryKey=Ct.advance=Tr,Mn(Q0)}});return et.onsuccess=Et(function(Mn){et.onsuccess=xn,xn()}),Ct.continue=At,Ct.continuePrimaryKey=Ut,Ct.advance=Nt,xn(),Of},Me(Ct)):Me(null)},Ze)})},count:function(oe){var ie=oe.query,ue=oe.trans,ve=ie.index,_e=ie.range;return new Promise(function(we,Me){var Ze=ue.objectStore(ne),We=ve.isPrimaryKey?Ze:Ze.index(ve.name),Ze=S(_e),We=Ze?We.count(Ze):We.count();We.onsuccess=Et(function(qe){return we(qe.target.result)}),We.onerror=ss(Me)})}}}var A,L,W,se=(L=Y,W=ty((A=f).objectStoreNames),{schema:{name:A.name,tables:W.map(function(le){return L.objectStore(le)}).map(function(le){var Q=le.keyPath,ie=le.autoIncrement,ne=o(Q),oe={},ie={name:le.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Q==null,compound:ne,keyPath:Q,autoIncrement:ie,unique:!0,extractKey:j0(Q)},indexes:ty(le.indexNames).map(function(ue){return le.index(ue)}).map(function(we){var ve=we.name,_e=we.unique,Me=we.multiEntry,we=we.keyPath,Me={name:ve,compound:o(we),keyPath:we,unique:_e,multiEntry:Me,extractKey:j0(we)};return oe[mc(we)]=Me}),getIndexByKeyPath:function(ue){return oe[mc(ue)]}};return oe[":id"]=ie.primaryKey,Q!=null&&(oe[mc(Q)]=ie.primaryKey),ie})},hasGetAll:0<W.length&&"getAll"in L.objectStore(W[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Y=se.schema,te=se.hasGetAll,se=Y.tables.map(T),q={};return se.forEach(function(le){return q[le.name]=le}),{stack:"dbcore",transaction:f.transaction.bind(f),table:function(le){if(!q[le])throw new Error("Table '".concat(le,"' not found"));return q[le]},MIN_KEY:-1/0,MAX_KEY:pc(g),schema:Y}}function vT(f,g,b,S){var T=b.IDBKeyRange;return b.indexedDB,{dbcore:(S=gT(g,T,S),f.dbcore.reduce(function(A,L){return L=L.create,n(n({},A),L(A))},S))}}function _f(f,S){var b=S.db,S=vT(f._middlewares,b,f._deps,S);f.core=S.dbcore,f.tables.forEach(function(T){var A=T.name;f.core.schema.tables.some(function(L){return L.name===A})&&(T.core=f.core.table(A),f[A]instanceof f.Table&&(f[A].core=T.core))})}function wf(f,g,b,S){b.forEach(function(T){var A=S[T];g.forEach(function(L){var W=function Y(te,se){return _(te,se)||(te=c(te))&&Y(te,se)}(L,T);(!W||"value"in W&&W.value===void 0)&&(L===f.Transaction.prototype||L instanceof f.Transaction?y(L,T,{get:function(){return this.table(T)},set:function(Y){v(this,T,{value:Y,writable:!0,configurable:!0,enumerable:!0})}}):L[T]=new f.Table(T,A))})})}function F0(f,g){g.forEach(function(b){for(var S in b)b[S]instanceof f.Table&&delete b[S]})}function yT(f,g){return f._cfg.version-g._cfg.version}function _T(f,g,b,S){var T=f._dbSchema;b.objectStoreNames.contains("$meta")&&!T.$meta&&(T.$meta=R0("$meta",ny("")[0],[]),f._storeNames.push("$meta"));var A=f._createTransaction("readwrite",f._storeNames,T);A.create(b),A._completion.catch(S);var L=A._reject.bind(A),W=lt.transless||lt;R(function(){return lt.trans=A,lt.transless=W,g!==0?(_f(f,b),te=g,((Y=A).storeNames.includes("$meta")?Y.table("$meta").get("version").then(function(se){return se??te}):Qe.resolve(te)).then(function(se){return le=se,Q=A,ne=b,oe=[],se=(q=f)._versions,ie=q._dbSchema=kf(0,q.idbdb,ne),(se=se.filter(function(ue){return ue._cfg.version>=le})).length!==0?(se.forEach(function(ue){oe.push(function(){var ve=ie,_e=ue._cfg.dbschema;bf(q,ve,ne),bf(q,_e,ne),ie=q._dbSchema=_e;var we=L0(ve,_e);we.add.forEach(function(rt){M0(ne,rt[0],rt[1].primKey,rt[1].indexes)}),we.change.forEach(function(rt){if(rt.recreate)throw new ce.Upgrade("Not yet support for changing primary key");var et=ne.objectStore(rt.name);rt.add.forEach(function(at){return xf(et,at)}),rt.change.forEach(function(at){et.deleteIndex(at.name),xf(et,at)}),rt.del.forEach(function(at){return et.deleteIndex(at)})});var Me=ue._cfg.contentUpgrade;if(Me&&ue._cfg.version>le){_f(q,ne),Q._memoizedTables={};var Ze=V(_e);we.del.forEach(function(rt){Ze[rt]=ve[rt]}),F0(q,[q.Transaction.prototype]),wf(q,[q.Transaction.prototype],i(Ze),Ze),Q.schema=Ze;var We,qe=Ve(Me);return qe&&F(),we=Qe.follow(function(){var rt;(We=Me(Q))&&qe&&(rt=U.bind(null,null),We.then(rt,rt))}),We&&typeof We.then=="function"?Qe.resolve(We):we.then(function(){return We})}}),oe.push(function(ve){var _e,we,Me=ue._cfg.dbschema;_e=Me,we=ve,[].slice.call(we.db.objectStoreNames).forEach(function(Ze){return _e[Ze]==null&&we.db.deleteObjectStore(Ze)}),F0(q,[q.Transaction.prototype]),wf(q,[q.Transaction.prototype],q._storeNames,q._dbSchema),Q.schema=q._dbSchema}),oe.push(function(ve){q.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(q.idbdb.version/10)===ue._cfg.version?(q.idbdb.deleteObjectStore("$meta"),delete q._dbSchema.$meta,q._storeNames=q._storeNames.filter(function(_e){return _e!=="$meta"})):ve.objectStore("$meta").put(ue._cfg.version,"version"))})}),function ue(){return oe.length?Qe.resolve(oe.shift()(Q.idbtrans)).then(ue):Qe.resolve()}().then(function(){ry(ie,ne)})):Qe.resolve();var q,le,Q,ne,oe,ie}).catch(L)):(i(T).forEach(function(se){M0(b,se,T[se].primKey,T[se].indexes)}),_f(f,b),void Qe.follow(function(){return f.on.populate.fire(A)}).catch(L));var Y,te})}function wT(f,g){ry(f._dbSchema,g),g.db.version%10!=0||g.objectStoreNames.contains("$meta")||g.db.createObjectStore("$meta").add(Math.ceil(g.db.version/10-1),"version");var b=kf(0,f.idbdb,g);bf(f,f._dbSchema,g);for(var S=0,T=L0(b,f._dbSchema).change;S<T.length;S++){var A=function(L){if(L.change.length||L.recreate)return console.warn("Unable to patch indexes of table ".concat(L.name," because it has changes on the type of index or primary key.")),{value:void 0};var W=g.objectStore(L.name);L.add.forEach(function(Y){ae&&console.debug("Dexie upgrade patch: Creating missing index ".concat(L.name,".").concat(Y.src)),xf(W,Y)})}(T[S]);if(typeof A=="object")return A.value}}function L0(f,g){var b,S={del:[],add:[],change:[]};for(b in f)g[b]||S.del.push(b);for(b in g){var T=f[b],A=g[b];if(T){var L={name:b,def:A,recreate:!1,del:[],add:[],change:[]};if(""+(T.primKey.keyPath||"")!=""+(A.primKey.keyPath||"")||T.primKey.auto!==A.primKey.auto)L.recreate=!0,S.change.push(L);else{var W=T.idxByName,Y=A.idxByName,te=void 0;for(te in W)Y[te]||L.del.push(te);for(te in Y){var se=W[te],q=Y[te];se?se.src!==q.src&&L.change.push(q):L.add.push(q)}(0<L.del.length||0<L.add.length||0<L.change.length)&&S.change.push(L)}}else S.add.push([b,A])}return S}function M0(f,g,b,S){var T=f.db.createObjectStore(g,b.keyPath?{keyPath:b.keyPath,autoIncrement:b.auto}:{autoIncrement:b.auto});return S.forEach(function(A){return xf(T,A)}),T}function ry(f,g){i(f).forEach(function(b){g.db.objectStoreNames.contains(b)||(ae&&console.debug("Dexie: Creating missing table",b),M0(g,b,f[b].primKey,f[b].indexes))})}function xf(f,g){f.createIndex(g.name,g.keyPath,{unique:g.unique,multiEntry:g.multi})}function kf(f,g,b){var S={};return k(g.objectStoreNames,0).forEach(function(T){for(var A=b.objectStore(T),L=P0(ey(te=A.keyPath),te||"",!0,!1,!!A.autoIncrement,te&&typeof te!="string",!0),W=[],Y=0;Y<A.indexNames.length;++Y){var se=A.index(A.indexNames[Y]),te=se.keyPath,se=P0(se.name,te,!!se.unique,!!se.multiEntry,!1,te&&typeof te!="string",!1);W.push(se)}S[T]=R0(T,L,W)}),S}function bf(f,g,b){for(var S=b.db.objectStoreNames,T=0;T<S.length;++T){var A=S[T],L=b.objectStore(A);f._hasGetAll="getAll"in L;for(var W=0;W<L.indexNames.length;++W){var Y=L.indexNames[W],te=L.index(Y).keyPath,se=typeof te=="string"?te:"["+k(te).join("+")+"]";!g[A]||(te=g[A].idxByName[se])&&(te.name=Y,delete g[A].idxByName[se],g[A].idxByName[Y]=te)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(f._hasGetAll=!1)}function ny(f){return f.split(",").map(function(g,b){var A=g.split(":"),S=(T=A[1])===null||T===void 0?void 0:T.trim(),T=(g=A[0].trim()).replace(/([&*]|\+\+)/g,""),A=/^\[/.test(T)?T.match(/^\[(.*)\]$/)[1].split("+"):T;return P0(T,A||null,/\&/.test(g),/\*/.test(g),/\+\+/.test(g),o(A),b===0,S)})}var xT=(Go.prototype._createTableSchema=R0,Go.prototype._parseIndexSyntax=ny,Go.prototype._parseStoresSpec=function(f,g){var b=this;i(f).forEach(function(S){if(f[S]!==null){var T=b._parseIndexSyntax(f[S]),A=T.shift();if(!A)throw new ce.Schema("Invalid schema for table "+S+": "+f[S]);if(A.unique=!0,A.multi)throw new ce.Schema("Primary key cannot be multiEntry*");T.forEach(function(L){if(L.auto)throw new ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!L.keyPath)throw new ce.Schema("Index must have a name and cannot be an empty string")}),T=b._createTableSchema(S,A,T),g[S]=T}})},Go.prototype.stores=function(b){var g=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,b):b;var b=g._versions,S={},T={};return b.forEach(function(A){l(S,A._cfg.storesSource),T=A._cfg.dbschema={},A._parseStoresSpec(S,T)}),g._dbSchema=T,F0(g,[g._allTables,g,g.Transaction.prototype]),wf(g,[g._allTables,g,g.Transaction.prototype,this._cfg.tables],i(T),T),g._storeNames=i(T),this},Go.prototype.upgrade=function(f){return this._cfg.contentUpgrade=H(this._cfg.contentUpgrade||N,f),this},Go);function Go(){}function B0(f,g){var b=f._dbNamesDB;return b||(b=f._dbNamesDB=new Ns(tr,{addons:[],indexedDB:f,IDBKeyRange:g})).version(1).stores({dbnames:"name"}),b.table("dbnames")}function $0(f){return f&&typeof f.databases=="function"}function U0(f){return R(function(){return lt.letThrough=!0,f()})}function z0(f){return!("from"in f)}var _n=function(f,g){if(!this){var b=new _n;return f&&"d"in f&&l(b,f),b}l(this,arguments.length?{d:1,from:f,to:1<arguments.length?g:f}:{d:0})};function gc(f,g,b){var S=Tt(g,b);if(!isNaN(S)){if(0<S)throw RangeError();if(z0(f))return l(f,{from:g,to:b,d:1});var T=f.l,S=f.r;if(Tt(b,f.from)<0)return T?gc(T,g,b):f.l={from:g,to:b,d:1,l:null,r:null},sy(f);if(0<Tt(g,f.to))return S?gc(S,g,b):f.r={from:g,to:b,d:1,l:null,r:null},sy(f);Tt(g,f.from)<0&&(f.from=g,f.l=null,f.d=S?S.d+1:1),0<Tt(b,f.to)&&(f.to=b,f.r=null,f.d=f.l?f.l.d+1:1),b=!f.r,T&&!f.l&&vc(f,T),S&&b&&vc(f,S)}}function vc(f,g){z0(g)||function b(S,Y){var A=Y.from,L=Y.to,W=Y.l,Y=Y.r;gc(S,A,L),W&&b(S,W),Y&&b(S,Y)}(f,g)}function ay(f,g){var b=Sf(g),S=b.next();if(S.done)return!1;for(var T=S.value,A=Sf(f),L=A.next(T.from),W=L.value;!S.done&&!L.done;){if(Tt(W.from,T.to)<=0&&0<=Tt(W.to,T.from))return!0;Tt(T.from,W.from)<0?T=(S=b.next(W.from)).value:W=(L=A.next(T.from)).value}return!1}function Sf(f){var g=z0(f)?null:{s:0,n:f};return{next:function(b){for(var S=0<arguments.length;g;)switch(g.s){case 0:if(g.s=1,S)for(;g.n.l&&Tt(b,g.n.from)<0;)g={up:g,n:g.n.l,s:1};else for(;g.n.l;)g={up:g,n:g.n.l,s:1};case 1:if(g.s=2,!S||Tt(b,g.n.to)<=0)return{value:g.n,done:!1};case 2:if(g.n.r){g.s=3,g={up:g,n:g.n.r,s:0};continue}case 3:g=g.up}return{done:!0}}}}function sy(f){var g,b,S=(((g=f.r)===null||g===void 0?void 0:g.d)||0)-(((b=f.l)===null||b===void 0?void 0:b.d)||0),T=1<S?"r":S<-1?"l":"";T&&(g=T=="r"?"l":"r",b=n({},f),S=f[T],f.from=S.from,f.to=S.to,f[T]=S[T],b[T]=S[g],(f[g]=b).d=iy(b)),f.d=iy(f)}function iy(b){var g=b.r,b=b.l;return(g?b?Math.max(g.d,b.d):g.d:b?b.d:0)+1}function Ef(f,g){return i(g).forEach(function(b){f[b]?vc(f[b],g[b]):f[b]=function S(T){var A,L,W={};for(A in T)d(T,A)&&(L=T[A],W[A]=!L||typeof L!="object"||re.has(L.constructor)?L:S(L));return W}(g[b])}),f}function V0(f,g){return f.all||g.all||Object.keys(f).some(function(b){return g[b]&&ay(g[b],f[b])})}h(_n.prototype,((xa={add:function(f){return vc(this,f),this},addKey:function(f){return gc(this,f,f),this},addKeys:function(f){var g=this;return f.forEach(function(b){return gc(g,b,b)}),this},hasKey:function(f){var g=Sf(this).next(f).value;return g&&Tt(g.from,f)<=0&&0<=Tt(g.to,f)}})[ke]=function(){return Sf(this)},xa));var Yi={},W0={},H0=!1;function Tf(f){Ef(W0,f),H0||(H0=!0,setTimeout(function(){H0=!1,K0(W0,!(W0={}))},0))}function K0(f,g){g===void 0&&(g=!1);var b=new Set;if(f.all)for(var S=0,T=Object.values(Yi);S<T.length;S++)oy(L=T[S],f,b,g);else for(var A in f){var L,W=/^idb\:\/\/(.*)\/(.*)\//.exec(A);W&&(A=W[1],W=W[2],(L=Yi["idb://".concat(A,"/").concat(W)])&&oy(L,f,b,g))}b.forEach(function(Y){return Y()})}function oy(f,g,b,S){for(var T=[],A=0,L=Object.entries(f.queries.query);A<L.length;A++){for(var W=L[A],Y=W[0],te=[],se=0,q=W[1];se<q.length;se++){var le=q[se];V0(g,le.obsSet)?le.subscribers.forEach(function(ie){return b.add(ie)}):S&&te.push(le)}S&&T.push([Y,te])}if(S)for(var Q=0,ne=T;Q<ne.length;Q++){var oe=ne[Q],Y=oe[0],te=oe[1];f.queries.query[Y]=te}}function kT(f){var g=f._state,b=f._deps.indexedDB;if(g.isBeingOpened||f.idbdb)return g.dbReadyPromise.then(function(){return g.dbOpenError?He(g.dbOpenError):f});g.isBeingOpened=!0,g.dbOpenError=null,g.openComplete=!1;var S=g.openCanceller,T=Math.round(10*f.verno),A=!1;function L(){if(g.openCanceller!==S)throw new ce.DatabaseClosed("db.open() was cancelled")}function W(){return new Qe(function(le,Q){if(L(),!b)throw new ce.MissingAPI;var ne=f.name,oe=g.autoSchema||!T?b.open(ne):b.open(ne,T);if(!oe)throw new ce.MissingAPI;oe.onerror=ss(Q),oe.onblocked=Et(f._fireOnBlocked),oe.onupgradeneeded=Et(function(ie){var ue;se=oe.transaction,g.autoSchema&&!f._options.allowEmptyDB?(oe.onerror=dc,se.abort(),oe.result.close(),(ue=b.deleteDatabase(ne)).onsuccess=ue.onerror=Et(function(){Q(new ce.NoSuchDatabase("Database ".concat(ne," doesnt exist")))})):(se.onerror=ss(Q),ie=ie.oldVersion>Math.pow(2,62)?0:ie.oldVersion,q=ie<1,f.idbdb=oe.result,A&&wT(f,se),_T(f,ie/10,se,Q))},Q),oe.onsuccess=Et(function(){se=null;var ie,ue,ve,_e,we,Me=f.idbdb=oe.result,Ze=k(Me.objectStoreNames);if(0<Ze.length)try{var We=Me.transaction((_e=Ze).length===1?_e[0]:_e,"readonly");if(g.autoSchema)ue=Me,ve=We,(ie=f).verno=ue.version/10,ve=ie._dbSchema=kf(0,ue,ve),ie._storeNames=k(ue.objectStoreNames,0),wf(ie,[ie._allTables],i(ve),ve);else if(bf(f,f._dbSchema,We),((we=L0(kf(0,(we=f).idbdb,We),we._dbSchema)).add.length||we.change.some(function(qe){return qe.add.length||qe.change.length}))&&!A)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Me.close(),T=Me.version+1,A=!0,le(W());_f(f,We)}catch{}Xt.push(f),Me.onversionchange=Et(function(qe){g.vcFired=!0,f.on("versionchange").fire(qe)}),Me.onclose=Et(function(qe){f.on("close").fire(qe)}),q&&(we=f._deps,We=ne,Me=we.indexedDB,we=we.IDBKeyRange,$0(Me)||We===tr||B0(Me,we).put({name:We}).catch(N)),le()},Q)}).catch(function(le){switch(le==null?void 0:le.name){case"UnknownError":if(0<g.PR1398_maxLoop)return g.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),W();break;case"VersionError":if(0<T)return T=0,W()}return Qe.reject(le)})}var Y,te=g.dbReadyResolve,se=null,q=!1;return Qe.race([S,(typeof navigator>"u"?Qe.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(le){function Q(){return indexedDB.databases().finally(le)}Y=setInterval(Q,100),Q()}).finally(function(){return clearInterval(Y)}):Promise.resolve()).then(W)]).then(function(){return L(),g.onReadyBeingFired=[],Qe.resolve(U0(function(){return f.on.ready.fire(f.vip)})).then(function le(){if(0<g.onReadyBeingFired.length){var Q=g.onReadyBeingFired.reduce(H,N);return g.onReadyBeingFired=[],Qe.resolve(U0(function(){return Q(f.vip)})).then(le)}})}).finally(function(){g.openCanceller===S&&(g.onReadyBeingFired=null,g.isBeingOpened=!1)}).catch(function(le){g.dbOpenError=le;try{se&&se.abort()}catch{}return S===g.openCanceller&&f._close(),He(le)}).finally(function(){g.openComplete=!0,te()}).then(function(){var le;return q&&(le={},f.tables.forEach(function(Q){Q.schema.indexes.forEach(function(ne){ne.name&&(le["idb://".concat(f.name,"/").concat(Q.name,"/").concat(ne.name)]=new _n(-1/0,[[[]]]))}),le["idb://".concat(f.name,"/").concat(Q.name,"/")]=le["idb://".concat(f.name,"/").concat(Q.name,"/:dels")]=new _n(-1/0,[[[]]])}),ii(hc).fire(le),K0(le,!0)),f})}function q0(f){function g(A){return f.next(A)}var b=T(g),S=T(function(A){return f.throw(A)});function T(A){return function(Y){var W=A(Y),Y=W.value;return W.done?Y:Y&&typeof Y.then=="function"?Y.then(b,S):o(Y)?Promise.all(Y).then(b,S):b(Y)}}return T(g)()}function Cf(f,g,b){for(var S=o(f)?f.slice():[f],T=0;T<b;++T)S.push(g);return S}var bT={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(f){return n(n({},f),{table:function(g){var b=f.table(g),S=b.schema,T={},A=[];function L(q,le,Q){var ne=mc(q),oe=T[ne]=T[ne]||[],ie=q==null?0:typeof q=="string"?1:q.length,ue=0<le,ue=n(n({},Q),{name:ue?"".concat(ne,"(virtual-from:").concat(Q.name,")"):Q.name,lowLevelIndex:Q,isVirtual:ue,keyTail:le,keyLength:ie,extractKey:j0(q),unique:!ue&&Q.unique});return oe.push(ue),ue.isPrimaryKey||A.push(ue),1<ie&&L(ie===2?q[0]:q.slice(0,ie-1),le+1,Q),oe.sort(function(ve,_e){return ve.keyTail-_e.keyTail}),ue}g=L(S.primaryKey.keyPath,0,S.primaryKey),T[":id"]=[g];for(var W=0,Y=S.indexes;W<Y.length;W++){var te=Y[W];L(te.keyPath,0,te)}function se(q){var le,Q=q.query.index;return Q.isVirtual?n(n({},q),{query:{index:Q.lowLevelIndex,range:(le=q.query.range,Q=Q.keyTail,{type:le.type===1?2:le.type,lower:Cf(le.lower,le.lowerOpen?f.MAX_KEY:f.MIN_KEY,Q),lowerOpen:!0,upper:Cf(le.upper,le.upperOpen?f.MIN_KEY:f.MAX_KEY,Q),upperOpen:!0})}}):q}return n(n({},b),{schema:n(n({},S),{primaryKey:g,indexes:A,getIndexByKeyPath:function(q){return(q=T[mc(q)])&&q[0]}}),count:function(q){return b.count(se(q))},query:function(q){return b.query(se(q))},openCursor:function(q){var le=q.query.index,Q=le.keyTail,ne=le.isVirtual,oe=le.keyLength;return ne?b.openCursor(se(q)).then(function(ue){return ue&&ie(ue)}):b.openCursor(q);function ie(ue){return Object.create(ue,{continue:{value:function(ve){ve!=null?ue.continue(Cf(ve,q.reverse?f.MAX_KEY:f.MIN_KEY,Q)):q.unique?ue.continue(ue.key.slice(0,oe).concat(q.reverse?f.MIN_KEY:f.MAX_KEY,Q)):ue.continue()}},continuePrimaryKey:{value:function(ve,_e){ue.continuePrimaryKey(Cf(ve,f.MAX_KEY,Q),_e)}},primaryKey:{get:function(){return ue.primaryKey}},key:{get:function(){var ve=ue.key;return oe===1?ve[0]:ve.slice(0,oe)}},value:{get:function(){return ue.value}}})}}})}})}};function G0(f,g,b,S){return b=b||{},S=S||"",i(f).forEach(function(T){var A,L,W;d(g,T)?(A=f[T],L=g[T],typeof A=="object"&&typeof L=="object"&&A&&L?(W=Ae(A))!==Ae(L)?b[S+T]=g[T]:W==="Object"?G0(A,L,b,S+T+"."):A!==L&&(b[S+T]=g[T]):A!==L&&(b[S+T]=g[T])):b[S+T]=void 0}),i(g).forEach(function(T){d(f,T)||(b[S+T]=g[T])}),b}function X0(f,g){return g.type==="delete"?g.keys:g.keys||g.values.map(f.extractKey)}var ST={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(f){return n(n({},f),{table:function(g){var b=f.table(g),S=b.schema.primaryKey;return n(n({},b),{mutate:function(T){var A=lt.trans,L=A.table(g).hook,W=L.deleting,Y=L.creating,te=L.updating;switch(T.type){case"add":if(Y.fire===N)break;return A._promise("readwrite",function(){return se(T)},!0);case"put":if(Y.fire===N&&te.fire===N)break;return A._promise("readwrite",function(){return se(T)},!0);case"delete":if(W.fire===N)break;return A._promise("readwrite",function(){return se(T)},!0);case"deleteRange":if(W.fire===N)break;return A._promise("readwrite",function(){return function q(le,Q,ne){return b.query({trans:le,values:!1,query:{index:S,range:Q},limit:ne}).then(function(oe){var ie=oe.result;return se({type:"delete",keys:ie,trans:le}).then(function(ue){return 0<ue.numFailures?Promise.reject(ue.failures[0]):ie.length<ne?{failures:[],numFailures:0,lastResult:void 0}:q(le,n(n({},Q),{lower:ie[ie.length-1],lowerOpen:!0}),ne)})})}(T.trans,T.range,1e4)},!0)}return b.mutate(T);function se(q){var le,Q,ne,oe=lt.trans,ie=q.keys||X0(S,q);if(!ie)throw new Error("Keys missing");return(q=q.type==="add"||q.type==="put"?n(n({},q),{keys:ie}):n({},q)).type!=="delete"&&(q.values=a([],q.values)),q.keys&&(q.keys=a([],q.keys)),le=b,ne=ie,((Q=q).type==="add"?Promise.resolve([]):le.getMany({trans:Q.trans,keys:ne,cache:"immutable"})).then(function(ue){var ve=ie.map(function(_e,we){var Me,Ze,We,qe=ue[we],rt={onerror:null,onsuccess:null};return q.type==="delete"?W.fire.call(rt,_e,qe,oe):q.type==="add"||qe===void 0?(Me=Y.fire.call(rt,_e,q.values[we],oe),_e==null&&Me!=null&&(q.keys[we]=_e=Me,S.outbound||C(q.values[we],S.keyPath,_e))):(Me=G0(qe,q.values[we]),(Ze=te.fire.call(rt,Me,_e,qe,oe))&&(We=q.values[we],Object.keys(Ze).forEach(function(et){d(We,et)?We[et]=Ze[et]:C(We,et,Ze[et])}))),rt});return b.mutate(q).then(function(_e){for(var we=_e.failures,Me=_e.results,Ze=_e.numFailures,_e=_e.lastResult,We=0;We<ie.length;++We){var qe=(Me||ie)[We],rt=ve[We];qe==null?rt.onerror&&rt.onerror(we[We]):rt.onsuccess&&rt.onsuccess(q.type==="put"&&ue[We]?q.values[We]:qe)}return{failures:we,results:Me,numFailures:Ze,lastResult:_e}}).catch(function(_e){return ve.forEach(function(we){return we.onerror&&we.onerror(_e)}),Promise.reject(_e)})})}}})}})}};function ly(f,g,b){try{if(!g||g.keys.length<f.length)return null;for(var S=[],T=0,A=0;T<g.keys.length&&A<f.length;++T)Tt(g.keys[T],f[A])===0&&(S.push(b?me(g.values[T]):g.values[T]),++A);return S.length===f.length?S:null}catch{return null}}var ET={stack:"dbcore",level:-1,create:function(f){return{table:function(g){var b=f.table(g);return n(n({},b),{getMany:function(S){if(!S.cache)return b.getMany(S);var T=ly(S.keys,S.trans._cache,S.cache==="clone");return T?Qe.resolve(T):b.getMany(S).then(function(A){return S.trans._cache={keys:S.keys,values:S.cache==="clone"?me(A):A},A})},mutate:function(S){return S.type!=="add"&&(S.trans._cache=null),b.mutate(S)}})}}}};function cy(f,g){return f.trans.mode==="readonly"&&!!f.subscr&&!f.trans.explicit&&f.trans.db._options.cache!=="disabled"&&!g.schema.primaryKey.outbound}function uy(f,g){switch(f){case"query":return g.values&&!g.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var TT={stack:"dbcore",level:0,name:"Observability",create:function(f){var g=f.schema.name,b=new _n(f.MIN_KEY,f.MAX_KEY);return n(n({},f),{transaction:function(S,T,A){if(lt.subscr&&T!=="readonly")throw new ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(lt.querier));return f.transaction(S,T,A)},table:function(S){var T=f.table(S),A=T.schema,L=A.primaryKey,q=A.indexes,W=L.extractKey,Y=L.outbound,te=L.autoIncrement&&q.filter(function(Q){return Q.compound&&Q.keyPath.includes(L.keyPath)}),se=n(n({},T),{mutate:function(Q){function ne(et){return et="idb://".concat(g,"/").concat(S,"/").concat(et),_e[et]||(_e[et]=new _n)}var oe,ie,ue,ve=Q.trans,_e=Q.mutatedParts||(Q.mutatedParts={}),we=ne(""),Me=ne(":dels"),Ze=Q.type,rt=Q.type==="deleteRange"?[Q.range]:Q.type==="delete"?[Q.keys]:Q.values.length<50?[X0(L,Q).filter(function(et){return et}),Q.values]:[],We=rt[0],qe=rt[1],rt=Q.trans._cache;return o(We)?(we.addKeys(We),(rt=Ze==="delete"||We.length===qe.length?ly(We,rt):null)||Me.addKeys(We),(rt||qe)&&(oe=ne,ie=rt,ue=qe,A.indexes.forEach(function(et){var at=oe(et.name||"");function At(Nt){return Nt!=null?et.extractKey(Nt):null}function Ut(Nt){return et.multiEntry&&o(Nt)?Nt.forEach(function(Tr){return at.addKey(Tr)}):at.addKey(Nt)}(ie||ue).forEach(function(Nt,wn){var Ct=ie&&At(ie[wn]),wn=ue&&At(ue[wn]);Tt(Ct,wn)!==0&&(Ct!=null&&Ut(Ct),wn!=null&&Ut(wn))})}))):We?(qe={from:(qe=We.lower)!==null&&qe!==void 0?qe:f.MIN_KEY,to:(qe=We.upper)!==null&&qe!==void 0?qe:f.MAX_KEY},Me.add(qe),we.add(qe)):(we.add(b),Me.add(b),A.indexes.forEach(function(et){return ne(et.name).add(b)})),T.mutate(Q).then(function(et){return!We||Q.type!=="add"&&Q.type!=="put"||(we.addKeys(et.results),te&&te.forEach(function(at){for(var At=Q.values.map(function(Ct){return at.extractKey(Ct)}),Ut=at.keyPath.findIndex(function(Ct){return Ct===L.keyPath}),Nt=0,Tr=et.results.length;Nt<Tr;++Nt)At[Nt][Ut]=et.results[Nt];ne(at.name).addKeys(At)})),ve.mutatedParts=Ef(ve.mutatedParts||{},_e),et})}}),q=function(ne){var oe=ne.query,ne=oe.index,oe=oe.range;return[ne,new _n((ne=oe.lower)!==null&&ne!==void 0?ne:f.MIN_KEY,(oe=oe.upper)!==null&&oe!==void 0?oe:f.MAX_KEY)]},le={get:function(Q){return[L,new _n(Q.key)]},getMany:function(Q){return[L,new _n().addKeys(Q.keys)]},count:q,query:q,openCursor:q};return i(le).forEach(function(Q){se[Q]=function(ne){var oe=lt.subscr,ie=!!oe,ue=cy(lt,T)&&uy(Q,ne)?ne.obsSet={}:oe;if(ie){var ve=function(qe){return qe="idb://".concat(g,"/").concat(S,"/").concat(qe),ue[qe]||(ue[qe]=new _n)},_e=ve(""),we=ve(":dels"),oe=le[Q](ne),ie=oe[0],oe=oe[1];if((Q==="query"&&ie.isPrimaryKey&&!ne.values?we:ve(ie.name||"")).add(oe),!ie.isPrimaryKey){if(Q!=="count"){var Me=Q==="query"&&Y&&ne.values&&T.query(n(n({},ne),{values:!1}));return T[Q].apply(this,arguments).then(function(qe){if(Q==="query"){if(Y&&ne.values)return Me.then(function(At){return At=At.result,_e.addKeys(At),qe});var rt=ne.values?qe.result.map(W):qe.result;(ne.values?_e:we).addKeys(rt)}else if(Q==="openCursor"){var et=qe,at=ne.values;return et&&Object.create(et,{key:{get:function(){return we.addKey(et.primaryKey),et.key}},primaryKey:{get:function(){var At=et.primaryKey;return we.addKey(At),At}},value:{get:function(){return at&&_e.addKey(et.primaryKey),et.value}}})}return qe})}we.add(b)}}return T[Q].apply(this,arguments)}}),se}})}};function fy(f,g,b){if(b.numFailures===0)return g;if(g.type==="deleteRange")return null;var S=g.keys?g.keys.length:"values"in g&&g.values?g.values.length:1;return b.numFailures===S?null:(g=n({},g),o(g.keys)&&(g.keys=g.keys.filter(function(T,A){return!(A in b.failures)})),"values"in g&&o(g.values)&&(g.values=g.values.filter(function(T,A){return!(A in b.failures)})),g)}function Z0(f,g){return b=f,((S=g).lower===void 0||(S.lowerOpen?0<Tt(b,S.lower):0<=Tt(b,S.lower)))&&(f=f,(g=g).upper===void 0||(g.upperOpen?Tt(f,g.upper)<0:Tt(f,g.upper)<=0));var b,S}function dy(f,g,le,S,T,A){if(!le||le.length===0)return f;var L=g.query.index,W=L.multiEntry,Y=g.query.range,te=S.schema.primaryKey.extractKey,se=L.extractKey,q=(L.lowLevelIndex||L).extractKey,le=le.reduce(function(Q,ne){var oe=Q,ie=[];if(ne.type==="add"||ne.type==="put")for(var ue=new _n,ve=ne.values.length-1;0<=ve;--ve){var _e,we=ne.values[ve],Me=te(we);ue.hasKey(Me)||(_e=se(we),(W&&o(_e)?_e.some(function(et){return Z0(et,Y)}):Z0(_e,Y))&&(ue.addKey(Me),ie.push(we)))}switch(ne.type){case"add":var Ze=new _n().addKeys(g.values?Q.map(function(at){return te(at)}):Q),oe=Q.concat(g.values?ie.filter(function(at){return at=te(at),!Ze.hasKey(at)&&(Ze.addKey(at),!0)}):ie.map(function(at){return te(at)}).filter(function(at){return!Ze.hasKey(at)&&(Ze.addKey(at),!0)}));break;case"put":var We=new _n().addKeys(ne.values.map(function(at){return te(at)}));oe=Q.filter(function(at){return!We.hasKey(g.values?te(at):at)}).concat(g.values?ie:ie.map(function(at){return te(at)}));break;case"delete":var qe=new _n().addKeys(ne.keys);oe=Q.filter(function(at){return!qe.hasKey(g.values?te(at):at)});break;case"deleteRange":var rt=ne.range;oe=Q.filter(function(at){return!Z0(te(at),rt)})}return oe},f);return le===f?f:(le.sort(function(Q,ne){return Tt(q(Q),q(ne))||Tt(te(Q),te(ne))}),g.limit&&g.limit<1/0&&(le.length>g.limit?le.length=g.limit:f.length===g.limit&&le.length<g.limit&&(T.dirty=!0)),A?Object.freeze(le):le)}function hy(f,g){return Tt(f.lower,g.lower)===0&&Tt(f.upper,g.upper)===0&&!!f.lowerOpen==!!g.lowerOpen&&!!f.upperOpen==!!g.upperOpen}function CT(f,g){return function(b,S,T,A){if(b===void 0)return S!==void 0?-1:0;if(S===void 0)return 1;if((S=Tt(b,S))===0){if(T&&A)return 0;if(T)return 1;if(A)return-1}return S}(f.lower,g.lower,f.lowerOpen,g.lowerOpen)<=0&&0<=function(b,S,T,A){if(b===void 0)return S!==void 0?1:0;if(S===void 0)return-1;if((S=Tt(b,S))===0){if(T&&A)return 0;if(T)return-1;if(A)return 1}return S}(f.upper,g.upper,f.upperOpen,g.upperOpen)}function NT(f,g,b,S){f.subscribers.add(b),S.addEventListener("abort",function(){var T,A;f.subscribers.delete(b),f.subscribers.size===0&&(T=f,A=g,setTimeout(function(){T.subscribers.size===0&&Ce(A,T)},3e3))})}var AT={stack:"dbcore",level:0,name:"Cache",create:function(f){var g=f.schema.name;return n(n({},f),{transaction:function(b,S,T){var A,L,W=f.transaction(b,S,T);return S==="readwrite"&&(L=(A=new AbortController).signal,T=function(Y){return function(){if(A.abort(),S==="readwrite"){for(var te=new Set,se=0,q=b;se<q.length;se++){var le=q[se],Q=Yi["idb://".concat(g,"/").concat(le)];if(Q){var ne=f.table(le),oe=Q.optimisticOps.filter(function(at){return at.trans===W});if(W._explicit&&Y&&W.mutatedParts)for(var ie=0,ue=Object.values(Q.queries.query);ie<ue.length;ie++)for(var ve=0,_e=(Ze=ue[ie]).slice();ve<_e.length;ve++)V0((We=_e[ve]).obsSet,W.mutatedParts)&&(Ce(Ze,We),We.subscribers.forEach(function(at){return te.add(at)}));else if(0<oe.length){Q.optimisticOps=Q.optimisticOps.filter(function(at){return at.trans!==W});for(var we=0,Me=Object.values(Q.queries.query);we<Me.length;we++)for(var Ze,We,qe,rt=0,et=(Ze=Me[we]).slice();rt<et.length;rt++)(We=et[rt]).res!=null&&W.mutatedParts&&(Y&&!We.dirty?(qe=Object.isFrozen(We.res),qe=dy(We.res,We.req,oe,ne,We,qe),We.dirty?(Ce(Ze,We),We.subscribers.forEach(function(at){return te.add(at)})):qe!==We.res&&(We.res=qe,We.promise=Qe.resolve({result:qe}))):(We.dirty&&Ce(Ze,We),We.subscribers.forEach(function(at){return te.add(at)})))}}}te.forEach(function(at){return at()})}}},W.addEventListener("abort",T(!1),{signal:L}),W.addEventListener("error",T(!1),{signal:L}),W.addEventListener("complete",T(!0),{signal:L})),W},table:function(b){var S=f.table(b),T=S.schema.primaryKey;return n(n({},S),{mutate:function(A){var L=lt.trans;if(T.outbound||L.db._options.cache==="disabled"||L.explicit||L.idbtrans.mode!=="readwrite")return S.mutate(A);var W=Yi["idb://".concat(g,"/").concat(b)];return W?(L=S.mutate(A),A.type!=="add"&&A.type!=="put"||!(50<=A.values.length||X0(T,A).some(function(Y){return Y==null}))?(W.optimisticOps.push(A),A.mutatedParts&&Tf(A.mutatedParts),L.then(function(Y){0<Y.numFailures&&(Ce(W.optimisticOps,A),(Y=fy(0,A,Y))&&W.optimisticOps.push(Y),A.mutatedParts&&Tf(A.mutatedParts))}),L.catch(function(){Ce(W.optimisticOps,A),A.mutatedParts&&Tf(A.mutatedParts)})):L.then(function(Y){var te=fy(0,n(n({},A),{values:A.values.map(function(se,q){var le;return Y.failures[q]?se:(se=(le=T.keyPath)!==null&&le!==void 0&&le.includes(".")?me(se):n({},se),C(se,T.keyPath,Y.results[q]),se)})}),Y);W.optimisticOps.push(te),queueMicrotask(function(){return A.mutatedParts&&Tf(A.mutatedParts)})}),L):S.mutate(A)},query:function(A){if(!cy(lt,S)||!uy("query",A))return S.query(A);var L=((te=lt.trans)===null||te===void 0?void 0:te.db._options.cache)==="immutable",q=lt,W=q.requery,Y=q.signal,te=function(ne,oe,ie,ue){var ve=Yi["idb://".concat(ne,"/").concat(oe)];if(!ve)return[];if(!(oe=ve.queries[ie]))return[null,!1,ve,null];var _e=oe[(ue.query?ue.query.index.name:null)||""];if(!_e)return[null,!1,ve,null];switch(ie){case"query":var we=_e.find(function(Me){return Me.req.limit===ue.limit&&Me.req.values===ue.values&&hy(Me.req.query.range,ue.query.range)});return we?[we,!0,ve,_e]:[_e.find(function(Me){return("limit"in Me.req?Me.req.limit:1/0)>=ue.limit&&(!ue.values||Me.req.values)&&CT(Me.req.query.range,ue.query.range)}),!1,ve,_e];case"count":return we=_e.find(function(Me){return hy(Me.req.query.range,ue.query.range)}),[we,!!we,ve,_e]}}(g,b,"query",A),se=te[0],q=te[1],le=te[2],Q=te[3];return se&&q?se.obsSet=A.obsSet:(q=S.query(A).then(function(ne){var oe=ne.result;if(se&&(se.res=oe),L){for(var ie=0,ue=oe.length;ie<ue;++ie)Object.freeze(oe[ie]);Object.freeze(oe)}else ne.result=me(oe);return ne}).catch(function(ne){return Q&&se&&Ce(Q,se),Promise.reject(ne)}),se={obsSet:A.obsSet,promise:q,subscribers:new Set,type:"query",req:A,dirty:!1},Q?Q.push(se):(Q=[se],(le=le||(Yi["idb://".concat(g,"/").concat(b)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[A.query.index.name||""]=Q)),NT(se,Q,W,Y),se.promise.then(function(ne){return{result:dy(ne.result,A,le==null?void 0:le.optimisticOps,S,se,L)}})}})}})}};function Nf(f,g){return new Proxy(f,{get:function(b,S,T){return S==="db"?g:Reflect.get(b,S,T)}})}var Ns=(Pr.prototype.version=function(f){if(isNaN(f)||f<.1)throw new ce.Type("Given version is not a positive number");if(f=Math.round(10*f)/10,this.idbdb||this._state.isBeingOpened)throw new ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,f);var g=this._versions,b=g.filter(function(S){return S._cfg.version===f})[0];return b||(b=new this.Version(f),g.push(b),g.sort(yT),b.stores({}),this._state.autoSchema=!1,b)},Pr.prototype._whenReady=function(f){var g=this;return this.idbdb&&(this._state.openComplete||lt.letThrough||this._vip)?f():new Qe(function(b,S){if(g._state.openComplete)return S(new ce.DatabaseClosed(g._state.dbOpenError));if(!g._state.isBeingOpened){if(!g._state.autoOpen)return void S(new ce.DatabaseClosed);g.open().catch(N)}g._state.dbReadyPromise.then(b,S)}).then(f)},Pr.prototype.use=function(f){var g=f.stack,b=f.create,S=f.level,T=f.name;return T&&this.unuse({stack:g,name:T}),f=this._middlewares[g]||(this._middlewares[g]=[]),f.push({stack:g,create:b,level:S??10,name:T}),f.sort(function(A,L){return A.level-L.level}),this},Pr.prototype.unuse=function(f){var g=f.stack,b=f.name,S=f.create;return g&&this._middlewares[g]&&(this._middlewares[g]=this._middlewares[g].filter(function(T){return S?T.create!==S:!!b&&T.name!==b})),this},Pr.prototype.open=function(){var f=this;return he(Fn,function(){return kT(f)})},Pr.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var f=this._state,g=Xt.indexOf(this);if(0<=g&&Xt.splice(g,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}f.isBeingOpened||(f.dbReadyPromise=new Qe(function(b){f.dbReadyResolve=b}),f.openCanceller=new Qe(function(b,S){f.cancelOpen=S}))},Pr.prototype.close=function(b){var g=(b===void 0?{disableAutoOpen:!0}:b).disableAutoOpen,b=this._state;g?(b.isBeingOpened&&b.cancelOpen(new ce.DatabaseClosed),this._close(),b.autoOpen=!1,b.dbOpenError=new ce.DatabaseClosed):(this._close(),b.autoOpen=this._options.autoOpen||b.isBeingOpened,b.openComplete=!1,b.dbOpenError=null)},Pr.prototype.delete=function(f){var g=this;f===void 0&&(f={disableAutoOpen:!0});var b=0<arguments.length&&typeof arguments[0]!="object",S=this._state;return new Qe(function(T,A){function L(){g.close(f);var W=g._deps.indexedDB.deleteDatabase(g.name);W.onsuccess=Et(function(){var Y,te,se;Y=g._deps,te=g.name,se=Y.indexedDB,Y=Y.IDBKeyRange,$0(se)||te===tr||B0(se,Y).delete(te).catch(N),T()}),W.onerror=ss(A),W.onblocked=g._fireOnBlocked}if(b)throw new ce.InvalidArgument("Invalid closeOptions argument to db.delete()");S.isBeingOpened?S.dbReadyPromise.then(L):L()})},Pr.prototype.backendDB=function(){return this.idbdb},Pr.prototype.isOpen=function(){return this.idbdb!==null},Pr.prototype.hasBeenClosed=function(){var f=this._state.dbOpenError;return f&&f.name==="DatabaseClosed"},Pr.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Pr.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Pr.prototype,"tables",{get:function(){var f=this;return i(this._allTables).map(function(g){return f._allTables[g]})},enumerable:!1,configurable:!0}),Pr.prototype.transaction=function(){var f=(function(g,b,S){var T=arguments.length;if(T<2)throw new ce.InvalidArgument("Too few arguments");for(var A=new Array(T-1);--T;)A[T-1]=arguments[T];return S=A.pop(),[g,ee(A),S]}).apply(this,arguments);return this._transaction.apply(this,f)},Pr.prototype._transaction=function(f,g,b){var S=this,T=lt.trans;T&&T.db===this&&f.indexOf("!")===-1||(T=null);var A,L,W=f.indexOf("?")!==-1;f=f.replace("!","").replace("?","");try{if(L=g.map(function(te){if(te=te instanceof S.Table?te.name:te,typeof te!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return te}),f=="r"||f===Br)A=Br;else{if(f!="rw"&&f!=Cs)throw new ce.InvalidArgument("Invalid transaction mode: "+f);A=Cs}if(T){if(T.mode===Br&&A===Cs){if(!W)throw new ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");T=null}T&&L.forEach(function(te){if(T&&T.storeNames.indexOf(te)===-1){if(!W)throw new ce.SubTransaction("Table "+te+" not included in parent transaction.");T=null}}),W&&T&&!T.active&&(T=null)}}catch(te){return T?T._promise(null,function(se,q){q(te)}):He(te)}var Y=(function te(se,q,le,Q,ne){return Qe.resolve().then(function(){var oe=lt.transless||lt,ie=se._createTransaction(q,le,se._dbSchema,Q);if(ie.explicit=!0,oe={trans:ie,transless:oe},Q)ie.idbtrans=Q.idbtrans;else try{ie.create(),ie.idbtrans._explicit=!0,se._state.PR1398_maxLoop=3}catch(_e){return _e.name===Pe.InvalidState&&se.isOpen()&&0<--se._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),se.close({disableAutoOpen:!1}),se.open().then(function(){return te(se,q,le,null,ne)})):He(_e)}var ue,ve=Ve(ne);return ve&&F(),oe=Qe.follow(function(){var _e;(ue=ne.call(ie,ie))&&(ve?(_e=U.bind(null,null),ue.then(_e,_e)):typeof ue.next=="function"&&typeof ue.throw=="function"&&(ue=q0(ue)))},oe),(ue&&typeof ue.then=="function"?Qe.resolve(ue).then(function(_e){return ie.active?_e:He(new ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):oe.then(function(){return ue})).then(function(_e){return Q&&ie._resolve(),ie._completion.then(function(){return _e})}).catch(function(_e){return ie._reject(_e),He(_e)})})}).bind(null,this,A,L,T,b);return T?T._promise(A,Y,"lock"):lt.trans?he(lt.transless,function(){return S._whenReady(Y)}):this._whenReady(Y)},Pr.prototype.table=function(f){if(!d(this._allTables,f))throw new ce.InvalidTable("Table ".concat(f," does not exist"));return this._allTables[f]},Pr);function Pr(f,g){var b=this;this._middlewares={},this.verno=0;var S=Pr.dependencies;this._options=g=n({addons:Pr.addons,autoOpen:!0,indexedDB:S.indexedDB,IDBKeyRange:S.IDBKeyRange,cache:"cloned"},g),this._deps={indexedDB:g.indexedDB,IDBKeyRange:g.IDBKeyRange},S=g.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var T,A,L,W,Y,te={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:N,dbReadyPromise:null,cancelOpen:N,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:g.autoOpen};te.dbReadyPromise=new Qe(function(q){te.dbReadyResolve=q}),te.openCanceller=new Qe(function(q,le){te.cancelOpen=le}),this._state=te,this.name=f,this.on=cc(this,"populate","blocked","versionchange","close",{ready:[H,N]}),this.once=function(q,le){var Q=function(){for(var ne=[],oe=0;oe<arguments.length;oe++)ne[oe]=arguments[oe];b.on(q).unsubscribe(Q),le.apply(b,ne)};return b.on(q,Q)},this.on.ready.subscribe=w(this.on.ready.subscribe,function(q){return function(le,Q){Pr.vip(function(){var ne,oe=b._state;oe.openComplete?(oe.dbOpenError||Qe.resolve().then(le),Q&&q(le)):oe.onReadyBeingFired?(oe.onReadyBeingFired.push(le),Q&&q(le)):(q(le),ne=b,Q||q(function ie(){ne.on.ready.unsubscribe(le),ne.on.ready.unsubscribe(ie)}))})}}),this.Collection=(T=this,uc(fT.prototype,function(ue,ie){this.db=T;var Q=ai,ne=null;if(ie)try{Q=ie()}catch(ve){ne=ve}var oe=ue._ctx,ie=oe.table,ue=ie.hook.reading.fire;this._ctx={table:ie,index:oe.index,isPrimKey:!oe.index||ie.schema.primKey.keyPath&&oe.index===ie.schema.primKey.name,range:Q,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ne,or:oe.or,valueMapper:ue!==Ue?ue:null}})),this.Table=(A=this,uc(qv.prototype,function(q,le,Q){this.db=A,this._tx=Q,this.name=q,this.schema=le,this.hook=A._allTables[q]?A._allTables[q].hook:cc(null,{creating:[mt,N],reading:[it,Ue],updating:[$t,N],deleting:[Fe,N]})})),this.Transaction=(L=this,uc(pT.prototype,function(q,le,Q,ne,oe){var ie=this;q!=="readonly"&&le.forEach(function(ue){ue=(ue=Q[ue])===null||ue===void 0?void 0:ue.yProps,ue&&(le=le.concat(ue.map(function(ve){return ve.updatesTable})))}),this.db=L,this.mode=q,this.storeNames=le,this.schema=Q,this.chromeTransactionDurability=ne,this.idbtrans=null,this.on=cc(this,"complete","error","abort"),this.parent=oe||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Qe(function(ue,ve){ie._resolve=ue,ie._reject=ve}),this._completion.then(function(){ie.active=!1,ie.on.complete.fire()},function(ue){var ve=ie.active;return ie.active=!1,ie.on.error.fire(ue),ie.parent?ie.parent._reject(ue):ve&&ie.idbtrans&&ie.idbtrans.abort(),He(ue)})})),this.Version=(W=this,uc(xT.prototype,function(q){this.db=W,this._cfg={version:q,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Y=this,uc(Qv.prototype,function(q,le,Q){if(this.db=Y,this._ctx={table:q,index:le===":id"?null:le,or:Q},this._cmp=this._ascending=Tt,this._descending=function(ne,oe){return Tt(oe,ne)},this._max=function(ne,oe){return 0<Tt(ne,oe)?ne:oe},this._min=function(ne,oe){return Tt(ne,oe)<0?ne:oe},this._IDBKeyRange=Y._deps.IDBKeyRange,!this._IDBKeyRange)throw new ce.MissingAPI})),this.on("versionchange",function(q){0<q.newVersion?console.warn("Another connection wants to upgrade database '".concat(b.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(b.name,"'. Closing db now to resume the delete request.")),b.close({disableAutoOpen:!1})}),this.on("blocked",function(q){!q.newVersion||q.newVersion<q.oldVersion?console.warn("Dexie.delete('".concat(b.name,"') was blocked")):console.warn("Upgrade '".concat(b.name,"' blocked by other connection holding version ").concat(q.oldVersion/10))}),this._maxKey=pc(g.IDBKeyRange),this._createTransaction=function(q,le,Q,ne){return new b.Transaction(q,le,Q,b._options.chromeTransactionDurability,ne)},this._fireOnBlocked=function(q){b.on("blocked").fire(q),Xt.filter(function(le){return le.name===b.name&&le!==b&&!le._state.vcFired}).map(function(le){return le.on("versionchange").fire(q)})},this.use(ET),this.use(AT),this.use(TT),this.use(bT),this.use(ST);var se=new Proxy(this,{get:function(q,le,Q){if(le==="_vip")return!0;if(le==="table")return function(oe){return Nf(b.table(oe),se)};var ne=Reflect.get(q,le,Q);return ne instanceof qv?Nf(ne,se):le==="tables"?ne.map(function(oe){return Nf(oe,se)}):le==="_createTransaction"?function(){return Nf(ne.apply(this,arguments),se)}:ne}});this.vip=se,S.forEach(function(q){return q(b)})}var Af,xa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",OT=(Y0.prototype.subscribe=function(f,g,b){return this._subscribe(f&&typeof f!="function"?f:{next:f,error:g,complete:b})},Y0.prototype[xa]=function(){return this},Y0);function Y0(f){this._subscribe=f}try{Af={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{Af={indexedDB:null,IDBKeyRange:null}}function py(f){var g,b=!1,S=new OT(function(T){var A=Ve(f),L,W=!1,Y={},te={},se={get closed(){return W},unsubscribe:function(){W||(W=!0,L&&L.abort(),q&&ii.storagemutated.unsubscribe(Q))}};T.start&&T.start(se);var q=!1,le=function(){return Ye(ne)},Q=function(oe){Ef(Y,oe),V0(te,Y)&&le()},ne=function(){var oe,ie,ue;!W&&Af.indexedDB&&(Y={},oe={},L&&L.abort(),L=new AbortController,ue=function(ve){var _e=tt();try{A&&F();var we=R(f,ve);return we=A?we.finally(U):we}finally{_e&&ft()}}(ie={subscr:oe,signal:L.signal,requery:le,querier:f,trans:null}),Promise.resolve(ue).then(function(ve){b=!0,g=ve,W||ie.signal.aborted||(Y={},function(_e){for(var we in _e)if(d(_e,we))return;return 1}(te=oe)||q||(ii(hc,Q),q=!0),Ye(function(){return!W&&T.next&&T.next(ve)}))},function(ve){b=!1,["DatabaseClosedError","AbortError"].includes(ve==null?void 0:ve.name)||W||Ye(function(){W||T.error&&T.error(ve)})}))};return setTimeout(le,0),se});return S.hasValue=function(){return b},S.getValue=function(){return g},S}var Ji=Ns;function J0(f){var g=oi;try{oi=!0,ii.storagemutated.fire(f),K0(f,!0)}finally{oi=g}}h(Ji,n(n({},dt),{delete:function(f){return new Ji(f,{addons:[]}).delete()},exists:function(f){return new Ji(f,{addons:[]}).open().then(function(g){return g.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(f){try{return g=Ji.dependencies,b=g.indexedDB,g=g.IDBKeyRange,($0(b)?Promise.resolve(b.databases()).then(function(S){return S.map(function(T){return T.name}).filter(function(T){return T!==tr})}):B0(b,g).toCollection().primaryKeys()).then(f)}catch{return He(new ce.MissingAPI)}var g,b},defineClass:function(){return function(f){l(this,f)}},ignoreTransaction:function(f){return lt.trans?he(lt.transless,f):f()},vip:U0,async:function(f){return function(){try{var g=q0(f.apply(this,arguments));return g&&typeof g.then=="function"?g:Qe.resolve(g)}catch(b){return He(b)}}},spawn:function(f,g,b){try{var S=q0(f.apply(b,g||[]));return S&&typeof S.then=="function"?S:Qe.resolve(S)}catch(T){return He(T)}},currentTransaction:{get:function(){return lt.trans||null}},waitFor:function(f,g){return g=Qe.resolve(typeof f=="function"?Ji.ignoreTransaction(f):f).timeout(g||6e4),lt.trans?lt.trans.waitFor(g):g},Promise:Qe,debug:{get:function(){return ae},set:function(f){ye(f)}},derive:p,extend:l,props:h,override:w,Events:cc,on:ii,liveQuery:py,extendObservabilitySet:Ef,getByKeyPath:D,setByKeyPath:C,delByKeyPath:function(f,g){typeof g=="string"?C(f,g,void 0):"length"in g&&[].map.call(g,function(b){C(f,b,void 0)})},shallowClone:V,deepClone:me,getObjectDiff:G0,cmp:Tt,asap:I,minKey:-1/0,addons:[],connections:Xt,errnames:Pe,dependencies:Af,cache:Yi,semVer:"4.2.0",version:"4.2.0".split(".").map(function(f){return parseInt(f)}).reduce(function(f,g,b){return f+g/Math.pow(10,2*b)})})),Ji.maxKey=pc(Ji.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ii(hc,function(f){oi||(f=new CustomEvent(D0,{detail:f}),oi=!0,dispatchEvent(f),oi=!1)}),addEventListener(D0,function(f){f=f.detail,oi||J0(f)}));var Xo,oi=!1,my=function(){};return typeof BroadcastChannel<"u"&&((my=function(){(Xo=new BroadcastChannel(D0)).onmessage=function(f){return f.data&&J0(f.data)}})(),typeof Xo.unref=="function"&&Xo.unref(),ii(hc,function(f){oi||Xo.postMessage(f)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(f){if(!Ns.disableBfCache&&f.persisted){ae&&console.debug("Dexie: handling persisted pagehide"),Xo!=null&&Xo.close();for(var g=0,b=Xt;g<b.length;g++)b[g].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(f){!Ns.disableBfCache&&f.persisted&&(ae&&console.debug("Dexie: handling persisted pageshow"),my(),J0({all:new _n(-1/0,[[]])}))})),Qe.rejectionMapper=function(f,g){return!f||f instanceof J||f instanceof TypeError||f instanceof SyntaxError||!f.name||!Te[f.name]?f:(g=new Te[f.name](g||f.message,f),"stack"in f&&y(g,"stack",{get:function(){return this.inner.stack}}),g)},ye(ae),n(Ns,Object.freeze({__proto__:null,Dexie:Ns,liveQuery:py,Entity:Ho,cmp:Tt,PropModification:fc,replacePrefix:function(f,g){return new fc({replacePrefix:[f,g]})},add:function(f){return new fc({add:f})},remove:function(f){return new fc({remove:f})},default:Ns,RangeSet:_n,mergeRanges:vc,rangesOverlap:ay}),{default:Ns}),Ns})})(X4);var YW=X4.exports;const Dg=Qx(YW),Xx=Symbol.for("Dexie"),Pg=globalThis[Xx]||(globalThis[Xx]=Dg);if(Dg.semVer!==Pg.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Dg.semVer} and ${Pg.semVer}`);class JW extends Pg{constructor(){super("CaixaDatabase"),this.version(1).stores({bank_uploads:"++id, day, user_id, file_name, upload_mode, created_at",bank_entries:"++id, upload_id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",cash_conference_entries:"++id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",not_found_history:"++id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",manual_entries:"++id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",day_selection:"++id, &day, user_id, last_accessed"}),this.version(2).stores({bank_uploads:"++id, day, user_id, file_name, upload_mode, created_at",bank_entries:"++id, upload_id, source_id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",cash_conference_entries:"++id, &source_id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",not_found_history:"++id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",manual_entries:"++id, &source_id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",day_selection:"++id, &day, user_id, last_accessed"}).upgrade(t=>(console.log("Migrating to version 2: Adding source_id fields"),t.manual_entries.toCollection().modify(r=>{r.source_id||(r.source_id=`manual_${crypto.randomUUID?crypto.randomUUID():Date.now().toString(36)}`)}))),this.version(3).stores({bank_uploads:"++id, day, user_id, file_name, upload_mode, created_at",bank_entries:"++id, upload_id, source_id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",cash_conference_entries:"++id, &source_id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",not_found_history:"++id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",manual_entries:"++id, &source_id, day, status, [status+day], value_cents, [value_cents+day], source, [source+day], user_id, created_at",day_selection:"++id, &day, user_id, last_accessed",action_log:"++id, day, user_id, action_type, timestamp, result, [action_type+day], [result+day]"}),this.bank_entries.hook("creating",(t,r,n)=>{r.value_cents=Math.round((r.value||0)*100),r.created_at=r.created_at||new Date().toISOString()}),this.cash_conference_entries.hook("creating",(t,r,n)=>{r.value_cents=Math.round((r.value||0)*100),r.created_at=r.created_at||new Date().toISOString()}),this.not_found_history.hook("creating",(t,r,n)=>{r.value_cents=Math.round((r.value||0)*100),r.created_at=r.created_at||new Date().toISOString()}),this.manual_entries.hook("creating",(t,r,n)=>{r.value_cents=Math.round((r.value||0)*100),r.created_at=r.created_at||new Date().toISOString()}),this.bank_uploads.hook("creating",(t,r,n)=>{r.created_at=r.created_at||new Date().toISOString()}),this.day_selection.hook("creating",(t,r,n)=>{r.last_accessed=r.last_accessed||new Date().toISOString()}),this.bank_entries.hook("updating",(t,r,n,a)=>{t.value!==void 0&&(t.value_cents=Math.round((t.value||0)*100))}),this.cash_conference_entries.hook("updating",(t,r,n,a)=>{t.value!==void 0&&(t.value_cents=Math.round((t.value||0)*100))}),this.not_found_history.hook("updating",(t,r,n,a)=>{t.value!==void 0&&(t.value_cents=Math.round((t.value||0)*100))}),this.manual_entries.hook("updating",(t,r,n,a)=>{t.value!==void 0&&(t.value_cents=Math.round((t.value||0)*100))}),this.day_selection.hook("updating",(t,r,n,a)=>{t.last_accessed=new Date().toISOString()}),this.action_log.hook("creating",(t,r,n)=>{r.timestamp=r.timestamp||new Date().toISOString()})}static valueToCents(t){return Math.round(t*100)}static centsToValue(t){return t/100}async clearUserData(t){await this.transaction("rw",this.bank_uploads,this.bank_entries,this.cash_conference_entries,this.not_found_history,this.manual_entries,this.day_selection,this.action_log,async()=>{await this.bank_uploads.where("user_id").equals(t).delete(),await this.bank_entries.where("user_id").equals(t).delete(),await this.cash_conference_entries.where("user_id").equals(t).delete(),await this.not_found_history.where("user_id").equals(t).delete(),await this.manual_entries.where("user_id").equals(t).delete(),await this.day_selection.where("user_id").equals(t).delete(),await this.action_log.where("user_id").equals(t).delete()})}async getStats(){const[t,r,n,a,s,i,o]=await Promise.all([this.bank_uploads.count(),this.bank_entries.count(),this.cash_conference_entries.count(),this.not_found_history.count(),this.manual_entries.count(),this.day_selection.count(),this.action_log.count()]);return{bank_uploads:t,bank_entries:r,cash_conference_entries:n,not_found_history:a,manual_entries:s,day_selection:i,action_log:o}}}const st=new JW,Pd=()=>{try{return typeof indexedDB<"u"}catch{return!1}},QW=async()=>{try{return Pd()?(await st.open(),console.log("IndexedDB inicializado com sucesso!"),!0):(console.warn("IndexedDB não está disponível. Mantendo armazenamento em memória."),!1)}catch(e){return console.error("Erro ao inicializar IndexedDB:",e),!1}};function eH(e){let t=0;if(e.length===0)return t.toString();for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);t=(t<<5)-t+n,t=t&t}return Math.abs(t).toString(36)}function tH(e,t,r,n){const a=(e==null?void 0:e.trim())||"",s=(t==null?void 0:t.replace(/\D/g,""))||"",i=Math.round(r*100),o=(n==null?void 0:n.trim().toLowerCase())||"",l=`${a}|${s}|${i}|${o}`;return`origin_${eH(l)}`}function rH(){return typeof crypto<"u"&&crypto.randomUUID?`manual_${crypto.randomUUID()}`:`manual_${"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const n=Math.random()*16|0;return(r==="x"?n:n&3|8).toString(16)})}`}function nH(){const e=Date.now().toString(36),t=Math.random().toString(36).substring(2,8);return`conf_${e}_${t}`}const aH=/^\d{11}$/,Zx=/^(\d{2})\/(\d{2})\/(\d{4})$/,sH=/^\d{2}-\d{2}-\d{4}$/,A0=On().transform(e=>e.replace(/\D/g,"")).pipe(On().length(11,{message:"CPF deve ter 11 dígitos"}).regex(aH,{message:"CPF deve conter apenas números"}).refine(e=>{if(e==="00000000000"||e==="11111111111"||e==="22222222222"||e==="33333333333"||e==="44444444444"||e==="55555555555"||e==="66666666666"||e==="77777777777"||e==="88888888888"||e==="99999999999")return!1;let t=0;for(let n=0;n<9;n++)t+=parseInt(e.charAt(n))*(10-n);let r=t*10%11;if((r===10||r===11)&&(r=0),r!==parseInt(e.charAt(9)))return!1;t=0;for(let n=0;n<10;n++)t+=parseInt(e.charAt(n))*(11-n);return r=t*10%11,(r===10||r===11)&&(r=0),r===parseInt(e.charAt(10))},{message:"CPF inválido"})),Z4=On().min(1,{message:"Data é obrigatória"}).regex(Zx,{message:"Data deve estar no formato DD/MM/AAAA"}).refine(e=>{const t=e.match(Zx);if(!t)return!1;const r=parseInt(t[1],10),n=parseInt(t[2],10),a=parseInt(t[3],10);if(n<1||n>12||r<1||r>31||a<1900||a>2100)return!1;const s=new Date(a,n-1,r);return s.getDate()===r&&s.getMonth()===n-1&&s.getFullYear()===a},{message:"Data inválida"});On().min(1,{message:"Data é obrigatória"}).regex(sH,{message:"Data deve estar no formato DD-MM-AAAA"}).refine(e=>{const[t,r,n]=e.split("-").map(s=>parseInt(s,10));if(r<1||r>12||t<1||t>31||n<1900||n>2100)return!1;const a=new Date(n,r-1,t);return a.getDate()===t&&a.getMonth()===r-1&&a.getFullYear()===n},{message:"Data inválida"});const lc=gh([mh(),On()]).transform(e=>{if(typeof e=="number")return e;const t=e.replace(/[R$\s]/g,"").replace(/\./g,"").replace(",","."),r=parseFloat(t);return isNaN(r)?0:r}).pipe(mh().finite({message:"Valor deve ser um número válido"}).min(.01,{message:"Valor deve ser maior que zero"}).max(99999999999e-2,{message:"Valor muito alto"}));mh().int({message:"Valor em centavos deve ser inteiro"}).min(1,{message:"Valor deve ser maior que zero"}).max(99999999999,{message:"Valor muito alto"});const iH=On().min(1,{message:"Descrição é obrigatória"}).max(500,{message:"Descrição muito longa (máx. 500 caracteres)"}).transform(e=>e.trim()),Y4=On().max(500,{message:"Descrição muito longa (máx. 500 caracteres)"}).transform(e=>e.trim()).optional(),oH=Fo({date:Z4.optional(),document_number:A0.optional(),description:Y4,value:lc,transaction_type:On().optional(),balance:mh().optional()}),lH=Fo({document_number:A0.optional(),description:iH,value:lc,entry_type:DS(["income","expense","transfer"],{errorMap:()=>({message:"Tipo deve ser: receita, despesa ou transferência"})}),category:On().optional()}),cH=Fo({value:lc,document_number:A0.optional(),description:Y4}),uH=Fo({value:lc}),fH=Fo({value:lc}),dH=Fo({date:gh([Z4,On().optional()]).optional(),paymentType:On().optional(),cpf:gh([A0,On().optional()]).optional(),value:lc,originalHistory:On().optional()}),hH=e=>{if(!e.errors||e.errors.length===0)return"Dados inválidos";const t=e.errors[0];return(t==null?void 0:t.message)||"Dados inválidos"},Ph=(e,t)=>{const r=e.safeParse(t);return r.success?{success:!0,data:r.data}:{success:!1,error:hH(r.error)}};On().min(1,{message:"Nome do arquivo é obrigatório"}).max(255,{message:"Nome do arquivo muito longo"}).refine(e=>[".xlsx",".xls",".csv"].some(r=>e.toLowerCase().endsWith(r)),{message:"Arquivo deve ser Excel (.xlsx, .xls) ou CSV"});const Rh={bankingEntry:oH,manualEntry:lH,cashConference:cH,conferenceValue:uH,notFoundValue:fH,excelRow:dH};class pH{constructor(){this.isEnabled=!1,this.activeOperations=new Map,this.dbName="performance_metrics",this.dbVersion=1,this.storeName="metrics",this.isEnabled=localStorage.getItem("performance_logging_enabled")==="true",this.isEnabled&&(this.initDatabase(),this.cleanOldMetrics())}setEnabled(t){this.isEnabled=t,localStorage.setItem("performance_logging_enabled",t.toString()),t&&this.initDatabase()}isLoggingEnabled(){return this.isEnabled}startOperation(t,r){if(!this.isEnabled)return"";const n=`${t}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,a=performance.now();return this.activeOperations.set(n,{operation:t,startTime:a,metadata:r}),n}endOperation(t){if(!this.isEnabled||!t)return null;const r=this.activeOperations.get(t);if(!r)return null;const n=performance.now(),a=n-r.startTime,s={id:t,operation:r.operation,startTime:r.startTime,endTime:n,duration:a,metadata:r.metadata,timestamp:new Date};return this.activeOperations.delete(t),this.saveMetric(s),s}measureSync(t,r,n){if(!this.isEnabled)return r();const a=this.startOperation(t,n);try{const s=r();return this.endOperation(a),s}catch(s){throw this.endOperation(a),s}}async measureAsync(t,r,n){if(!this.isEnabled)return r();const a=this.startOperation(t,n);try{const s=await r();return this.endOperation(a),s}catch(s){throw this.endOperation(a),s}}async getTodaysStats(){if(!this.isEnabled)return[];const t=new Date;t.setHours(0,0,0,0);const r=new Date(t);r.setDate(r.getDate()+1);const n=await this.getMetricsByDateRange(t,r);return this.calculateStats(n)}async getOperationStats(t,r=24){if(!this.isEnabled)return null;const n=new Date(Date.now()-r*60*60*1e3),s=(await this.getMetricsByDateRange(n,new Date)).filter(o=>o.operation===t);return s.length===0?null:this.calculateStats(s).find(o=>o.operation===t)||null}async getMetricsByDateRange(t,r){return this.isEnabled?new Promise((n,a)=>{const s=indexedDB.open(this.dbName,this.dbVersion);s.onsuccess=()=>{const c=d.result.transaction([this.storeName],"readonly").objectStore(this.storeName).index("timestamp"),u=IDBKeyRange.bound(t,r),d=c.getAll(u);d.onsuccess=()=>{n(d.result||[])},d.onerror=()=>{a(d.error)}},s.onerror=()=>{a(s.error)}}):[]}calculateStats(t){const r=new Map;t.forEach(a=>{r.has(a.operation)||r.set(a.operation,[]),r.get(a.operation).push(a)});const n=[];return r.forEach((a,s)=>{const i=a.map(p=>p.duration).sort((p,_)=>p-_),o=i.length,l=i.reduce((p,_)=>p+_,0),c=l/o,u=i[Math.floor(o/2)],d=Math.floor(o*.95),h=i[d]||i[o-1],v=i[0],y=i[o-1];n.push({operation:s,count:o,average:c,median:u,p95:h,min:v,max:y,totalTime:l})}),n.sort((a,s)=>s.average-a.average)}initDatabase(){const t=indexedDB.open(this.dbName,this.dbVersion);t.onupgradeneeded=()=>{const r=t.result;if(!r.objectStoreNames.contains(this.storeName)){const n=r.createObjectStore(this.storeName,{keyPath:"id"});n.createIndex("operation","operation",{unique:!1}),n.createIndex("timestamp","timestamp",{unique:!1})}},t.onerror=()=>{console.error("Failed to initialize performance metrics database:",t.error)}}saveMetric(t){const r=indexedDB.open(this.dbName,this.dbVersion);r.onsuccess=()=>{const a=r.result.transaction([this.storeName],"readwrite");a.objectStore(this.storeName).add(t),a.onerror=()=>{console.error("Failed to save performance metric:",a.error)}},r.onerror=()=>{console.error("Failed to open performance metrics database:",r.error)}}cleanOldMetrics(){const t=new Date(Date.now()-864e5),r=indexedDB.open(this.dbName,this.dbVersion);r.onsuccess=()=>{const a=l.result.transaction([this.storeName],"readwrite"),i=a.objectStore(this.storeName).index("timestamp"),o=IDBKeyRange.upperBound(t),l=i.openCursor(o);l.onsuccess=()=>{const c=l.result;c&&(c.delete(),c.continue())},a.onerror=()=>{console.error("Failed to clean old performance metrics:",a.error)}},r.onerror=()=>{console.error("Failed to open performance metrics database for cleanup:",r.error)}}async exportMetrics(){if(!this.isEnabled)return[];const t=new Date(Date.now()-24*60*60*1e3);return this.getMetricsByDateRange(t,new Date)}async clearAllMetrics(){if(this.isEnabled)return new Promise((t,r)=>{const n=indexedDB.open(this.dbName,this.dbVersion);n.onsuccess=()=>{const o=n.result.transaction([this.storeName],"readwrite").objectStore(this.storeName).clear();o.onsuccess=()=>{t()},o.onerror=()=>{r(o.error)}},n.onerror=()=>{r(n.error)}})}}const Or=new pH;Or.measureSync.bind(Or);Or.measureAsync.bind(Or);Or.startOperation.bind(Or);Or.endOperation.bind(Or);const Wv=class Wv{static setCurrentUserId(t){this.currentUserId=t}static getCurrentUserId(){return this.currentUserId}static valueToCents(t){return Math.round(t*100)}static centsToValue(t){return t/100}static async logAction(t,r,n,a,s="success",i){const o=this.getCurrentUserId();try{const l={action_type:t,action_description:r,user_id:o,day:n,payload:a,result:s,error_message:i,metadata:{user_agent:navigator.userAgent,timestamp_local:new Date().toLocaleString("pt-BR")}};await st.action_log.add(l)}catch(l){console.error("Error logging action:",l)}}static async saveBankingUpload(t,r,n,a){const s=this.getCurrentUserId();try{await st.transaction("rw",st.bank_uploads,st.bank_entries,async()=>{var u,d;const i=await st.bank_uploads.add({day:n,bank_name:(u=t[0])==null?void 0:u.bankName,account_number:(d=t[0])==null?void 0:d.accountNumber,file_name:r,file_upload_date:n,upload_mode:a,user_id:s,metadata:{total_entries:t.length}}),o=t.map(h=>{const v=tH(h.date||n,h.documentNumber||"",h.value||0,h.description||"");return{upload_id:i,source_id:v,day:n,document_number:h.documentNumber,date:h.date,description:h.description,value:h.value,value_cents:this.valueToCents(h.value||0),transaction_type:h.transactionType,balance:h.balance,status:"pending",source:"banking_upload",user_id:s,metadata:h}}),c=(await Promise.all(o.map(h=>st.bank_entries.where("source_id").equals(h.source_id).first()))).filter(Boolean);if(c.length>0)throw new Error(`${c.length} entradas duplicadas encontradas. Upload cancelado.`);await st.bank_entries.bulkAdd(o),await this.logAction("banking_upload",`Upload de ${o.length} entradas bancárias do arquivo ${r}`,n,{file_name:r,entry_count:o.length,source_ids:o.map(h=>h.source_id),values:o.map(h=>h.value||0),upload_mode:a})})}catch(i){throw console.error("Error saving banking upload:",i),await this.logAction("banking_upload",`Falha no upload do arquivo ${r}`,n,{file_name:r,entry_count:t.length,upload_mode:a},"error",i instanceof Error?i.message:"Erro desconhecido"),i instanceof Error&&i.message.includes("duplicadas")?Bt.error(i.message):Bt.error("Erro ao salvar upload bancário. Tente novamente."),i}}static async saveCashConference(t,r,n){const a=this.getCurrentUserId();try{const s=t.source_id||nH(),i={source_id:s,day:r,document_number:t.documentNumber,description:t.description,value:t.value,value_cents:this.valueToCents(t.value||0),status:n,conferred_at:new Date().toISOString(),conferred_by:a,source:"cash_conference",user_id:a,metadata:t};if(await st.cash_conference_entries.where("source_id").equals(s).first())throw new Error("Entrada já foi conferida anteriormente.");await st.cash_conference_entries.add(i),await this.logAction("cash_conference",`Conferência de caixa: ${n==="conferred"?"Conferido":"Não encontrado"} - ${i.description}`,r,{source_ids:[s],values:[t.value||0],target_status:n})}catch(s){throw console.error("Error saving cash conference:",s),await this.logAction("cash_conference",`Falha na conferência de caixa: ${t.description}`,r,{values:[t.value||0],target_status:n},"error",s instanceof Error?s.message:"Erro desconhecido"),s instanceof Error&&s.message.includes("já foi conferida")?Bt.error(s.message):Bt.error("Erro ao salvar conferência. Tente novamente."),s}}static async saveNotFound(t,r){const n=this.getCurrentUserId(),a=parseFloat(t.replace(",",".").replace(/[^\d.-]/g,""));try{const s={day:r,value:isNaN(a)?0:a,value_cents:this.valueToCents(isNaN(a)?0:a),status:"not_found",source:"not_found_manual",user_id:n,metadata:{originalValue:t}};await st.not_found_history.add(s),await this.logAction("not_found",`Valor não encontrado registrado: ${t}`,r,{values:[a],original_value:t})}catch(s){throw console.error("Error saving not found value:",s),await this.logAction("not_found",`Falha ao registrar valor não encontrado: ${t}`,r,{original_value:t},"error",s instanceof Error?s.message:"Erro desconhecido"),s}}static async saveManualEntry(t,r){const n=Or.startOperation("manual_entry_save",{entryType:t.entry_type,value:t.value,operationDate:r}),a=this.getCurrentUserId();try{const s=Ph(Rh.manualEntry,t);if(!s.success)throw new Error(`Dados inválidos: ${s.error}`);const i=s.data,o={source_id:rH(),day:r,document_number:i.document_number,description:i.description,value:i.value,value_cents:this.valueToCents(i.value),entry_type:i.entry_type,category:i.category,status:"active",source:"manual_entry",user_id:a,metadata:i};if(await st.manual_entries.where("source_id").equals(o.source_id).first())throw new Error("Lançamento manual já existe.");await st.manual_entries.add(o),await this.logAction("manual_entry",`Lançamento manual criado: ${i.entry_type} - ${i.description}`,r,{source_ids:[o.source_id],values:[i.value],entry_type:i.entry_type,category:i.category}),Or.endOperation(n)}catch(s){throw Or.endOperation(n),console.error("Error saving manual entry:",s),await this.logAction("manual_entry",`Falha ao criar lançamento manual: ${t.description||"Sem descrição"}`,r,{values:[t.value||0],entry_type:t.entry_type},"error",s instanceof Error?s.message:"Erro desconhecido"),s instanceof Error&&s.message.includes("já existe")?Bt.error(s.message):Bt.error("Erro ao salvar lançamento manual. Tente novamente."),s}}static async getHistoryByDate(t){const r=this.getCurrentUserId();try{const[n,a,s,i]=await Promise.all([st.bank_entries.where({day:t,user_id:r}).toArray(),st.cash_conference_entries.where({day:t,user_id:r}).toArray(),st.not_found_history.where({day:t,user_id:r}).toArray(),st.manual_entries.where({day:t,user_id:r}).toArray()]),o=[];for(const l of n){const c=await st.bank_uploads.get(l.upload_id);o.push({id:l.id,operation_date:l.day,operation_type:"banking_upload",operation_timestamp:l.created_at,document_number:l.document_number,date:l.date,description:l.description,value:l.value,bank_name:c==null?void 0:c.bank_name,account_number:c==null?void 0:c.account_number,transaction_type:l.transaction_type,balance:l.balance,conferred_at:l.conferred_at,conferred_by:l.conferred_by,status:l.status,file_name:c==null?void 0:c.file_name,file_upload_date:c==null?void 0:c.file_upload_date,upload_mode:c==null?void 0:c.upload_mode,metadata:l.metadata,user_id:l.user_id,source:l.source})}for(const l of a)o.push({id:l.id,operation_date:l.day,operation_type:"cash_conference",operation_timestamp:l.created_at,document_number:l.document_number,description:l.description,value:l.value,conferred_at:l.conferred_at,conferred_by:l.conferred_by,status:l.status,metadata:l.metadata,user_id:l.user_id,source:l.source});for(const l of s)o.push({id:l.id,operation_date:l.day,operation_type:"not_found",operation_timestamp:l.created_at,value:l.value,status:l.status,metadata:l.metadata,user_id:l.user_id,source:l.source});for(const l of i)o.push({id:l.id,operation_date:l.day,operation_type:"manual_entry",operation_timestamp:l.created_at,document_number:l.document_number,description:l.description,value:l.value,status:l.status,metadata:l.metadata,user_id:l.user_id,source:l.source});return o.sort((l,c)=>{const u=new Date(l.operation_timestamp||"").getTime();return new Date(c.operation_timestamp||"").getTime()-u})}catch(n){throw console.error("Error fetching history:",n),n}}static async getDailySummary(t){const r=this.getCurrentUserId();try{const[n,a,s,i,o]=await Promise.all([st.bank_entries.where({day:t,user_id:r}).toArray(),st.cash_conference_entries.where({day:t,user_id:r}).toArray(),st.not_found_history.where({day:t,user_id:r}).toArray(),st.manual_entries.where({day:t,user_id:r}).toArray(),st.bank_uploads.where({day:t,user_id:r}).toArray()]);if(n.length===0&&a.length===0&&s.length===0&&i.length===0)return null;const l=n.filter(x=>x.status==="conferred"),c=n.reduce((x,k)=>x+(k.value||0),0),u=l.reduce((x,k)=>x+(k.value||0),0),d=a.filter(x=>x.status==="conferred"),h=a.filter(x=>x.status==="not_found"),v=d.reduce((x,k)=>x+(k.value||0),0),y=i.filter(x=>x.status==="active"),p=y.reduce((x,k)=>x+(k.value||0),0),_=o.sort((x,k)=>new Date(k.created_at||"").getTime()-new Date(x.created_at||"").getTime())[0];return{operation_date:t,banking_total_uploaded:n.length,banking_total_value:c,banking_conferred_count:l.length,banking_conferred_value:u,cash_conferred_count:d.length,cash_conferred_value:v,cash_not_found_count:h.length+s.length,manual_entries_count:y.length,manual_entries_value:p,last_file_name:_==null?void 0:_.file_name,last_upload_timestamp:_==null?void 0:_.created_at,total_conferred:l.length+d.length,total_value:c+v+p}}catch(n){throw console.error("Error calculating daily summary:",n),n}}static async transferBankingToCash(t,r){const n=this.getCurrentUserId();try{await st.transaction("rw",st.bank_entries,st.cash_conference_entries,async()=>{const a=await st.bank_entries.where({id:t,user_id:n}).first();if(!a)throw new Error("Entrada bancária não encontrada");if(a.status==="transferred")throw new Error("Entrada já foi transferida");const s={source_id:a.source_id,day:r,document_number:a.document_number,description:a.description,value:a.value,value_cents:a.value_cents,status:"conferred",conferred_at:new Date().toISOString(),conferred_by:n,source:"cash_conference",user_id:n,metadata:{...a.metadata,transferred_from_bank_entry:t,original_bank_date:a.date}};await st.cash_conference_entries.add(s),await st.bank_entries.where({id:t,user_id:n}).modify({status:"transferred",conferred_at:new Date().toISOString(),conferred_by:n}),await this.logAction("transfer",`Transferência bancária→caixa: ${a.description}`,r,{source_ids:[a.source_id],values:[a.value||0],original_status:a.status,target_status:"transferred"})})}catch(a){console.error("Error transferring banking to cash:",a);const s=`Falha na transferência: ${a instanceof Error?a.message:"Erro desconhecido"}`;throw await this.logAction("transfer",`Falha na transferência bancária→caixa (ID: ${t})`,r,{bank_entry_id:t},"error",s),Bt.error(s),new Error(s)}}static async undoManualEntry(t){const r=this.getCurrentUserId();try{await st.transaction("rw",st.manual_entries,st.cash_conference_entries,async()=>{const n=await st.manual_entries.where({source_id:t,user_id:r}).first();if(!n)throw new Error("Lançamento manual não encontrado");if(n.status==="cancelled")throw new Error("Lançamento já foi cancelado");await st.cash_conference_entries.where("source_id").equals(t).and(a=>a.user_id===r).delete(),await st.manual_entries.where({source_id:t,user_id:r}).delete(),await this.logAction("undo",`Lançamento manual desfeito: ${n.description}`,n.day,{source_ids:[t],values:[n.value||0],original_status:n.status,entry_type:n.entry_type})})}catch(n){console.error("Error undoing manual entry:",n);const a=`Falha ao desfazer lançamento: ${n instanceof Error?n.message:"Erro desconhecido"}`;throw await this.logAction("undo",`Falha ao desfazer lançamento manual com source_id: ${t}`,In(new Date),{source_ids:[t]},"error",a),Bt.error(a),new Error(a)}}static async updateConferenceStatus(t,r,n){const a=this.getCurrentUserId();try{const s={status:r,updated_at:new Date().toISOString()};switch(r==="conferred"||r==="transferred"?(s.conferred_at=new Date().toISOString(),s.conferred_by=a):(s.conferred_at=null,s.conferred_by=null),n){case"banking_upload":await st.bank_entries.where({id:Number(t),user_id:a}).modify(s);break;case"cash_conference":await st.cash_conference_entries.where({id:Number(t),user_id:a}).modify(s);break;case"not_found_manual":await st.not_found_history.where({id:Number(t),user_id:a}).modify(s);break;case"manual_entry":await st.manual_entries.where({id:Number(t),user_id:a}).modify(s);break}}catch(s){throw console.error("Error updating conference status:",s),s}}static async saveDaySelection(t,r){const n=this.getCurrentUserId();try{await st.day_selection.put({day:t,selected_date:r,user_id:n,last_accessed:new Date().toISOString()})}catch(a){throw console.error("Error saving day selection:",a),a}}static async getDaySelection(t){const r=this.getCurrentUserId();try{return await st.day_selection.where({day:t,user_id:r}).first()||null}catch(n){return console.error("Error getting day selection:",n),null}}static async clearDayHistory(t){const r=this.getCurrentUserId();try{await st.transaction("rw",[st.bank_uploads,st.bank_entries,st.cash_conference_entries,st.not_found_history,st.manual_entries],async()=>{const a=(await st.bank_uploads.where({day:t,user_id:r}).toArray()).map(s=>s.id);for(const s of a)await st.bank_entries.where("upload_id").equals(s).delete();await st.bank_uploads.where({day:t,user_id:r}).delete(),await st.cash_conference_entries.where({day:t,user_id:r}).delete(),await st.not_found_history.where({day:t,user_id:r}).delete(),await st.manual_entries.where({day:t,user_id:r}).delete()})}catch(n){throw console.error("Error clearing day history:",n),n}}static async deleteHistoryEntry(t,r){const n=this.getCurrentUserId();try{switch(r){case"banking_upload":const a=await st.bank_entries.where({id:Number(t),user_id:n}).first();a&&(await st.bank_entries.delete(Number(t)),await st.bank_entries.where("upload_id").equals(a.upload_id).count()===0&&await st.bank_uploads.delete(a.upload_id));break;case"cash_conference":await st.cash_conference_entries.where({id:Number(t),user_id:n}).delete();break;case"not_found_manual":await st.not_found_history.where({id:Number(t),user_id:n}).delete();break;case"manual_entry":await st.manual_entries.where({id:Number(t),user_id:n}).delete();break}}catch(a){throw console.error("Error deleting history entry:",a),a}}static async searchByValue(t,r){const n=this.getCurrentUserId(),a=this.valueToCents(t);try{let s=st.bank_entries.where({value_cents:a,user_id:n}),i=st.cash_conference_entries.where({value_cents:a,user_id:n}),o=st.not_found_history.where({value_cents:a,user_id:n}),l=st.manual_entries.where({value_cents:a,user_id:n});r&&(s=s.and(y=>y.day===r),i=i.and(y=>y.day===r),o=o.and(y=>y.day===r),l=l.and(y=>y.day===r));const[c,u,d,h]=await Promise.all([s.toArray(),i.toArray(),o.toArray(),l.toArray()]),v=[];for(const y of c){const p=await st.bank_uploads.get(y.upload_id);v.push({id:y.id,operation_date:y.day,operation_type:"banking_upload",operation_timestamp:y.created_at,document_number:y.document_number,description:y.description,value:y.value,status:y.status,source:y.source,file_name:p==null?void 0:p.file_name,user_id:y.user_id})}for(const y of u)v.push({id:y.id,operation_date:y.day,operation_type:"cash_conference",operation_timestamp:y.created_at,document_number:y.document_number,description:y.description,value:y.value,status:y.status,source:y.source,user_id:y.user_id});for(const y of d)v.push({id:y.id,operation_date:y.day,operation_type:"not_found",operation_timestamp:y.created_at,value:y.value,status:y.status,source:y.source,user_id:y.user_id});for(const y of h)v.push({id:y.id,operation_date:y.day,operation_type:"manual_entry",operation_timestamp:y.created_at,document_number:y.document_number,description:y.description,value:y.value,status:y.status,source:y.source,user_id:y.user_id});return v.sort((y,p)=>new Date(p.operation_timestamp||"").getTime()-new Date(y.operation_timestamp||"").getTime())}catch(s){throw console.error("Error searching by value:",s),s}}static async getStats(){try{const t=await st.getStats(),r=t.bank_uploads*.5+t.bank_entries*1+t.cash_conference_entries*.8+t.not_found_history*.3+t.manual_entries*.8+t.day_selection*.2;return{...t,total_storage_mb:Math.round(r/1e3)/1e3}}catch(t){throw console.error("Error getting stats:",t),t}}};Wv.currentUserId="default_user";let hn=Wv;class Ua{static async saveBankingUpload(t,r,n,a){const s=await fs(),[i,o,l]=n.split("-"),c=`${l}-${o}-${i}`,{data:u,error:d}=await Cr.from("banking_files").insert({user_id:s,file_name:r,operation_date:c,total_transactions:t.length,total_value:t.reduce((y,p)=>y+(p.value||0),0),status:"uploaded",metadata:{upload_mode:a}}).select("id").single();if(d)throw console.error("Error creating banking file:",d),d;const h=t.map((y,p)=>{var _;return{file_id:u.id,user_id:s,transaction_date:c,payment_type:y.paymentType||y.transactionType,cpf:(_=y.cpf)==null?void 0:_.replace(/[^0-9]/g,""),value:y.value,original_history:y.originalHistory||y.description,status:"pending",row_index:p,original_data:y}}),{error:v}=await Cr.from("banking_transactions").insert(h);if(v)throw console.error("Error saving banking transactions:",v),v}static async saveCashConference(t,r,n){var d;const a=await fs(),[s,i,o]=r.split("-"),l=`${o}-${i}-${s}`,c={user_id:a,transaction_id:t.transactionId||null,conferred_value:t.value,conference_date:l,transaction_date:t.date?(()=>{const[h,v,y]=t.date.split("-");return`${y}-${v}-${h}`})():l,payment_type:t.paymentType,cpf:(d=t.cpf)==null?void 0:d.replace(/[^0-9]/g,""),original_value:t.originalValue||t.value,original_history:t.description,conference_status:n==="conferred"?"active":"cancelled",notes:n==="not_found"?"Value not found":null},{error:u}=await Cr.from("cash_conference").insert(c);if(u)throw console.error("Error saving cash conference:",u),u}static async saveNotFound(t,r){const n=await fs(),a=parseFloat(t.replace(",",".").replace(/[^\d.-]/g,"")),s={user_id:n,searched_value:t,normalized_value:isNaN(a)?0:a,status:"not_found",notes:`Date: ${r}`},{error:i}=await Cr.from("not_found_history").insert(s);if(i)throw console.error("Error saving not found value:",i),i}static async getHistoryByDate(t){const r=await fs(),[n,a,s]=t.split("-"),i=`${s}-${a}-${n}`,o=[],{data:l,error:c}=await Cr.from("banking_transactions").select(`
        *,
        banking_files!inner(file_name, upload_date)
      `).eq("user_id",r).eq("transaction_date",i).order("created_at",{ascending:!1});if(c)throw console.error("Error fetching transactions:",c),c;l&&l.forEach(y=>{var p,_;o.push({id:y.id,operation_date:t,operation_type:"banking_upload",document_number:(p=y.original_data)==null?void 0:p.documentNumber,date:y.transaction_date,description:y.original_history,value:y.value,status:y.status,file_name:(_=y.banking_files)==null?void 0:_.file_name,user_id:y.user_id,metadata:y.original_data})});const{data:u,error:d}=await Cr.from("cash_conference").select("*").eq("user_id",r).eq("conference_date",i).order("created_at",{ascending:!1});if(d)throw console.error("Error fetching conferences:",d),d;u&&u.forEach(y=>{o.push({id:y.id,operation_date:t,operation_type:"cash_conference",description:y.original_history,value:y.conferred_value,status:y.conference_status==="active"?"conferred":"not_found",conferred_at:y.created_at,user_id:y.user_id})});const{data:h,error:v}=await Cr.from("not_found_history").select("*").eq("user_id",r).gte("search_timestamp",`${i}T00:00:00`).lt("search_timestamp",`${i}T23:59:59`).order("search_timestamp",{ascending:!1});if(v)throw console.error("Error fetching not found history:",v),v;return h&&h.forEach(y=>{o.push({id:y.id,operation_date:t,operation_type:"not_found",value:y.normalized_value,status:"not_found",user_id:y.user_id,metadata:{originalValue:y.searched_value}})}),o.sort((y,p)=>new Date(p.conferred_at||p.operation_timestamp||"").getTime()-new Date(y.conferred_at||y.operation_timestamp||"").getTime())}static async getDailySummary(t){const r=await fs(),[n,a,s]=t.split("-"),i=`${s}-${a}-${n}`,{data:o}=await Cr.from("banking_transactions").select("value, status").eq("user_id",r).eq("transaction_date",i),{data:l}=await Cr.from("cash_conference").select("conferred_value, conference_status").eq("user_id",r).eq("conference_date",i),{data:c}=await Cr.from("banking_files").select("file_name, upload_date").eq("user_id",r).eq("operation_date",i).order("upload_date",{ascending:!1}).limit(1).single(),u={operation_date:t,banking_total_uploaded:(o==null?void 0:o.length)||0,banking_total_value:(o==null?void 0:o.reduce((d,h)=>d+h.value,0))||0,banking_conferred_count:(o==null?void 0:o.filter(d=>d.status==="conferred").length)||0,banking_conferred_value:(o==null?void 0:o.filter(d=>d.status==="conferred").reduce((d,h)=>d+h.value,0))||0,cash_conferred_count:(l==null?void 0:l.filter(d=>d.conference_status==="active").length)||0,cash_conferred_value:(l==null?void 0:l.filter(d=>d.conference_status==="active").reduce((d,h)=>d+h.conferred_value,0))||0,cash_not_found_count:(l==null?void 0:l.filter(d=>d.conference_status==="cancelled").length)||0,last_file_name:c==null?void 0:c.file_name,last_upload_timestamp:c==null?void 0:c.upload_date};return u.total_conferred=u.banking_conferred_count+u.cash_conferred_count,u.total_value=u.banking_total_value+u.cash_conferred_value,u}static async getHistoryByDateRange(t,r){const n=await fs(),[a,s,i]=t.split("-"),[o,l,c]=r.split("-"),u=`${i}-${s}-${a}`,d=`${c}-${l}-${o}`,h=[],{data:v}=await Cr.from("banking_transactions").select("*, banking_files!inner(file_name, upload_date)").eq("user_id",n).gte("transaction_date",u).lte("transaction_date",d).order("transaction_date",{ascending:!1}),{data:y}=await Cr.from("cash_conference").select("*").eq("user_id",n).gte("conference_date",u).lte("conference_date",d).order("conference_date",{ascending:!1}),{data:p}=await Cr.from("not_found_history").select("*").eq("user_id",n).gte("search_timestamp",`${u}T00:00:00`).lte("search_timestamp",`${d}T23:59:59`).order("search_timestamp",{ascending:!1});return v&&v.forEach(_=>{var E,I;const[x,k,w]=_.transaction_date.split("-");h.push({id:_.id,operation_date:`${w}-${k}-${x}`,operation_type:"banking_upload",document_number:(E=_.original_data)==null?void 0:E.documentNumber,description:_.original_history,value:_.value,status:_.status,file_name:(I=_.banking_files)==null?void 0:I.file_name,user_id:_.user_id,metadata:_.original_data})}),y&&y.forEach(_=>{const[x,k,w]=_.conference_date.split("-");h.push({id:_.id,operation_date:`${w}-${k}-${x}`,operation_type:"cash_conference",description:_.original_history,value:_.conferred_value,status:_.conference_status==="active"?"conferred":"not_found",conferred_at:_.created_at,user_id:_.user_id})}),p&&p.forEach(_=>{const x=new Date(_.search_timestamp),k=`${x.getDate().toString().padStart(2,"0")}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getFullYear()}`;h.push({id:_.id,operation_date:k,operation_type:"not_found",value:_.normalized_value,status:"not_found",user_id:_.user_id,metadata:{originalValue:_.searched_value}})}),h.sort((_,x)=>{const k=new Date(_.operation_date.split("-").reverse().join("-"));return new Date(x.operation_date.split("-").reverse().join("-")).getTime()-k.getTime()})}static async updateConferenceStatus(t,r){const n=await fs(),{error:a}=await Cr.from("banking_transactions").update({status:r,updated_at:new Date().toISOString()}).eq("id",t).eq("user_id",n);if(!a)return;const{error:s}=await Cr.from("cash_conference").update({conference_status:r==="conferred"?"active":"cancelled",updated_at:new Date().toISOString()}).eq("id",t).eq("user_id",n);if(s)throw console.error("Error updating conference status:",s),s}static async deleteHistoryEntry(t){const r=await fs(),{error:n}=await Cr.from("banking_transactions").delete().eq("id",t).eq("user_id",r);if(!n)return;const{error:a}=await Cr.from("cash_conference").delete().eq("id",t).eq("user_id",r);if(!a)return;const{error:s}=await Cr.from("not_found_history").delete().eq("id",t).eq("user_id",r);if(s)throw console.error("Error deleting history entry:",s),s}static async clearDayHistory(t){const r=await fs(),[n,a,s]=t.split("-"),i=`${s}-${a}-${n}`;await Cr.from("banking_transactions").delete().eq("user_id",r).eq("transaction_date",i),await Cr.from("cash_conference").delete().eq("user_id",r).eq("conference_date",i),await Cr.from("not_found_history").delete().eq("user_id",r).gte("search_timestamp",`${i}T00:00:00`).lt("search_timestamp",`${i}T23:59:59`),await Cr.from("banking_files").delete().eq("user_id",r).eq("operation_date",i)}}const Mh=class Mh{static async initialize(){if(!this.initialized)try{if(Pd())if(await QW()){this.useIndexedDB=!0,console.log("Using IndexedDB for storage");const r=await fs();hn.setCurrentUserId(r)}else console.log("IndexedDB initialization failed, falling back to Supabase"),this.useIndexedDB=!1;else console.log("IndexedDB not available, using Supabase"),this.useIndexedDB=!1;this.initialized=!0}catch(t){console.error("Error initializing storage adapter:",t),this.useIndexedDB=!1,this.initialized=!0}}static isUsingIndexedDB(){return this.useIndexedDB}static forceIndexedDB(t=!0){this.useIndexedDB=t&&Pd()}static async saveBankingUpload(t,r,n,a){return await this.initialize(),this.useIndexedDB?hn.saveBankingUpload(t,r,n,a):Ua.saveBankingUpload(t,r,n,a)}static async saveCashConference(t,r,n){return await this.initialize(),this.useIndexedDB?hn.saveCashConference(t,r,n):Ua.saveCashConference(t,r,n)}static async saveNotFound(t,r){return await this.initialize(),this.useIndexedDB?hn.saveNotFound(t,r):Ua.saveNotFound(t,r)}static async saveManualEntry(t,r){if(await this.initialize(),this.useIndexedDB)return hn.saveManualEntry(t,r);throw new Error("Manual entries not yet implemented for Supabase")}static async getHistoryByDate(t){return await this.initialize(),this.useIndexedDB?hn.getHistoryByDate(t):Ua.getHistoryByDate(t)}static async getDailySummary(t){return await this.initialize(),this.useIndexedDB?hn.getDailySummary(t):Ua.getDailySummary(t)}static async getHistoryByDateRange(t,r){if(await this.initialize(),this.useIndexedDB){const n=[],a=new Date(t.split("-").reverse().join("-")),s=new Date(r.split("-").reverse().join("-"));for(let i=new Date(a);i<=s;i.setDate(i.getDate()+1)){const o=i.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),l=await hn.getHistoryByDate(o);n.push(...l)}return n.sort((i,o)=>{const l=new Date(i.operation_timestamp||"").getTime();return new Date(o.operation_timestamp||"").getTime()-l})}else return Ua.getHistoryByDateRange(t,r)}static async updateConferenceStatus(t,r){return await this.initialize(),this.useIndexedDB?hn.updateConferenceStatus(t,r,"banking_upload"):Ua.updateConferenceStatus(String(t),r)}static async clearDayHistory(t){return await this.initialize(),this.useIndexedDB?hn.clearDayHistory(t):Ua.clearDayHistory(t)}static async deleteHistoryEntry(t){return await this.initialize(),this.useIndexedDB?hn.deleteHistoryEntry(t,"banking_upload"):Ua.deleteHistoryEntry(String(t))}static async saveDaySelection(t,r){if(await this.initialize(),this.useIndexedDB)return hn.saveDaySelection(t,r);try{const n=`day_selection_${t}`,a={day:t,selectedDate:r,timestamp:new Date().toISOString()};localStorage.setItem(n,JSON.stringify(a))}catch(n){console.warn("Failed to save day selection:",n)}}static async getDaySelection(t){if(await this.initialize(),this.useIndexedDB)return hn.getDaySelection(t);try{const r=`day_selection_${t}`,n=localStorage.getItem(r);if(n){const a=JSON.parse(n);return{day:a.day,selected_date:a.selectedDate}}}catch(r){console.warn("Failed to get day selection:",r)}return null}static async searchByValue(t,r){return await this.initialize(),this.useIndexedDB?hn.searchByValue(t,r):(r?await Ua.getHistoryByDate(r):await Ua.getHistoryByDateRange(new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}))).filter(a=>a.value===t)}static async getStorageStats(){return await this.initialize(),this.useIndexedDB?{type:"IndexedDB",stats:await hn.getStats()}:{type:"Supabase"}}static async migrateToIndexedDB(){if(!Pd())throw new Error("IndexedDB is not available");console.log("Migration to IndexedDB would be implemented here")}static async migrateToSupabase(){if(!this.useIndexedDB)throw new Error("Not using IndexedDB");console.log("Migration to Supabase would be implemented here")}};Mh.useIndexedDB=!1,Mh.initialized=!1;let Ws=Mh;const J4=Jt.memo(({index:e,style:t,data:r})=>{const n=r.items[e],a=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),s=l=>{if(!l)return"-";try{const c=new Date(l);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(c)}catch{return l}},i=l=>{const c={banking_upload:"bg-blue-900 text-blue-200",cash_conference:"bg-green-900 text-green-200",not_found:"bg-red-900 text-red-200",manual_entry:"bg-purple-900 text-purple-200"},u={banking_upload:"Upload Bancário",cash_conference:"Conf. Caixa",not_found:"Não Encontrado",manual_entry:"Lançamento Manual"},d=c[l]||"bg-gray-700 text-gray-300",h=u[l]||l;return m.jsx("span",{className:`px-2 py-1 text-xs rounded ${d}`,children:h})},o=l=>{const c={pending:"bg-yellow-900 text-yellow-200",conferred:"bg-green-900 text-green-200",not_found:"bg-red-900 text-red-200",transferred:"bg-blue-900 text-blue-200",active:"bg-green-900 text-green-200",cancelled:"bg-gray-700 text-gray-300"},u={pending:"Pendente",conferred:"Conferido",not_found:"Não Encontrado",transferred:"Transferido",active:"Ativo",cancelled:"Cancelado"},d=c[l]||"bg-gray-700 text-gray-300",h=u[l]||l;return m.jsx("span",{className:`px-2 py-1 text-xs rounded ${d}`,children:h})};return m.jsxs("div",{style:t,className:`grid grid-cols-12 gap-2 px-4 py-3 border-b border-gray-700 text-sm ${e%2===0?"bg-gray-900":"bg-gray-850"} hover:bg-gray-800 transition-colors`,children:[m.jsx("div",{className:"col-span-1 text-gray-400 font-mono flex items-center",children:e+1}),m.jsx("div",{className:"col-span-2 text-gray-300 flex items-center",children:m.jsx("span",{className:"text-xs",children:n.operation_date})}),m.jsx("div",{className:"col-span-2 flex items-center",children:i(n.operation_type||"unknown")}),m.jsx("div",{className:"col-span-2 text-right font-semibold flex items-center justify-end",children:n.value?m.jsx("span",{className:n.value>=0?"text-green-400":"text-red-400",children:a(n.value)}):m.jsx("span",{className:"text-gray-500",children:"-"})}),m.jsx("div",{className:"col-span-2 flex items-center",children:o(n.status||"unknown")}),m.jsx("div",{className:"col-span-2 text-gray-300 flex items-center",children:m.jsx("span",{className:"truncate",title:n.description,children:n.description||"-"})}),m.jsx("div",{className:"col-span-1 text-gray-400 flex items-center",children:m.jsx("span",{className:"text-xs",children:s(n.operation_timestamp)})})]})});J4.displayName="HistoryTableRow";const mH=({historyData:e,onExport:t,className:r=""})=>{const[n,a]=ms("history_table_filters",{dateFilter:"",typeFilter:"all",statusFilter:"all",searchText:""}),{filteredData:s,stats:i,isEmpty:o,hasFilters:l}=E8(e,n),c=j.useMemo(()=>{const p=[...new Set(e.map(x=>x.operation_type||"unknown"))].sort(),_=[...new Set(e.map(x=>x.status||"unknown"))].sort();return{operationTypes:p,statuses:_}},[e]),u=j.useMemo(()=>({items:s}),[s]),d=j.useCallback((p,_)=>{a(x=>({...x,[p]:_}))},[a]),h=j.useCallback(()=>{a({dateFilter:"",typeFilter:"all",statusFilter:"all",searchText:""})},[a]),v=70,y=Math.min(600,Math.max(300,s.length*v+50));return m.jsxs("div",{className:`bg-gray-800 border border-gray-700 rounded-lg ${r}`,children:[m.jsxs("div",{className:"p-4 border-b border-gray-700",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs("h3",{className:"text-lg font-semibold text-gray-200 flex items-center",children:[m.jsx(I8,{className:"h-5 w-5 mr-2"}),"Histórico de Operações"]}),m.jsxs("div",{className:"flex items-center space-x-4",children:[m.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-400",children:[m.jsxs("span",{children:["Total: ",i.totalItems]}),m.jsxs("span",{children:["Filtrados: ",i.filteredCount]}),m.jsxs("span",{children:["Valor: ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.filteredValue)]})]}),t&&m.jsxs("button",{onClick:t,className:"flex items-center px-3 py-2 text-sm text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:[m.jsx(O8,{className:"h-4 w-4 mr-1"}),"Exportar"]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[m.jsx("input",{type:"text",placeholder:"Buscar...",value:n.searchText,onChange:p=>d("searchText",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),m.jsx("input",{type:"text",placeholder:"Data (DD-MM-YYYY)",value:n.dateFilter,onChange:p=>d("dateFilter",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),m.jsxs("select",{value:n.typeFilter,onChange:p=>d("typeFilter",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[m.jsx("option",{value:"all",children:"Todos os tipos"}),c.operationTypes.map(p=>m.jsx("option",{value:p,children:p==="banking_upload"?"Upload Bancário":p==="cash_conference"?"Conf. Caixa":p==="not_found"?"Não Encontrado":p==="manual_entry"?"Lançamento Manual":p},p))]}),m.jsxs("select",{value:n.statusFilter,onChange:p=>d("statusFilter",p.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[m.jsx("option",{value:"all",children:"Todos os status"}),c.statuses.map(p=>m.jsx("option",{value:p,children:p==="pending"?"Pendente":p==="conferred"?"Conferido":p==="not_found"?"Não Encontrado":p==="transferred"?"Transferido":p==="active"?"Ativo":p==="cancelled"?"Cancelado":p},p))]}),l&&m.jsxs("button",{onClick:h,className:"flex items-center justify-center px-3 py-2 text-sm text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:[m.jsx(P8,{className:"h-4 w-4 mr-1"}),"Limpar"]})]})]}),m.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 bg-gray-750 border-b border-gray-700 text-sm font-semibold text-gray-300",children:[m.jsx("div",{className:"col-span-1",children:"#"}),m.jsx("div",{className:"col-span-2",children:"Data"}),m.jsx("div",{className:"col-span-2",children:"Tipo"}),m.jsx("div",{className:"col-span-2 text-right",children:"Valor"}),m.jsx("div",{className:"col-span-2",children:"Status"}),m.jsx("div",{className:"col-span-2",children:"Descrição"}),m.jsx("div",{className:"col-span-1",children:"Timestamp"})]}),o?m.jsx("div",{className:"p-8 text-center text-gray-400",children:l?"Nenhum resultado encontrado com os filtros aplicados":"Nenhum histórico disponível"}):m.jsx(_0,{height:y,itemCount:s.length,itemSize:v,itemData:u,className:"custom-scrollbar",children:J4}),!o&&m.jsx("div",{className:"p-3 border-t border-gray-700 bg-gray-750",children:m.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[m.jsx("div",{className:"flex space-x-4",children:m.jsxs("span",{children:["Média: ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.averageValue)]})}),m.jsx("div",{className:"flex space-x-4",children:Object.entries(i.itemsByStatus).slice(0,4).map(([p,_])=>m.jsxs("span",{children:[p==="pending"?"Pendente":p==="conferred"?"Conferido":p==="not_found"?"Não Encontrado":p==="active"?"Ativo":p,": ",_]},p))})]})})]})};class rm{static formatCurrency(t){return t==null?"":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t)}static exportToCSV(t,r){const n=[];t.banking&&t.banking.length>0&&(n.push("DADOS BANCÁRIOS"),n.push(["Data","Documento","Descrição","Valor","Tipo Transação","Status","ID Origem"].join(",")),t.banking.forEach(s=>{var i;n.push([`"${s.date||""}"`,`"${s.document_number||""}"`,`"${((i=s.description)==null?void 0:i.replace(/"/g,'""'))||""}"`,`"${this.formatCurrency(s.value)}"`,`"${s.transaction_type||""}"`,`"${s.status||""}"`,`"${s.source_id||""}"`].join(","))}),n.push("")),t.cash&&t.cash.length>0&&(n.push("CONFERÊNCIA DE CAIXA"),n.push(["Data","Documento","Descrição","Valor","Status","Conferido Em","Conferido Por","ID Origem"].join(",")),t.cash.forEach(s=>{var i;n.push([`"${s.day||""}"`,`"${s.document_number||""}"`,`"${((i=s.description)==null?void 0:i.replace(/"/g,'""'))||""}"`,`"${this.formatCurrency(s.value)}"`,`"${s.status||""}"`,`"${s.conferred_at?El(s.conferred_at):""}"`,`"${s.conferred_by||""}"`,`"${s.source_id||""}"`].join(","))}),n.push("")),t.manual&&t.manual.length>0&&(n.push("LANÇAMENTOS MANUAIS"),n.push(["Data","Documento","Descrição","Valor","Tipo","Categoria","Status","ID Origem"].join(",")),t.manual.forEach(s=>{var i;n.push([`"${s.day||""}"`,`"${s.document_number||""}"`,`"${((i=s.description)==null?void 0:i.replace(/"/g,'""'))||""}"`,`"${this.formatCurrency(s.value)}"`,`"${s.entry_type||""}"`,`"${s.category||""}"`,`"${s.status||""}"`,`"${s.source_id||""}"`].join(","))}),n.push("")),t.actions&&t.actions.length>0&&(n.push("HISTÓRICO DE AÇÕES"),n.push(["Data/Hora","Tipo de Ação","Descrição","Resultado","Usuário","Valores","IDs de Origem","Erro"].join(",")),t.actions.forEach(s=>{var i,o;n.push([`"${El(s.timestamp)}"`,`"${this.getActionTypeLabel(s.action_type)}"`,`"${s.action_description.replace(/"/g,'""')}"`,`"${s.result}"`,`"${s.user_id}"`,`"${((i=s.payload.values)==null?void 0:i.join("; "))||""}"`,`"${((o=s.payload.source_ids)==null?void 0:o.join("; "))||""}"`,`"${s.error_message||""}"`].join(","))}),n.push("")),t.history&&t.history.length>0&&(n.push("HISTÓRICO POR DATA"),n.push(["Data Operação","Tipo Operação","Documento","Descrição","Valor","Status","Arquivo","Banco"].join(",")),t.history.forEach(s=>{var i;n.push([`"${s.operation_date||""}"`,`"${this.getOperationTypeLabel(s.operation_type)}"`,`"${s.document_number||""}"`,`"${((i=s.description)==null?void 0:i.replace(/"/g,'""'))||""}"`,`"${this.formatCurrency(s.value)}"`,`"${s.status||""}"`,`"${s.file_name||""}"`,`"${s.bank_name||""}"`].join(","))}));const a=n.join(`
`);this.downloadFile(a,r,"text/csv;charset=utf-8;")}static exportToXLSX(t,r){const n=ar.book_new();if(t.banking&&t.banking.length>0){const i=t.banking.map(l=>({Data:l.date||"",Documento:l.document_number||"",Descrição:l.description||"",Valor:l.value||0,"Tipo Transação":l.transaction_type||"",Status:l.status||"","ID Origem":l.source_id||""})),o=ar.json_to_sheet(i);ar.book_append_sheet(n,o,"Bancário")}if(t.cash&&t.cash.length>0){const i=t.cash.map(l=>({Data:l.day||"",Documento:l.document_number||"",Descrição:l.description||"",Valor:l.value||0,Status:l.status||"","Conferido Em":l.conferred_at?El(l.conferred_at):"","Conferido Por":l.conferred_by||"","ID Origem":l.source_id||""})),o=ar.json_to_sheet(i);ar.book_append_sheet(n,o,"Caixa")}if(t.manual&&t.manual.length>0){const i=t.manual.map(l=>({Data:l.day||"",Documento:l.document_number||"",Descrição:l.description||"",Valor:l.value||0,Tipo:l.entry_type||"",Categoria:l.category||"",Status:l.status||"","ID Origem":l.source_id||""})),o=ar.json_to_sheet(i);ar.book_append_sheet(n,o,"Lançamentos")}if(t.actions&&t.actions.length>0){const i=t.actions.map(l=>{var c,u;return{"Data/Hora":El(l.timestamp),"Tipo de Ação":this.getActionTypeLabel(l.action_type),Descrição:l.action_description,Resultado:l.result,Usuário:l.user_id,Valores:((c=l.payload.values)==null?void 0:c.join("; "))||"","IDs de Origem":((u=l.payload.source_ids)==null?void 0:u.join("; "))||"",Erro:l.error_message||""}}),o=ar.json_to_sheet(i);ar.book_append_sheet(n,o,"Ações")}if(t.history&&t.history.length>0){const i=t.history.map(l=>({"Data Operação":l.operation_date||"","Tipo Operação":this.getOperationTypeLabel(l.operation_type),Documento:l.document_number||"",Descrição:l.description||"",Valor:l.value||0,Status:l.status||"",Arquivo:l.file_name||"",Banco:l.bank_name||""})),o=ar.json_to_sheet(i);ar.book_append_sheet(n,o,"Histórico")}const a=$v(n,{bookType:"xlsx",type:"array"}),s=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});this.downloadBlob(s,r)}static getActionTypeLabel(t){switch(t){case"banking_upload":return"Upload Bancário";case"cash_conference":return"Conferência";case"manual_entry":return"Lançamento Manual";case"transfer":return"Transferência";case"undo":return"Desfazer";case"not_found":return"Não Encontrado";default:return t}}static getOperationTypeLabel(t){switch(t){case"banking_upload":return"Upload Bancário";case"cash_conference":return"Conferência de Caixa";case"not_found":return"Não Encontrado";case"manual_entry":return"Lançamento Manual";default:return t}}static downloadFile(t,r,n){const a=new Blob([t],{type:n});this.downloadBlob(a,r)}static downloadBlob(t,r){const n=document.createElement("a"),a=URL.createObjectURL(t);n.setAttribute("href",a),n.setAttribute("download",r),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}static generateFilename(t,r,n){const a=n||In(new Date),s=new Date().toISOString().split("T")[0];return`${t}_${a}_${s}.${r}`}}const Ku=({data:e,prefix:t,date:r,className:n="",disabled:a=!1})=>{const[s,i]=j.useState(!1),o=async l=>{if(a)return;if(!Object.values(e).some(d=>Array.isArray(d)&&d.length>0)){Bt.error("Nenhum dado para exportar");return}const u=Object.values(e).reduce((d,h)=>d+(Array.isArray(h)?h.length:0),0);i(!0);try{await Or.measureAsync("data_export",async()=>{const d=rm.generateFilename(t,l,r);l==="csv"?rm.exportToCSV(e,d):rm.exportToXLSX(e,d)},{format:l,totalRecords:u,prefix:t}),Bt.success(`Dados exportados! ${u} registros em formato ${l.toUpperCase()}.`)}catch(d){console.error("Export error:",d),Bt.error(d instanceof Error?d.message:"Erro ao exportar dados")}finally{i(!1)}};return m.jsxs("div",{className:`flex space-x-2 ${n}`,children:[m.jsxs("button",{onClick:()=>o("csv"),disabled:a||s,className:"px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",title:"Exportar para CSV",children:[s?m.jsxs("svg",{className:"animate-spin h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):m.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),"CSV"]}),m.jsxs("button",{onClick:()=>o("xlsx"),disabled:a||s,className:"px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",title:"Exportar para Excel",children:[s?m.jsxs("svg",{className:"animate-spin h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):m.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),"XLSX"]})]})},gH=({className:e="",onDataLoaded:t,onLookupMapBuilt:r})=>{const[n,a]=j.useState(Gl(new Date)),[s,i]=j.useState([]),[o,l]=j.useState(null),[c,u]=j.useState(!1),[d,h]=j.useState(null),[v,y]=j.useState("day"),p=async()=>{u(!0),h(null);try{let x=[];if(v==="day"){const k=In(n);x=await Ws.getHistoryByDate(k);const w=await Ws.getDailySummary(k);l(w)}else{const k=new Date(n),w=new Date(n);v==="week"?w.setDate(w.getDate()-7):v==="month"&&w.setMonth(w.getMonth()-1),x=await Ws.getHistoryByDateRange(In(w),In(k)),l(null)}i(x),t&&t(x),x.length>0&&(r==null||r(x)),x.length===0&&h("Nenhum registro encontrado para o período selecionado.")}catch(x){console.error("Error loading history:",x),h("Erro ao carregar histórico. Tente novamente.")}finally{u(!1)}},_=x=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(x);return m.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border border-gray-700 ${e}`,children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"4"}),"Histórico por Data"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"history-date-input",className:"block text-xs text-gray-400 mb-1",children:"Selecionar data"}),m.jsx("input",{id:"history-date-input",type:"date",value:n,onChange:x=>a(x.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Selecionar data"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"period-select",className:"block text-xs text-gray-400 mb-1",children:"Período"}),m.jsxs("select",{id:"period-select",value:v,onChange:x=>y(x.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Selecionar período",children:[m.jsx("option",{value:"day",children:"Dia específico"}),m.jsx("option",{value:"week",children:"Última semana"}),m.jsx("option",{value:"month",children:"Último mês"})]})]})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:p,disabled:c,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?"Carregando...":"Carregar Histórico"}),m.jsx("button",{onClick:()=>{const x=Gl(new Date);a(x),y("day")},className:"px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",title:"Carregar dia atual",children:"Hoje"})]}),d&&m.jsx("div",{className:"p-2 bg-red-900/20 border border-red-400 rounded-md",children:m.jsx("p",{className:"text-xs text-red-400",children:d})}),o&&m.jsxs("div",{className:"bg-gray-900 rounded p-3 border border-gray-600",children:[m.jsx("h4",{className:"text-xs font-medium text-gray-400 mb-2",children:"Resumo do Dia"}),m.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Uploads:"}),m.jsx("span",{className:"text-gray-200",children:o.banking_total_uploaded})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Conferidos:"}),m.jsx("span",{className:"text-green-400",children:o.total_conferred||0})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Não encontrados:"}),m.jsx("span",{className:"text-red-400",children:o.cash_not_found_count})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Valor total:"}),m.jsx("span",{className:"text-indigo-400",children:_(o.total_value||0)})]})]})]}),s.length>0&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h4",{className:"text-sm font-medium text-gray-200",children:"Dados do Histórico"}),m.jsx(Ku,{data:{history:s},prefix:"historico",date:In(n),disabled:s.length===0})]}),m.jsx(mH,{historyData:s,onExport:()=>{}})]}),c&&m.jsx("div",{className:"flex items-center justify-center py-8",children:m.jsxs("svg",{className:"animate-spin h-8 w-8 text-indigo-500",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]})};function vH({items:e,itemHeight:t,height:r,renderItem:n,className:a=""}){return e.length===0?m.jsx("div",{className:`flex items-center justify-center ${a}`,style:{height:r},children:m.jsx("p",{className:"text-gray-400 text-sm",children:"Nenhum item para exibir"})}):m.jsx(_0,{height:r,itemCount:e.length,itemSize:t,className:a,overscanCount:5,children:n})}const yH=({className:e=""})=>{const[t,r]=j.useState(Gl(new Date)),[n,a]=j.useState([]),[s,i]=j.useState(!1),[o,l]=j.useState(null),[c,u]=j.useState("all"),[d,h]=j.useState("all"),v=async()=>{i(!0),l(null);try{const k=In(t),E=await st.action_log.where("day").equals(k).toArray();E.sort((I,D)=>new Date(D.timestamp).getTime()-new Date(I.timestamp).getTime()),a(E),E.length===0&&l("Nenhuma ação encontrada para a data selecionada.")}catch(k){console.error("Error loading action logs:",k),l("Erro ao carregar histórico de ações. Tente novamente.")}finally{i(!1)}},y=j.useMemo(()=>n.filter(k=>{const w=c==="all"||k.action_type===c,E=d==="all"||k.result===d;return w&&E}),[n,c,d]),p=k=>{switch(k){case"banking_upload":return"Upload Bancário";case"cash_conference":return"Conferência";case"manual_entry":return"Lançamento Manual";case"transfer":return"Transferência";case"undo":return"Desfazer";case"not_found":return"Não Encontrado";default:return k}},_=k=>{switch(k){case"success":return m.jsx("span",{className:"px-2 py-1 text-xs bg-green-900/30 text-green-400 border border-green-600 rounded",children:"Sucesso"});case"error":return m.jsx("span",{className:"px-2 py-1 text-xs bg-red-900/30 text-red-400 border border-red-600 rounded",children:"Erro"});case"warning":return m.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-900/30 text-yellow-400 border border-yellow-600 rounded",children:"Aviso"});default:return null}},x=({index:k,style:w})=>{const E=y[k];return m.jsxs("div",{style:w,className:"flex items-start space-x-3 p-3 border-b border-gray-700 hover:bg-gray-700/30 transition-colors",children:[m.jsx("div",{className:"flex-shrink-0 mt-1",children:_(E.result)}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsx("h4",{className:"text-sm font-medium text-gray-200 truncate",children:p(E.action_type)}),m.jsx("span",{className:"text-xs text-gray-400",children:El(E.timestamp)})]}),m.jsx("p",{className:"text-sm text-gray-300 mb-2",children:E.action_description}),E.payload.values&&E.payload.values.length>0&&m.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["Valores: ",E.payload.values.map(I=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(I)).join(", ")]}),E.payload.source_ids&&E.payload.source_ids.length>0&&m.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["IDs: ",E.payload.source_ids.slice(0,2).join(", "),E.payload.source_ids.length>2&&` +${E.payload.source_ids.length-2} mais`]}),E.error_message&&m.jsxs("div",{className:"text-xs text-red-400 mt-1 p-2 bg-red-900/20 rounded",children:["Erro: ",E.error_message]})]})]})};return m.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border border-gray-700 ${e}`,children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-purple-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"📝"}),"Histórico de Ações"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"action-date-input",className:"block text-xs text-gray-400 mb-1",children:"Data"}),m.jsx("input",{id:"action-date-input",type:"date",value:t,onChange:k=>r(k.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"action-type-filter",className:"block text-xs text-gray-400 mb-1",children:"Tipo de Ação"}),m.jsxs("select",{id:"action-type-filter",value:c,onChange:k=>u(k.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[m.jsx("option",{value:"all",children:"Todas"}),m.jsx("option",{value:"banking_upload",children:"Upload Bancário"}),m.jsx("option",{value:"cash_conference",children:"Conferência"}),m.jsx("option",{value:"manual_entry",children:"Lançamento Manual"}),m.jsx("option",{value:"transfer",children:"Transferência"}),m.jsx("option",{value:"undo",children:"Desfazer"}),m.jsx("option",{value:"not_found",children:"Não Encontrado"})]})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"result-filter",className:"block text-xs text-gray-400 mb-1",children:"Resultado"}),m.jsxs("select",{id:"result-filter",value:d,onChange:k=>h(k.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[m.jsx("option",{value:"all",children:"Todos"}),m.jsx("option",{value:"success",children:"Sucesso"}),m.jsx("option",{value:"error",children:"Erro"}),m.jsx("option",{value:"warning",children:"Aviso"})]})]})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:v,disabled:s,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s?"Carregando...":"Carregar Histórico"}),m.jsx(Ku,{data:{actions:y},prefix:"acoes",date:In(t),disabled:y.length===0}),m.jsx("button",{onClick:()=>{const k=Gl(new Date);r(k)},className:"px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",title:"Carregar dia atual",children:"Hoje"})]}),o&&m.jsx("div",{className:"p-2 bg-red-900/20 border border-red-400 rounded-md",children:m.jsx("p",{className:"text-xs text-red-400",children:o})}),y.length>0&&m.jsxs("div",{className:"bg-gray-900 rounded p-3 border border-gray-600",children:[m.jsx("h4",{className:"text-xs font-medium text-gray-400 mb-2",children:"Resumo"}),m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Total:"}),m.jsx("span",{className:"text-gray-200",children:y.length})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Sucessos:"}),m.jsx("span",{className:"text-green-400",children:y.filter(k=>k.result==="success").length})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Erros:"}),m.jsx("span",{className:"text-red-400",children:y.filter(k=>k.result==="error").length})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Avisos:"}),m.jsx("span",{className:"text-yellow-400",children:y.filter(k=>k.result==="warning").length})]})]})]}),y.length>0&&m.jsx("div",{className:"bg-gray-900 rounded border border-gray-600",children:m.jsx(vH,{items:y,itemHeight:120,height:400,renderItem:x,className:"custom-scrollbar"})}),s&&m.jsx("div",{className:"flex items-center justify-center py-8",children:m.jsxs("svg",{className:"animate-spin h-8 w-8 text-purple-500",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]})};class _H{constructor(){this.currentUser=null,this.currentSession=null,this.initializeAuth()}async initializeAuth(){const{data:{session:t}}=await yt.auth.getSession();t&&(this.currentSession=t,this.currentUser=t.user),yt.auth.onAuthStateChange((r,n)=>{var a;this.currentSession=n,this.currentUser=(n==null?void 0:n.user)??null,r==="SIGNED_IN"?console.log("User signed in:",(a=n==null?void 0:n.user)==null?void 0:a.email):r==="SIGNED_OUT"?console.log("User signed out"):r==="TOKEN_REFRESHED"&&console.log("Token refreshed")})}async signUp(t,r){try{const{data:n,error:a}=await yt.auth.signUp({email:t.email,password:t.password,options:{data:{username:r==null?void 0:r.username,full_name:r==null?void 0:r.fullName}}});if(a)throw a;if(n.user){const{error:s}=await yt.from("profiles").insert([{id:n.user.id,username:(r==null?void 0:r.username)||t.email.split("@")[0],full_name:r==null?void 0:r.fullName,role:"user",is_active:!0}]);s&&console.error("Error creating profile:",s)}return{data:n,error:null}}catch(n){return console.error("Sign up error:",n),{data:null,error:n}}}async signIn(t){try{const{data:r,error:n}=await yt.auth.signInWithPassword({email:t.email,password:t.password});if(n)throw n;return this.currentUser=r.user,this.currentSession=r.session,{data:r,error:null}}catch(r){return console.error("Sign in error:",r),{data:null,error:r}}}async signOut(){try{const{error:t}=await yt.auth.signOut();if(t)throw t;return this.currentUser=null,this.currentSession=null,{error:null}}catch(t){return console.error("Sign out error:",t),{error:t}}}async resetPassword(t){try{const{error:r}=await yt.auth.resetPasswordForEmail(t,{redirectTo:`${window.location.origin}/reset-password`});if(r)throw r;return{error:null}}catch(r){return console.error("Reset password error:",r),{error:r}}}async updatePassword(t){try{const{error:r}=await yt.auth.updateUser({password:t});if(r)throw r;return{error:null}}catch(r){return console.error("Update password error:",r),{error:r}}}async getProfile(){if(!this.currentUser)return null;try{const{data:t,error:r}=await yt.from("profiles").select("*").eq("id",this.currentUser.id).single();if(r)throw r;return{id:t.id,email:this.currentUser.email,username:t.username,fullName:t.full_name,avatarUrl:t.avatar_url,role:t.role,isActive:t.is_active}}catch(t){return console.error("Get profile error:",t),null}}async updateProfile(t){if(!this.currentUser)return{error:new Error("No user logged in")};try{const{error:r}=await yt.from("profiles").update({username:t.username,full_name:t.fullName,avatar_url:t.avatarUrl}).eq("id",this.currentUser.id);if(r)throw r;return{error:null}}catch(r){return console.error("Update profile error:",r),{error:r}}}getUser(){return this.currentUser}getSession(){return this.currentSession}isAuthenticated(){return!!this.currentSession}async checkSession(){const{data:{session:t}}=await yt.auth.getSession();return!!t}async refreshSession(){const{data:{session:t},error:r}=await yt.auth.refreshSession();return r?(console.error("Refresh session error:",r),{session:null,error:r}):(this.currentSession=t,this.currentUser=(t==null?void 0:t.user)??null,{session:t,error:null})}}const di=new _H;class wH{constructor(){this.userId=null,this.initializeUser()}async initializeUser(){const t=di.getUser();t&&(this.userId=t.id),yt.auth.onAuthStateChange((r,n)=>{var a;this.userId=((a=n==null?void 0:n.user)==null?void 0:a.id)??null})}ensureAuthenticated(){if(!this.userId)throw new Error("User not authenticated")}async uploadBankingFile(t,r,n){this.ensureAuthenticated();const a=performance.now();try{const s=r.reduce((u,d)=>u+(d.value||0),0),{data:i,error:o}=await yt.from("banking_files").insert({user_id:this.userId,file_name:t,operation_date:n==null?void 0:n.toISOString().split("T")[0],total_transactions:r.length,total_value:s,status:"processing"}).select().single();if(o)throw o;const{error:l}=await Os.insertBankingTransactions(this.userId,i.id,r);if(l)throw l;await yt.from("banking_files").update({status:"completed"}).eq("id",i.id);const c=performance.now()-a;return Or.logOperation("supabase_upload_file",c,{fileName:t,transactionCount:r.length}),{fileId:i.id,fileName:i.file_name,totalTransactions:i.total_transactions,totalValue:i.total_value}}catch(s){throw console.error("Error uploading banking file:",s),s}}async searchTransactionsByValue(t,r=.01){this.ensureAuthenticated();const n=performance.now();try{const{data:a,error:s}=await Os.searchTransactionsByValue(this.userId,t);if(s)throw s;const i=performance.now()-n;return Or.logOperation("supabase_search_value",i,{value:t,resultCount:(a==null?void 0:a.length)||0}),a||[]}catch(a){return console.error("Error searching transactions:",a),[]}}async getTransactionsByDateRange(t,r){this.ensureAuthenticated();try{const{data:n,error:a}=await yt.from("banking_transactions").select("*").eq("user_id",this.userId).gte("transaction_date",t.toISOString().split("T")[0]).lte("transaction_date",r.toISOString().split("T")[0]).order("transaction_date",{ascending:!1});if(a)throw a;return n||[]}catch(n){return console.error("Error getting transactions by date:",n),[]}}async transferToConference(t){this.ensureAuthenticated();const r=performance.now();try{const{data:n,error:a}=await Os.transferToConference(this.userId,t);if(a)throw a;const s=performance.now()-r;Or.logOperation("supabase_transfer",s,{transactionId:t});const{data:i,error:o}=await yt.from("cash_conference").select("*").eq("transaction_id",t).single();if(o)throw o;return{conferenceId:i.id,transactionId:i.transaction_id,value:i.conferred_value}}catch(n){return console.error("Error transferring to conference:",n),null}}async removeFromConference(t){this.ensureAuthenticated();try{const{data:r,error:n}=await Os.removeFromConference(this.userId,t);if(n)throw n;return!0}catch(r){return console.error("Error removing from conference:",r),!1}}async getActiveConferences(){this.ensureAuthenticated();try{const{data:t,error:r}=await Os.getActiveConferences(this.userId);if(r)throw r;return t||[]}catch(t){return console.error("Error getting active conferences:",t),[]}}async addManualEntry(t){this.ensureAuthenticated();try{const{data:r,error:n}=await yt.from("manual_entries").insert({user_id:this.userId,document_number:t.documentNumber,description:t.description,value:t.value,entry_type:t.entryType,category:t.category,is_link:t.isLink||!1}).select().single();if(n)throw n;return r}catch(r){throw console.error("Error adding manual entry:",r),r}}async getManualEntries(t){this.ensureAuthenticated();try{let r=yt.from("manual_entries").select("*").eq("user_id",this.userId);if(t){const s=t.toISOString().split("T")[0];r=r.eq("entry_date",s)}const{data:n,error:a}=await r.order("created_at",{ascending:!1});if(a)throw a;return n||[]}catch(r){return console.error("Error getting manual entries:",r),[]}}async deleteManualEntry(t){this.ensureAuthenticated();try{const{error:r}=await yt.from("manual_entries").delete().eq("id",t).eq("user_id",this.userId);if(r)throw r;return!0}catch(r){return console.error("Error deleting manual entry:",r),!1}}async registerNotFound(t,r){this.ensureAuthenticated();try{const{data:n,error:a}=await Os.registerNotFound(this.userId,t,r);if(a)throw a;return n}catch(n){return console.error("Error registering not found:",n),null}}async getNotFoundHistory(){this.ensureAuthenticated();try{const{data:t,error:r}=await Os.getNotFoundHistory(this.userId);if(r)throw r;return t||[]}catch(t){return console.error("Error getting not found history:",t),[]}}async getUserStatistics(){this.ensureAuthenticated();try{const{data:t,error:r}=await Os.getUserStats(this.userId);if(r)throw r;return t}catch(t){return console.error("Error getting user statistics:",t),null}}async restartWorkDay(){this.ensureAuthenticated();try{const{data:t,error:r}=await Os.restartWorkDay(this.userId);if(r)throw r;return!0}catch(t){return console.error("Error restarting work day:",t),!1}}async logPerformance(t,r,n){try{await yt.from("performance_logs").insert({user_id:this.userId,operation:t,duration_ms:r,metadata:n})}catch(a){console.debug("Performance log failed:",a)}}async logAudit(t,r,n,a,s){try{await yt.from("audit_logs").insert({user_id:this.userId,action:t,table_name:r,record_id:n,old_data:a,new_data:s})}catch(i){console.debug("Audit log failed:",i)}}async batchTransferToConference(t){this.ensureAuthenticated();const r=[];for(const n of t){const a=await this.transferToConference(n);a&&r.push(a)}return r}async exportConferences(t,r){this.ensureAuthenticated();try{let n=yt.from("cash_conference").select("*").eq("user_id",this.userId);t&&r&&(n=n.gte("conference_date",t.toISOString().split("T")[0]).lte("conference_date",r.toISOString().split("T")[0]));const{data:a,error:s}=await n.order("conference_date",{ascending:!1});if(s)throw s;return a||[]}catch(n){return console.error("Error exporting conferences:",n),[]}}}const Dc=new wH;class xH{constructor(){this.bucketName="backups",this.initializeBucket()}async initializeBucket(){try{const{data:t}=await yt.storage.listBuckets();if(!(t==null?void 0:t.some(n=>n.name===this.bucketName))){const{error:n}=await yt.storage.createBucket(this.bucketName,{public:!1,fileSizeLimit:52428800});n&&!n.message.includes("already exists")&&console.error("Error creating bucket:",n)}}catch(t){console.error("Error initializing bucket:",t)}}async createBackup(t,r,n=!0,a=!0,s=!0){var o,l,c,u,d,h,v,y;const i=di.getUser();if(!i)throw new Error("User not authenticated");try{console.log("Creating backup...");const p={metadata:{createdAt:new Date().toISOString(),userId:i.id,userEmail:i.email,version:"1.0.0",type:t&&r?"partial":"full"},data:{}};n&&(p.data.conferences=await Dc.exportConferences(t,r)),a&&t&&r&&(p.data.transactions=await Dc.getTransactionsByDateRange(t,r)),s&&(p.data.manualEntries=await Dc.getManualEntries()),p.data.notFoundHistory=await Dc.getNotFoundHistory(),p.data.statistics=await Dc.getUserStatistics();const _=ar.book_new(),x=ar.json_to_sheet([p.metadata]);if(ar.book_append_sheet(_,x,"Metadata"),((o=p.data.conferences)==null?void 0:o.length)>0){const re=ar.json_to_sheet(p.data.conferences);ar.book_append_sheet(_,re,"Conferences")}if(((l=p.data.transactions)==null?void 0:l.length)>0){const re=ar.json_to_sheet(p.data.transactions);ar.book_append_sheet(_,re,"Transactions")}if(((c=p.data.manualEntries)==null?void 0:c.length)>0){const re=ar.json_to_sheet(p.data.manualEntries);ar.book_append_sheet(_,re,"ManualEntries")}if(((u=p.data.notFoundHistory)==null?void 0:u.length)>0){const re=ar.json_to_sheet(p.data.notFoundHistory);ar.book_append_sheet(_,re,"NotFound")}const k=$v(_,{bookType:"xlsx",type:"array"}),w=new Blob([k],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),I=`backup_${new Date().toISOString().replace(/[:.]/g,"-")}.xlsx`,D=`${i.id}/${I}`,{data:C,error:V}=await yt.storage.from(this.bucketName).upload(D,w,{contentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",upsert:!1});if(V)throw V;const z=(((d=p.data.conferences)==null?void 0:d.length)||0)+(((h=p.data.transactions)==null?void 0:h.length)||0)+(((v=p.data.manualEntries)==null?void 0:v.length)||0)+(((y=p.data.notFoundHistory)==null?void 0:y.length)||0),ee={id:C.path,fileName:I,createdAt:new Date,size:w.size,recordCount:z,type:p.metadata.type};return console.log("Backup created successfully:",I),ee}catch(p){return console.error("Error creating backup:",p),null}}async listBackups(){const t=di.getUser();if(!t)throw new Error("User not authenticated");try{const{data:r,error:n}=await yt.storage.from(this.bucketName).list(t.id,{limit:100,sortBy:{column:"created_at",order:"desc"}});if(n)throw n;return(r||[]).map(a=>{var s;return{id:`${t.id}/${a.name}`,fileName:a.name,createdAt:new Date(a.created_at),size:((s=a.metadata)==null?void 0:s.size)||0,recordCount:0,type:"full"}})}catch(r){return console.error("Error listing backups:",r),[]}}async downloadBackup(t){if(!di.getUser())throw new Error("User not authenticated");try{const{data:n,error:a}=await yt.storage.from(this.bucketName).download(t);if(a)throw a;return n}catch(n){return console.error("Error downloading backup:",n),null}}async restoreFromBackup(t){const r=di.getUser();if(!r)throw new Error("User not authenticated");try{console.log("Restoring from backup:",t);const n=await this.downloadBackup(t);if(!n)throw new Error("Failed to download backup");const a=await n.arrayBuffer(),s=Ih(a,{type:"array"}),i=s.Sheets.Metadata;if(ar.sheet_to_json(i)[0].userId!==r.id)throw new Error("Backup belongs to different user");if(s.Sheets.Conferences){const l=ar.sheet_to_json(s.Sheets.Conferences);console.log(`Restoring ${l.length} conferences...`)}if(s.Sheets.Transactions){const l=ar.sheet_to_json(s.Sheets.Transactions);console.log(`Restoring ${l.length} transactions...`)}if(s.Sheets.ManualEntries){const l=ar.sheet_to_json(s.Sheets.ManualEntries);console.log(`Restoring ${l.length} manual entries...`)}return console.log("Restore completed successfully"),!0}catch(n){return console.error("Error restoring backup:",n),!1}}async deleteBackup(t){if(!di.getUser())throw new Error("User not authenticated");try{const{error:n}=await yt.storage.from(this.bucketName).remove([t]);if(n)throw n;return!0}catch(n){return console.error("Error deleting backup:",n),!1}}async scheduleAutoBackup(t=24){setInterval(async()=>{console.log("Running auto backup..."),await this.createBackup()},t*60*60*1e3)}async getBackupUrl(t){if(!di.getUser())throw new Error("User not authenticated");try{const{data:n}=yt.storage.from(this.bucketName).getPublicUrl(t);return n.publicUrl}catch(n){return console.error("Error getting backup URL:",n),null}}async getSignedBackupUrl(t,r=3600){if(!di.getUser())throw new Error("User not authenticated");try{const{data:a,error:s}=await yt.storage.from(this.bucketName).createSignedUrl(t,r);if(s)throw s;return a.signedUrl}catch(a){return console.error("Error getting signed URL:",a),null}}}const Pc=new xH,kH=({className:e="",currentDate:t=In(new Date)})=>{const[r,n]=j.useState(Gl(new Date)),[a,s]=j.useState(!1),[i,o]=j.useState(!1),[l,c]=j.useState(null),[u,d]=j.useState(null),[h,v]=j.useState(null),y=async()=>{s(!0);try{const k=In(r),w=await Pc.exportDayBackup(k);Pc.downloadBackup(w),Bt.success(`Backup do dia ${k} exportado com sucesso! ${w.metadata.total_records} registros.`)}catch(k){console.error("Error exporting backup:",k),Bt.error(k instanceof Error?k.message:"Erro ao exportar backup")}finally{s(!1)}},p=async k=>{var E;const w=(E=k.target.files)==null?void 0:E[0];if(w){c(w),d(null),v(null);try{const I=await Pc.readBackupFromFile(w),D=Pc.validateBackup(I);if(!D.valid){Bt.error(`Backup inválido: ${D.errors.join(", ")}`),c(null);return}d(I),Bt.success("Backup carregado e validado com sucesso!")}catch(I){console.error("Error reading backup file:",I),Bt.error(I instanceof Error?I.message:"Erro ao ler arquivo de backup"),c(null)}}},_=async k=>{if(u){o(!0);try{const w=await Pc.importDayBackup(u,k);v(w),w.errors.length>0?Bt.error(`Importação concluída com ${w.errors.length} erros. ${w.imported} importados, ${w.skipped} ignorados.`):Bt.success(`Backup importado com sucesso! ${w.imported} registros importados, ${w.skipped} ignorados.`)}catch(w){console.error("Error importing backup:",w),Bt.error(w instanceof Error?w.message:"Erro ao importar backup")}finally{o(!1)}}},x=()=>{c(null),d(null),v(null);const k=document.getElementById("backup-file-input");k&&(k.value="")};return m.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border border-gray-700 ${e}`,children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-4 flex items-center",children:[m.jsx("span",{className:"bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"💾"}),"Backup e Restauração"]}),m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-600",children:[m.jsxs("h4",{className:"text-sm font-medium text-gray-200 mb-3 flex items-center",children:[m.jsx("svg",{className:"w-4 h-4 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),"Exportar Backup do Dia"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"backup-date-input",className:"block text-xs text-gray-400 mb-1",children:"Data para backup"}),m.jsx("input",{id:"backup-date-input",type:"date",value:r,onChange:k=>n(k.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),m.jsx("button",{onClick:y,disabled:a,className:"w-full px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:a?m.jsxs(m.Fragment,{children:[m.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Exportando..."]}):m.jsxs(m.Fragment,{children:[m.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),"Exportar Backup JSON"]})}),m.jsx("p",{className:"text-xs text-gray-400",children:"Exporta todas as tabelas do dia selecionado em formato JSON para backup seguro."})]})]}),m.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-600",children:[m.jsxs("h4",{className:"text-sm font-medium text-gray-200 mb-3 flex items-center",children:[m.jsx("svg",{className:"w-4 h-4 text-blue-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),"Importar Backup"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"backup-file-input",className:"block text-xs text-gray-400 mb-1",children:"Selecionar arquivo de backup (.json)"}),m.jsx("input",{id:"backup-file-input",type:"file",accept:".json",onChange:p,className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 file:mr-4 file:py-1 file:px-2 file:rounded file:border-0 file:bg-blue-600 file:text-white file:text-xs hover:file:bg-blue-700"})]}),u&&m.jsxs("div",{className:"bg-gray-800 rounded p-3 border border-gray-600",children:[m.jsx("h5",{className:"text-xs font-medium text-gray-300 mb-2",children:"Preview do Backup"}),m.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Data:"}),m.jsx("span",{className:"text-gray-200",children:u.backup_date})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Exportado em:"}),m.jsx("span",{className:"text-gray-200",children:El(u.export_timestamp)})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Total registros:"}),m.jsx("span",{className:"text-gray-200",children:u.metadata.total_records})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Usuário:"}),m.jsx("span",{className:"text-gray-200",children:u.user_id})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Versão:"}),m.jsx("span",{className:"text-gray-200",children:u.version})]})]}),m.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-600",children:[m.jsx("h6",{className:"text-xs font-medium text-gray-300 mb-2",children:"Registros por Tabela"}),m.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-400",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Uploads:"}),m.jsx("span",{className:"text-gray-200",children:u.tables.bank_uploads.length})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Bancário:"}),m.jsx("span",{className:"text-gray-200",children:u.tables.bank_entries.length})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Caixa:"}),m.jsx("span",{className:"text-gray-200",children:u.tables.cash_conference_entries.length})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Manual:"}),m.jsx("span",{className:"text-gray-200",children:u.tables.manual_entries.length})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Não encontrados:"}),m.jsx("span",{className:"text-gray-200",children:u.tables.not_found_history.length})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Ações:"}),m.jsx("span",{className:"text-gray-200",children:u.tables.action_log.length})]})]})]})]}),u&&!h&&m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:()=>_("merge"),disabled:i,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?"Importando...":"Mesclar"}),m.jsx("button",{onClick:()=>_("replace"),disabled:i,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-orange-600 rounded-md hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?"Importando...":"Substituir"}),m.jsx("button",{onClick:x,disabled:i,className:"px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Cancelar"})]}),h&&m.jsxs("div",{className:"bg-gray-800 rounded p-3 border border-gray-600",children:[m.jsx("h5",{className:"text-xs font-medium text-gray-300 mb-2",children:"Resultado da Importação"}),m.jsxs("div",{className:"text-xs space-y-1",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Importados:"}),m.jsx("span",{className:"text-green-400",children:h.imported})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Ignorados:"}),m.jsx("span",{className:"text-yellow-400",children:h.skipped})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Erros:"}),m.jsx("span",{className:"text-red-400",children:h.errors.length})]})]}),h.errors.length>0&&m.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-600",children:[m.jsx("h6",{className:"text-xs font-medium text-red-400 mb-2",children:"Erros de Importação"}),m.jsx("div",{className:"max-h-32 overflow-y-auto custom-scrollbar",children:h.errors.map((k,w)=>m.jsx("div",{className:"text-xs text-red-400 mb-1",children:k},w))})]}),m.jsx("button",{onClick:x,className:"mt-3 w-full px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Novo Backup"})]}),m.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Mesclar:"})," Mantém dados existentes, adiciona apenas novos registros."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Substituir:"})," Remove todos os dados do dia e importa do backup."]})]})]})]})]})]})},Q4=({error:e,className:t="",fieldId:r})=>{if(!e)return null;const n=r?`${r}-error`:void 0;return m.jsxs("div",{id:n,className:`mt-1 text-sm text-red-400 flex items-start space-x-2 ${t}`,role:"alert","aria-live":"polite",children:[m.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:m.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),m.jsx("span",{children:e})]})},eT=(e,t)=>{const r=!!t,n=r?`${e}-error`:void 0;return{"aria-invalid":r,"aria-describedby":n,className:r?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-600 focus:border-indigo-500 focus:ring-indigo-500"}},nm={excel_parse:"Parse Excel",excel_filter:"Filtro Excel",conference_search:"Busca Conferência",conference_transfer:"Transferência",manual_entry_save:"Salvar Manual",data_export:"Export Dados",cache_operations:"Cache Ops"},Rc=e=>e<1e3?`${e.toFixed(1)}ms`:`${(e/1e3).toFixed(2)}s`,bH=({isVisible:e,onToggle:t})=>{const[r,n]=j.useState([]),[a,s]=j.useState(Or.isLoggingEnabled()),[i,o]=j.useState(0),[l,c]=j.useState(!1);j.useEffect(()=>{e&&a&&u()},[e,a,i]);const u=async()=>{c(!0);try{const p=await Or.getTodaysStats();n(p)}catch(p){console.error("Failed to load performance stats:",p)}finally{c(!1)}},d=()=>{const p=!a;Or.setEnabled(p),s(p),p?u():n([])},h=()=>{o(p=>p+1)},v=async()=>{confirm("Limpar todas as métricas de performance?")&&(await Or.clearAllMetrics(),n([]),o(p=>p+1))},y=async()=>{try{const p=await Or.exportMetrics(),_=JSON.stringify(p,null,2),x=new Blob([_],{type:"application/json"}),k=URL.createObjectURL(x),w=document.createElement("a");w.href=k,w.download=`performance-metrics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(k)}catch(p){console.error("Failed to export metrics:",p)}};return e?m.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-96 max-h-96 bg-gray-900 border border-gray-700 rounded-lg shadow-2xl",children:[m.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-700",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-100 flex items-center",children:"📊 Performance Monitor"}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("button",{onClick:d,className:`px-2 py-1 text-xs rounded transition-colors ${a?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,title:a?"Desabilitar logging":"Habilitar logging",children:a?"ON":"OFF"}),m.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-gray-400 hover:text-gray-200 transition-colors",title:"Fechar painel",children:"✕"})]})]}),m.jsx("div",{className:"p-3",children:a?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[m.jsxs("button",{onClick:h,disabled:l,className:"px-2 py-1 text-xs bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:[l?"⟳":"🔄"," Refresh"]}),m.jsx("button",{onClick:v,className:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"🗑️ Limpar"}),m.jsx("button",{onClick:y,className:"px-2 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:"💾 Export"})]}),m.jsx("div",{className:"max-h-64 overflow-y-auto",children:l?m.jsx("div",{className:"text-center py-4",children:m.jsx("p",{className:"text-sm text-gray-400",children:"Carregando estatísticas..."})}):r.length===0?m.jsx("div",{className:"text-center py-4",children:m.jsx("p",{className:"text-sm text-gray-400",children:"Nenhuma métrica registrada hoje"})}):m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"grid grid-cols-5 gap-1 text-xs text-gray-400 font-semibold border-b border-gray-700 pb-1",children:[m.jsx("span",{children:"Operação"}),m.jsx("span",{className:"text-center",children:"Count"}),m.jsx("span",{className:"text-right",children:"Avg"}),m.jsx("span",{className:"text-right",children:"P95"}),m.jsx("span",{className:"text-right",children:"Max"})]}),r.map(p=>m.jsxs("div",{className:"grid grid-cols-5 gap-1 text-xs text-gray-300 py-1 hover:bg-gray-800 rounded px-1",children:[m.jsx("span",{className:"truncate",title:nm[p.operation],children:nm[p.operation]}),m.jsx("span",{className:"text-center text-gray-400",children:p.count}),m.jsx("span",{className:"text-right font-mono",children:Rc(p.average)}),m.jsx("span",{className:"text-right font-mono text-yellow-400",children:Rc(p.p95)}),m.jsx("span",{className:"text-right font-mono text-red-400",children:Rc(p.max)})]},p.operation)),m.jsx("div",{className:"pt-2 mt-2 border-t border-gray-700",children:m.jsxs("div",{className:"text-xs text-gray-400",children:[m.jsxs("p",{children:["Total operations: ",r.reduce((p,_)=>p+_.count,0)]}),m.jsxs("p",{children:["Total time: ",Rc(r.reduce((p,_)=>p+_.totalTime,0))]})]})})]})})]}):m.jsxs("div",{className:"text-center py-4",children:[m.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Performance logging está desabilitado"}),m.jsx("button",{onClick:d,className:"px-3 py-1 text-xs bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors",children:"Habilitar"})]})}),a&&r.length>0&&m.jsx("div",{className:"p-2 border-t border-gray-700 bg-gray-800",children:(()=>{const p=r[0];if((p==null?void 0:p.p95)>1e3)return m.jsxs("div",{className:"text-xs text-yellow-400",children:["⚠️ ",nm[p.operation]," está lento (P95: ",Rc(p.p95),")"]});const _=r.reduce((x,k)=>x+k.count,0);return _>100?m.jsxs("div",{className:"text-xs text-blue-400",children:["✓ ",_," operações monitoradas hoje"]}):m.jsx("div",{className:"text-xs text-gray-400",children:"📊 Coletando dados de performance..."})})()})]}):m.jsx("button",{onClick:t,className:"fixed bottom-4 right-4 z-50 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg border border-gray-600 hover:bg-gray-700 transition-colors",title:"Abrir painel de performance",children:"📊 Perf"})},SH=[{keys:["Ctrl","L"],description:"Focar no campo de valor",context:"Global"},{keys:["Ctrl","F"],description:"Focar no filtro de data",context:"Global"},{keys:["Enter"],description:"Confirmar ação atual",context:"Global"},{keys:["Esc"],description:"Fechar modais",context:"Global"},{keys:["Enter"],description:"Adicionar lançamento",context:"Lançamentos (quando no input de valor)"},{keys:["Enter"],description:"Selecionar primeiro item",context:"Modal de seleção"}],EH=()=>{const[e,t]=j.useState(!1),r=n=>n.map((a,s)=>m.jsxs(Jt.Fragment,{children:[s>0&&m.jsx("span",{className:"text-gray-400 mx-1",children:"+"}),m.jsx("kbd",{className:"px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded text-gray-200 font-mono",children:a})]},a));return e?m.jsxs("div",{className:"fixed bottom-4 left-4 z-50 w-96 max-h-80 bg-gray-900 border border-gray-700 rounded-lg shadow-2xl",children:[m.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-700",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-100 flex items-center",children:"⌨️ Atalhos de Teclado"}),m.jsx("button",{onClick:()=>t(!1),className:"px-2 py-1 text-xs text-gray-400 hover:text-gray-200 transition-colors",title:"Fechar",children:"✕"})]}),m.jsxs("div",{className:"p-3 max-h-64 overflow-y-auto",children:[m.jsx("div",{className:"space-y-3",children:SH.map((n,a)=>m.jsx("div",{className:"flex items-start justify-between",children:m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"flex items-center space-x-2 mb-1",children:r(n.keys)}),m.jsx("p",{className:"text-sm text-gray-300",children:n.description}),n.context&&m.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n.context})]})},a))}),m.jsx("div",{className:"mt-4 pt-3 border-t border-gray-700",children:m.jsxs("div",{className:"text-xs text-gray-400",children:[m.jsxs("p",{className:"mb-1",children:["💡 ",m.jsx("strong",{children:"Dicas:"})]}),m.jsxs("ul",{className:"space-y-1 ml-4",children:[m.jsx("li",{children:"• Os atalhos funcionam em toda a aplicação"}),m.jsxs("li",{children:["• ",m.jsx("kbd",{className:"px-1 py-0.5 bg-gray-700 rounded text-gray-200",children:"Ctrl+L"})," sempre foca no campo de valor mais próximo"]}),m.jsxs("li",{children:["• ",m.jsx("kbd",{className:"px-1 py-0.5 bg-gray-700 rounded text-gray-200",children:"Enter"})," confirma a ação do contexto atual"]}),m.jsxs("li",{children:["• ",m.jsx("kbd",{className:"px-1 py-0.5 bg-gray-700 rounded text-gray-200",children:"Esc"})," sempre fecha modais e volta o foco"]})]})]})})]})]}):m.jsxs("button",{onClick:()=>t(!0),className:"fixed bottom-4 left-4 z-40 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg border border-gray-600 hover:bg-gray-700 transition-colors flex items-center space-x-2",title:"Mostrar atalhos de teclado",children:[m.jsx("span",{children:"⌨️"}),m.jsx("span",{children:"Atalhos"})]})},tT="dashboard_launches",TH=()=>{try{const e=localStorage.getItem(tT);if(e)return JSON.parse(e).map(r=>{let n=new Date,a=new Date;try{if(r.date){const s=new Date(r.date);isNaN(s.getTime())||(n=s)}}catch{console.warn("Invalid date value:",r.date)}try{if(r.timestamp){const s=new Date(r.timestamp);isNaN(s.getTime())||(a=s)}}catch{console.warn("Invalid timestamp value:",r.timestamp)}return{...r,date:n,timestamp:a}})}catch(e){console.error("Error loading launches:",e)}return[]},Yx=e=>{try{localStorage.setItem(tT,JSON.stringify(e))}catch(t){console.error("Error saving launches:",t)}},CH=({currentDate:e,operationDate:t,onLaunchAdded:r,conferredItems:n})=>{const[a,s]=FS(),[i,o]=j.useState(null),[l,c]=j.useState(null),[u,d]=j.useState(""),[h,v]=j.useState(TH),[y,p]=j.useState(null),[_,x]=j.useState(null),[k,w]=j.useState("date"),[E,I]=j.useState("desc"),[D,C]=j.useState(null),[V,z]=j.useState("all"),[ee,re]=j.useState(!1),[G,me]=j.useState(null),Ee=j.useRef(null);BS();const Ae=j.useCallback(()=>{if(a.selectedDate){const[N,Ue,it]=a.selectedDate.split("-");return new Date(parseInt(N),parseInt(Ue)-1,parseInt(it))}if(t){const[N,Ue,it]=t.split("/");return new Date(parseInt(it),parseInt(Ue)-1,parseInt(N))}return e},[a.selectedDate,t,e]),ke=j.useMemo(()=>[{id:"credit_1x",label:"Cartão de Crédito 1x",group:"credit"},{id:"credit_2x",label:"Cartão de Crédito 2x",group:"credit"},{id:"credit_3x",label:"Cartão de Crédito 3x",group:"credit"},{id:"credit_4x",label:"Cartão de Crédito 4x",group:"credit"},{id:"credit_5x",label:"Cartão de Crédito 5x",group:"credit"},{id:"debit",label:"Débito",group:"other"},{id:"cash",label:"Dinheiro",group:"other"},{id:"coins",label:"Moedas",group:"other"},{id:"deposit",label:"Depósito",group:"other"}],[]),Oe=N=>{const Ue=N.replace(/[^\d,]/g,"").replace(",","."),it=parseFloat(Ue);return isNaN(it)?"":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(it)},Ce=N=>{const Ue=N.target.value;if(d(Ue),Ue.trim()){const it=Ph(Rh.conferenceValue,{value:Ue});it.success?p(null):p(it.error)}else p(null)},Z=j.useCallback(()=>{var ae;if(p(null),x(null),!i){p("Selecione um método de pagamento");return}if(i.startsWith("credit")&&l===null){p("Informe se é link (Sim/Não)");return}const N=Ph(Rh.conferenceValue,{value:u});if(!N.success){p(N.error);return}const Ue=N.data.value,it=((ae=ke.find(ye=>ye.id===i))==null?void 0:ae.label)||"",ct=i.startsWith("credit")&&l!==null?` / Link: ${l?"Sim":"Não"}`:"",mt=Ae(),Fe={id:`launch-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,date:mt,paymentType:`${it}${ct}`,isLink:i.startsWith("credit")?l||!1:void 0,value:Ue,timestamp:new Date};i==="credit_1x"&&(Fe.credit1x=Ue),i==="credit_2x"&&(Fe.credit2x=Ue),i==="credit_3x"&&(Fe.credit3x=Ue),i==="credit_4x"&&(Fe.credit4x=Ue),i==="credit_5x"&&(Fe.credit5x=Ue);const $t=[Fe,...h];v($t),Yx($t);const yr={id:Fe.id,date:gs(Fe.date),description:Fe.paymentType,value:Fe.value,originalHistory:"Manual",source:"manual",cpf:"",conferredAt:new Date,conferredId:Fe.id};n.some(ye=>ye.conferredId===Fe.id)?x("Lançamento adicionado com sucesso"):(r(yr),x("Lançamento criado e enviado para Conferência de Caixa")),d(""),Ee.current&&Ee.current.focus(),setTimeout(()=>x(null),3e3)},[i,l,u,Ae,h,n,r]),Se=j.useCallback(()=>{z("all"),s(N=>({...N,selectedDate:""})),C("Todos os filtros foram removidos"),setTimeout(()=>C(null),3e3),Ee.current&&Ee.current.focus()},[s]),Ve=j.useCallback(N=>{if(z(N),N==="all")C("Exibindo todos os tipos de pagamento");else{const Ue=ke.find(it=>it.id===N);C(`Filtrado por: ${(Ue==null?void 0:Ue.label)||N}`)}setTimeout(()=>C(null),3e3),Ee.current&&Ee.current.focus()},[ke]),B=N=>{o(N),p(null),N.startsWith("credit")||c(null)},J=N=>{k===N?I(Ue=>Ue==="asc"?"desc":"asc"):(w(N),I("asc"))},K=N=>{me(N),re(!0)},X=()=>{if(!G)return;const N=h.filter(Ue=>Ue.id!==G.id);v(N),Yx(N),r&&r({id:G.id,conferredId:G.id,remove:!0}),x("Lançamento desfeito com sucesso"),re(!1),me(null),Ee.current&&Ee.current.focus(),setTimeout(()=>x(null),3e3)},ge=()=>{re(!1),me(null)},Pe=[...h].sort((N,Ue)=>{const it=E==="asc"?1:-1;return k==="date"?(N.timestamp.getTime()-Ue.timestamp.getTime())*it:(N.value-Ue.value)*it}),je=Ae(),ce=Pe.filter(N=>{const Ue=N.date.toDateString()===je.toDateString();let it=!0;if(V!=="all"){const ct=N.paymentType.toLowerCase().replace(/\s+/g,"_"),mt=V.toString();if(mt.startsWith("credit_")){it=ct.includes("crédito")||ct.includes("credito");const Fe=mt.match(/credit_(\d+)x/);if(Fe){const $t=Fe[1];it=it&&ct.includes(`${$t}x`)}}else mt==="debit"?it=ct.includes("débito")||ct.includes("debito"):mt==="cash"?it=ct.includes("dinheiro"):mt==="coins"?it=ct.includes("moedas"):mt==="deposit"&&(it=ct.includes("depósito")||ct.includes("deposito"))}return Ue&&it}),Te={general:ce.reduce((N,Ue)=>N+Ue.value,0),credit1x:ce.reduce((N,Ue)=>N+(Ue.credit1x||0),0),credit2x:ce.reduce((N,Ue)=>N+(Ue.credit2x||0),0),credit3x:ce.reduce((N,Ue)=>N+(Ue.credit3x||0),0),credit4x:ce.reduce((N,Ue)=>N+(Ue.credit4x||0),0),credit5x:ce.reduce((N,Ue)=>N+(Ue.credit5x||0),0)};return tv([{key:"l",ctrlKey:!0,action:()=>{Ee.current&&(Ee.current.focus(),Ee.current.select())},description:"Focar no campo de valor (Ctrl+L)"},{key:"Escape",action:()=>{ee&&ge()},description:"Fechar modal de desfazer (Esc)"}],!0),j.useEffect(()=>{const N=Ue=>{Ue.key==="Enter"&&Ee.current===document.activeElement&&Z()};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[Z]),m.jsxs(m.Fragment,{children:[m.jsx("aside",{className:"w-80 bg-gray-900 border-r border-gray-800 sticky top-32 self-start",children:m.jsxs("div",{className:"p-4 space-y-4",children:[m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-100 mb-3",children:"Selecionar Pagamento"}),m.jsxs("div",{className:"space-y-2 mb-3",children:[m.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Cartão de Crédito"}),ke.filter(N=>N.group==="credit").map(N=>m.jsx("button",{onClick:()=>B(N.id),className:`w-full text-left px-3 py-2 text-sm rounded-md transition-colors ${i===N.id?"bg-indigo-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-gray-100"}`,"aria-label":N.label,children:N.label},N.id)),(i==null?void 0:i.startsWith("credit"))&&m.jsxs("div",{className:"pl-3 space-y-2 mt-2",children:[m.jsx("p",{className:"text-xs text-gray-400",children:"É link?"}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:()=>c(!0),className:`flex-1 px-3 py-1 text-xs rounded-md transition-colors ${l===!0?"bg-green-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Sim"}),m.jsx("button",{onClick:()=>c(!1),className:`flex-1 px-3 py-1 text-xs rounded-md transition-colors ${l===!1?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Não"})]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Outros Métodos"}),ke.filter(N=>N.group==="other").map(N=>m.jsx("button",{onClick:()=>B(N.id),className:`w-full text-left px-3 py-2 text-sm rounded-md transition-colors ${i===N.id?"bg-indigo-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-gray-100"}`,"aria-label":N.label,children:N.label},N.id))]})]}),m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-100 mb-3",children:"Preencher Valor"}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("input",{id:"launch-value-input",ref:Ee,type:"text",placeholder:"Digite o valor (ex: 123,45)",value:u,onChange:Ce,...eT("launch-value-input",y),className:`w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border rounded-md focus:ring-2 ${y?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-600 focus:ring-indigo-500 focus:border-indigo-500"}`,"aria-label":"Valor do lançamento"}),m.jsx(Q4,{error:y,fieldId:"launch-value-input"}),m.jsx("button",{onClick:Z,disabled:!i||!u,className:"w-full px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Adicionar"})]}),_&&m.jsx("div",{className:"mt-2 p-2 bg-green-900/20 border border-green-400 rounded-md",children:m.jsx("p",{className:"text-xs text-green-400",children:_})})]}),m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-100 mb-3",children:"Filtrar por Data"}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"bg-gray-900 rounded p-2 border border-gray-600",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-xs text-gray-400",children:"Data atual:"}),m.jsx("span",{className:"text-sm text-indigo-400 font-medium",children:gs(je)})]})}),m.jsx("input",{type:"date",value:a.selectedDate,onChange:N=>s(Ue=>({...Ue,selectedDate:N.target.value})),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Selecionar data para filtro"}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:()=>{C("Filtro aplicado"),setTimeout(()=>C(null),2e3),Ee.current&&Ee.current.focus()},className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:"Aplicar"}),m.jsx("button",{onClick:()=>{const N=new Date().toISOString().split("T")[0];s(Ue=>({...Ue,selectedDate:N})),C("Data de hoje selecionada"),setTimeout(()=>C(null),2e3),Ee.current&&Ee.current.focus()},className:"flex-1 px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Hoje"}),m.jsx("button",{onClick:()=>{s(N=>({...N,selectedDate:""})),C("Filtro limpo"),setTimeout(()=>C(null),2e3),Ee.current&&Ee.current.focus()},className:"flex-1 px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar"})]}),D&&m.jsx("div",{className:"p-2 bg-indigo-900/20 border border-indigo-400 rounded-md",children:m.jsx("p",{className:"text-xs text-indigo-400",children:D})}),ce.length===0&&h.length>0&&m.jsx("div",{className:"p-2 bg-yellow-900/20 border border-yellow-400 rounded-md",children:m.jsxs("p",{className:"text-xs text-yellow-400",children:["Nenhum lançamento encontrado para ",gs(je)]})})]})]})]})}),m.jsx("main",{className:"flex-1 bg-gray-950 p-6 min-h-[calc(100vh-8rem)] min-w-0",children:m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 h-full flex flex-col",children:[m.jsx("div",{className:"p-4 border-b border-gray-700",children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Lançamentos Manuais"}),m.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[ce.length," lançamento(s) para ",gs(je)]})]}),m.jsx(Ku,{data:{manual:ce.map(N=>({day:t,document_number:"",description:`${N.paymentType} - Lançamento manual`,value:N.value,entry_type:N.value>=0?"income":"expense",category:N.paymentType,status:"active",source_id:`manual_${N.id}`}))},prefix:"lancamentos",date:t,disabled:ce.length===0})]})}),m.jsx("div",{className:"bg-gray-800 border-b border-gray-700 p-4",children:m.jsxs("div",{className:"flex flex-wrap gap-4",children:[m.jsxs("div",{className:"flex-1 min-w-[200px]",children:[m.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Filtrar por Tipo de Pagamento"}),m.jsxs("select",{value:V,onChange:N=>Ve(N.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[m.jsx("option",{value:"all",children:"Todos"}),m.jsx("option",{value:"credit_1x",children:"Crédito 1x"}),m.jsx("option",{value:"credit_2x",children:"Crédito 2x"}),m.jsx("option",{value:"credit_3x",children:"Crédito 3x"}),m.jsx("option",{value:"credit_4x",children:"Crédito 4x"}),m.jsx("option",{value:"credit_5x",children:"Crédito 5x"}),m.jsx("option",{value:"debit",children:"Débito"}),m.jsx("option",{value:"cash",children:"Dinheiro"}),m.jsx("option",{value:"coins",children:"Moedas"}),m.jsx("option",{value:"deposit",children:"Depósito"})]})]}),m.jsx("div",{className:"flex items-end",children:m.jsx("button",{onClick:Se,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar Filtros"})})]})}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("table",{className:"w-full text-sm text-left text-gray-300",children:[m.jsx("thead",{className:"text-xs text-gray-400 uppercase bg-gray-900 sticky top-0",children:m.jsxs("tr",{children:[m.jsx("th",{scope:"col",className:"px-6 py-3 cursor-pointer hover:bg-gray-800",onClick:()=>J("date"),children:m.jsxs("div",{className:"flex items-center",children:["Data",m.jsx("svg",{className:"w-3 h-3 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:m.jsx("path",{d:"M5 12a1 1 0 102 0V6.414l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L5 6.414V12zM15 8a1 1 0 10-2 0v5.586l-1.293-1.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L15 13.586V8z"})})]})}),m.jsx("th",{scope:"col",className:"px-6 py-3",children:"Tipo de Pagamento"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 1x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 2x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 3x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 4x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 5x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right cursor-pointer hover:bg-gray-800",onClick:()=>J("value"),children:m.jsxs("div",{className:"flex items-center justify-end",children:["Valor (R$)",m.jsx("svg",{className:"w-3 h-3 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:m.jsx("path",{d:"M5 12a1 1 0 102 0V6.414l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L5 6.414V12zM15 8a1 1 0 10-2 0v5.586l-1.293-1.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L15 13.586V8z"})})]})}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Ações"})]})}),m.jsx("tbody",{children:ce.length===0?m.jsx("tr",{children:m.jsx("td",{colSpan:9,className:"px-6 py-8 text-center text-gray-500",children:"Nenhum lançamento registrado para esta data"})}):ce.map(N=>m.jsxs("tr",{className:"bg-gray-800 border-b border-gray-700 hover:bg-gray-750",children:[m.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:gs(N.date)}),m.jsx("td",{className:"px-6 py-4",children:m.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-700 text-gray-300",children:N.paymentType})}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:N.credit1x?Oe(N.credit1x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:N.credit2x?Oe(N.credit2x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:N.credit3x?Oe(N.credit3x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:N.credit4x?Oe(N.credit4x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:N.credit5x?Oe(N.credit5x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono text-green-400",children:Oe(N.value.toString())}),m.jsx("td",{className:"px-6 py-4 text-center",children:m.jsx("button",{onClick:()=>K(N),className:"px-2 py-1 text-xs font-medium text-red-300 bg-red-900/20 border border-red-600 rounded hover:bg-red-900/30 transition-colors","aria-label":"Desfazer lançamento",children:"Desfazer"})})]},N.id))}),ce.length>0&&m.jsx("tfoot",{className:"text-xs text-gray-300 bg-gray-900 border-t-2 border-indigo-500",children:m.jsxs("tr",{children:[m.jsx("td",{colSpan:2,className:"px-6 py-3 font-semibold",children:"Total Geral"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:Te.credit1x>0?Oe(Te.credit1x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:Te.credit2x>0?Oe(Te.credit2x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:Te.credit3x>0?Oe(Te.credit3x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:Te.credit4x>0?Oe(Te.credit4x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:Te.credit5x>0?Oe(Te.credit5x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold text-green-400",children:Oe(Te.general.toString())}),m.jsx("td",{className:"px-6 py-3"})]})})]})})]})}),ee&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 p-6 max-w-md w-full mx-4",children:m.jsxs("div",{className:"flex items-start",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-6 w-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("h3",{className:"text-lg font-medium text-gray-100 mb-2",children:"Confirmar Desfazer"}),m.jsx("p",{className:"text-sm text-gray-300 mb-6",children:"Tem certeza que deseja desfazer este lançamento? Ele será removido de todas as abas."}),G&&m.jsx("div",{className:"bg-gray-900 rounded p-3 mb-4 border border-gray-700",children:m.jsxs("div",{className:"text-xs text-gray-400",children:[m.jsxs("p",{children:["Tipo: ",G.paymentType]}),m.jsxs("p",{children:["Valor: ",Oe(G.value.toString())]}),m.jsxs("p",{children:["Data: ",gs(G.date)]})]})}),m.jsxs("div",{className:"flex space-x-3",children:[m.jsx("button",{onClick:X,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500 transition-colors",children:"Confirmar"}),m.jsx("button",{onClick:ge,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-gray-500 transition-colors",children:"Cancelar"})]})]})]})})})]})};function NH(e,t){const[r,n]=j.useState(e);return j.useEffect(()=>{const a=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}const AH=()=>{const[e,t]=j.useState(null),[r,n]=j.useState(!1);return j.useEffect(()=>{(async()=>{try{const s=await Ws.getStorageStats();t(s)}catch(s){console.warn("Failed to load storage stats:",s)}})()},[]),e?m.jsxs("div",{className:"fixed bottom-4 left-4 z-50",children:[m.jsx("button",{onClick:()=>n(!r),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${e.type==="IndexedDB"?"bg-green-600 text-white hover:bg-green-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:e.type}),r&&e.stats&&m.jsxs("div",{className:"absolute bottom-8 left-0 bg-gray-800 text-white rounded-lg p-3 shadow-lg min-w-[200px]",children:[m.jsx("h4",{className:"font-semibold mb-2",children:"Storage Stats"}),m.jsxs("div",{className:"text-xs space-y-1",children:[m.jsxs("div",{children:["Bank Uploads: ",e.stats.bank_uploads]}),m.jsxs("div",{children:["Bank Entries: ",e.stats.bank_entries]}),m.jsxs("div",{children:["Cash Conferences: ",e.stats.cash_conference_entries]}),m.jsxs("div",{children:["Not Found: ",e.stats.not_found_history]}),m.jsxs("div",{children:["Manual Entries: ",e.stats.manual_entries]}),m.jsxs("div",{children:["Day Selections: ",e.stats.day_selection]}),e.stats.total_storage_mb!==void 0&&m.jsxs("div",{className:"pt-1 border-t border-gray-600",children:["Storage: ~",e.stats.total_storage_mb," MB"]})]})]})]}):null},am={parsing:{icon:D8,message:"Lendo planilha...",color:"text-blue-400"},normalizing:{icon:Lw,message:"Normalizando dados...",color:"text-yellow-400"},indexing:{icon:Lw,message:"Criando índices...",color:"text-green-400"},saving:{icon:R8,message:"Salvando...",color:"text-indigo-400"}};function OH({message:e,progress:t,stage:r="parsing",show:n,showStallWarning:a=!1,canCancel:s=!1,onCancel:i}){if(!n)return null;const o=am[r],l=o.icon,c=e||o.message;return m.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:m.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-8 max-w-md w-full mx-4 shadow-2xl",children:[m.jsx("div",{className:"text-center mb-6",children:m.jsxs("div",{className:"relative inline-flex items-center justify-center",children:[m.jsx("div",{className:"absolute inset-0 animate-spin",children:m.jsx("div",{className:"h-12 w-12 border-2 border-gray-600 border-t-transparent rounded-full"})}),m.jsx(l,{className:`h-6 w-6 ${o.color} animate-pulse`})]})}),m.jsxs("div",{className:"text-center mb-4",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-200 mb-2",children:"Processando..."}),m.jsx("p",{className:"text-gray-400 text-sm",children:c})]}),typeof t=="number"&&m.jsxs("div",{className:"mb-4",children:[m.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1",children:[m.jsx("span",{children:"Progresso"}),m.jsxs("span",{children:[Math.round(t),"%"]})]}),m.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:m.jsx("div",{className:"bg-indigo-500 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${Math.min(100,Math.max(0,t))}%`}})})]}),m.jsx("div",{className:"flex justify-center space-x-2",children:Object.entries(am).map(([u,d],h)=>m.jsx("div",{className:`h-2 w-2 rounded-full transition-all duration-300 ${u===r?"bg-indigo-500 scale-125":h<Object.keys(am).indexOf(r)?"bg-gray-500":"bg-gray-700"}`},u))}),a&&m.jsx("div",{className:"mt-4 p-3 bg-yellow-900/20 border border-yellow-700 rounded-md",children:m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-5 w-5 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("p",{className:"text-sm text-yellow-400",children:"Processamento mais lento que o esperado..."}),m.jsx("p",{className:"text-xs text-yellow-300 mt-1",children:"Isso pode acontecer com arquivos grandes ou complexos"})]})]})}),s&&i&&m.jsx("div",{className:"mt-4",children:m.jsx("button",{onClick:i,className:"w-full px-4 py-2 text-sm font-medium text-red-300 bg-red-900/20 border border-red-600 rounded-md hover:bg-red-900/30 transition-colors",children:"Cancelar Processamento"})}),m.jsx("div",{className:"mt-6 p-3 bg-gray-900 rounded-md",children:m.jsx("p",{className:"text-xs text-gray-400 text-center",children:"💡 Processamento em background para manter a UI responsiva"})})]})})}function IH(){const[e,t]=Jt.useState(!1),[r,n]=Jt.useState("parsing"),[a,s]=Jt.useState(void 0),[i,o]=Jt.useState(void 0),[l,c]=Jt.useState(0),[u,d]=Jt.useState(!1),[h,v]=Jt.useState(!1);Jt.useEffect(()=>{if(!e){d(!1);return}const w=setInterval(()=>{Date.now()-l>1e4&&(d(!0),v(!0))},2e3);return()=>clearInterval(w)},[e,l]);const y=Jt.useCallback((k="parsing")=>{console.log("🚀 Iniciando processamento..."),t(!0),n(k),s(void 0),o(void 0),c(Date.now()),d(!1),v(!1)},[]),p=Jt.useCallback((k,w)=>{console.log(`📍 Etapa: ${k} - ${w||""}`),n(k),o(w),c(Date.now()),d(!1)},[]),_=Jt.useCallback(k=>{console.log(`📊 Progresso: ${k}%`),s(k),c(Date.now()),d(!1)},[]),x=Jt.useCallback(()=>{console.log("✅ Processamento finalizado"),t(!1),s(void 0),o(void 0),d(!1),v(!1)},[]);return{isProcessing:e,stage:r,progress:a,message:i,showStallWarning:u,canCancel:h,startProcessing:y,updateStage:p,updateProgress:_,stopProcessing:x}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rT=Symbol("Comlink.proxy"),DH=Symbol("Comlink.endpoint"),nT=Symbol("Comlink.releaseProxy"),sm=Symbol("Comlink.finalizer"),Rd=Symbol("Comlink.thrown"),aT=e=>typeof e=="object"&&e!==null||typeof e=="function",PH={canHandle:e=>aT(e)&&e[rT],serialize(e){const{port1:t,port2:r}=new MessageChannel;return iT(e,t),[r,[r]]},deserialize(e){return e.start(),lT(e)}},RH={canHandle:e=>aT(e)&&Rd in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},sT=new Map([["proxy",PH],["throw",RH]]);function jH(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function iT(e,t=globalThis,r=["*"]){t.addEventListener("message",function n(a){if(!a||!a.data)return;if(!jH(r,a.origin)){console.warn(`Invalid origin '${a.origin}' for comlink proxy`);return}const{id:s,type:i,path:o}=Object.assign({path:[]},a.data),l=(a.data.argumentList||[]).map(oo);let c;try{const u=o.slice(0,-1).reduce((h,v)=>h[v],e),d=o.reduce((h,v)=>h[v],e);switch(i){case"GET":c=d;break;case"SET":u[o.slice(-1)[0]]=oo(a.data.value),c=!0;break;case"APPLY":c=d.apply(u,l);break;case"CONSTRUCT":{const h=new d(...l);c=UH(h)}break;case"ENDPOINT":{const{port1:h,port2:v}=new MessageChannel;iT(e,v),c=$H(h,[h])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[Rd]:0}}Promise.resolve(c).catch(u=>({value:u,[Rd]:0})).then(u=>{const[d,h]=Lh(u);t.postMessage(Object.assign(Object.assign({},d),{id:s}),h),i==="RELEASE"&&(t.removeEventListener("message",n),oT(t),sm in e&&typeof e[sm]=="function"&&e[sm]())}).catch(u=>{const[d,h]=Lh({value:new TypeError("Unserializable return value"),[Rd]:0});t.postMessage(Object.assign(Object.assign({},d),{id:s}),h)})}),t.start&&t.start()}function FH(e){return e.constructor.name==="MessagePort"}function oT(e){FH(e)&&e.close()}function lT(e,t){const r=new Map;return e.addEventListener("message",function(a){const{data:s}=a;if(!s||!s.id)return;const i=r.get(s.id);if(i)try{i(s)}finally{r.delete(s.id)}}),Rg(e,r,[],t)}function md(e){if(e)throw new Error("Proxy has been released and is not useable")}function cT(e){return ul(e,new Map,{type:"RELEASE"}).then(()=>{oT(e)})}const jh=new WeakMap,Fh="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(jh.get(e)||0)-1;jh.set(e,t),t===0&&cT(e)});function LH(e,t){const r=(jh.get(t)||0)+1;jh.set(t,r),Fh&&Fh.register(e,t,e)}function MH(e){Fh&&Fh.unregister(e)}function Rg(e,t,r=[],n=function(){}){let a=!1;const s=new Proxy(n,{get(i,o){if(md(a),o===nT)return()=>{MH(s),cT(e),t.clear(),a=!0};if(o==="then"){if(r.length===0)return{then:()=>s};const l=ul(e,t,{type:"GET",path:r.map(c=>c.toString())}).then(oo);return l.then.bind(l)}return Rg(e,t,[...r,o])},set(i,o,l){md(a);const[c,u]=Lh(l);return ul(e,t,{type:"SET",path:[...r,o].map(d=>d.toString()),value:c},u).then(oo)},apply(i,o,l){md(a);const c=r[r.length-1];if(c===DH)return ul(e,t,{type:"ENDPOINT"}).then(oo);if(c==="bind")return Rg(e,t,r.slice(0,-1));const[u,d]=Jx(l);return ul(e,t,{type:"APPLY",path:r.map(h=>h.toString()),argumentList:u},d).then(oo)},construct(i,o){md(a);const[l,c]=Jx(o);return ul(e,t,{type:"CONSTRUCT",path:r.map(u=>u.toString()),argumentList:l},c).then(oo)}});return LH(s,e),s}function BH(e){return Array.prototype.concat.apply([],e)}function Jx(e){const t=e.map(Lh);return[t.map(r=>r[0]),BH(t.map(r=>r[1]))]}const uT=new WeakMap;function $H(e,t){return uT.set(e,t),e}function UH(e){return Object.assign(e,{[rT]:!0})}function Lh(e){for(const[t,r]of sT)if(r.canHandle(e)){const[n,a]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},a]}return[{type:"RAW",value:e},uT.get(e)||[]]}function oo(e){switch(e.type){case"HANDLER":return sT.get(e.name).deserialize(e.value);case"RAW":return e.value}}function ul(e,t,r,n){return new Promise(a=>{const s=zH();t.set(s,a),e.start&&e.start(),e.postMessage(Object.assign({id:s},r),n)})}function zH(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function VH(){const e=j.useRef(null),t=j.useRef(null),r=j.useCallback(async()=>{if(!e.current){const i=new Worker(new URL("/assets/excelProcessor.worker-C6JdUgEW.js",import.meta.url),{type:"module"});e.current=i,t.current=lT(i)}return t.current},[]),n=j.useCallback(async(i,o,l,c={})=>{const{signal:u,timeout:d=6e4}=c;if(console.log("🚀 Iniciando processamento:",{fileName:i.name,size:i.size}),u!=null&&u.aborted)throw new DOMException("Operação cancelada pelo usuário","AbortError");let h=null,v;try{v=await r(),console.log("📄 Convertendo arquivo para ArrayBuffer...");const y=await i.arrayBuffer();if(u!=null&&u.aborted)throw new DOMException("Operação cancelada pelo usuário","AbortError");l==null||l(10);const p=new Promise((w,E)=>{h=setTimeout(()=>{E(new DOMException(`Timeout de ${d}ms excedido`,"TimeoutError"))},d)}),_=new Promise((w,E)=>{u&&u.addEventListener("abort",()=>{E(new DOMException("Operação cancelada pelo usuário","AbortError"))})});console.log("⚙️ Processando arquivo no Web Worker..."),l==null||l(30);const x=[v.processExcelFile(y,o)];d>0&&x.push(p),u&&x.push(_);const k=await Promise.race([v.processExcelFile(y,o,(w,E,I)=>{console.log(`📊 Progresso: ${w}% - ${E} - ${I}`),l==null||l(Math.min(90,w))}),...x.slice(1)]);return console.log("✅ Processamento concluído:",{totalRows:k.parseResult.stats.totalRows,validRows:k.parseResult.stats.validRows,errors:k.parseResult.errors.length}),l==null||l(90),k}catch(y){throw console.error("❌ Erro no processamento:",y),e.current&&(console.log("🔄 Terminando worker devido ao erro..."),e.current.terminate(),e.current=null,t.current=null),y instanceof DOMException?y:new Error(`Erro no processamento: ${y instanceof Error?y.message:"Erro desconhecido"}`)}finally{h&&clearTimeout(h),l==null||l(100)}},[r]),a=j.useCallback(async i=>(await r()).processExistingEntries(i),[r]),s=j.useCallback(()=>{if(console.log("🛑 Terminando Web Worker..."),t.current){try{t.current[nT]()}catch(i){console.warn("Erro ao liberar proxy do worker:",i)}t.current=null}if(e.current){try{e.current.terminate()}catch(i){console.warn("Erro ao terminar worker:",i)}e.current=null}},[]);return{processExcelFile:n,processExistingEntries:a,terminateWorker:s}}async function WH(e){const t=Date.now();console.log("🏦 Iniciando transação de upload bancário...",{entries:e.entries.length,fileName:e.fileName,operationDate:e.operationDate});try{if(!e.entries||e.entries.length===0)throw new Error("Nenhuma entrada fornecida para salvar");if(!e.fileName||!e.operationDate)throw new Error("Dados obrigatórios ausentes (fileName ou operationDate)");const r=await st.transaction("rw",[st.bank_uploads,st.bank_entries],async a=>{console.log("📝 Executando transação...");const s={day:e.operationDate,file_name:e.fileName,file_upload_date:new Date().toISOString(),upload_mode:e.uploadMode,user_id:e.userId||"default_user",metadata:{totalEntries:e.entries.length,uploadTimestamp:Date.now()}},i=await a.table("bank_uploads").add(s);console.log(`✅ Upload record criado com ID: ${i}`);const o=e.entries.map(c=>({...c,upload_id:Number(i),user_id:e.userId||"default_user",source:"banking_upload"}));console.log("💾 Inserindo entradas em lote...");const l=await a.table("bank_entries").bulkAdd(o,{allKeys:!0});return console.log(`✅ ${l.length} entradas inseridas com sucesso`),{uploadId:Number(i),entryIds:l.map(c=>Number(c))}}),n=Date.now()-t;return console.log(`🎉 Transação bancária concluída em ${n}ms`),{success:!0,data:r}}catch(r){const n=Date.now()-t;console.error(`❌ Erro na transação bancária após ${n}ms:`,r);let a="UnknownError",s="Erro desconhecido ao salvar no banco de dados";if(r instanceof Error){const i=r.name,o=r.message.toLowerCase();i==="ConstraintError"||o.includes("constraint")?(a="ConstraintError",s="Dados duplicados ou inválidos detectados"):i==="VersionError"||o.includes("version")?(a="VersionError",s="Banco de dados desatualizado. Recarregue a página."):o.includes("database")||o.includes("indexeddb")?(a="DatabaseError",s="Erro de acesso ao banco de dados local"):s=r.message}return{success:!1,error:s,errorType:a}}}function HH(e,t=""){if(e.success)return;const r=t?`${t}: `:"";switch(e.errorType){case"ConstraintError":Bt.error(`${r}Dados duplicados ou inválidos detectados`);break;case"VersionError":Bt.error(`${r}Banco desatualizado. Recarregue a página.`);break;case"DatabaseError":Bt.error(`${r}Erro de acesso ao banco local`);break;default:Bt.error(`${r}${e.error||"Erro desconhecido"}`)}}function KH(){const[e,t]=j.useState({lookup:new Map,totalEntries:0,uniqueValues:0,lastUpdated:new Date}),r=j.useCallback(h=>Math.round(h*100),[]),n=j.useCallback(h=>{const v=new Map;let y=0;console.time("buildLookupMap");for(const _ of h){if(!_.value||_.value===0)continue;const x=r(_.value),k={id:_.id,source:_.source,value:_.value,value_cents:x,status:_.status||"unknown",description:_.description,document_number:_.document_number,date:_.date,entry:_};v.has(x)||v.set(x,[]),v.get(x).push(k),y++}console.timeEnd("buildLookupMap");const p={lookup:v,totalEntries:y,uniqueValues:v.size,lastUpdated:new Date};return console.log(`Lookup map built: ${y} entries, ${v.size} unique values`),p},[r]),a=j.useCallback(h=>{const v=n(h);return t(v),v},[n]),s=j.useCallback(h=>{const v=r(h);return e.lookup.get(v)||[]},[e.lookup,r]),i=j.useCallback(h=>{if(!h.value||h.value===0||!h.id)return;const v=r(h.value),y={id:h.id,source:h.source,value:h.value,value_cents:v,status:h.status||"unknown",description:h.description,document_number:h.document_number,date:h.date,entry:h};t(p=>{const _=new Map(p.lookup);_.has(v)||_.set(v,[]);const x=_.get(v),k=x.findIndex(w=>w.id===h.id);return k===-1?x.push(y):x[k]=y,{lookup:_,totalEntries:Array.from(_.values()).reduce((w,E)=>w+E.length,0),uniqueValues:_.size,lastUpdated:new Date}})},[r]),o=j.useCallback((h,v)=>{const y=r(v);t(p=>{const _=new Map(p.lookup),x=_.get(y);if(x){const k=x.filter(w=>w.id!==h);k.length===0?_.delete(y):_.set(y,k)}return{lookup:_,totalEntries:Array.from(_.values()).reduce((k,w)=>k+w.length,0),uniqueValues:_.size,lastUpdated:new Date}})},[r]),l=j.useCallback((h,v,y)=>{const p=r(v);t(_=>{const x=new Map(_.lookup),k=x.get(p);if(k){const w=k.findIndex(E=>E.id===h);if(w!==-1){const E=[...k];E[w]={...E[w],status:y},x.set(p,E)}}return{..._,lookup:x,lastUpdated:new Date}})},[r]),c=j.useCallback((h,v)=>{const y=s(h),p=Array.isArray(v)?v:[v];return y.filter(_=>p.includes(_.status))},[s]),u=j.useMemo(()=>{const h=new Map,v=new Map;for(const y of e.lookup.values())for(const p of y)h.set(p.status,(h.get(p.status)||0)+1),v.set(p.source,(v.get(p.source)||0)+1);return{totalEntries:e.totalEntries,uniqueValues:e.uniqueValues,statusCounts:Object.fromEntries(h),sourceCounts:Object.fromEntries(v),lastUpdated:e.lastUpdated}},[e]),d=j.useCallback(()=>{t({lookup:new Map,totalEntries:0,uniqueValues:0,lastUpdated:new Date})},[]);return{lookupMap:e,updateLookupMap:a,findByValue:s,findByValueAndStatus:c,addEntry:i,removeEntry:o,updateEntryStatus:l,clearLookupMap:d,valueToCents:r,stats:u}}const qH=()=>{var ni,Wo;const{user:e,logout:t}=u0(),{processExcelFile:r,terminateWorker:n}=VH(),a=IH(),s=j.useRef(null),i=KH(),[o,l]=FS(),[c,u]=ms("dashboard_active_tab","banking"),[d,h]=ms("dashboard_show_history",!1),[v,y]=j.useState(null),[p,_]=j.useState(Vc()),[x,k]=j.useState("automatic"),[w,E]=j.useState(null),[I,D]=j.useState([]),[C,V]=j.useState(!1),{registerFocusTarget:z,focusTarget:ee,getFocusTarget:re}=B8(),{saveFocus:G,restoreFocus:me}=BS(),Ee=j.useRef(null),Ae=j.useRef(null),[ke,Oe]=ms("dashboard_parse_result",null),[Ce,Z]=j.useState(null),[Se,Ve]=ms("dashboard_conferred_items",[],{serialize:Ie=>JSON.stringify(Ie.map(tt=>({...tt,conferredAt:tt.conferredAt.toISOString()}))),deserialize:Ie=>JSON.parse(Ie).map(tt=>{let ft=new Date;try{if(tt.conferredAt){const Ft=new Date(tt.conferredAt);isNaN(Ft.getTime())||(ft=Ft)}}catch{console.warn("Invalid conferredAt value:",tt.conferredAt)}return{...tt,conferredAt:ft}})}),[B,J]=ms("dashboard_transferred_ids",new Set,{serialize:Ie=>JSON.stringify(Array.from(Ie)),deserialize:Ie=>new Set(JSON.parse(Ie))}),[K,X]=ms("dashboard_not_found_history",[],{serialize:Ie=>JSON.stringify(Ie.map(tt=>({...tt,timestamp:tt.timestamp.toISOString()}))),deserialize:Ie=>JSON.parse(Ie).map(tt=>{let ft=new Date;try{if(tt.timestamp){const Ft=new Date(tt.timestamp);isNaN(Ft.getTime())||(ft=Ft)}}catch{console.warn("Invalid timestamp value:",tt.timestamp)}return{...tt,timestamp:ft}})}),[ge,Pe]=j.useState(!1),[je,ce]=j.useState([]),[Te,dt]=j.useState(!1),[N,Ue]=j.useState(null),[it,ct]=j.useState(null),[mt,Fe]=j.useState(!1),[$t,yr]=j.useState(null),[H,ae]=j.useState([]),[ye,Ke]=j.useState(!1),Be=j.useCallback(()=>{dt(!1),Fe(!1),V(!1),me()},[me]),Re=j.useCallback(async()=>{const Ie=Ph(Rh.conferenceValue,{value:o.conferenceValue});if(!Ie.success){Ue(Ie.error);return}Pe(!0),Ue(null),ce([]);try{const tt=o.conferenceValue.trim(),ft=await Or.time("conference-search",async()=>await dataAdapter.searchConferenceValue(tt,o.selectedDate||formatDateForQuery(new Date)));if(ft.length===0){Ue("Nenhum valor encontrado para conferência");return}if(ce(ft),ft.length===1){const Ft={...ft[0],conferredAt:new Date,conferredId:`conf-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};Ve(un=>[Ft,...un]),l(un=>({...un,conferenceValue:""})),ce([]),ct("Valor conferido automaticamente!"),setTimeout(()=>ct(null),3e3)}else G(),dt(!0)}catch(tt){console.error("Erro na busca de conferência:",tt),Ue(tt.message||"Erro interno na busca")}finally{Pe(!1)}},[o.conferenceValue,o.selectedDate,Ue,ce,Ve,l,ct,G,dt,Pe]),nt=j.useCallback(()=>{if(Te&&je.length>0){const Ie=je[0];if(Ie){G(),dt(!1);const tt={...Ie,conferredAt:new Date,conferredId:`conf-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};Ve(ft=>[tt,...ft]),l(ft=>({...ft,conferenceValue:""})),ce([]),ct("Valor conferido com sucesso!"),setTimeout(()=>ct(null),3e3),me()}}else o.conferenceValue&&!Te&&Re()},[Te,je,o.conferenceValue,G,me,Ve,l,Re]),St=j.useCallback(()=>{const Ie=re("dateFilter");Ie?Ie.focus():ee("dateFilter")},[re,ee]);j.useEffect(()=>{z("conferenceValue",Ee.current),z("dateFilter",Ae.current)},[z]),$8({valueInput:re("valueInput"),conferenceValue:re("conferenceValue"),dateFilter:re("dateFilter")},{openDateFilter:St,closeModals:Be,confirmAction:nt});const gt=NH(o.conferenceValue,300);j.useEffect(()=>{if(gt&&(ke!=null&&ke.data)&&Ce)if(M8(gt).isValid){const tt=Or.measureSync("conference_search",()=>L8(gt,ke.data,Ce),{valueSearched:gt,dataSize:ke.data.length});yr(tt.matches.length)}else yr(null);else yr(null)},[gt,ke,Ce]),j.useEffect(()=>{if(ke&&ke.data&&ke.data.length>0&&!Ce){console.log("Creating value index from persistent data...");const Ie=Mw(ke.data);Z(Ie),console.log(`Índice criado com ${Ie.size} valores únicos`)}},[ke]);const qt=Ie=>{var ft;const tt=(ft=Ie.target.files)==null?void 0:ft[0];console.log("File selected:",tt),tt&&(console.log("File details:",{name:tt.name,size:tt.size,type:tt.type}),y(tt),E(null))},wt=j.useCallback(()=>{console.log("🛑 Cancelando processamento..."),s.current&&s.current.abort(),n(),a.stopProcessing(),E(null),Bt.info("Processamento cancelado pelo usuário")},[n,a]),jt=async()=>{var un;if(console.log("🚀 handleLoadFile called, selectedFile:",v),!v){console.log("❌ No file selected");return}const Ie=50*1024*1024;if(v.size>Ie){const Et=(v.size/1048576).toFixed(2),vt=`Arquivo muito grande: ${Et}MB (máximo: 50MB)`;E(vt),Bt.error(`📁 Arquivo muito grande
📊 Tamanho atual: ${Et}MB
⚠️ Tamanho máximo: 50MB
💡 Reduza o arquivo ou divida em partes menores`,{duration:8e3});return}const tt=[".xlsx",".xls",".csv"],ft=v.name.toLowerCase().substring(v.name.lastIndexOf("."));if(!tt.includes(ft)){const Et=`Tipo de arquivo não suportado: ${ft}`;E(Et),Bt.error(`📄 Formato de arquivo não suportado
❌ Arquivo atual: ${ft}
✅ Formatos aceitos: .xlsx, .xls, .csv
🔄 Converta o arquivo para um formato suportado`,{duration:8e3});return}if(v.size===0){E("Arquivo vazio ou corrompido"),Bt.error(`📄 Arquivo vazio
⚠️ O arquivo selecionado não tem conteúdo
🔧 Verifique se o arquivo não está corrompido`,{duration:6e3});return}console.log("✅ Starting file processing with Web Worker...");const Ft=Date.now();s.current=new AbortController,a.startProcessing("parsing"),E(null);try{const Et={signal:s.current.signal,timeout:6e4};a.updateStage("parsing","Lendo planilha...");const vt=await r(v,p,_r=>{console.log(`📊 Upload progress: ${_r}%`),a.updateProgress(_r)},Et);if((un=s.current)!=null&&un.signal.aborted){console.log("🛑 Processing was aborted");return}const fn=Date.now()-Ft;if(console.log(`⚡ Processing completed in ${fn}ms`),vt.parseResult.success){a.updateStage("indexing","Criando índices de busca...");const _r=vt.parseResult.data.map((P,R)=>({id:`row_${R}`,date:P.date,paymentType:P.paymentType,cpf:P.cpf,value:P.value,originalHistory:P.originalHistory,rowIndex:R,validationStatus:P.validationStatus,validationMessage:P.validationMessage,bankData:{date:P.date,description:P.originalHistory,value:P.value,documentNumber:P.cpf,transactionType:P.paymentType}})),O={success:vt.parseResult.success,data:_r,errors:vt.parseResult.errors,warnings:vt.parseResult.warnings,stats:vt.parseResult.stats};Oe(O);const M=Mw(_r);Z(M),console.log(`🔍 Índice criado com ${M.size} valores únicos`),a.updateStage("saving","Salvando no banco de dados...");try{const P={entries:vt.normalizedEntries.map(F=>({source_id:F.source_id,day:F.day,document_number:F.document_number,date:F.date,description:F.description,value_cents:F.value_cents,value:F.value,transaction_type:F.transaction_type,balance:F.balance,status:F.status,source:"banking_upload"})),fileName:v.name,operationDate:p,uploadMode:x,userId:(e==null?void 0:e.username)||"default_user"};console.log("💾 Saving to database with transaction...");const R=await WH(P);R.success?(console.log("✅ Data saved to database successfully:",R.data),Bt.success(`✅ Arquivo processado com sucesso!
⏱️ Tempo: ${fn}ms
📊 ${vt.parseResult.stats.totalRows} linhas processadas
✔️ ${vt.parseResult.stats.validRows} válidas`,{duration:5e3})):(console.error("❌ Database save failed:",R.error),HH(R,"Erro ao salvar no banco"),Bt.error(`⚠️ Dados processados mas erro ao salvar no banco
📊 ${vt.parseResult.stats.totalRows} linhas ainda disponíveis na tabela
❌ ${R.error}`,{duration:8e3}))}catch(P){console.error("❌ Critical database error:",P),Bt.error(`❌ Erro crítico no banco de dados
📊 Dados processados e visíveis na tabela
🔧 Verifique a configuração do banco`,{duration:8e3})}console.log("📊 Processing summary:"),console.log(`  - Tempo total: ${fn}ms`),console.log(`  - Linhas processadas: ${vt.parseResult.stats.totalRows}`),console.log(`  - Linhas válidas: ${vt.parseResult.stats.validRows}`),console.log(`  - Avisos: ${vt.parseResult.warnings.length}`),console.log(`  - Erros: ${vt.parseResult.errors.length}`)}else{const _r=vt.parseResult.errors.join(`
`);console.error("❌ Parse failed:",_r),E(_r),Oe(null),Bt.error(`❌ Erro no processamento da planilha
📄 Verifique se o formato está correto
🔍 ${vt.parseResult.errors.length} erro(s) encontrado(s)`,{duration:8e3})}}catch(Et){if(console.error("💥 Critical error processing file:",Et),Et instanceof DOMException)if(Et.name==="AbortError"){console.log("🛑 Operation was aborted");return}else Et.name==="TimeoutError"&&(E("⏰ Timeout: Arquivo muito grande ou complexo"),Bt.error(`⏰ Processamento interrompido por timeout
📁 Arquivo muito grande ou complexo
💡 Tente reduzir o tamanho ou simplificar os dados`,{duration:1e4}));else{const vt=Et instanceof Error?Et.message:"Erro desconhecido ao processar arquivo";E(vt),vt.includes("XLSX")||vt.includes("planilha")?Bt.error(`📄 Erro no formato da planilha
✅ Formatos suportados: .xlsx, .xls, .csv
🔧 Verifique se o arquivo não está corrompido`,{duration:8e3}):vt.includes("network")||vt.includes("fetch")?Bt.error(`🌐 Erro de conexão
🔄 Verifique sua conexão com a internet
⚡ Tente novamente em alguns segundos`,{duration:8e3}):vt.includes("memory")||vt.includes("heap")?Bt.error(`💾 Erro de memória
📁 Arquivo muito grande para o sistema
📉 Tente um arquivo menor ou feche outras abas`,{duration:8e3}):Bt.error(`❌ Erro inesperado no processamento
🔍 ${vt}
🔄 Tente recarregar a página`,{duration:8e3})}Oe(null),n()}finally{s.current=null,a.stopProcessing(),console.log("🏁 Upload operation finished")}},lr=()=>{y(null),Oe(null),Z(null),E(null),J(new Set),Ve([]),X([]);const Ie=document.getElementById("fileInput");Ie&&(Ie.value="")},Gt=()=>{if(!o.selectedDate){Ue("Selecione uma data para carregar o histórico.");return}console.log("Carregando histórico para data:",o.selectedDate);try{if(!o.selectedDate||o.selectedDate==="Invalid Date"){Ue("Data inválida selecionada.");return}const Ie=new Date(o.selectedDate+"T00:00:00"),tt=gs(Ie),ft=Se.filter(fn=>{if(!fn.conferredAt)return!1;const _r=new Date(fn.conferredAt);return!isNaN(_r.getTime())&&_r.toDateString()===Ie.toDateString()}),Ft=K.filter(fn=>{if(!fn.timestamp)return!1;const _r=new Date(fn.timestamp);return!isNaN(_r.getTime())&&_r.toDateString()===Ie.toDateString()}),un=ft.length,Et=Ft.length,vt=ft.reduce((fn,_r)=>fn+_r.value,0);if(un===0&&Et===0)Ue(`Nenhum registro encontrado para ${tt}.`),ae([]),Ke(!1);else{const fn=[`Histórico de ${tt}:`,`• ${un} conferências realizadas`,`• ${Et} valores não encontrados`,vt>0?`• Valor total: ${new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(vt)}`:""].filter(Boolean).join(`
`);ct(fn),setTimeout(()=>ct(null),5e3),ae(ft),Ke(!0),un>0&&u("cash")}}catch(Ie){console.error("Erro ao filtrar por data:",Ie),Ue("Erro ao carregar histórico. Verifique a data selecionada.")}},cn=()=>{Fe(!0)},Fn=()=>{Ve([]),J(new Set),X([]),ri(""),Ue(null),ct("Dia atual reiniciado com sucesso."),setTimeout(()=>ct(null),3e3),Fe(!1),setTimeout(()=>{const Ie=document.querySelector('input[placeholder*="Digite o valor"]');Ie&&(Ie.focus(),Ie.select())},100)},lt=()=>{Fe(!1)},_a=j.useCallback(async Ie=>{const tt=`conf-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ft={...Ie,conferredAt:new Date,conferredId:tt};Ve(Ft=>[...Ft,ft]),J(Ft=>new Set([...Ft,Ie.id])),i.updateEntryStatus(Ie.id,Ie.value,"conferred");try{await Ws.saveCashConference(Ie,p,"conferred")}catch(Ft){console.error("Error saving conference to database:",Ft)}ri(""),ct("Valor encontrado e transferido para Conferência de Caixa."),setTimeout(()=>{const Ft=document.querySelector('input[placeholder*="Digite o valor"]');Ft&&(Ft.focus(),Ft.select())},100),setTimeout(()=>ct(null),3e3)},[p]),Ln=j.useCallback(Ie=>{_a(Ie),dt(!1),ce([])},[_a]),Ts=j.useCallback(()=>{dt(!1),ce([]),Pe(!1)},[]),Qe=j.useCallback(Ie=>{const tt=Se.find(ft=>ft.conferredId===Ie);tt&&(Ve(ft=>ft.filter(Ft=>Ft.conferredId!==Ie)),J(ft=>{const Ft=new Set(ft);return Ft.delete(tt.id),Ft}),i.updateEntryStatus(tt.id,tt.value,"pending"))},[Se,i]),Ma=Ie=>{u(Ie),Ue(null),ct(null)},ri=Ie=>{l(tt=>({...tt,conferenceValue:Ie}))},as=Ie=>{ri(Ie),Ue(null),ct(null)},Vo=j.useCallback(Ie=>{if(Ie.remove)Ve(tt=>tt.filter(ft=>ft.conferredId!==Ie.conferredId)),i.removeEntry(Ie.id,Ie.value);else{const tt={id:Ie.id,date:Ie.date,description:Ie.description,value:Ie.value,cpf:Ie.cpf||"",originalHistory:Ie.originalHistory,source:Ie.source,conferredAt:Ie.conferredAt,conferredId:Ie.conferredId};if(Ve(ft=>[...ft,tt]),Ie.source==="manual_entry"){const ft={id:Ie.id,operation_date:Ie.date,operation_type:"manual_entry",value:Ie.value,description:Ie.description,status:"active",source:"manual_entry",user_id:"default_user"};i.addEntry(ft)}}},[i]);return m.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-black",children:[m.jsx("header",{className:"bg-gray-900 shadow-lg border-b border-gray-800",children:m.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[m.jsxs("div",{className:"flex justify-between items-center h-16",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("img",{src:jS,alt:"Manipularium Logo",className:"h-8 w-auto drop-shadow-lg"}),m.jsx("h1",{className:"ml-3 text-xl font-semibold text-gray-100",children:"Manipularium - Sistema de Conferência"})]}),m.jsxs("div",{className:"flex items-center space-x-4",children:[m.jsx("span",{className:"text-sm text-gray-300",children:m.jsx("strong",{className:"text-gray-100",children:e==null?void 0:e.username})}),m.jsxs("button",{onClick:t,className:"inline-flex items-center px-3 py-2 border border-gray-700 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-300 bg-gray-800 hover:bg-gray-700 hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-colors",children:[m.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sair"]})]})]}),m.jsxs("div",{className:"flex space-x-1 border-t border-gray-800 pt-2",children:[m.jsx("button",{onClick:()=>Ma("launches"),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${c==="launches"?"bg-gray-800 text-gray-100 border-b-2 border-indigo-500":"text-gray-400 hover:text-gray-100 hover:bg-gray-800/50"}`,children:"Lançamentos"}),m.jsxs("button",{onClick:()=>Ma("banking"),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${c==="banking"?"bg-gray-800 text-gray-100 border-b-2 border-indigo-500":"text-gray-400 hover:text-gray-100 hover:bg-gray-800/50"}`,children:["Conferência Bancária",ke&&m.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-indigo-600 text-white rounded-full",children:ke.stats.totalRows-B.size})]}),m.jsxs("button",{onClick:()=>Ma("cash"),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${c==="cash"?"bg-gray-800 text-gray-100 border-b-2 border-indigo-500":"text-gray-400 hover:text-gray-100 hover:bg-gray-800/50"}`,children:["Conferência de Caixa",Se.length>0&&m.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-green-600 text-white rounded-full",children:Se.length})]}),m.jsx("button",{onClick:()=>Ma("actions"),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${c==="actions"?"bg-gray-800 text-gray-100 border-b-2 border-purple-500":"text-gray-400 hover:text-gray-100 hover:bg-gray-800/50"}`,children:"📝 Ações"}),m.jsx("button",{onClick:()=>Ma("backup"),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${c==="backup"?"bg-gray-800 text-gray-100 border-b-2 border-blue-500":"text-gray-400 hover:text-gray-100 hover:bg-gray-800/50"}`,children:"💾 Backup"})]})]})}),m.jsx("div",{className:"flex min-h-[calc(100vh-8rem)]",children:c==="launches"?m.jsx(CH,{currentDate:p?(()=>{try{const[Ie,tt,ft]=p.split("/");return new Date(parseInt(ft),parseInt(tt)-1,parseInt(Ie))}catch{return new Date}})():new Date,operationDate:p,onLaunchAdded:Vo,conferredItems:Se}):c==="banking"?m.jsxs(m.Fragment,{children:[m.jsx("aside",{className:"w-80 bg-gray-900 border-r border-gray-800 sticky top-32 self-start",children:m.jsxs("div",{className:"p-4 space-y-4",children:[m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"1"}),"Carregar Planilha"]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("input",{type:"file",id:"fileInput",accept:".xlsx,.xls,.csv",onChange:qt,className:"hidden"}),m.jsx("label",{htmlFor:"fileInput",className:"block w-full px-3 py-2 text-sm text-gray-300 bg-gray-700 border border-gray-600 rounded-md cursor-pointer hover:bg-gray-600 transition-colors text-center",onClick:()=>console.log("Label clicked"),children:v?`✅ ${v.name}`:"📁 Escolher arquivo"}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:jt,disabled:!v||a.isProcessing,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a.isProcessing?"Processando...":"Carregar"}),m.jsx("button",{onClick:lr,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar"})]})]})]}),m.jsx(XW,{selectedFile:v,onDateSelected:(Ie,tt)=>{_(Ie),k(tt)}}),m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"3"}),"Conferir Valor"]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"relative",children:[m.jsx("input",{ref:Ee,id:"conference-value-input",type:"text",placeholder:"Digite o valor (ex: 123,45)",value:o.conferenceValue,onChange:Ie=>as(Ie.target.value),onKeyDown:Ie=>Ie.key==="Enter"&&!ge&&Re(),disabled:!ke||ge,...eT("conference-value-input",N),className:`w-full px-3 py-2 pr-20 text-sm text-gray-100 bg-gray-700 border rounded-md focus:ring-2 disabled:opacity-50 disabled:cursor-not-allowed ${N?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-600 focus:ring-indigo-500 focus:border-indigo-500"}`}),$t!==null&&m.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:m.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${$t>0?"bg-green-900/50 text-green-400 border border-green-600":"bg-red-900/50 text-red-400 border border-red-600"}`,children:$t>0?`${$t} ${$t===1?"resultado":"resultados"}`:"Sem resultados"})})]}),m.jsx(Q4,{error:N,fieldId:"conference-value-input"}),m.jsx("button",{onClick:Re,disabled:!ke||ge||!o.conferenceValue.trim(),className:"w-full px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:ge?m.jsxs(m.Fragment,{children:[m.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Buscando..."]}):"OK"}),N&&m.jsx("div",{className:"p-2 bg-red-900/20 border border-red-400 rounded-md",children:m.jsx("p",{className:"text-xs text-red-400",children:N})}),it&&m.jsx("div",{className:"p-2 bg-green-900/20 border border-green-400 rounded-md",children:m.jsx("p",{className:"text-xs text-green-400",children:it})}),!ke&&m.jsx("div",{className:"p-2 bg-gray-700 border border-gray-600 rounded-md",children:m.jsx("p",{className:"text-xs text-gray-400",children:"Carregue uma planilha para usar esta função"})}),m.jsx("button",{onClick:cn,className:"w-full px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Reiniciar dia atual"}),m.jsxs("button",{onClick:()=>h(!d),className:"w-full px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors flex items-center justify-between",children:[m.jsx("span",{children:"Histórico de valores não encontrados"}),m.jsxs("div",{className:"flex items-center space-x-2",children:[K.length>0&&m.jsx("span",{className:"px-2 py-1 text-xs bg-red-600 text-white rounded-full",children:K.length}),m.jsx("svg",{className:`w-4 h-4 transform transition-transform ${d?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),d&&m.jsx("div",{className:"mt-2 p-2 bg-gray-900 rounded-md border border-gray-700 max-h-40 overflow-y-auto",children:K.length===0?m.jsx("p",{className:"text-xs text-gray-400",children:"Nenhum valor não encontrado"}):m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2",children:[m.jsxs("span",{className:"text-xs font-medium text-gray-300",children:[K.length," valor(es) não encontrado(s)"]}),m.jsx("button",{onClick:()=>X([]),className:"text-xs text-red-400 hover:text-red-300 transition-colors",title:"Limpar histórico",children:"Limpar"})]}),K.map((Ie,tt)=>m.jsxs("div",{className:"bg-gray-800 rounded p-2 border border-gray-600",children:[m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsx("span",{className:"text-xs text-gray-200 font-mono",children:Ie.value}),m.jsx("span",{className:"text-xs text-red-400 bg-red-900/30 px-1 rounded",children:"Não encontrado"})]}),m.jsx("div",{className:"mt-1 text-xs text-gray-400",children:new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format(Ie.timestamp)})]},tt))]})})]})]}),m.jsx(gH,{onDataLoaded:Ie=>{D(Ie);const tt=Ie.filter(ft=>ft.operation_type==="cash_conference"&&ft.status==="conferred").map(ft=>({...ft.metadata,conferredAt:(()=>{try{const Ft=ft.conferred_at||ft.operation_timestamp||"";return Ft?new Date(Ft):new Date}catch{return new Date}})(),conferredId:ft.id||`hist-${ft.operation_timestamp}`}));tt.length>0&&(ae(tt),Ke(!0),u("cash"))},onLookupMapBuilt:Ie=>{console.log(`Building lookup map for ${Ie.length} entries...`),i.updateLookupMap(Ie),console.log("Lookup map updated:",i.stats)}})]})}),m.jsx("main",{className:"flex-1 bg-gray-950 p-6 min-h-[calc(100vh-8rem)] min-w-0",children:a.isProcessing?m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 min-h-full p-8 flex items-center justify-center",children:m.jsxs("div",{className:"text-center",children:[m.jsxs("svg",{className:"animate-spin h-12 w-12 text-indigo-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),m.jsx("p",{className:"mt-4 text-gray-300",children:"Processando arquivo..."})]})}):w?m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 min-h-full p-8",children:m.jsx("div",{className:"max-w-md mx-auto",children:m.jsx("div",{className:"bg-red-900/20 border border-red-400 rounded-md p-4",children:m.jsxs("div",{className:"flex",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:m.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),m.jsxs("div",{className:"ml-3",children:[m.jsx("h3",{className:"text-sm font-medium text-red-400",children:"Erro ao processar arquivo"}),m.jsx("div",{className:"mt-2 text-sm text-red-300",children:m.jsx("p",{style:{whiteSpace:"pre-line"},children:w})}),m.jsx("div",{className:"mt-4",children:m.jsx("button",{onClick:lr,className:"px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Tentar novamente"})})]})]})})})}):ke?m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 min-h-[calc(100vh-12rem)] flex flex-col overflow-auto",children:[ke.warnings.length>0&&m.jsx("div",{className:"bg-yellow-900/20 border-b border-yellow-700 p-4",children:m.jsxs("div",{className:"flex items-start",children:[m.jsx("svg",{className:"h-5 w-5 text-yellow-400 mt-0.5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:m.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("h3",{className:"text-sm font-medium text-yellow-400",children:"Avisos encontrados durante o processamento"}),m.jsxs("div",{className:"mt-2 text-xs text-yellow-300 max-h-20 overflow-y-auto",children:[ke.warnings.slice(0,5).map((Ie,tt)=>m.jsx("p",{children:Ie},tt)),ke.warnings.length>5&&m.jsxs("p",{className:"mt-1 font-semibold",children:["... e mais ",ke.warnings.length-5," avisos"]})]})]})]})}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h3",{className:"text-lg font-medium text-gray-200",children:"Dados Bancários"}),m.jsx(Ku,{data:{banking:((ni=ke==null?void 0:ke.data)==null?void 0:ni.filter(Ie=>!B.has(Ie.id)))||[]},prefix:"bancario",date:p,disabled:!((Wo=ke==null?void 0:ke.data)!=null&&Wo.length)})]}),m.jsx(T8,{parseResult:ke,transferredIds:B})]})]}):m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 min-h-full p-8",children:m.jsx("div",{className:"flex items-center justify-center h-full",children:m.jsxs("div",{className:"text-center",children:[m.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),m.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-300",children:"Conferência Bancária"}),m.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Carregue uma planilha para começar a conferir valores."})]})})})})]}):c==="actions"?m.jsx(yH,{className:"flex-1"}):c==="backup"?m.jsx(kH,{className:"flex-1",currentDate:p}):m.jsxs(m.Fragment,{children:[m.jsx("aside",{className:"w-80 bg-gray-900 border-r border-gray-800 sticky top-32 self-start",children:m.jsx("div",{className:"p-4",children:m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("svg",{className:"w-5 h-5 text-indigo-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Filtrar por Data"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Data específica"}),m.jsx("input",{ref:Ae,type:"date",value:o.selectedDate,onChange:Ie=>l(tt=>({...tt,selectedDate:Ie.target.value})),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),m.jsx("button",{onClick:Gt,className:"w-full px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:"Aplicar Filtro"}),m.jsx("button",{onClick:()=>l(Ie=>({...Ie,selectedDate:""})),className:"w-full px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar Filtro"})]}),m.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-700",children:[m.jsx("h4",{className:"text-xs font-medium text-gray-400 mb-3",children:"Resumo"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsx("span",{className:"text-gray-400",children:"Total de itens:"}),m.jsx("span",{className:"text-gray-200 font-medium",children:Se.length})]}),m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsx("span",{className:"text-gray-400",children:"Valor total:"}),m.jsx("span",{className:"text-green-400 font-medium",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Se.reduce((Ie,tt)=>Ie+tt.value,0))})]}),Se.length>0&&m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsx("span",{className:"text-gray-400",children:"Última conferência:"}),m.jsx("span",{className:"text-gray-200 font-medium",children:new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format([...Se].sort((Ie,tt)=>tt.conferredAt.getTime()-Ie.conferredAt.getTime())[0].conferredAt)})]})]})]})]})})}),m.jsx("main",{className:"flex-1 bg-gray-950 p-6 min-h-[calc(100vh-8rem)] min-w-0",children:m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 h-full",children:[ye&&m.jsx("div",{className:"bg-indigo-900/20 border-b border-indigo-700 p-3",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("svg",{className:"w-4 h-4 text-indigo-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),m.jsxs("span",{className:"text-sm font-medium text-indigo-400",children:["Filtrado por: ",o.selectedDate&&gs(o.selectedDate)]})]}),m.jsxs("span",{className:"text-xs text-indigo-300",children:[H.length," registro(s)"]})]})}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h3",{className:"text-lg font-medium text-gray-200",children:"Conferência de Caixa"}),m.jsx(Ku,{data:{cash:ye?H:Se},prefix:"caixa",date:p,disabled:(ye?H:Se).length===0})]}),m.jsx(F8,{conferredItems:ye?H:Se,onRemoveItem:Qe})]})]})})]})}),m.jsx(U8,{isOpen:Te,matches:je,searchValue:je.length>0?je[0].value:0,onSelect:Ln,onClose:Ts}),mt&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 p-6 max-w-md w-full mx-4",children:m.jsxs("div",{className:"flex items-start",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-6 w-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("h3",{className:"text-lg font-medium text-gray-100 mb-2",children:"Confirmar Reinício"}),m.jsx("p",{className:"text-sm text-gray-300 mb-6",children:"Tem certeza que deseja reiniciar o dia atual? Todos os dados transferidos e históricos serão apagados."}),m.jsxs("div",{className:"flex space-x-3",children:[m.jsx("button",{onClick:Fn,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500 transition-colors",children:"Confirmar"}),m.jsx("button",{onClick:lt,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-gray-500 transition-colors",children:"Cancelar"})]})]})]})})}),m.jsx(AH,{}),m.jsx(bH,{isVisible:C,onToggle:()=>V(!C)}),m.jsx(EH,{}),m.jsx(OH,{show:a.isProcessing,stage:a.stage,progress:a.progress,message:a.message,showStallWarning:a.showStallWarning,canCancel:a.canCancel,onCancel:wt})]})};class GH extends j.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null,errorInfo:null},this.handleReload=()=>{window.location.reload()},this.handleClearStorage=()=>{localStorage.clear(),window.location.reload()}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,r){console.error("ErrorBoundary caught an error:",t,r),this.setState({error:t,errorInfo:r})}render(){return this.state.hasError?m.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-black flex items-center justify-center p-4",children:m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 p-6 max-w-2xl w-full",children:m.jsxs("div",{className:"flex items-start mb-4",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-8 w-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("h1",{className:"text-xl font-semibold text-gray-100 mb-2",children:"Erro na Aplicação"}),m.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Ocorreu um erro inesperado. Isso pode ser causado por dados corrompidos no armazenamento local ou um problema na aplicação."}),!1,m.jsxs("div",{className:"flex space-x-3",children:[m.jsx("button",{onClick:this.handleReload,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-indigo-500 transition-colors",children:"Recarregar Página"}),m.jsx("button",{onClick:this.handleClearStorage,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-gray-500 transition-colors",children:"Limpar Dados e Recarregar"})]}),m.jsx("p",{className:"mt-3 text-xs text-gray-400",children:"Se o problema persistir, entre em contato com o suporte técnico."})]})]})})}):this.props.children}}function XH(){const[e,t]=j.useState({isInitialized:!1,isLoading:!0,usingIndexedDB:!1,error:null});return j.useEffect(()=>{let r=!0;return(async()=>{try{await Ws.initialize(),r&&t({isInitialized:!0,isLoading:!1,usingIndexedDB:Ws.isUsingIndexedDB(),error:null})}catch(a){console.error("Failed to initialize storage:",a),r&&t({isInitialized:!1,isLoading:!1,usingIndexedDB:!1,error:a instanceof Error?a.message:"Unknown error"})}})(),()=>{r=!1}},[]),e}function ZH(){const{user:e,isLoading:t}=u0(),r=XH();return t||r.isLoading?m.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 to-black",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),m.jsx("p",{className:"text-gray-400",children:t?"Carregando...":"Inicializando storage..."}),r.usingIndexedDB&&m.jsx("p",{className:"text-green-400 text-sm mt-2",children:"IndexedDB disponível"})]})}):m.jsxs(q5,{children:[m.jsx(Nd,{path:"/",element:e?m.jsx(Qm,{to:"/dashboard",replace:!0}):m.jsx(d8,{})}),m.jsx(Nd,{path:"/dashboard",element:m.jsx(h8,{children:m.jsx(qH,{})})}),m.jsx(Nd,{path:"*",element:m.jsx(Qm,{to:"/",replace:!0})})]})}function YH(){return m.jsx(GH,{children:m.jsxs(IO,{children:[m.jsx(ZH,{}),m.jsx(hN,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#1f2937",color:"#f3f4f6",border:"1px solid #374151"},success:{iconTheme:{primary:"#10b981",secondary:"#f3f4f6"}},error:{iconTheme:{primary:"#ef4444",secondary:"#f3f4f6"}}}})]})})}db(document.getElementById("root")).render(m.jsx(j.StrictMode,{children:m.jsx(gC,{children:m.jsx(YH,{})})}));
