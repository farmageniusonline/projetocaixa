(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var Gr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function K_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Z_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Sg={exports:{}},uu={},bg={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rl=Symbol.for("react.element"),X_=Symbol.for("react.portal"),Y_=Symbol.for("react.fragment"),q_=Symbol.for("react.strict_mode"),J_=Symbol.for("react.profiler"),Q_=Symbol.for("react.provider"),ek=Symbol.for("react.context"),tk=Symbol.for("react.forward_ref"),rk=Symbol.for("react.suspense"),nk=Symbol.for("react.memo"),ak=Symbol.for("react.lazy"),ip=Symbol.iterator;function sk(e){return e===null||typeof e!="object"?null:(e=ip&&e[ip]||e["@@iterator"],typeof e=="function"?e:null)}var Cg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ag=Object.assign,Ng={};function vi(e,t,r){this.props=e,this.context=t,this.refs=Ng,this.updater=r||Cg}vi.prototype.isReactComponent={};vi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};vi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Og(){}Og.prototype=vi.prototype;function dh(e,t,r){this.props=e,this.context=t,this.refs=Ng,this.updater=r||Cg}var hh=dh.prototype=new Og;hh.constructor=dh;Ag(hh,vi.prototype);hh.isPureReactComponent=!0;var op=Array.isArray,Rg=Object.prototype.hasOwnProperty,ph={current:null},Pg={key:!0,ref:!0,__self:!0,__source:!0};function Ig(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)Rg.call(t,n)&&!Pg.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:rl,type:e,key:s,ref:i,props:a,_owner:ph.current}}function ik(e,t){return{$$typeof:rl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mh(e){return typeof e=="object"&&e!==null&&e.$$typeof===rl}function ok(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var lp=/\/+/g;function Zu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ok(""+e.key):t.toString(36)}function rc(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case rl:case X_:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Zu(i,0):n,op(a)?(r="",e!=null&&(r=e.replace(lp,"$&/")+"/"),rc(a,t,r,"",function(c){return c})):a!=null&&(mh(a)&&(a=ik(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(lp,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",op(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Zu(s,o);i+=rc(s,t,r,l,a)}else if(l=sk(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Zu(s,o++),i+=rc(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function kl(e,t,r){if(e==null)return e;var n=[],a=0;return rc(e,n,"","",function(s){return t.call(r,s,a++)}),n}function lk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var vr={current:null},nc={transition:null},ck={ReactCurrentDispatcher:vr,ReactCurrentBatchConfig:nc,ReactCurrentOwner:ph};function Dg(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:kl,forEach:function(e,t,r){kl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return kl(e,function(){t++}),t},toArray:function(e){return kl(e,function(t){return t})||[]},only:function(e){if(!mh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ve.Component=vi;Ve.Fragment=Y_;Ve.Profiler=J_;Ve.PureComponent=dh;Ve.StrictMode=q_;Ve.Suspense=rk;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ck;Ve.act=Dg;Ve.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ag({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=ph.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Rg.call(t,l)&&!Pg.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:rl,type:e.type,key:a,ref:s,props:n,_owner:i}};Ve.createContext=function(e){return e={$$typeof:ek,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Q_,_context:e},e.Consumer=e};Ve.createElement=Ig;Ve.createFactory=function(e){var t=Ig.bind(null,e);return t.type=e,t};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(e){return{$$typeof:tk,render:e}};Ve.isValidElement=mh;Ve.lazy=function(e){return{$$typeof:ak,_payload:{_status:-1,_result:e},_init:lk}};Ve.memo=function(e,t){return{$$typeof:nk,type:e,compare:t===void 0?null:t}};Ve.startTransition=function(e){var t=nc.transition;nc.transition={};try{e()}finally{nc.transition=t}};Ve.unstable_act=Dg;Ve.useCallback=function(e,t){return vr.current.useCallback(e,t)};Ve.useContext=function(e){return vr.current.useContext(e)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(e){return vr.current.useDeferredValue(e)};Ve.useEffect=function(e,t){return vr.current.useEffect(e,t)};Ve.useId=function(){return vr.current.useId()};Ve.useImperativeHandle=function(e,t,r){return vr.current.useImperativeHandle(e,t,r)};Ve.useInsertionEffect=function(e,t){return vr.current.useInsertionEffect(e,t)};Ve.useLayoutEffect=function(e,t){return vr.current.useLayoutEffect(e,t)};Ve.useMemo=function(e,t){return vr.current.useMemo(e,t)};Ve.useReducer=function(e,t,r){return vr.current.useReducer(e,t,r)};Ve.useRef=function(e){return vr.current.useRef(e)};Ve.useState=function(e){return vr.current.useState(e)};Ve.useSyncExternalStore=function(e,t,r){return vr.current.useSyncExternalStore(e,t,r)};Ve.useTransition=function(){return vr.current.useTransition()};Ve.version="18.3.1";bg.exports=Ve;var B=bg.exports;const Ar=K_(B);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uk=B,fk=Symbol.for("react.element"),dk=Symbol.for("react.fragment"),hk=Object.prototype.hasOwnProperty,pk=uk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mk={key:!0,ref:!0,__self:!0,__source:!0};function Lg(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)hk.call(t,n)&&!mk.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:fk,type:e,key:s,ref:i,props:a,_owner:pk.current}}uu.Fragment=dk;uu.jsx=Lg;uu.jsxs=Lg;Sg.exports=uu;var m=Sg.exports,Fg={exports:{}},Fr={},jg={exports:{}},Mg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(oe,j){var fe=oe.length;oe.push(j);e:for(;0<fe;){var ye=fe-1>>>1,O=oe[ye];if(0<a(O,j))oe[ye]=j,oe[fe]=O,fe=ye;else break e}}function r(oe){return oe.length===0?null:oe[0]}function n(oe){if(oe.length===0)return null;var j=oe[0],fe=oe.pop();if(fe!==j){oe[0]=fe;e:for(var ye=0,O=oe.length,W=O>>>1;ye<W;){var U=2*(ye+1)-1,M=oe[U],Q=U+1,pe=oe[Q];if(0>a(M,fe))Q<O&&0>a(pe,M)?(oe[ye]=pe,oe[Q]=fe,ye=Q):(oe[ye]=M,oe[U]=fe,ye=U);else if(Q<O&&0>a(pe,fe))oe[ye]=pe,oe[Q]=fe,ye=Q;else break e}}return j}function a(oe,j){var fe=oe.sortIndex-j.sortIndex;return fe!==0?fe:oe.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,f=null,d=3,h=!1,v=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(oe){for(var j=r(c);j!==null;){if(j.callback===null)n(c);else if(j.startTime<=oe)n(c),j.sortIndex=j.expirationTime,t(l,j);else break;j=r(c)}}function k(oe){if(g=!1,p(oe),!v)if(r(l)!==null)v=!0,ge(T);else{var j=r(c);j!==null&&le(k,j.startTime-oe)}}function T(oe,j){v=!1,g&&(g=!1,w(D),D=-1),h=!0;var fe=d;try{for(p(j),f=r(l);f!==null&&(!(f.expirationTime>j)||oe&&!V());){var ye=f.callback;if(typeof ye=="function"){f.callback=null,d=f.priorityLevel;var O=ye(f.expirationTime<=j);j=e.unstable_now(),typeof O=="function"?f.callback=O:f===r(l)&&n(l),p(j)}else n(l);f=r(l)}if(f!==null)var W=!0;else{var U=r(c);U!==null&&le(k,U.startTime-j),W=!1}return W}finally{f=null,d=fe,h=!1}}var S=!1,x=null,D=-1,I=5,z=-1;function V(){return!(e.unstable_now()-z<I)}function F(){if(x!==null){var oe=e.unstable_now();z=oe;var j=!0;try{j=x(!0,oe)}finally{j?q():(S=!1,x=null)}}else S=!1}var q;if(typeof y=="function")q=function(){y(F)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,se=ae.port2;ae.port1.onmessage=F,q=function(){se.postMessage(null)}}else q=function(){_(F,0)};function ge(oe){x=oe,S||(S=!0,q())}function le(oe,j){D=_(function(){oe(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,ge(T))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(oe){switch(d){case 1:case 2:case 3:var j=3;break;default:j=d}var fe=d;d=j;try{return oe()}finally{d=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,j){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var fe=d;d=oe;try{return j()}finally{d=fe}},e.unstable_scheduleCallback=function(oe,j,fe){var ye=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ye+fe:ye):fe=ye,oe){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=fe+O,oe={id:u++,callback:j,priorityLevel:oe,startTime:fe,expirationTime:O,sortIndex:-1},fe>ye?(oe.sortIndex=fe,t(c,oe),r(l)===null&&oe===r(c)&&(g?(w(D),D=-1):g=!0,le(k,fe-ye))):(oe.sortIndex=O,t(l,oe),v||h||(v=!0,ge(T))),oe},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(oe){var j=d;return function(){var fe=d;d=j;try{return oe.apply(this,arguments)}finally{d=fe}}}})(Mg);jg.exports=Mg;var gk=jg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vk=B,Dr=gk;function he(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $g=new Set,Co={};function gs(e,t){oi(e,t),oi(e+"Capture",t)}function oi(e,t){for(Co[e]=t,e=0;e<t.length;e++)$g.add(t[e])}var Jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vf=Object.prototype.hasOwnProperty,yk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cp={},up={};function wk(e){return Vf.call(up,e)?!0:Vf.call(cp,e)?!1:yk.test(e)?up[e]=!0:(cp[e]=!0,!1)}function _k(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kk(e,t,r,n){if(t===null||typeof t>"u"||_k(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function yr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Kt[e]=new yr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Kt[t]=new yr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Kt[e]=new yr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Kt[e]=new yr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Kt[e]=new yr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Kt[e]=new yr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Kt[e]=new yr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Kt[e]=new yr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Kt[e]=new yr(e,5,!1,e.toLowerCase(),null,!1,!1)});var gh=/[\-:]([a-z])/g;function vh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gh,vh);Kt[t]=new yr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gh,vh);Kt[t]=new yr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gh,vh);Kt[t]=new yr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Kt[e]=new yr(e,1,!1,e.toLowerCase(),null,!1,!1)});Kt.xlinkHref=new yr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Kt[e]=new yr(e,1,!1,e.toLowerCase(),null,!0,!0)});function yh(e,t,r,n){var a=Kt.hasOwnProperty(t)?Kt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kk(t,r,a,n)&&(r=null),n||a===null?wk(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var aa=vk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xl=Symbol.for("react.element"),Fs=Symbol.for("react.portal"),js=Symbol.for("react.fragment"),wh=Symbol.for("react.strict_mode"),Wf=Symbol.for("react.profiler"),Ug=Symbol.for("react.provider"),Bg=Symbol.for("react.context"),_h=Symbol.for("react.forward_ref"),Hf=Symbol.for("react.suspense"),Gf=Symbol.for("react.suspense_list"),kh=Symbol.for("react.memo"),ua=Symbol.for("react.lazy"),zg=Symbol.for("react.offscreen"),fp=Symbol.iterator;function Ii(e){return e===null||typeof e!="object"?null:(e=fp&&e[fp]||e["@@iterator"],typeof e=="function"?e:null)}var ht=Object.assign,Xu;function Gi(e){if(Xu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Xu=t&&t[1]||""}return`
`+Xu+e}var Yu=!1;function qu(e,t){if(!e||Yu)return"";Yu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Yu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Gi(e):""}function xk(e){switch(e.tag){case 5:return Gi(e.type);case 16:return Gi("Lazy");case 13:return Gi("Suspense");case 19:return Gi("SuspenseList");case 0:case 2:case 15:return e=qu(e.type,!1),e;case 11:return e=qu(e.type.render,!1),e;case 1:return e=qu(e.type,!0),e;default:return""}}function Kf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case js:return"Fragment";case Fs:return"Portal";case Wf:return"Profiler";case wh:return"StrictMode";case Hf:return"Suspense";case Gf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Bg:return(e.displayName||"Context")+".Consumer";case Ug:return(e._context.displayName||"Context")+".Provider";case _h:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case kh:return t=e.displayName||null,t!==null?t:Kf(e.type)||"Memo";case ua:t=e._payload,e=e._init;try{return Kf(e(t))}catch{}}return null}function Ek(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kf(t);case 8:return t===wh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ra(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Vg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Tk(e){var t=Vg(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function El(e){e._valueTracker||(e._valueTracker=Tk(e))}function Wg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Vg(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function yc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Zf(e,t){var r=t.checked;return ht({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function dp(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ra(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Hg(e,t){t=t.checked,t!=null&&yh(e,"checked",t,!1)}function Xf(e,t){Hg(e,t);var r=Ra(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Yf(e,t.type,r):t.hasOwnProperty("defaultValue")&&Yf(e,t.type,Ra(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hp(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Yf(e,t,r){(t!=="number"||yc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ki=Array.isArray;function Ys(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ra(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function qf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(he(91));return ht({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function pp(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(he(92));if(Ki(r)){if(1<r.length)throw Error(he(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ra(r)}}function Gg(e,t){var r=Ra(t.value),n=Ra(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function mp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Kg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Kg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Tl,Zg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Tl=Tl||document.createElement("div"),Tl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Tl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ao(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ro={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sk=["Webkit","ms","Moz","O"];Object.keys(ro).forEach(function(e){Sk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ro[t]=ro[e]})});function Xg(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ro.hasOwnProperty(e)&&ro[e]?(""+t).trim():t+"px"}function Yg(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Xg(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var bk=ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qf(e,t){if(t){if(bk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(he(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(he(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(he(61))}if(t.style!=null&&typeof t.style!="object")throw Error(he(62))}}function ed(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var td=null;function xh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rd=null,qs=null,Js=null;function gp(e){if(e=sl(e)){if(typeof rd!="function")throw Error(he(280));var t=e.stateNode;t&&(t=mu(t),rd(e.stateNode,e.type,t))}}function qg(e){qs?Js?Js.push(e):Js=[e]:qs=e}function Jg(){if(qs){var e=qs,t=Js;if(Js=qs=null,gp(e),t)for(e=0;e<t.length;e++)gp(t[e])}}function Qg(e,t){return e(t)}function ev(){}var Ju=!1;function tv(e,t,r){if(Ju)return e(t,r);Ju=!0;try{return Qg(e,t,r)}finally{Ju=!1,(qs!==null||Js!==null)&&(ev(),Jg())}}function No(e,t){var r=e.stateNode;if(r===null)return null;var n=mu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(he(231,t,typeof r));return r}var nd=!1;if(Jn)try{var Di={};Object.defineProperty(Di,"passive",{get:function(){nd=!0}}),window.addEventListener("test",Di,Di),window.removeEventListener("test",Di,Di)}catch{nd=!1}function Ck(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var no=!1,wc=null,_c=!1,ad=null,Ak={onError:function(e){no=!0,wc=e}};function Nk(e,t,r,n,a,s,i,o,l){no=!1,wc=null,Ck.apply(Ak,arguments)}function Ok(e,t,r,n,a,s,i,o,l){if(Nk.apply(this,arguments),no){if(no){var c=wc;no=!1,wc=null}else throw Error(he(198));_c||(_c=!0,ad=c)}}function vs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function rv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vp(e){if(vs(e)!==e)throw Error(he(188))}function Rk(e){var t=e.alternate;if(!t){if(t=vs(e),t===null)throw Error(he(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return vp(a),e;if(s===n)return vp(a),t;s=s.sibling}throw Error(he(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(he(189))}}if(r.alternate!==n)throw Error(he(190))}if(r.tag!==3)throw Error(he(188));return r.stateNode.current===r?e:t}function nv(e){return e=Rk(e),e!==null?av(e):null}function av(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=av(e);if(t!==null)return t;e=e.sibling}return null}var sv=Dr.unstable_scheduleCallback,yp=Dr.unstable_cancelCallback,Pk=Dr.unstable_shouldYield,Ik=Dr.unstable_requestPaint,wt=Dr.unstable_now,Dk=Dr.unstable_getCurrentPriorityLevel,Eh=Dr.unstable_ImmediatePriority,iv=Dr.unstable_UserBlockingPriority,kc=Dr.unstable_NormalPriority,Lk=Dr.unstable_LowPriority,ov=Dr.unstable_IdlePriority,fu=null,Nn=null;function Fk(e){if(Nn&&typeof Nn.onCommitFiberRoot=="function")try{Nn.onCommitFiberRoot(fu,e,void 0,(e.current.flags&128)===128)}catch{}}var hn=Math.clz32?Math.clz32:$k,jk=Math.log,Mk=Math.LN2;function $k(e){return e>>>=0,e===0?32:31-(jk(e)/Mk|0)|0}var Sl=64,bl=4194304;function Zi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function xc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Zi(o):(s&=i,s!==0&&(n=Zi(s)))}else i=r&~a,i!==0?n=Zi(i):s!==0&&(n=Zi(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-hn(t),a=1<<r,n|=e[r],t&=~a;return n}function Uk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bk(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-hn(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=Uk(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function sd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function lv(){var e=Sl;return Sl<<=1,!(Sl&4194240)&&(Sl=64),e}function Qu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function nl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-hn(t),e[t]=r}function zk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-hn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function Th(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-hn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Ye=0;function cv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var uv,Sh,fv,dv,hv,id=!1,Cl=[],xa=null,Ea=null,Ta=null,Oo=new Map,Ro=new Map,da=[],Vk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wp(e,t){switch(e){case"focusin":case"focusout":xa=null;break;case"dragenter":case"dragleave":Ea=null;break;case"mouseover":case"mouseout":Ta=null;break;case"pointerover":case"pointerout":Oo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ro.delete(t.pointerId)}}function Li(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=sl(t),t!==null&&Sh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Wk(e,t,r,n,a){switch(t){case"focusin":return xa=Li(xa,e,t,r,n,a),!0;case"dragenter":return Ea=Li(Ea,e,t,r,n,a),!0;case"mouseover":return Ta=Li(Ta,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Oo.set(s,Li(Oo.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Ro.set(s,Li(Ro.get(s)||null,e,t,r,n,a)),!0}return!1}function pv(e){var t=qa(e.target);if(t!==null){var r=vs(t);if(r!==null){if(t=r.tag,t===13){if(t=rv(r),t!==null){e.blockedOn=t,hv(e.priority,function(){fv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ac(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=od(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);td=n,r.target.dispatchEvent(n),td=null}else return t=sl(r),t!==null&&Sh(t),e.blockedOn=r,!1;t.shift()}return!0}function _p(e,t,r){ac(e)&&r.delete(t)}function Hk(){id=!1,xa!==null&&ac(xa)&&(xa=null),Ea!==null&&ac(Ea)&&(Ea=null),Ta!==null&&ac(Ta)&&(Ta=null),Oo.forEach(_p),Ro.forEach(_p)}function Fi(e,t){e.blockedOn===t&&(e.blockedOn=null,id||(id=!0,Dr.unstable_scheduleCallback(Dr.unstable_NormalPriority,Hk)))}function Po(e){function t(a){return Fi(a,e)}if(0<Cl.length){Fi(Cl[0],e);for(var r=1;r<Cl.length;r++){var n=Cl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(xa!==null&&Fi(xa,e),Ea!==null&&Fi(Ea,e),Ta!==null&&Fi(Ta,e),Oo.forEach(t),Ro.forEach(t),r=0;r<da.length;r++)n=da[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<da.length&&(r=da[0],r.blockedOn===null);)pv(r),r.blockedOn===null&&da.shift()}var Qs=aa.ReactCurrentBatchConfig,Ec=!0;function Gk(e,t,r,n){var a=Ye,s=Qs.transition;Qs.transition=null;try{Ye=1,bh(e,t,r,n)}finally{Ye=a,Qs.transition=s}}function Kk(e,t,r,n){var a=Ye,s=Qs.transition;Qs.transition=null;try{Ye=4,bh(e,t,r,n)}finally{Ye=a,Qs.transition=s}}function bh(e,t,r,n){if(Ec){var a=od(e,t,r,n);if(a===null)uf(e,t,n,Tc,r),wp(e,n);else if(Wk(a,e,t,r,n))n.stopPropagation();else if(wp(e,n),t&4&&-1<Vk.indexOf(e)){for(;a!==null;){var s=sl(a);if(s!==null&&uv(s),s=od(e,t,r,n),s===null&&uf(e,t,n,Tc,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else uf(e,t,n,null,r)}}var Tc=null;function od(e,t,r,n){if(Tc=null,e=xh(n),e=qa(e),e!==null)if(t=vs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=rv(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Tc=e,null}function mv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Dk()){case Eh:return 1;case iv:return 4;case kc:case Lk:return 16;case ov:return 536870912;default:return 16}default:return 16}}var ya=null,Ch=null,sc=null;function gv(){if(sc)return sc;var e,t=Ch,r=t.length,n,a="value"in ya?ya.value:ya.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return sc=a.slice(e,1<n?1-n:void 0)}function ic(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Al(){return!0}function kp(){return!1}function jr(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Al:kp,this.isPropagationStopped=kp,this}return ht(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Al)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Al)},persist:function(){},isPersistent:Al}),t}var yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ah=jr(yi),al=ht({},yi,{view:0,detail:0}),Zk=jr(al),ef,tf,ji,du=ht({},al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ji&&(ji&&e.type==="mousemove"?(ef=e.screenX-ji.screenX,tf=e.screenY-ji.screenY):tf=ef=0,ji=e),ef)},movementY:function(e){return"movementY"in e?e.movementY:tf}}),xp=jr(du),Xk=ht({},du,{dataTransfer:0}),Yk=jr(Xk),qk=ht({},al,{relatedTarget:0}),rf=jr(qk),Jk=ht({},yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Qk=jr(Jk),ex=ht({},yi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),tx=jr(ex),rx=ht({},yi,{data:0}),Ep=jr(rx),nx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ax={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ix(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=sx[e])?!!t[e]:!1}function Nh(){return ix}var ox=ht({},al,{key:function(e){if(e.key){var t=nx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ic(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ax[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nh,charCode:function(e){return e.type==="keypress"?ic(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ic(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),lx=jr(ox),cx=ht({},du,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tp=jr(cx),ux=ht({},al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nh}),fx=jr(ux),dx=ht({},yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),hx=jr(dx),px=ht({},du,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),mx=jr(px),gx=[9,13,27,32],Oh=Jn&&"CompositionEvent"in window,ao=null;Jn&&"documentMode"in document&&(ao=document.documentMode);var vx=Jn&&"TextEvent"in window&&!ao,vv=Jn&&(!Oh||ao&&8<ao&&11>=ao),Sp=" ",bp=!1;function yv(e,t){switch(e){case"keyup":return gx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ms=!1;function yx(e,t){switch(e){case"compositionend":return wv(t);case"keypress":return t.which!==32?null:(bp=!0,Sp);case"textInput":return e=t.data,e===Sp&&bp?null:e;default:return null}}function wx(e,t){if(Ms)return e==="compositionend"||!Oh&&yv(e,t)?(e=gv(),sc=Ch=ya=null,Ms=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return vv&&t.locale!=="ko"?null:t.data;default:return null}}var _x={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!_x[e.type]:t==="textarea"}function _v(e,t,r,n){qg(n),t=Sc(t,"onChange"),0<t.length&&(r=new Ah("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var so=null,Io=null;function kx(e){Rv(e,0)}function hu(e){var t=Bs(e);if(Wg(t))return e}function xx(e,t){if(e==="change")return t}var kv=!1;if(Jn){var nf;if(Jn){var af="oninput"in document;if(!af){var Ap=document.createElement("div");Ap.setAttribute("oninput","return;"),af=typeof Ap.oninput=="function"}nf=af}else nf=!1;kv=nf&&(!document.documentMode||9<document.documentMode)}function Np(){so&&(so.detachEvent("onpropertychange",xv),Io=so=null)}function xv(e){if(e.propertyName==="value"&&hu(Io)){var t=[];_v(t,Io,e,xh(e)),tv(kx,t)}}function Ex(e,t,r){e==="focusin"?(Np(),so=t,Io=r,so.attachEvent("onpropertychange",xv)):e==="focusout"&&Np()}function Tx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hu(Io)}function Sx(e,t){if(e==="click")return hu(t)}function bx(e,t){if(e==="input"||e==="change")return hu(t)}function Cx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var gn=typeof Object.is=="function"?Object.is:Cx;function Do(e,t){if(gn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Vf.call(t,a)||!gn(e[a],t[a]))return!1}return!0}function Op(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Rp(e,t){var r=Op(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Op(r)}}function Ev(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ev(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Tv(){for(var e=window,t=yc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=yc(e.document)}return t}function Rh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ax(e){var t=Tv(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ev(r.ownerDocument.documentElement,r)){if(n!==null&&Rh(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Rp(r,s);var i=Rp(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Nx=Jn&&"documentMode"in document&&11>=document.documentMode,$s=null,ld=null,io=null,cd=!1;function Pp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;cd||$s==null||$s!==yc(n)||(n=$s,"selectionStart"in n&&Rh(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),io&&Do(io,n)||(io=n,n=Sc(ld,"onSelect"),0<n.length&&(t=new Ah("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=$s)))}function Nl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Us={animationend:Nl("Animation","AnimationEnd"),animationiteration:Nl("Animation","AnimationIteration"),animationstart:Nl("Animation","AnimationStart"),transitionend:Nl("Transition","TransitionEnd")},sf={},Sv={};Jn&&(Sv=document.createElement("div").style,"AnimationEvent"in window||(delete Us.animationend.animation,delete Us.animationiteration.animation,delete Us.animationstart.animation),"TransitionEvent"in window||delete Us.transitionend.transition);function pu(e){if(sf[e])return sf[e];if(!Us[e])return e;var t=Us[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Sv)return sf[e]=t[r];return e}var bv=pu("animationend"),Cv=pu("animationiteration"),Av=pu("animationstart"),Nv=pu("transitionend"),Ov=new Map,Ip="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function La(e,t){Ov.set(e,t),gs(t,[e])}for(var of=0;of<Ip.length;of++){var lf=Ip[of],Ox=lf.toLowerCase(),Rx=lf[0].toUpperCase()+lf.slice(1);La(Ox,"on"+Rx)}La(bv,"onAnimationEnd");La(Cv,"onAnimationIteration");La(Av,"onAnimationStart");La("dblclick","onDoubleClick");La("focusin","onFocus");La("focusout","onBlur");La(Nv,"onTransitionEnd");oi("onMouseEnter",["mouseout","mouseover"]);oi("onMouseLeave",["mouseout","mouseover"]);oi("onPointerEnter",["pointerout","pointerover"]);oi("onPointerLeave",["pointerout","pointerover"]);gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Px=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xi));function Dp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Ok(n,t,void 0,e),e.currentTarget=null}function Rv(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;Dp(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;Dp(a,o,c),s=l}}}if(_c)throw e=ad,_c=!1,ad=null,e}function nt(e,t){var r=t[pd];r===void 0&&(r=t[pd]=new Set);var n=e+"__bubble";r.has(n)||(Pv(t,e,2,!1),r.add(n))}function cf(e,t,r){var n=0;t&&(n|=4),Pv(r,e,n,t)}var Ol="_reactListening"+Math.random().toString(36).slice(2);function Lo(e){if(!e[Ol]){e[Ol]=!0,$g.forEach(function(r){r!=="selectionchange"&&(Px.has(r)||cf(r,!1,e),cf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ol]||(t[Ol]=!0,cf("selectionchange",!1,t))}}function Pv(e,t,r,n){switch(mv(t)){case 1:var a=Gk;break;case 4:a=Kk;break;default:a=bh}r=a.bind(null,t,r,e),a=void 0,!nd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function uf(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=qa(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}tv(function(){var c=s,u=xh(r),f=[];e:{var d=Ov.get(e);if(d!==void 0){var h=Ah,v=e;switch(e){case"keypress":if(ic(r)===0)break e;case"keydown":case"keyup":h=lx;break;case"focusin":v="focus",h=rf;break;case"focusout":v="blur",h=rf;break;case"beforeblur":case"afterblur":h=rf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=xp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Yk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=fx;break;case bv:case Cv:case Av:h=Qk;break;case Nv:h=hx;break;case"scroll":h=Zk;break;case"wheel":h=mx;break;case"copy":case"cut":case"paste":h=tx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Tp}var g=(t&4)!==0,_=!g&&e==="scroll",w=g?d!==null?d+"Capture":null:d;g=[];for(var y=c,p;y!==null;){p=y;var k=p.stateNode;if(p.tag===5&&k!==null&&(p=k,w!==null&&(k=No(y,w),k!=null&&g.push(Fo(y,k,p)))),_)break;y=y.return}0<g.length&&(d=new h(d,v,null,r,u),f.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&r!==td&&(v=r.relatedTarget||r.fromElement)&&(qa(v)||v[Qn]))break e;if((h||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=c,v=v?qa(v):null,v!==null&&(_=vs(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=c),h!==v)){if(g=xp,k="onMouseLeave",w="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=Tp,k="onPointerLeave",w="onPointerEnter",y="pointer"),_=h==null?d:Bs(h),p=v==null?d:Bs(v),d=new g(k,y+"leave",h,r,u),d.target=_,d.relatedTarget=p,k=null,qa(u)===c&&(g=new g(w,y+"enter",v,r,u),g.target=p,g.relatedTarget=_,k=g),_=k,h&&v)t:{for(g=h,w=v,y=0,p=g;p;p=Ss(p))y++;for(p=0,k=w;k;k=Ss(k))p++;for(;0<y-p;)g=Ss(g),y--;for(;0<p-y;)w=Ss(w),p--;for(;y--;){if(g===w||w!==null&&g===w.alternate)break t;g=Ss(g),w=Ss(w)}g=null}else g=null;h!==null&&Lp(f,d,h,g,!1),v!==null&&_!==null&&Lp(f,_,v,g,!0)}}e:{if(d=c?Bs(c):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var T=xx;else if(Cp(d))if(kv)T=bx;else{T=Tx;var S=Ex}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(T=Sx);if(T&&(T=T(e,c))){_v(f,T,r,u);break e}S&&S(e,d,c),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&Yf(d,"number",d.value)}switch(S=c?Bs(c):window,e){case"focusin":(Cp(S)||S.contentEditable==="true")&&($s=S,ld=c,io=null);break;case"focusout":io=ld=$s=null;break;case"mousedown":cd=!0;break;case"contextmenu":case"mouseup":case"dragend":cd=!1,Pp(f,r,u);break;case"selectionchange":if(Nx)break;case"keydown":case"keyup":Pp(f,r,u)}var x;if(Oh)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Ms?yv(e,r)&&(D="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(D="onCompositionStart");D&&(vv&&r.locale!=="ko"&&(Ms||D!=="onCompositionStart"?D==="onCompositionEnd"&&Ms&&(x=gv()):(ya=u,Ch="value"in ya?ya.value:ya.textContent,Ms=!0)),S=Sc(c,D),0<S.length&&(D=new Ep(D,e,null,r,u),f.push({event:D,listeners:S}),x?D.data=x:(x=wv(r),x!==null&&(D.data=x)))),(x=vx?yx(e,r):wx(e,r))&&(c=Sc(c,"onBeforeInput"),0<c.length&&(u=new Ep("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=x))}Rv(f,t)})}function Fo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Sc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=No(e,r),s!=null&&n.unshift(Fo(e,s,a)),s=No(e,t),s!=null&&n.push(Fo(e,s,a))),e=e.return}return n}function Ss(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Lp(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=No(r,s),l!=null&&i.unshift(Fo(r,l,o))):a||(l=No(r,s),l!=null&&i.push(Fo(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Ix=/\r\n?/g,Dx=/\u0000|\uFFFD/g;function Fp(e){return(typeof e=="string"?e:""+e).replace(Ix,`
`).replace(Dx,"")}function Rl(e,t,r){if(t=Fp(t),Fp(e)!==t&&r)throw Error(he(425))}function bc(){}var ud=null,fd=null;function dd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hd=typeof setTimeout=="function"?setTimeout:void 0,Lx=typeof clearTimeout=="function"?clearTimeout:void 0,jp=typeof Promise=="function"?Promise:void 0,Fx=typeof queueMicrotask=="function"?queueMicrotask:typeof jp<"u"?function(e){return jp.resolve(null).then(e).catch(jx)}:hd;function jx(e){setTimeout(function(){throw e})}function ff(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Po(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Po(t)}function Sa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Mp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var wi=Math.random().toString(36).slice(2),Cn="__reactFiber$"+wi,jo="__reactProps$"+wi,Qn="__reactContainer$"+wi,pd="__reactEvents$"+wi,Mx="__reactListeners$"+wi,$x="__reactHandles$"+wi;function qa(e){var t=e[Cn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Qn]||r[Cn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Mp(e);e!==null;){if(r=e[Cn])return r;e=Mp(e)}return t}e=r,r=e.parentNode}return null}function sl(e){return e=e[Cn]||e[Qn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Bs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(he(33))}function mu(e){return e[jo]||null}var md=[],zs=-1;function Fa(e){return{current:e}}function at(e){0>zs||(e.current=md[zs],md[zs]=null,zs--)}function Qe(e,t){zs++,md[zs]=e.current,e.current=t}var Pa={},ar=Fa(Pa),Sr=Fa(!1),is=Pa;function li(e,t){var r=e.type.contextTypes;if(!r)return Pa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function br(e){return e=e.childContextTypes,e!=null}function Cc(){at(Sr),at(ar)}function $p(e,t,r){if(ar.current!==Pa)throw Error(he(168));Qe(ar,t),Qe(Sr,r)}function Iv(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(he(108,Ek(e)||"Unknown",a));return ht({},r,n)}function Ac(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pa,is=ar.current,Qe(ar,e),Qe(Sr,Sr.current),!0}function Up(e,t,r){var n=e.stateNode;if(!n)throw Error(he(169));r?(e=Iv(e,t,is),n.__reactInternalMemoizedMergedChildContext=e,at(Sr),at(ar),Qe(ar,e)):at(Sr),Qe(Sr,r)}var Vn=null,gu=!1,df=!1;function Dv(e){Vn===null?Vn=[e]:Vn.push(e)}function Ux(e){gu=!0,Dv(e)}function ja(){if(!df&&Vn!==null){df=!0;var e=0,t=Ye;try{var r=Vn;for(Ye=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Vn=null,gu=!1}catch(a){throw Vn!==null&&(Vn=Vn.slice(e+1)),sv(Eh,ja),a}finally{Ye=t,df=!1}}return null}var Vs=[],Ws=0,Nc=null,Oc=0,Br=[],zr=0,os=null,Wn=1,Hn="";function Ga(e,t){Vs[Ws++]=Oc,Vs[Ws++]=Nc,Nc=e,Oc=t}function Lv(e,t,r){Br[zr++]=Wn,Br[zr++]=Hn,Br[zr++]=os,os=e;var n=Wn;e=Hn;var a=32-hn(n)-1;n&=~(1<<a),r+=1;var s=32-hn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Wn=1<<32-hn(t)+a|r<<a|n,Hn=s+e}else Wn=1<<s|r<<a|n,Hn=e}function Ph(e){e.return!==null&&(Ga(e,1),Lv(e,1,0))}function Ih(e){for(;e===Nc;)Nc=Vs[--Ws],Vs[Ws]=null,Oc=Vs[--Ws],Vs[Ws]=null;for(;e===os;)os=Br[--zr],Br[zr]=null,Hn=Br[--zr],Br[zr]=null,Wn=Br[--zr],Br[zr]=null}var Ir=null,Pr=null,it=!1,on=null;function Fv(e,t){var r=Wr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Bp(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ir=e,Pr=Sa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ir=e,Pr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=os!==null?{id:Wn,overflow:Hn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Wr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ir=e,Pr=null,!0):!1;default:return!1}}function gd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vd(e){if(it){var t=Pr;if(t){var r=t;if(!Bp(e,t)){if(gd(e))throw Error(he(418));t=Sa(r.nextSibling);var n=Ir;t&&Bp(e,t)?Fv(n,r):(e.flags=e.flags&-4097|2,it=!1,Ir=e)}}else{if(gd(e))throw Error(he(418));e.flags=e.flags&-4097|2,it=!1,Ir=e}}}function zp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ir=e}function Pl(e){if(e!==Ir)return!1;if(!it)return zp(e),it=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!dd(e.type,e.memoizedProps)),t&&(t=Pr)){if(gd(e))throw jv(),Error(he(418));for(;t;)Fv(e,t),t=Sa(t.nextSibling)}if(zp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(he(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Pr=Sa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Pr=null}}else Pr=Ir?Sa(e.stateNode.nextSibling):null;return!0}function jv(){for(var e=Pr;e;)e=Sa(e.nextSibling)}function ci(){Pr=Ir=null,it=!1}function Dh(e){on===null?on=[e]:on.push(e)}var Bx=aa.ReactCurrentBatchConfig;function Mi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(he(309));var n=r.stateNode}if(!n)throw Error(he(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(he(284));if(!r._owner)throw Error(he(290,e))}return e}function Il(e,t){throw e=Object.prototype.toString.call(t),Error(he(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vp(e){var t=e._init;return t(e._payload)}function Mv(e){function t(w,y){if(e){var p=w.deletions;p===null?(w.deletions=[y],w.flags|=16):p.push(y)}}function r(w,y){if(!e)return null;for(;y!==null;)t(w,y),y=y.sibling;return null}function n(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function a(w,y){return w=Na(w,y),w.index=0,w.sibling=null,w}function s(w,y,p){return w.index=p,e?(p=w.alternate,p!==null?(p=p.index,p<y?(w.flags|=2,y):p):(w.flags|=2,y)):(w.flags|=1048576,y)}function i(w){return e&&w.alternate===null&&(w.flags|=2),w}function o(w,y,p,k){return y===null||y.tag!==6?(y=wf(p,w.mode,k),y.return=w,y):(y=a(y,p),y.return=w,y)}function l(w,y,p,k){var T=p.type;return T===js?u(w,y,p.props.children,k,p.key):y!==null&&(y.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ua&&Vp(T)===y.type)?(k=a(y,p.props),k.ref=Mi(w,y,p),k.return=w,k):(k=hc(p.type,p.key,p.props,null,w.mode,k),k.ref=Mi(w,y,p),k.return=w,k)}function c(w,y,p,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==p.containerInfo||y.stateNode.implementation!==p.implementation?(y=_f(p,w.mode,k),y.return=w,y):(y=a(y,p.children||[]),y.return=w,y)}function u(w,y,p,k,T){return y===null||y.tag!==7?(y=ns(p,w.mode,k,T),y.return=w,y):(y=a(y,p),y.return=w,y)}function f(w,y,p){if(typeof y=="string"&&y!==""||typeof y=="number")return y=wf(""+y,w.mode,p),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case xl:return p=hc(y.type,y.key,y.props,null,w.mode,p),p.ref=Mi(w,null,y),p.return=w,p;case Fs:return y=_f(y,w.mode,p),y.return=w,y;case ua:var k=y._init;return f(w,k(y._payload),p)}if(Ki(y)||Ii(y))return y=ns(y,w.mode,p,null),y.return=w,y;Il(w,y)}return null}function d(w,y,p,k){var T=y!==null?y.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return T!==null?null:o(w,y,""+p,k);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case xl:return p.key===T?l(w,y,p,k):null;case Fs:return p.key===T?c(w,y,p,k):null;case ua:return T=p._init,d(w,y,T(p._payload),k)}if(Ki(p)||Ii(p))return T!==null?null:u(w,y,p,k,null);Il(w,p)}return null}function h(w,y,p,k,T){if(typeof k=="string"&&k!==""||typeof k=="number")return w=w.get(p)||null,o(y,w,""+k,T);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case xl:return w=w.get(k.key===null?p:k.key)||null,l(y,w,k,T);case Fs:return w=w.get(k.key===null?p:k.key)||null,c(y,w,k,T);case ua:var S=k._init;return h(w,y,p,S(k._payload),T)}if(Ki(k)||Ii(k))return w=w.get(p)||null,u(y,w,k,T,null);Il(y,k)}return null}function v(w,y,p,k){for(var T=null,S=null,x=y,D=y=0,I=null;x!==null&&D<p.length;D++){x.index>D?(I=x,x=null):I=x.sibling;var z=d(w,x,p[D],k);if(z===null){x===null&&(x=I);break}e&&x&&z.alternate===null&&t(w,x),y=s(z,y,D),S===null?T=z:S.sibling=z,S=z,x=I}if(D===p.length)return r(w,x),it&&Ga(w,D),T;if(x===null){for(;D<p.length;D++)x=f(w,p[D],k),x!==null&&(y=s(x,y,D),S===null?T=x:S.sibling=x,S=x);return it&&Ga(w,D),T}for(x=n(w,x);D<p.length;D++)I=h(x,w,D,p[D],k),I!==null&&(e&&I.alternate!==null&&x.delete(I.key===null?D:I.key),y=s(I,y,D),S===null?T=I:S.sibling=I,S=I);return e&&x.forEach(function(V){return t(w,V)}),it&&Ga(w,D),T}function g(w,y,p,k){var T=Ii(p);if(typeof T!="function")throw Error(he(150));if(p=T.call(p),p==null)throw Error(he(151));for(var S=T=null,x=y,D=y=0,I=null,z=p.next();x!==null&&!z.done;D++,z=p.next()){x.index>D?(I=x,x=null):I=x.sibling;var V=d(w,x,z.value,k);if(V===null){x===null&&(x=I);break}e&&x&&V.alternate===null&&t(w,x),y=s(V,y,D),S===null?T=V:S.sibling=V,S=V,x=I}if(z.done)return r(w,x),it&&Ga(w,D),T;if(x===null){for(;!z.done;D++,z=p.next())z=f(w,z.value,k),z!==null&&(y=s(z,y,D),S===null?T=z:S.sibling=z,S=z);return it&&Ga(w,D),T}for(x=n(w,x);!z.done;D++,z=p.next())z=h(x,w,D,z.value,k),z!==null&&(e&&z.alternate!==null&&x.delete(z.key===null?D:z.key),y=s(z,y,D),S===null?T=z:S.sibling=z,S=z);return e&&x.forEach(function(F){return t(w,F)}),it&&Ga(w,D),T}function _(w,y,p,k){if(typeof p=="object"&&p!==null&&p.type===js&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case xl:e:{for(var T=p.key,S=y;S!==null;){if(S.key===T){if(T=p.type,T===js){if(S.tag===7){r(w,S.sibling),y=a(S,p.props.children),y.return=w,w=y;break e}}else if(S.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ua&&Vp(T)===S.type){r(w,S.sibling),y=a(S,p.props),y.ref=Mi(w,S,p),y.return=w,w=y;break e}r(w,S);break}else t(w,S);S=S.sibling}p.type===js?(y=ns(p.props.children,w.mode,k,p.key),y.return=w,w=y):(k=hc(p.type,p.key,p.props,null,w.mode,k),k.ref=Mi(w,y,p),k.return=w,w=k)}return i(w);case Fs:e:{for(S=p.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===p.containerInfo&&y.stateNode.implementation===p.implementation){r(w,y.sibling),y=a(y,p.children||[]),y.return=w,w=y;break e}else{r(w,y);break}else t(w,y);y=y.sibling}y=_f(p,w.mode,k),y.return=w,w=y}return i(w);case ua:return S=p._init,_(w,y,S(p._payload),k)}if(Ki(p))return v(w,y,p,k);if(Ii(p))return g(w,y,p,k);Il(w,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,y!==null&&y.tag===6?(r(w,y.sibling),y=a(y,p),y.return=w,w=y):(r(w,y),y=wf(p,w.mode,k),y.return=w,w=y),i(w)):r(w,y)}return _}var ui=Mv(!0),$v=Mv(!1),Rc=Fa(null),Pc=null,Hs=null,Lh=null;function Fh(){Lh=Hs=Pc=null}function jh(e){var t=Rc.current;at(Rc),e._currentValue=t}function yd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ei(e,t){Pc=e,Lh=Hs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Tr=!0),e.firstContext=null)}function Kr(e){var t=e._currentValue;if(Lh!==e)if(e={context:e,memoizedValue:t,next:null},Hs===null){if(Pc===null)throw Error(he(308));Hs=e,Pc.dependencies={lanes:0,firstContext:e}}else Hs=Hs.next=e;return t}var Ja=null;function Mh(e){Ja===null?Ja=[e]:Ja.push(e)}function Uv(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Mh(t)):(r.next=a.next,a.next=r),t.interleaved=r,ea(e,n)}function ea(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var fa=!1;function $h(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Zn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ba(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ke&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ea(e,r)}return a=n.interleaved,a===null?(t.next=t,Mh(n)):(t.next=a.next,a.next=t),n.interleaved=t,ea(e,r)}function oc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Th(e,r)}}function Wp(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ic(e,t,r,n){var a=e.updateQueue;fa=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=a.baseState;i=0,u=c=l=null,o=s;do{var d=o.lane,h=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,g=o;switch(d=t,h=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(h,f,d);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,d=typeof v=="function"?v.call(h,f,d):v,d==null)break e;f=ht({},f,d);break e;case 2:fa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else h={eventTime:h,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=h,l=f):u=u.next=h,i|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(!0);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);cs|=i,e.lanes=i,e.memoizedState=f}}function Hp(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(he(191,a));a.call(n)}}}var il={},On=Fa(il),Mo=Fa(il),$o=Fa(il);function Qa(e){if(e===il)throw Error(he(174));return e}function Uh(e,t){switch(Qe($o,t),Qe(Mo,e),Qe(On,il),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Jf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Jf(t,e)}at(On),Qe(On,t)}function fi(){at(On),at(Mo),at($o)}function zv(e){Qa($o.current);var t=Qa(On.current),r=Jf(t,e.type);t!==r&&(Qe(Mo,e),Qe(On,r))}function Bh(e){Mo.current===e&&(at(On),at(Mo))}var ft=Fa(0);function Dc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var hf=[];function zh(){for(var e=0;e<hf.length;e++)hf[e]._workInProgressVersionPrimary=null;hf.length=0}var lc=aa.ReactCurrentDispatcher,pf=aa.ReactCurrentBatchConfig,ls=0,dt=null,Rt=null,Mt=null,Lc=!1,oo=!1,Uo=0,zx=0;function Yt(){throw Error(he(321))}function Vh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!gn(e[r],t[r]))return!1;return!0}function Wh(e,t,r,n,a,s){if(ls=s,dt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,lc.current=e===null||e.memoizedState===null?Gx:Kx,e=r(n,a),oo){s=0;do{if(oo=!1,Uo=0,25<=s)throw Error(he(301));s+=1,Mt=Rt=null,t.updateQueue=null,lc.current=Zx,e=r(n,a)}while(oo)}if(lc.current=Fc,t=Rt!==null&&Rt.next!==null,ls=0,Mt=Rt=dt=null,Lc=!1,t)throw Error(he(300));return e}function Hh(){var e=Uo!==0;return Uo=0,e}function En(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?dt.memoizedState=Mt=e:Mt=Mt.next=e,Mt}function Zr(){if(Rt===null){var e=dt.alternate;e=e!==null?e.memoizedState:null}else e=Rt.next;var t=Mt===null?dt.memoizedState:Mt.next;if(t!==null)Mt=t,Rt=e;else{if(e===null)throw Error(he(310));Rt=e,e={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},Mt===null?dt.memoizedState=Mt=e:Mt=Mt.next=e}return Mt}function Bo(e,t){return typeof t=="function"?t(e):t}function mf(e){var t=Zr(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=Rt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var u=c.lane;if((ls&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,i=n):l=l.next=f,dt.lanes|=u,cs|=u}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,gn(n,t.memoizedState)||(Tr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,dt.lanes|=s,cs|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function gf(e){var t=Zr(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);gn(s,t.memoizedState)||(Tr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Vv(){}function Wv(e,t){var r=dt,n=Zr(),a=t(),s=!gn(n.memoizedState,a);if(s&&(n.memoizedState=a,Tr=!0),n=n.queue,Gh(Kv.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Mt!==null&&Mt.memoizedState.tag&1){if(r.flags|=2048,zo(9,Gv.bind(null,r,n,a,t),void 0,null),$t===null)throw Error(he(349));ls&30||Hv(r,t,a)}return a}function Hv(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Gv(e,t,r,n){t.value=r,t.getSnapshot=n,Zv(t)&&Xv(e)}function Kv(e,t,r){return r(function(){Zv(t)&&Xv(e)})}function Zv(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!gn(e,r)}catch{return!0}}function Xv(e){var t=ea(e,1);t!==null&&pn(t,e,1,-1)}function Gp(e){var t=En();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bo,lastRenderedState:e},t.queue=e,e=e.dispatch=Hx.bind(null,dt,e),[t.memoizedState,e]}function zo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Yv(){return Zr().memoizedState}function cc(e,t,r,n){var a=En();dt.flags|=e,a.memoizedState=zo(1|t,r,void 0,n===void 0?null:n)}function vu(e,t,r,n){var a=Zr();n=n===void 0?null:n;var s=void 0;if(Rt!==null){var i=Rt.memoizedState;if(s=i.destroy,n!==null&&Vh(n,i.deps)){a.memoizedState=zo(t,r,s,n);return}}dt.flags|=e,a.memoizedState=zo(1|t,r,s,n)}function Kp(e,t){return cc(8390656,8,e,t)}function Gh(e,t){return vu(2048,8,e,t)}function qv(e,t){return vu(4,2,e,t)}function Jv(e,t){return vu(4,4,e,t)}function Qv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ey(e,t,r){return r=r!=null?r.concat([e]):null,vu(4,4,Qv.bind(null,t,e),r)}function Kh(){}function ty(e,t){var r=Zr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Vh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ry(e,t){var r=Zr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Vh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function ny(e,t,r){return ls&21?(gn(r,t)||(r=lv(),dt.lanes|=r,cs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Tr=!0),e.memoizedState=r)}function Vx(e,t){var r=Ye;Ye=r!==0&&4>r?r:4,e(!0);var n=pf.transition;pf.transition={};try{e(!1),t()}finally{Ye=r,pf.transition=n}}function ay(){return Zr().memoizedState}function Wx(e,t,r){var n=Aa(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},sy(e))iy(t,r);else if(r=Uv(e,t,r,n),r!==null){var a=pr();pn(r,e,n,a),oy(r,t,n)}}function Hx(e,t,r){var n=Aa(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(sy(e))iy(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,gn(o,i)){var l=t.interleaved;l===null?(a.next=a,Mh(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=Uv(e,t,a,n),r!==null&&(a=pr(),pn(r,e,n,a),oy(r,t,n))}}function sy(e){var t=e.alternate;return e===dt||t!==null&&t===dt}function iy(e,t){oo=Lc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function oy(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Th(e,r)}}var Fc={readContext:Kr,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},Gx={readContext:Kr,useCallback:function(e,t){return En().memoizedState=[e,t===void 0?null:t],e},useContext:Kr,useEffect:Kp,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,cc(4194308,4,Qv.bind(null,t,e),r)},useLayoutEffect:function(e,t){return cc(4194308,4,e,t)},useInsertionEffect:function(e,t){return cc(4,2,e,t)},useMemo:function(e,t){var r=En();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=En();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Wx.bind(null,dt,e),[n.memoizedState,e]},useRef:function(e){var t=En();return e={current:e},t.memoizedState=e},useState:Gp,useDebugValue:Kh,useDeferredValue:function(e){return En().memoizedState=e},useTransition:function(){var e=Gp(!1),t=e[0];return e=Vx.bind(null,e[1]),En().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=dt,a=En();if(it){if(r===void 0)throw Error(he(407));r=r()}else{if(r=t(),$t===null)throw Error(he(349));ls&30||Hv(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Kp(Kv.bind(null,n,s,e),[e]),n.flags|=2048,zo(9,Gv.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=En(),t=$t.identifierPrefix;if(it){var r=Hn,n=Wn;r=(n&~(1<<32-hn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Uo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=zx++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Kx={readContext:Kr,useCallback:ty,useContext:Kr,useEffect:Gh,useImperativeHandle:ey,useInsertionEffect:qv,useLayoutEffect:Jv,useMemo:ry,useReducer:mf,useRef:Yv,useState:function(){return mf(Bo)},useDebugValue:Kh,useDeferredValue:function(e){var t=Zr();return ny(t,Rt.memoizedState,e)},useTransition:function(){var e=mf(Bo)[0],t=Zr().memoizedState;return[e,t]},useMutableSource:Vv,useSyncExternalStore:Wv,useId:ay,unstable_isNewReconciler:!1},Zx={readContext:Kr,useCallback:ty,useContext:Kr,useEffect:Gh,useImperativeHandle:ey,useInsertionEffect:qv,useLayoutEffect:Jv,useMemo:ry,useReducer:gf,useRef:Yv,useState:function(){return gf(Bo)},useDebugValue:Kh,useDeferredValue:function(e){var t=Zr();return Rt===null?t.memoizedState=e:ny(t,Rt.memoizedState,e)},useTransition:function(){var e=gf(Bo)[0],t=Zr().memoizedState;return[e,t]},useMutableSource:Vv,useSyncExternalStore:Wv,useId:ay,unstable_isNewReconciler:!1};function nn(e,t){if(e&&e.defaultProps){t=ht({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function wd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ht({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var yu={isMounted:function(e){return(e=e._reactInternals)?vs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=pr(),a=Aa(e),s=Zn(n,a);s.payload=t,r!=null&&(s.callback=r),t=ba(e,s,a),t!==null&&(pn(t,e,a,n),oc(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=pr(),a=Aa(e),s=Zn(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=ba(e,s,a),t!==null&&(pn(t,e,a,n),oc(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=pr(),n=Aa(e),a=Zn(r,n);a.tag=2,t!=null&&(a.callback=t),t=ba(e,a,n),t!==null&&(pn(t,e,n,r),oc(t,e,n))}};function Zp(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Do(r,n)||!Do(a,s):!0}function ly(e,t,r){var n=!1,a=Pa,s=t.contextType;return typeof s=="object"&&s!==null?s=Kr(s):(a=br(t)?is:ar.current,n=t.contextTypes,s=(n=n!=null)?li(e,a):Pa),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yu,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function Xp(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&yu.enqueueReplaceState(t,t.state,null)}function _d(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},$h(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Kr(s):(s=br(t)?is:ar.current,a.context=li(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(wd(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&yu.enqueueReplaceState(a,a.state,null),Ic(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function di(e,t){try{var r="",n=t;do r+=xk(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function vf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function kd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Xx=typeof WeakMap=="function"?WeakMap:Map;function cy(e,t,r){r=Zn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Mc||(Mc=!0,Rd=n),kd(e,t)},r}function uy(e,t,r){r=Zn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){kd(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){kd(e,t),typeof n!="function"&&(Ca===null?Ca=new Set([this]):Ca.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Yp(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Xx;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=c4.bind(null,e,t,r),t.then(e,e))}function qp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Jp(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Zn(-1,1),t.tag=2,ba(r,t,1))),r.lanes|=1),e)}var Yx=aa.ReactCurrentOwner,Tr=!1;function cr(e,t,r,n){t.child=e===null?$v(t,null,r,n):ui(t,e.child,r,n)}function Qp(e,t,r,n,a){r=r.render;var s=t.ref;return ei(t,a),n=Wh(e,t,r,n,s,a),r=Hh(),e!==null&&!Tr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ta(e,t,a)):(it&&r&&Ph(t),t.flags|=1,cr(e,t,n,a),t.child)}function e1(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!t0(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,fy(e,t,s,n,a)):(e=hc(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Do,r(i,n)&&e.ref===t.ref)return ta(e,t,a)}return t.flags|=1,e=Na(s,n),e.ref=t.ref,e.return=t,t.child=e}function fy(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Do(s,n)&&e.ref===t.ref)if(Tr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Tr=!0);else return t.lanes=e.lanes,ta(e,t,a)}return xd(e,t,r,n,a)}function dy(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(Ks,Nr),Nr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Qe(Ks,Nr),Nr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Qe(Ks,Nr),Nr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Qe(Ks,Nr),Nr|=n;return cr(e,t,a,r),t.child}function hy(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function xd(e,t,r,n,a){var s=br(r)?is:ar.current;return s=li(t,s),ei(t,a),r=Wh(e,t,r,n,s,a),n=Hh(),e!==null&&!Tr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ta(e,t,a)):(it&&n&&Ph(t),t.flags|=1,cr(e,t,r,a),t.child)}function t1(e,t,r,n,a){if(br(r)){var s=!0;Ac(t)}else s=!1;if(ei(t,a),t.stateNode===null)uc(e,t),ly(t,r,n),_d(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Kr(c):(c=br(r)?is:ar.current,c=li(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Xp(t,i,n,c),fa=!1;var d=t.memoizedState;i.state=d,Ic(t,n,i,a),l=t.memoizedState,o!==n||d!==l||Sr.current||fa?(typeof u=="function"&&(wd(t,r,u,n),l=t.memoizedState),(o=fa||Zp(t,r,o,n,d,l,c))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Bv(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:nn(t.type,o),i.props=c,f=t.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Kr(l):(l=br(r)?is:ar.current,l=li(t,l));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||d!==l)&&Xp(t,i,n,l),fa=!1,d=t.memoizedState,i.state=d,Ic(t,n,i,a);var v=t.memoizedState;o!==f||d!==v||Sr.current||fa?(typeof h=="function"&&(wd(t,r,h,n),v=t.memoizedState),(c=fa||Zp(t,r,c,n,d,v,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Ed(e,t,r,n,s,a)}function Ed(e,t,r,n,a,s){hy(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Up(t,r,!1),ta(e,t,s);n=t.stateNode,Yx.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=ui(t,e.child,null,s),t.child=ui(t,null,o,s)):cr(e,t,o,s),t.memoizedState=n.state,a&&Up(t,r,!0),t.child}function py(e){var t=e.stateNode;t.pendingContext?$p(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$p(e,t.context,!1),Uh(e,t.containerInfo)}function r1(e,t,r,n,a){return ci(),Dh(a),t.flags|=256,cr(e,t,r,n),t.child}var Td={dehydrated:null,treeContext:null,retryLane:0};function Sd(e){return{baseLanes:e,cachePool:null,transitions:null}}function my(e,t,r){var n=t.pendingProps,a=ft.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Qe(ft,a&1),e===null)return vd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=ku(i,n,0,null),e=ns(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Sd(r),t.memoizedState=Td,e):Zh(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return qx(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Na(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Na(o,s):(s=ns(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?Sd(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=Td,n}return s=e.child,e=s.sibling,n=Na(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Zh(e,t){return t=ku({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Dl(e,t,r,n){return n!==null&&Dh(n),ui(t,e.child,null,r),e=Zh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function qx(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=vf(Error(he(422))),Dl(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=ku({mode:"visible",children:n.children},a,0,null),s=ns(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ui(t,e.child,null,i),t.child.memoizedState=Sd(i),t.memoizedState=Td,s);if(!(t.mode&1))return Dl(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(he(419)),n=vf(s,n,void 0),Dl(e,t,i,n)}if(o=(i&e.childLanes)!==0,Tr||o){if(n=$t,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ea(e,a),pn(n,e,a,-1))}return e0(),n=vf(Error(he(421))),Dl(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=u4.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Pr=Sa(a.nextSibling),Ir=t,it=!0,on=null,e!==null&&(Br[zr++]=Wn,Br[zr++]=Hn,Br[zr++]=os,Wn=e.id,Hn=e.overflow,os=t),t=Zh(t,n.children),t.flags|=4096,t)}function n1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),yd(e.return,t,r)}function yf(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function gy(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(cr(e,t,n.children,r),n=ft.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&n1(e,r,t);else if(e.tag===19)n1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Qe(ft,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Dc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),yf(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Dc(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}yf(t,!0,r,null,s);break;case"together":yf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function uc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ta(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),cs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(he(153));if(t.child!==null){for(e=t.child,r=Na(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Na(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Jx(e,t,r){switch(t.tag){case 3:py(t),ci();break;case 5:zv(t);break;case 1:br(t.type)&&Ac(t);break;case 4:Uh(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Qe(Rc,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Qe(ft,ft.current&1),t.flags|=128,null):r&t.child.childLanes?my(e,t,r):(Qe(ft,ft.current&1),e=ta(e,t,r),e!==null?e.sibling:null);Qe(ft,ft.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return gy(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Qe(ft,ft.current),n)break;return null;case 22:case 23:return t.lanes=0,dy(e,t,r)}return ta(e,t,r)}var vy,bd,yy,wy;vy=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};bd=function(){};yy=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Qa(On.current);var s=null;switch(r){case"input":a=Zf(e,a),n=Zf(e,n),s=[];break;case"select":a=ht({},a,{value:void 0}),n=ht({},n,{value:void 0}),s=[];break;case"textarea":a=qf(e,a),n=qf(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=bc)}Qf(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Co.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Co.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&nt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};wy=function(e,t,r,n){r!==n&&(t.flags|=4)};function $i(e,t){if(!it)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function qt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Qx(e,t,r){var n=t.pendingProps;switch(Ih(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(t),null;case 1:return br(t.type)&&Cc(),qt(t),null;case 3:return n=t.stateNode,fi(),at(Sr),at(ar),zh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Pl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,on!==null&&(Dd(on),on=null))),bd(e,t),qt(t),null;case 5:Bh(t);var a=Qa($o.current);if(r=t.type,e!==null&&t.stateNode!=null)yy(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(he(166));return qt(t),null}if(e=Qa(On.current),Pl(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Cn]=t,n[jo]=s,e=(t.mode&1)!==0,r){case"dialog":nt("cancel",n),nt("close",n);break;case"iframe":case"object":case"embed":nt("load",n);break;case"video":case"audio":for(a=0;a<Xi.length;a++)nt(Xi[a],n);break;case"source":nt("error",n);break;case"img":case"image":case"link":nt("error",n),nt("load",n);break;case"details":nt("toggle",n);break;case"input":dp(n,s),nt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},nt("invalid",n);break;case"textarea":pp(n,s),nt("invalid",n)}Qf(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Rl(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Rl(n.textContent,o,e),a=["children",""+o]):Co.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&nt("scroll",n)}switch(r){case"input":El(n),hp(n,s,!0);break;case"textarea":El(n),mp(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=bc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Kg(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Cn]=t,e[jo]=n,vy(e,t,!1,!1),t.stateNode=e;e:{switch(i=ed(r,n),r){case"dialog":nt("cancel",e),nt("close",e),a=n;break;case"iframe":case"object":case"embed":nt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Xi.length;a++)nt(Xi[a],e);a=n;break;case"source":nt("error",e),a=n;break;case"img":case"image":case"link":nt("error",e),nt("load",e),a=n;break;case"details":nt("toggle",e),a=n;break;case"input":dp(e,n),a=Zf(e,n),nt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=ht({},n,{value:void 0}),nt("invalid",e);break;case"textarea":pp(e,n),a=qf(e,n),nt("invalid",e);break;default:a=n}Qf(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Yg(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Zg(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ao(e,l):typeof l=="number"&&Ao(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Co.hasOwnProperty(s)?l!=null&&s==="onScroll"&&nt("scroll",e):l!=null&&yh(e,s,l,i))}switch(r){case"input":El(e),hp(e,n,!1);break;case"textarea":El(e),mp(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ra(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Ys(e,!!n.multiple,s,!1):n.defaultValue!=null&&Ys(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=bc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return qt(t),null;case 6:if(e&&t.stateNode!=null)wy(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(he(166));if(r=Qa($o.current),Qa(On.current),Pl(t)){if(n=t.stateNode,r=t.memoizedProps,n[Cn]=t,(s=n.nodeValue!==r)&&(e=Ir,e!==null))switch(e.tag){case 3:Rl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Rl(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Cn]=t,t.stateNode=n}return qt(t),null;case 13:if(at(ft),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(it&&Pr!==null&&t.mode&1&&!(t.flags&128))jv(),ci(),t.flags|=98560,s=!1;else if(s=Pl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(he(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(he(317));s[Cn]=t}else ci(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;qt(t),s=!1}else on!==null&&(Dd(on),on=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ft.current&1?Pt===0&&(Pt=3):e0())),t.updateQueue!==null&&(t.flags|=4),qt(t),null);case 4:return fi(),bd(e,t),e===null&&Lo(t.stateNode.containerInfo),qt(t),null;case 10:return jh(t.type._context),qt(t),null;case 17:return br(t.type)&&Cc(),qt(t),null;case 19:if(at(ft),s=t.memoizedState,s===null)return qt(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)$i(s,!1);else{if(Pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Dc(e),i!==null){for(t.flags|=128,$i(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Qe(ft,ft.current&1|2),t.child}e=e.sibling}s.tail!==null&&wt()>hi&&(t.flags|=128,n=!0,$i(s,!1),t.lanes=4194304)}else{if(!n)if(e=Dc(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),$i(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!it)return qt(t),null}else 2*wt()-s.renderingStartTime>hi&&r!==1073741824&&(t.flags|=128,n=!0,$i(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=wt(),t.sibling=null,r=ft.current,Qe(ft,n?r&1|2:r&1),t):(qt(t),null);case 22:case 23:return Qh(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Nr&1073741824&&(qt(t),t.subtreeFlags&6&&(t.flags|=8192)):qt(t),null;case 24:return null;case 25:return null}throw Error(he(156,t.tag))}function e4(e,t){switch(Ih(t),t.tag){case 1:return br(t.type)&&Cc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fi(),at(Sr),at(ar),zh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Bh(t),null;case 13:if(at(ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(he(340));ci()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return at(ft),null;case 4:return fi(),null;case 10:return jh(t.type._context),null;case 22:case 23:return Qh(),null;case 24:return null;default:return null}}var Ll=!1,er=!1,t4=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Gs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){mt(e,t,n)}else r.current=null}function Cd(e,t,r){try{r()}catch(n){mt(e,t,n)}}var a1=!1;function r4(e,t){if(ud=Ec,e=Tv(),Rh(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,f=e,d=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(o=i+a),f!==s||n!==0&&f.nodeType!==3||(l=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===r&&++c===a&&(o=i),d===s&&++u===n&&(l=i),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(fd={focusedElem:e,selectionRange:r},Ec=!1,Ce=t;Ce!==null;)if(t=Ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ce=e;else for(;Ce!==null;){t=Ce;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,_=v.memoizedState,w=t.stateNode,y=w.getSnapshotBeforeUpdate(t.elementType===t.type?g:nn(t.type,g),_);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(k){mt(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Ce=e;break}Ce=t.return}return v=a1,a1=!1,v}function lo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Cd(t,r,s)}a=a.next}while(a!==n)}}function wu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Ad(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function _y(e){var t=e.alternate;t!==null&&(e.alternate=null,_y(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Cn],delete t[jo],delete t[pd],delete t[Mx],delete t[$x])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ky(e){return e.tag===5||e.tag===3||e.tag===4}function s1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ky(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Nd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=bc));else if(n!==4&&(e=e.child,e!==null))for(Nd(e,t,r),e=e.sibling;e!==null;)Nd(e,t,r),e=e.sibling}function Od(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Od(e,t,r),e=e.sibling;e!==null;)Od(e,t,r),e=e.sibling}var zt=null,an=!1;function ia(e,t,r){for(r=r.child;r!==null;)xy(e,t,r),r=r.sibling}function xy(e,t,r){if(Nn&&typeof Nn.onCommitFiberUnmount=="function")try{Nn.onCommitFiberUnmount(fu,r)}catch{}switch(r.tag){case 5:er||Gs(r,t);case 6:var n=zt,a=an;zt=null,ia(e,t,r),zt=n,an=a,zt!==null&&(an?(e=zt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):zt.removeChild(r.stateNode));break;case 18:zt!==null&&(an?(e=zt,r=r.stateNode,e.nodeType===8?ff(e.parentNode,r):e.nodeType===1&&ff(e,r),Po(e)):ff(zt,r.stateNode));break;case 4:n=zt,a=an,zt=r.stateNode.containerInfo,an=!0,ia(e,t,r),zt=n,an=a;break;case 0:case 11:case 14:case 15:if(!er&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Cd(r,t,i),a=a.next}while(a!==n)}ia(e,t,r);break;case 1:if(!er&&(Gs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){mt(r,t,o)}ia(e,t,r);break;case 21:ia(e,t,r);break;case 22:r.mode&1?(er=(n=er)||r.memoizedState!==null,ia(e,t,r),er=n):ia(e,t,r);break;default:ia(e,t,r)}}function i1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new t4),t.forEach(function(n){var a=f4.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Qr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:zt=o.stateNode,an=!1;break e;case 3:zt=o.stateNode.containerInfo,an=!0;break e;case 4:zt=o.stateNode.containerInfo,an=!0;break e}o=o.return}if(zt===null)throw Error(he(160));xy(s,i,a),zt=null,an=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){mt(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ey(t,e),t=t.sibling}function Ey(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Qr(t,e),wn(e),n&4){try{lo(3,e,e.return),wu(3,e)}catch(g){mt(e,e.return,g)}try{lo(5,e,e.return)}catch(g){mt(e,e.return,g)}}break;case 1:Qr(t,e),wn(e),n&512&&r!==null&&Gs(r,r.return);break;case 5:if(Qr(t,e),wn(e),n&512&&r!==null&&Gs(r,r.return),e.flags&32){var a=e.stateNode;try{Ao(a,"")}catch(g){mt(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Hg(a,s),ed(o,i);var c=ed(o,s);for(i=0;i<l.length;i+=2){var u=l[i],f=l[i+1];u==="style"?Yg(a,f):u==="dangerouslySetInnerHTML"?Zg(a,f):u==="children"?Ao(a,f):yh(a,u,f,c)}switch(o){case"input":Xf(a,s);break;case"textarea":Gg(a,s);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Ys(a,!!s.multiple,h,!1):d!==!!s.multiple&&(s.defaultValue!=null?Ys(a,!!s.multiple,s.defaultValue,!0):Ys(a,!!s.multiple,s.multiple?[]:"",!1))}a[jo]=s}catch(g){mt(e,e.return,g)}}break;case 6:if(Qr(t,e),wn(e),n&4){if(e.stateNode===null)throw Error(he(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){mt(e,e.return,g)}}break;case 3:if(Qr(t,e),wn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Po(t.containerInfo)}catch(g){mt(e,e.return,g)}break;case 4:Qr(t,e),wn(e);break;case 13:Qr(t,e),wn(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(qh=wt())),n&4&&i1(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(er=(c=er)||u,Qr(t,e),er=c):Qr(t,e),wn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ce=e,u=e.child;u!==null;){for(f=Ce=u;Ce!==null;){switch(d=Ce,h=d.child,d.tag){case 0:case 11:case 14:case 15:lo(4,d,d.return);break;case 1:Gs(d,d.return);var v=d.stateNode;if(typeof v.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){mt(n,r,g)}}break;case 5:Gs(d,d.return);break;case 22:if(d.memoizedState!==null){l1(f);continue}}h!==null?(h.return=d,Ce=h):l1(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Xg("display",i))}catch(g){mt(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(g){mt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Qr(t,e),wn(e),n&4&&i1(e);break;case 21:break;default:Qr(t,e),wn(e)}}function wn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ky(r)){var n=r;break e}r=r.return}throw Error(he(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ao(a,""),n.flags&=-33);var s=s1(e);Od(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=s1(e);Nd(e,o,i);break;default:throw Error(he(161))}}catch(l){mt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function n4(e,t,r){Ce=e,Ty(e)}function Ty(e,t,r){for(var n=(e.mode&1)!==0;Ce!==null;){var a=Ce,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Ll;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||er;o=Ll;var c=er;if(Ll=i,(er=l)&&!c)for(Ce=a;Ce!==null;)i=Ce,l=i.child,i.tag===22&&i.memoizedState!==null?c1(a):l!==null?(l.return=i,Ce=l):c1(a);for(;s!==null;)Ce=s,Ty(s),s=s.sibling;Ce=a,Ll=o,er=c}o1(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Ce=s):o1(e)}}function o1(e){for(;Ce!==null;){var t=Ce;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:er||wu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!er)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:nn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Hp(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Hp(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Po(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}er||t.flags&512&&Ad(t)}catch(d){mt(t,t.return,d)}}if(t===e){Ce=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ce=r;break}Ce=t.return}}function l1(e){for(;Ce!==null;){var t=Ce;if(t===e){Ce=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ce=r;break}Ce=t.return}}function c1(e){for(;Ce!==null;){var t=Ce;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{wu(4,t)}catch(l){mt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){mt(t,a,l)}}var s=t.return;try{Ad(t)}catch(l){mt(t,s,l)}break;case 5:var i=t.return;try{Ad(t)}catch(l){mt(t,i,l)}}}catch(l){mt(t,t.return,l)}if(t===e){Ce=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ce=o;break}Ce=t.return}}var a4=Math.ceil,jc=aa.ReactCurrentDispatcher,Xh=aa.ReactCurrentOwner,Hr=aa.ReactCurrentBatchConfig,Ke=0,$t=null,Ct=null,Wt=0,Nr=0,Ks=Fa(0),Pt=0,Vo=null,cs=0,_u=0,Yh=0,co=null,xr=null,qh=0,hi=1/0,Bn=null,Mc=!1,Rd=null,Ca=null,Fl=!1,wa=null,$c=0,uo=0,Pd=null,fc=-1,dc=0;function pr(){return Ke&6?wt():fc!==-1?fc:fc=wt()}function Aa(e){return e.mode&1?Ke&2&&Wt!==0?Wt&-Wt:Bx.transition!==null?(dc===0&&(dc=lv()),dc):(e=Ye,e!==0||(e=window.event,e=e===void 0?16:mv(e.type)),e):1}function pn(e,t,r,n){if(50<uo)throw uo=0,Pd=null,Error(he(185));nl(e,r,n),(!(Ke&2)||e!==$t)&&(e===$t&&(!(Ke&2)&&(_u|=r),Pt===4&&ha(e,Wt)),Cr(e,n),r===1&&Ke===0&&!(t.mode&1)&&(hi=wt()+500,gu&&ja()))}function Cr(e,t){var r=e.callbackNode;Bk(e,t);var n=xc(e,e===$t?Wt:0);if(n===0)r!==null&&yp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&yp(r),t===1)e.tag===0?Ux(u1.bind(null,e)):Dv(u1.bind(null,e)),Fx(function(){!(Ke&6)&&ja()}),r=null;else{switch(cv(n)){case 1:r=Eh;break;case 4:r=iv;break;case 16:r=kc;break;case 536870912:r=ov;break;default:r=kc}r=Py(r,Sy.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Sy(e,t){if(fc=-1,dc=0,Ke&6)throw Error(he(327));var r=e.callbackNode;if(ti()&&e.callbackNode!==r)return null;var n=xc(e,e===$t?Wt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Uc(e,n);else{t=n;var a=Ke;Ke|=2;var s=Cy();($t!==e||Wt!==t)&&(Bn=null,hi=wt()+500,rs(e,t));do try{o4();break}catch(o){by(e,o)}while(!0);Fh(),jc.current=s,Ke=a,Ct!==null?t=0:($t=null,Wt=0,t=Pt)}if(t!==0){if(t===2&&(a=sd(e),a!==0&&(n=a,t=Id(e,a))),t===1)throw r=Vo,rs(e,0),ha(e,n),Cr(e,wt()),r;if(t===6)ha(e,n);else{if(a=e.current.alternate,!(n&30)&&!s4(a)&&(t=Uc(e,n),t===2&&(s=sd(e),s!==0&&(n=s,t=Id(e,s))),t===1))throw r=Vo,rs(e,0),ha(e,n),Cr(e,wt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(he(345));case 2:Ka(e,xr,Bn);break;case 3:if(ha(e,n),(n&130023424)===n&&(t=qh+500-wt(),10<t)){if(xc(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){pr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=hd(Ka.bind(null,e,xr,Bn),t);break}Ka(e,xr,Bn);break;case 4:if(ha(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-hn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=wt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*a4(n/1960))-n,10<n){e.timeoutHandle=hd(Ka.bind(null,e,xr,Bn),n);break}Ka(e,xr,Bn);break;case 5:Ka(e,xr,Bn);break;default:throw Error(he(329))}}}return Cr(e,wt()),e.callbackNode===r?Sy.bind(null,e):null}function Id(e,t){var r=co;return e.current.memoizedState.isDehydrated&&(rs(e,t).flags|=256),e=Uc(e,t),e!==2&&(t=xr,xr=r,t!==null&&Dd(t)),e}function Dd(e){xr===null?xr=e:xr.push.apply(xr,e)}function s4(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!gn(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ha(e,t){for(t&=~Yh,t&=~_u,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-hn(t),n=1<<r;e[r]=-1,t&=~n}}function u1(e){if(Ke&6)throw Error(he(327));ti();var t=xc(e,0);if(!(t&1))return Cr(e,wt()),null;var r=Uc(e,t);if(e.tag!==0&&r===2){var n=sd(e);n!==0&&(t=n,r=Id(e,n))}if(r===1)throw r=Vo,rs(e,0),ha(e,t),Cr(e,wt()),r;if(r===6)throw Error(he(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ka(e,xr,Bn),Cr(e,wt()),null}function Jh(e,t){var r=Ke;Ke|=1;try{return e(t)}finally{Ke=r,Ke===0&&(hi=wt()+500,gu&&ja())}}function us(e){wa!==null&&wa.tag===0&&!(Ke&6)&&ti();var t=Ke;Ke|=1;var r=Hr.transition,n=Ye;try{if(Hr.transition=null,Ye=1,e)return e()}finally{Ye=n,Hr.transition=r,Ke=t,!(Ke&6)&&ja()}}function Qh(){Nr=Ks.current,at(Ks)}function rs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Lx(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(Ih(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Cc();break;case 3:fi(),at(Sr),at(ar),zh();break;case 5:Bh(n);break;case 4:fi();break;case 13:at(ft);break;case 19:at(ft);break;case 10:jh(n.type._context);break;case 22:case 23:Qh()}r=r.return}if($t=e,Ct=e=Na(e.current,null),Wt=Nr=t,Pt=0,Vo=null,Yh=_u=cs=0,xr=co=null,Ja!==null){for(t=0;t<Ja.length;t++)if(r=Ja[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Ja=null}return e}function by(e,t){do{var r=Ct;try{if(Fh(),lc.current=Fc,Lc){for(var n=dt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Lc=!1}if(ls=0,Mt=Rt=dt=null,oo=!1,Uo=0,Xh.current=null,r===null||r.return===null){Pt=1,Vo=t,Ct=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=Wt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=qp(i);if(h!==null){h.flags&=-257,Jp(h,i,o,s,t),h.mode&1&&Yp(s,c,t),t=h,l=c;var v=t.updateQueue;if(v===null){var g=new Set;g.add(l),t.updateQueue=g}else v.add(l);break e}else{if(!(t&1)){Yp(s,c,t),e0();break e}l=Error(he(426))}}else if(it&&o.mode&1){var _=qp(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Jp(_,i,o,s,t),Dh(di(l,o));break e}}s=l=di(l,o),Pt!==4&&(Pt=2),co===null?co=[s]:co.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var w=cy(s,l,t);Wp(s,w);break e;case 1:o=l;var y=s.type,p=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Ca===null||!Ca.has(p)))){s.flags|=65536,t&=-t,s.lanes|=t;var k=uy(s,o,t);Wp(s,k);break e}}s=s.return}while(s!==null)}Ny(r)}catch(T){t=T,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function Cy(){var e=jc.current;return jc.current=Fc,e===null?Fc:e}function e0(){(Pt===0||Pt===3||Pt===2)&&(Pt=4),$t===null||!(cs&268435455)&&!(_u&268435455)||ha($t,Wt)}function Uc(e,t){var r=Ke;Ke|=2;var n=Cy();($t!==e||Wt!==t)&&(Bn=null,rs(e,t));do try{i4();break}catch(a){by(e,a)}while(!0);if(Fh(),Ke=r,jc.current=n,Ct!==null)throw Error(he(261));return $t=null,Wt=0,Pt}function i4(){for(;Ct!==null;)Ay(Ct)}function o4(){for(;Ct!==null&&!Pk();)Ay(Ct)}function Ay(e){var t=Ry(e.alternate,e,Nr);e.memoizedProps=e.pendingProps,t===null?Ny(e):Ct=t,Xh.current=null}function Ny(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=e4(r,t),r!==null){r.flags&=32767,Ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Pt=6,Ct=null;return}}else if(r=Qx(r,t,Nr),r!==null){Ct=r;return}if(t=t.sibling,t!==null){Ct=t;return}Ct=t=e}while(t!==null);Pt===0&&(Pt=5)}function Ka(e,t,r){var n=Ye,a=Hr.transition;try{Hr.transition=null,Ye=1,l4(e,t,r,n)}finally{Hr.transition=a,Ye=n}return null}function l4(e,t,r,n){do ti();while(wa!==null);if(Ke&6)throw Error(he(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(he(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(zk(e,s),e===$t&&(Ct=$t=null,Wt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Fl||(Fl=!0,Py(kc,function(){return ti(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Hr.transition,Hr.transition=null;var i=Ye;Ye=1;var o=Ke;Ke|=4,Xh.current=null,r4(e,r),Ey(r,e),Ax(fd),Ec=!!ud,fd=ud=null,e.current=r,n4(r),Ik(),Ke=o,Ye=i,Hr.transition=s}else e.current=r;if(Fl&&(Fl=!1,wa=e,$c=a),s=e.pendingLanes,s===0&&(Ca=null),Fk(r.stateNode),Cr(e,wt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Mc)throw Mc=!1,e=Rd,Rd=null,e;return $c&1&&e.tag!==0&&ti(),s=e.pendingLanes,s&1?e===Pd?uo++:(uo=0,Pd=e):uo=0,ja(),null}function ti(){if(wa!==null){var e=cv($c),t=Hr.transition,r=Ye;try{if(Hr.transition=null,Ye=16>e?16:e,wa===null)var n=!1;else{if(e=wa,wa=null,$c=0,Ke&6)throw Error(he(331));var a=Ke;for(Ke|=4,Ce=e.current;Ce!==null;){var s=Ce,i=s.child;if(Ce.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ce=c;Ce!==null;){var u=Ce;switch(u.tag){case 0:case 11:case 15:lo(8,u,s)}var f=u.child;if(f!==null)f.return=u,Ce=f;else for(;Ce!==null;){u=Ce;var d=u.sibling,h=u.return;if(_y(u),u===c){Ce=null;break}if(d!==null){d.return=h,Ce=d;break}Ce=h}}}var v=s.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(g!==null)}}Ce=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Ce=i;else e:for(;Ce!==null;){if(s=Ce,s.flags&2048)switch(s.tag){case 0:case 11:case 15:lo(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Ce=w;break e}Ce=s.return}}var y=e.current;for(Ce=y;Ce!==null;){i=Ce;var p=i.child;if(i.subtreeFlags&2064&&p!==null)p.return=i,Ce=p;else e:for(i=y;Ce!==null;){if(o=Ce,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wu(9,o)}}catch(T){mt(o,o.return,T)}if(o===i){Ce=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Ce=k;break e}Ce=o.return}}if(Ke=a,ja(),Nn&&typeof Nn.onPostCommitFiberRoot=="function")try{Nn.onPostCommitFiberRoot(fu,e)}catch{}n=!0}return n}finally{Ye=r,Hr.transition=t}}return!1}function f1(e,t,r){t=di(r,t),t=cy(e,t,1),e=ba(e,t,1),t=pr(),e!==null&&(nl(e,1,t),Cr(e,t))}function mt(e,t,r){if(e.tag===3)f1(e,e,r);else for(;t!==null;){if(t.tag===3){f1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ca===null||!Ca.has(n))){e=di(r,e),e=uy(t,e,1),t=ba(t,e,1),e=pr(),t!==null&&(nl(t,1,e),Cr(t,e));break}}t=t.return}}function c4(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=pr(),e.pingedLanes|=e.suspendedLanes&r,$t===e&&(Wt&r)===r&&(Pt===4||Pt===3&&(Wt&130023424)===Wt&&500>wt()-qh?rs(e,0):Yh|=r),Cr(e,t)}function Oy(e,t){t===0&&(e.mode&1?(t=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):t=1);var r=pr();e=ea(e,t),e!==null&&(nl(e,t,r),Cr(e,r))}function u4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Oy(e,r)}function f4(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(he(314))}n!==null&&n.delete(t),Oy(e,r)}var Ry;Ry=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Sr.current)Tr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Tr=!1,Jx(e,t,r);Tr=!!(e.flags&131072)}else Tr=!1,it&&t.flags&1048576&&Lv(t,Oc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;uc(e,t),e=t.pendingProps;var a=li(t,ar.current);ei(t,r),a=Wh(null,t,n,e,a,r);var s=Hh();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,br(n)?(s=!0,Ac(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,$h(t),a.updater=yu,t.stateNode=a,a._reactInternals=t,_d(t,n,e,r),t=Ed(null,t,n,!0,s,r)):(t.tag=0,it&&s&&Ph(t),cr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(uc(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=h4(n),e=nn(n,e),a){case 0:t=xd(null,t,n,e,r);break e;case 1:t=t1(null,t,n,e,r);break e;case 11:t=Qp(null,t,n,e,r);break e;case 14:t=e1(null,t,n,nn(n.type,e),r);break e}throw Error(he(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:nn(n,a),xd(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:nn(n,a),t1(e,t,n,a,r);case 3:e:{if(py(t),e===null)throw Error(he(387));n=t.pendingProps,s=t.memoizedState,a=s.element,Bv(e,t),Ic(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=di(Error(he(423)),t),t=r1(e,t,n,r,a);break e}else if(n!==a){a=di(Error(he(424)),t),t=r1(e,t,n,r,a);break e}else for(Pr=Sa(t.stateNode.containerInfo.firstChild),Ir=t,it=!0,on=null,r=$v(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ci(),n===a){t=ta(e,t,r);break e}cr(e,t,n,r)}t=t.child}return t;case 5:return zv(t),e===null&&vd(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,dd(n,a)?i=null:s!==null&&dd(n,s)&&(t.flags|=32),hy(e,t),cr(e,t,i,r),t.child;case 6:return e===null&&vd(t),null;case 13:return my(e,t,r);case 4:return Uh(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ui(t,null,n,r):cr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:nn(n,a),Qp(e,t,n,a,r);case 7:return cr(e,t,t.pendingProps,r),t.child;case 8:return cr(e,t,t.pendingProps.children,r),t.child;case 12:return cr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Qe(Rc,n._currentValue),n._currentValue=i,s!==null)if(gn(s.value,i)){if(s.children===a.children&&!Sr.current){t=ta(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Zn(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),yd(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(he(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),yd(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}cr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ei(t,r),a=Kr(a),n=n(a),t.flags|=1,cr(e,t,n,r),t.child;case 14:return n=t.type,a=nn(n,t.pendingProps),a=nn(n.type,a),e1(e,t,n,a,r);case 15:return fy(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:nn(n,a),uc(e,t),t.tag=1,br(n)?(e=!0,Ac(t)):e=!1,ei(t,r),ly(t,n,a),_d(t,n,a,r),Ed(null,t,n,!0,e,r);case 19:return gy(e,t,r);case 22:return dy(e,t,r)}throw Error(he(156,t.tag))};function Py(e,t){return sv(e,t)}function d4(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wr(e,t,r,n){return new d4(e,t,r,n)}function t0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function h4(e){if(typeof e=="function")return t0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===_h)return 11;if(e===kh)return 14}return 2}function Na(e,t){var r=e.alternate;return r===null?(r=Wr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function hc(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")t0(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case js:return ns(r.children,a,s,t);case wh:i=8,a|=8;break;case Wf:return e=Wr(12,r,t,a|2),e.elementType=Wf,e.lanes=s,e;case Hf:return e=Wr(13,r,t,a),e.elementType=Hf,e.lanes=s,e;case Gf:return e=Wr(19,r,t,a),e.elementType=Gf,e.lanes=s,e;case zg:return ku(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ug:i=10;break e;case Bg:i=9;break e;case _h:i=11;break e;case kh:i=14;break e;case ua:i=16,n=null;break e}throw Error(he(130,e==null?e:typeof e,""))}return t=Wr(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function ns(e,t,r,n){return e=Wr(7,e,n,t),e.lanes=r,e}function ku(e,t,r,n){return e=Wr(22,e,n,t),e.elementType=zg,e.lanes=r,e.stateNode={isHidden:!1},e}function wf(e,t,r){return e=Wr(6,e,null,t),e.lanes=r,e}function _f(e,t,r){return t=Wr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function p4(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qu(0),this.expirationTimes=Qu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qu(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function r0(e,t,r,n,a,s,i,o,l){return e=new p4(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Wr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},$h(s),e}function m4(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Iy(e){if(!e)return Pa;e=e._reactInternals;e:{if(vs(e)!==e||e.tag!==1)throw Error(he(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(br(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(he(171))}if(e.tag===1){var r=e.type;if(br(r))return Iv(e,r,t)}return t}function Dy(e,t,r,n,a,s,i,o,l){return e=r0(r,n,!0,e,a,s,i,o,l),e.context=Iy(null),r=e.current,n=pr(),a=Aa(r),s=Zn(n,a),s.callback=t??null,ba(r,s,a),e.current.lanes=a,nl(e,a,n),Cr(e,n),e}function xu(e,t,r,n){var a=t.current,s=pr(),i=Aa(a);return r=Iy(r),t.context===null?t.context=r:t.pendingContext=r,t=Zn(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ba(a,t,i),e!==null&&(pn(e,a,i,s),oc(e,a,i)),i}function Bc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function d1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function n0(e,t){d1(e,t),(e=e.alternate)&&d1(e,t)}function g4(){return null}var Ly=typeof reportError=="function"?reportError:function(e){console.error(e)};function a0(e){this._internalRoot=e}Eu.prototype.render=a0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(he(409));xu(e,t,null,null)};Eu.prototype.unmount=a0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;us(function(){xu(null,e,null,null)}),t[Qn]=null}};function Eu(e){this._internalRoot=e}Eu.prototype.unstable_scheduleHydration=function(e){if(e){var t=dv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<da.length&&t!==0&&t<da[r].priority;r++);da.splice(r,0,e),r===0&&pv(e)}};function s0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Tu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function h1(){}function v4(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Bc(i);s.call(c)}}var i=Dy(t,n,e,0,null,!1,!1,"",h1);return e._reactRootContainer=i,e[Qn]=i.current,Lo(e.nodeType===8?e.parentNode:e),us(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Bc(l);o.call(c)}}var l=r0(e,0,!1,null,null,!1,!1,"",h1);return e._reactRootContainer=l,e[Qn]=l.current,Lo(e.nodeType===8?e.parentNode:e),us(function(){xu(t,l,r,n)}),l}function Su(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Bc(i);o.call(l)}}xu(t,i,e,a)}else i=v4(r,t,e,a,n);return Bc(i)}uv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Zi(t.pendingLanes);r!==0&&(Th(t,r|1),Cr(t,wt()),!(Ke&6)&&(hi=wt()+500,ja()))}break;case 13:us(function(){var n=ea(e,1);if(n!==null){var a=pr();pn(n,e,1,a)}}),n0(e,1)}};Sh=function(e){if(e.tag===13){var t=ea(e,134217728);if(t!==null){var r=pr();pn(t,e,134217728,r)}n0(e,134217728)}};fv=function(e){if(e.tag===13){var t=Aa(e),r=ea(e,t);if(r!==null){var n=pr();pn(r,e,t,n)}n0(e,t)}};dv=function(){return Ye};hv=function(e,t){var r=Ye;try{return Ye=e,t()}finally{Ye=r}};rd=function(e,t,r){switch(t){case"input":if(Xf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=mu(n);if(!a)throw Error(he(90));Wg(n),Xf(n,a)}}}break;case"textarea":Gg(e,r);break;case"select":t=r.value,t!=null&&Ys(e,!!r.multiple,t,!1)}};Qg=Jh;ev=us;var y4={usingClientEntryPoint:!1,Events:[sl,Bs,mu,qg,Jg,Jh]},Ui={findFiberByHostInstance:qa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w4={bundleType:Ui.bundleType,version:Ui.version,rendererPackageName:Ui.rendererPackageName,rendererConfig:Ui.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:aa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=nv(e),e===null?null:e.stateNode},findFiberByHostInstance:Ui.findFiberByHostInstance||g4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jl.isDisabled&&jl.supportsFiber)try{fu=jl.inject(w4),Nn=jl}catch{}}Fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y4;Fr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!s0(t))throw Error(he(200));return m4(e,t,null,r)};Fr.createRoot=function(e,t){if(!s0(e))throw Error(he(299));var r=!1,n="",a=Ly;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=r0(e,1,!1,null,null,r,!1,n,a),e[Qn]=t.current,Lo(e.nodeType===8?e.parentNode:e),new a0(t)};Fr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(he(188)):(e=Object.keys(e).join(","),Error(he(268,e)));return e=nv(t),e=e===null?null:e.stateNode,e};Fr.flushSync=function(e){return us(e)};Fr.hydrate=function(e,t,r){if(!Tu(t))throw Error(he(200));return Su(null,e,t,!0,r)};Fr.hydrateRoot=function(e,t,r){if(!s0(e))throw Error(he(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=Ly;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Dy(t,null,e,1,r??null,a,!1,s,i),e[Qn]=t.current,Lo(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Eu(t)};Fr.render=function(e,t,r){if(!Tu(t))throw Error(he(200));return Su(null,e,t,!1,r)};Fr.unmountComponentAtNode=function(e){if(!Tu(e))throw Error(he(40));return e._reactRootContainer?(us(function(){Su(null,null,e,!1,function(){e._reactRootContainer=null,e[Qn]=null})}),!0):!1};Fr.unstable_batchedUpdates=Jh;Fr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Tu(r))throw Error(he(200));if(e==null||e._reactInternals===void 0)throw Error(he(38));return Su(e,t,r,!1,n)};Fr.version="18.3.1-next-f1338f8080-20240426";function Fy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fy)}catch(e){console.error(e)}}Fy(),Fg.exports=Fr;var _4=Fg.exports,jy,p1=_4;jy=p1.createRoot,p1.hydrateRoot;/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var m1="popstate";function k4(e={}){function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return Ld("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Wo(a)}return E4(t,r,null,e)}function ot(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function vn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function x4(){return Math.random().toString(36).substring(2,10)}function g1(e,t){return{usr:e.state,key:e.key,idx:t}}function Ld(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?_i(t):t,state:r,key:t&&t.key||n||x4()}}function Wo({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function _i(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function E4(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o="POP",l=null,c=u();c==null&&(c=0,i.replaceState({...i.state,idx:c},""));function u(){return(i.state||{idx:null}).idx}function f(){o="POP";let _=u(),w=_==null?null:_-c;c=_,l&&l({action:o,location:g.location,delta:w})}function d(_,w){o="PUSH";let y=Ld(g.location,_,w);c=u()+1;let p=g1(y,c),k=g.createHref(y);try{i.pushState(p,"",k)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;a.location.assign(k)}s&&l&&l({action:o,location:g.location,delta:1})}function h(_,w){o="REPLACE";let y=Ld(g.location,_,w);c=u();let p=g1(y,c),k=g.createHref(y);i.replaceState(p,"",k),s&&l&&l({action:o,location:g.location,delta:0})}function v(_){return T4(_)}let g={get action(){return o},get location(){return e(a,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(m1,f),l=_,()=>{a.removeEventListener(m1,f),l=null}},createHref(_){return t(a,_)},createURL:v,encodeLocation(_){let w=v(_);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:d,replace:h,go(_){return i.go(_)}};return g}function T4(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),ot(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Wo(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function My(e,t,r="/"){return S4(e,t,r,!1)}function S4(e,t,r,n){let a=typeof t=="string"?_i(t):t,s=ra(a.pathname||"/",r);if(s==null)return null;let i=$y(e);b4(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=j4(s);o=L4(i[l],c,n)}return o}function $y(e,t=[],r=[],n="",a=!1){let s=(i,o,l=a,c)=>{let u={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&l)return;ot(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let f=Xn([n,u.relativePath]),d=r.concat(u);i.children&&i.children.length>0&&(ot(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),$y(i.children,t,d,f,l)),!(i.path==null&&!i.index)&&t.push({path:f,score:I4(f,i.index),routesMeta:d})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of Uy(i.path))s(i,o,!0,c)}),t}function Uy(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=Uy(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function b4(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:D4(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var C4=/^:[\w-]+$/,A4=3,N4=2,O4=1,R4=10,P4=-2,v1=e=>e==="*";function I4(e,t){let r=e.split("/"),n=r.length;return r.some(v1)&&(n+=P4),t&&(n+=N4),r.filter(a=>!v1(a)).reduce((a,s)=>a+(C4.test(s)?A4:s===""?O4:R4),n)}function D4(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function L4(e,t,r=!1){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?t:t.slice(s.length)||"/",f=zc({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!f&&c&&r&&!n[n.length-1].route.index&&(f=zc({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),i.push({params:a,pathname:Xn([s,f.pathname]),pathnameBase:B4(Xn([s,f.pathnameBase])),route:d}),f.pathnameBase!=="/"&&(s=Xn([s,f.pathnameBase]))}return i}function zc(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=F4(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,{paramName:u,isOptional:f},d)=>{if(u==="*"){let v=o[d]||"";i=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const h=o[d];return f&&!h?c[u]=void 0:c[u]=(h||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function F4(e,t=!1,r=!0){vn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function j4(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return vn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ra(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function M4(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?_i(e):e;return{pathname:r?r.startsWith("/")?r:$4(r,t):t,search:z4(n),hash:V4(a)}}function $4(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function kf(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function U4(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function i0(e){let t=U4(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function o0(e,t,r,n=!1){let a;typeof e=="string"?a=_i(e):(a={...e},ot(!a.pathname||!a.pathname.includes("?"),kf("?","pathname","search",a)),ot(!a.pathname||!a.pathname.includes("#"),kf("#","pathname","hash",a)),ot(!a.search||!a.search.includes("#"),kf("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let d=i.split("/");for(;d[0]==="..";)d.shift(),f-=1;a.pathname=d.join("/")}o=f>=0?t[f]:"/"}let l=M4(a,o),c=i&&i!=="/"&&i.endsWith("/"),u=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Xn=e=>e.join("/").replace(/\/\/+/g,"/"),B4=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),z4=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,V4=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function W4(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var By=["POST","PUT","PATCH","DELETE"];new Set(By);var H4=["GET",...By];new Set(H4);var ki=B.createContext(null);ki.displayName="DataRouter";var bu=B.createContext(null);bu.displayName="DataRouterState";B.createContext(!1);var zy=B.createContext({isTransitioning:!1});zy.displayName="ViewTransition";var G4=B.createContext(new Map);G4.displayName="Fetchers";var K4=B.createContext(null);K4.displayName="Await";var yn=B.createContext(null);yn.displayName="Navigation";var ol=B.createContext(null);ol.displayName="Location";var Pn=B.createContext({outlet:null,matches:[],isDataRoute:!1});Pn.displayName="Route";var l0=B.createContext(null);l0.displayName="RouteError";function Z4(e,{relative:t}={}){ot(xi(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=B.useContext(yn),{hash:a,pathname:s,search:i}=ll(e,{relative:t}),o=s;return r!=="/"&&(o=s==="/"?r:Xn([r,s])),n.createHref({pathname:o,search:i,hash:a})}function xi(){return B.useContext(ol)!=null}function Ma(){return ot(xi(),"useLocation() may be used only in the context of a <Router> component."),B.useContext(ol).location}var Vy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Wy(e){B.useContext(yn).static||B.useLayoutEffect(e)}function c0(){let{isDataRoute:e}=B.useContext(Pn);return e?o3():X4()}function X4(){ot(xi(),"useNavigate() may be used only in the context of a <Router> component.");let e=B.useContext(ki),{basename:t,navigator:r}=B.useContext(yn),{matches:n}=B.useContext(Pn),{pathname:a}=Ma(),s=JSON.stringify(i0(n)),i=B.useRef(!1);return Wy(()=>{i.current=!0}),B.useCallback((l,c={})=>{if(vn(i.current,Vy),!i.current)return;if(typeof l=="number"){r.go(l);return}let u=o0(l,JSON.parse(s),a,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Xn([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,s,a,e])}B.createContext(null);function ll(e,{relative:t}={}){let{matches:r}=B.useContext(Pn),{pathname:n}=Ma(),a=JSON.stringify(i0(r));return B.useMemo(()=>o0(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function Y4(e,t){return Hy(e,t)}function Hy(e,t,r,n,a){var y;ot(xi(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=B.useContext(yn),{matches:i}=B.useContext(Pn),o=i[i.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",f=o&&o.route;{let p=f&&f.path||"";Gy(c,!f||p.endsWith("*")||p.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${p}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${p}"> to <Route path="${p==="/"?"*":`${p}/*`}">.`)}let d=Ma(),h;if(t){let p=typeof t=="string"?_i(t):t;ot(u==="/"||((y=p.pathname)==null?void 0:y.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${p.pathname}" was given in the \`location\` prop.`),h=p}else h=d;let v=h.pathname||"/",g=v;if(u!=="/"){let p=u.replace(/^\//,"").split("/");g="/"+v.replace(/^\//,"").split("/").slice(p.length).join("/")}let _=My(e,{pathname:g});vn(f||_!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),vn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=t3(_&&_.map(p=>Object.assign({},p,{params:Object.assign({},l,p.params),pathname:Xn([u,s.encodeLocation?s.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?u:Xn([u,s.encodeLocation?s.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),i,r,n,a);return t&&w?B.createElement(ol.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},w):w}function q4(){let e=i3(),t=W4(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=B.createElement(B.Fragment,null,B.createElement("p",null,"💿 Hey developer 👋"),B.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",B.createElement("code",{style:s},"ErrorBoundary")," or"," ",B.createElement("code",{style:s},"errorElement")," prop on your route.")),B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},t),r?B.createElement("pre",{style:a},r):null,i)}var J4=B.createElement(q4,null),Q4=class extends B.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?B.createElement(Pn.Provider,{value:this.props.routeContext},B.createElement(l0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function e3({routeContext:e,match:t,children:r}){let n=B.useContext(ki);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),B.createElement(Pn.Provider,{value:e},r)}function t3(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,i=r==null?void 0:r.errors;if(i!=null){let c=s.findIndex(u=>u.route.id&&(i==null?void 0:i[u.route.id])!==void 0);ot(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<s.length;c++){let u=s[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:f,errors:d}=r,h=u.route.loader&&!f.hasOwnProperty(u.route.id)&&(!d||d[u.route.id]===void 0);if(u.route.lazy||h){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,u,f)=>{let d,h=!1,v=null,g=null;r&&(d=i&&u.route.id?i[u.route.id]:void 0,v=u.route.errorElement||J4,o&&(l<0&&f===0?(Gy("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,g=null):l===f&&(h=!0,g=u.route.hydrateFallbackElement||null)));let _=t.concat(s.slice(0,f+1)),w=()=>{let y;return d?y=v:h?y=g:u.route.Component?y=B.createElement(u.route.Component,null):u.route.element?y=u.route.element:y=c,B.createElement(e3,{match:u,routeContext:{outlet:c,matches:_,isDataRoute:r!=null},children:y})};return r&&(u.route.ErrorBoundary||u.route.errorElement||f===0)?B.createElement(Q4,{location:r.location,revalidation:r.revalidation,component:v,error:d,children:w(),routeContext:{outlet:null,matches:_,isDataRoute:!0},unstable_onError:n}):w()},null)}function u0(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function r3(e){let t=B.useContext(ki);return ot(t,u0(e)),t}function n3(e){let t=B.useContext(bu);return ot(t,u0(e)),t}function a3(e){let t=B.useContext(Pn);return ot(t,u0(e)),t}function f0(e){let t=a3(e),r=t.matches[t.matches.length-1];return ot(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function s3(){return f0("useRouteId")}function i3(){var n;let e=B.useContext(l0),t=n3("useRouteError"),r=f0("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function o3(){let{router:e}=r3("useNavigate"),t=f0("useNavigate"),r=B.useRef(!1);return Wy(()=>{r.current=!0}),B.useCallback(async(a,s={})=>{vn(r.current,Vy),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...s}))},[e,t])}var y1={};function Gy(e,t,r){!t&&!y1[e]&&(y1[e]=!0,vn(!1,r))}B.memo(l3);function l3({routes:e,future:t,state:r,unstable_onError:n}){return Hy(e,void 0,r,n,t)}function Fd({to:e,replace:t,state:r,relative:n}){ot(xi(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=B.useContext(yn);vn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=B.useContext(Pn),{pathname:i}=Ma(),o=c0(),l=o0(e,i0(s),i,n==="path"),c=JSON.stringify(l);return B.useEffect(()=>{o(JSON.parse(c),{replace:t,state:r,relative:n})},[o,c,n,t,r]),null}function pc(e){ot(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function c3({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){ot(!xi(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),o=B.useMemo(()=>({basename:i,navigator:a,static:s,future:{}}),[i,a,s]);typeof r=="string"&&(r=_i(r));let{pathname:l="/",search:c="",hash:u="",state:f=null,key:d="default"}=r,h=B.useMemo(()=>{let v=ra(l,i);return v==null?null:{location:{pathname:v,search:c,hash:u,state:f,key:d},navigationType:n}},[i,l,c,u,f,d,n]);return vn(h!=null,`<Router basename="${i}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:B.createElement(yn.Provider,{value:o},B.createElement(ol.Provider,{children:t,value:h}))}function u3({children:e,location:t}){return Y4(jd(e),t)}function jd(e,t=[]){let r=[];return B.Children.forEach(e,(n,a)=>{if(!B.isValidElement(n))return;let s=[...t,a];if(n.type===B.Fragment){r.push.apply(r,jd(n.props.children,s));return}ot(n.type===pc,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ot(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=jd(n.props.children,s)),r.push(i)}),r}var mc="get",gc="application/x-www-form-urlencoded";function Cu(e){return e!=null&&typeof e.tagName=="string"}function f3(e){return Cu(e)&&e.tagName.toLowerCase()==="button"}function d3(e){return Cu(e)&&e.tagName.toLowerCase()==="form"}function h3(e){return Cu(e)&&e.tagName.toLowerCase()==="input"}function p3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function m3(e,t){return e.button===0&&(!t||t==="_self")&&!p3(e)}var Ml=null;function g3(){if(Ml===null)try{new FormData(document.createElement("form"),0),Ml=!1}catch{Ml=!0}return Ml}var v3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xf(e){return e!=null&&!v3.has(e)?(vn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gc}"`),null):e}function y3(e,t){let r,n,a,s,i;if(d3(e)){let o=e.getAttribute("action");n=o?ra(o,t):null,r=e.getAttribute("method")||mc,a=xf(e.getAttribute("enctype"))||gc,s=new FormData(e)}else if(f3(e)||h3(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||o.getAttribute("action");if(n=l?ra(l,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||mc,a=xf(e.getAttribute("formenctype"))||xf(o.getAttribute("enctype"))||gc,s=new FormData(o,e),!g3()){let{name:c,type:u,value:f}=e;if(u==="image"){let d=c?`${c}.`:"";s.append(`${d}x`,"0"),s.append(`${d}y`,"0")}else c&&s.append(c,f)}}else{if(Cu(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=mc,n=null,a=gc,i=e}return s&&a==="text/plain"&&(i=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function d0(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function w3(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&ra(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function _3(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function k3(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function x3(e,t,r){let n=await Promise.all(e.map(async a=>{let s=t.routes[a.route.id];if(s){let i=await _3(s,r);return i.links?i.links():[]}return[]}));return b3(n.flat(1).filter(k3).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function w1(e,t,r,n,a,s){let i=(l,c)=>r[c]?l.route.id!==r[c].route.id:!0,o=(l,c)=>{var u;return r[c].pathname!==l.pathname||((u=r[c].route.path)==null?void 0:u.endsWith("*"))&&r[c].params["*"]!==l.params["*"]};return s==="assets"?t.filter((l,c)=>i(l,c)||o(l,c)):s==="data"?t.filter((l,c)=>{var f;let u=n.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(i(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function E3(e,t,{includeHydrateFallback:r}={}){return T3(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function T3(e){return[...new Set(e)]}function S3(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function b3(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let s=JSON.stringify(S3(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function Ky(){let e=B.useContext(ki);return d0(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function C3(){let e=B.useContext(bu);return d0(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var h0=B.createContext(void 0);h0.displayName="FrameworkContext";function Zy(){let e=B.useContext(h0);return d0(e,"You must render this element inside a <HydratedRouter> element"),e}function A3(e,t){let r=B.useContext(h0),[n,a]=B.useState(!1),[s,i]=B.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:f}=t,d=B.useRef(null);B.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let g=w=>{w.forEach(y=>{i(y.isIntersecting)})},_=new IntersectionObserver(g,{threshold:.5});return d.current&&_.observe(d.current),()=>{_.disconnect()}}},[e]),B.useEffect(()=>{if(n){let g=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(g)}}},[n]);let h=()=>{a(!0)},v=()=>{a(!1),i(!1)};return r?e!=="intent"?[s,d,{}]:[s,d,{onFocus:Bi(o,h),onBlur:Bi(l,v),onMouseEnter:Bi(c,h),onMouseLeave:Bi(u,v),onTouchStart:Bi(f,h)}]:[!1,d,{}]}function Bi(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function N3({page:e,...t}){let{router:r}=Ky(),n=B.useMemo(()=>My(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?B.createElement(R3,{page:e,matches:n,...t}):null}function O3(e){let{manifest:t,routeModules:r}=Zy(),[n,a]=B.useState([]);return B.useEffect(()=>{let s=!1;return x3(e,t,r).then(i=>{s||a(i)}),()=>{s=!0}},[e,t,r]),n}function R3({page:e,matches:t,...r}){let n=Ma(),{manifest:a,routeModules:s}=Zy(),{basename:i}=Ky(),{loaderData:o,matches:l}=C3(),c=B.useMemo(()=>w1(e,t,l,a,n,"data"),[e,t,l,a,n]),u=B.useMemo(()=>w1(e,t,l,a,n,"assets"),[e,t,l,a,n]),f=B.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let v=new Set,g=!1;if(t.forEach(w=>{var p;let y=a.routes[w.route.id];!y||!y.hasLoader||(!c.some(k=>k.route.id===w.route.id)&&w.route.id in o&&((p=s[w.route.id])!=null&&p.shouldRevalidate)||y.hasClientLoader?g=!0:v.add(w.route.id))}),v.size===0)return[];let _=w3(e,i,"data");return g&&v.size>0&&_.searchParams.set("_routes",t.filter(w=>v.has(w.route.id)).map(w=>w.route.id).join(",")),[_.pathname+_.search]},[i,o,n,a,c,t,e,s]),d=B.useMemo(()=>E3(u,a),[u,a]),h=O3(u);return B.createElement(B.Fragment,null,f.map(v=>B.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...r})),d.map(v=>B.createElement("link",{key:v,rel:"modulepreload",href:v,...r})),h.map(({key:v,link:g})=>B.createElement("link",{key:v,nonce:r.nonce,...g})))}function P3(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Xy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Xy&&(window.__reactRouterVersion="7.8.2")}catch{}function I3({basename:e,children:t,window:r}){let n=B.useRef();n.current==null&&(n.current=k4({window:r,v5Compat:!0}));let a=n.current,[s,i]=B.useState({action:a.action,location:a.location}),o=B.useCallback(l=>{B.startTransition(()=>i(l))},[i]);return B.useLayoutEffect(()=>a.listen(o),[a,o]),B.createElement(c3,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:a})}var Yy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qy=B.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:f,...d},h){let{basename:v}=B.useContext(yn),g=typeof c=="string"&&Yy.test(c),_,w=!1;if(typeof c=="string"&&g&&(_=c,Xy))try{let I=new URL(window.location.href),z=c.startsWith("//")?new URL(I.protocol+c):new URL(c),V=ra(z.pathname,v);z.origin===I.origin&&V!=null?c=V+z.search+z.hash:w=!0}catch{vn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=Z4(c,{relative:a}),[p,k,T]=A3(n,d),S=j3(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:f});function x(I){t&&t(I),I.defaultPrevented||S(I)}let D=B.createElement("a",{...d,...T,href:_||y,onClick:w||s?t:x,ref:P3(h,k),target:l,"data-discover":!g&&r==="render"?"true":void 0});return p&&!g?B.createElement(B.Fragment,null,D,B.createElement(N3,{page:y})):D});qy.displayName="Link";var D3=B.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:i,viewTransition:o,children:l,...c},u){let f=ll(i,{relative:c.relative}),d=Ma(),h=B.useContext(bu),{navigator:v,basename:g}=B.useContext(yn),_=h!=null&&z3(f)&&o===!0,w=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,y=d.pathname,p=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),p=p?p.toLowerCase():null,w=w.toLowerCase()),p&&g&&(p=ra(p,g)||p);const k=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let T=y===w||!a&&y.startsWith(w)&&y.charAt(k)==="/",S=p!=null&&(p===w||!a&&p.startsWith(w)&&p.charAt(w.length)==="/"),x={isActive:T,isPending:S,isTransitioning:_},D=T?t:void 0,I;typeof n=="function"?I=n(x):I=[n,T?"active":null,S?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let z=typeof s=="function"?s(x):s;return B.createElement(qy,{...c,"aria-current":D,className:I,ref:u,style:z,to:i,viewTransition:o},typeof l=="function"?l(x):l)});D3.displayName="NavLink";var L3=B.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:s,method:i=mc,action:o,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:f,...d},h)=>{let v=U3(),g=B3(o,{relative:c}),_=i.toLowerCase()==="get"?"get":"post",w=typeof o=="string"&&Yy.test(o),y=p=>{if(l&&l(p),p.defaultPrevented)return;p.preventDefault();let k=p.nativeEvent.submitter,T=(k==null?void 0:k.getAttribute("formmethod"))||i;v(k||p.currentTarget,{fetcherKey:t,method:T,navigate:r,replace:a,state:s,relative:c,preventScrollReset:u,viewTransition:f})};return B.createElement("form",{ref:h,method:_,action:g,onSubmit:n?l:y,...d,"data-discover":!w&&e==="render"?"true":void 0})});L3.displayName="Form";function F3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jy(e){let t=B.useContext(ki);return ot(t,F3(e)),t}function j3(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:i}={}){let o=c0(),l=Ma(),c=ll(e,{relative:s});return B.useCallback(u=>{if(m3(u,t)){u.preventDefault();let f=r!==void 0?r:Wo(l)===Wo(c);o(e,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:i})}},[l,o,c,r,n,t,e,a,s,i])}var M3=0,$3=()=>`__${String(++M3)}__`;function U3(){let{router:e}=Jy("useSubmit"),{basename:t}=B.useContext(yn),r=s3();return B.useCallback(async(n,a={})=>{let{action:s,method:i,encType:o,formData:l,body:c}=y3(n,t);if(a.navigate===!1){let u=a.fetcherKey||$3();await e.fetch(u,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function B3(e,{relative:t}={}){let{basename:r}=B.useContext(yn),n=B.useContext(Pn);ot(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...ll(e||".",{relative:t})},i=Ma();if(e==null){s.search=i.search;let o=new URLSearchParams(s.search),l=o.getAll("index");if(l.some(u=>u==="")){o.delete("index"),l.filter(f=>f).forEach(f=>o.append("index",f));let u=o.toString();s.search=u?`?${u}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:Xn([r,s.pathname])),Wo(s)}function z3(e,{relative:t}={}){let r=B.useContext(zy);ot(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Jy("useViewTransitionState"),a=ll(e,{relative:t});if(!r.isTransitioning)return!1;let s=ra(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=ra(r.nextLocation.pathname,n)||r.nextLocation.pathname;return zc(a.pathname,i)!=null||zc(a.pathname,s)!=null}const V3="modulepreload",W3=function(e){return"/"+e},_1={},cl=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=W3(l),l in _1)return;_1[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":V3,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((d,h)=>{f.addEventListener("load",d),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},H3=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>cl(async()=>{const{default:n}=await Promise.resolve().then(()=>Ei);return{default:n}},[]).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class p0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class G3 extends p0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class k1 extends p0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class x1 extends p0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Md;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Md||(Md={}));var K3=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class Z3{constructor(t,{headers:r={},customFetch:n,region:a=Md.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=H3(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return K3(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const f=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(g=>{throw new G3(g)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new k1(f);if(!f.ok)throw new x1(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return h==="application/json"?v=yield f.json():h==="application/octet-stream"?v=yield f.blob():h==="text/event-stream"?v=f:h==="multipart/form-data"?v=yield f.formData():v=yield f.text(),{data:v,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof x1||a instanceof k1?a.context:void 0}}})}}var Er={},m0={},Au={},ul={},Nu={},Ou={},X3=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("unable to locate global object")},pi=X3();const Y3=pi.fetch,Qy=pi.fetch.bind(pi),e2=pi.Headers,q3=pi.Request,J3=pi.Response,Ei=Object.freeze(Object.defineProperty({__proto__:null,Headers:e2,Request:q3,Response:J3,default:Qy,fetch:Y3},Symbol.toStringTag,{value:"Module"})),Q3=Z_(Ei);var Ru={};Object.defineProperty(Ru,"__esModule",{value:!0});let eE=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Ru.default=eE;var t2=Gr&&Gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ou,"__esModule",{value:!0});const tE=t2(Q3),rE=t2(Ru);let nE=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=tE.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l,c;let u=null,f=null,d=null,h=s.status,v=s.statusText;if(s.ok){if(this.method!=="HEAD"){const y=await s.text();y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?f=y:f=JSON.parse(y))}const _=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),w=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");_&&w&&w.length>1&&(d=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,d=null,h=406,v="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const _=await s.text();try{u=JSON.parse(_),Array.isArray(u)&&s.status===404&&(f=[],u=null,h=200,v="OK")}catch{s.status===404&&_===""?(h=204,v="No Content"):u={message:_}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,h=200,v="OK"),u&&this.shouldThrowOnError)throw new rE.default(u)}return{error:u,data:f,count:d,status:h,statusText:v}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Ou.default=nE;var aE=Gr&&Gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nu,"__esModule",{value:!0});const sE=aE(Ou);let iE=class extends sE.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Nu.default=iE;var oE=Gr&&Gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ul,"__esModule",{value:!0});const lE=oE(Nu);let cE=class extends lE.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};ul.default=cE;var uE=Gr&&Gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Au,"__esModule",{value:!0});const zi=uE(ul);let fE=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new zi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const s="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new zi.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new zi.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new zi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new zi.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Au.default=fE;var r2=Gr&&Gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(m0,"__esModule",{value:!0});const dE=r2(Au),hE=r2(ul);let pE=class n2{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new dE.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new n2(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([f,d])=>d!==void 0).map(([f,d])=>[f,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([f,d])=>{l.searchParams.append(f,d)})):(o="POST",c=r);const u=new Headers(this.headers);return s&&u.set("Prefer",`count=${s}`),new hE.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};m0.default=pE;var Ti=Gr&&Gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Er,"__esModule",{value:!0});Er.PostgrestError=Er.PostgrestBuilder=Er.PostgrestTransformBuilder=Er.PostgrestFilterBuilder=Er.PostgrestQueryBuilder=Er.PostgrestClient=void 0;const a2=Ti(m0);Er.PostgrestClient=a2.default;const s2=Ti(Au);Er.PostgrestQueryBuilder=s2.default;const i2=Ti(ul);Er.PostgrestFilterBuilder=i2.default;const o2=Ti(Nu);Er.PostgrestTransformBuilder=o2.default;const l2=Ti(Ou);Er.PostgrestBuilder=l2.default;const c2=Ti(Ru);Er.PostgrestError=c2.default;var mE=Er.default={PostgrestClient:a2.default,PostgrestQueryBuilder:s2.default,PostgrestFilterBuilder:i2.default,PostgrestTransformBuilder:o2.default,PostgrestBuilder:l2.default,PostgrestError:c2.default};const{PostgrestClient:gE,PostgrestQueryBuilder:lL,PostgrestFilterBuilder:cL,PostgrestTransformBuilder:uL,PostgrestBuilder:fL,PostgrestError:dL}=mE;class vE{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const yE="2.15.5",wE=`realtime-js/${yE}`,_E="1.0.0",$d=1e4,kE=1e3,xE=100;var fo;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(fo||(fo={}));var At;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(At||(At={}));var sn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(sn||(sn={}));var Ud;(function(e){e.websocket="websocket"})(Ud||(Ud={}));var Xa;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Xa||(Xa={}));class EE{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const l=n.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class u2{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Je;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Je||(Je={}));const E1=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=TE(i,e,t,a),s),{})},TE=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?f2(s,i):Bd(i)},f2=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return AE(t,r)}switch(e){case Je.bool:return SE(t);case Je.float4:case Je.float8:case Je.int2:case Je.int4:case Je.int8:case Je.numeric:case Je.oid:return bE(t);case Je.json:case Je.jsonb:return CE(t);case Je.timestamp:return NE(t);case Je.abstime:case Je.date:case Je.daterange:case Je.int4range:case Je.int8range:case Je.money:case Je.reltime:case Je.text:case Je.time:case Je.timestamptz:case Je.timetz:case Je.tsrange:case Je.tstzrange:return Bd(t);default:return Bd(t)}},Bd=e=>e,SE=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},bE=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},CE=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},AE=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>f2(t,o))}return e},NE=e=>typeof e=="string"?e.replace(" ","T"):e,d2=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Ef{constructor(t,r,n={},a=$d){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var T1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(T1||(T1={}));class ho{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ho.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=ho.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=ho.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const f=s[c];if(f){const d=u.map(_=>_.presence_ref),h=f.map(_=>_.presence_ref),v=u.filter(_=>h.indexOf(_.presence_ref)<0),g=f.filter(_=>d.indexOf(_.presence_ref)<0);v.length>0&&(o[c]=v),g.length>0&&(l[c]=g)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(h=>h.presence_ref),d=u.filter(h=>f.indexOf(h.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var S1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(S1||(S1={}));var po;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(po||(po={}));var zn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(zn||(zn={}));class g0{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=At.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ef(this,sn.join,this.params,this.timeout),this.rejoinTimer=new u2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=At.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=At.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this._on(sn.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new ho(this),this.broadcastEndpointURL=d2(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==At.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[po.PRESENCE]&&this.bindings[po.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},d={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(zn.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(zn.CLOSED)),this.updateJoinPayload(Object.assign({config:d},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket.setAuth(),h===void 0){t==null||t(zn.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,_=(v=g==null?void 0:g.length)!==null&&v!==void 0?v:0,w=[];for(let y=0;y<_;y++){const p=g[y],{filter:{event:k,schema:T,table:S,filter:x}}=p,D=h&&h[y];if(D&&D.event===k&&D.schema===T&&D.table===S&&D.filter===x)w.push(Object.assign(Object.assign({},p),{id:D.id}));else{this.unsubscribe(),this.state=At.errored,t==null||t(zn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(zn.SUBSCRIBED);return}}).receive("error",h=>{this.state=At.errored,t==null||t(zn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(zn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===At.joined&&t===po.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=At.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(sn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Ef(this,sn.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=At.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Ef(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>xE){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=sn;if(n&&[o,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let d=this._onMessage(i,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var v,g,_;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((_=(g=h.filter)===null||g===void 0?void 0:g.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(h=>h.callback(d,n)):(s=this.bindings[i])===null||s===void 0||s.filter(h=>{var v,g,_,w,y,p;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in h){const k=h.id,T=(v=h.filter)===null||v===void 0?void 0:v.event;return k&&((g=r.ids)===null||g===void 0?void 0:g.includes(k))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const k=(y=(w=h==null?void 0:h.filter)===null||w===void 0?void 0:w.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return k==="*"||k===((p=r==null?void 0:r.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===i}).map(h=>{if(typeof d=="object"&&"ids"in d){const v=d.data,{schema:g,table:_,commit_timestamp:w,type:y,errors:p}=v;d=Object.assign(Object.assign({},{schema:g,table:_,commit_timestamp:w,eventType:y,new:{},old:{},errors:p}),this._getPayloadRecords(v))}h.callback(d,n)})}_isClosed(){return this.state===At.closed}_isJoined(){return this.state===At.joined}_isJoining(){return this.state===At.joining}_isLeaving(){return this.state===At.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&g0.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(sn.close,{},t)}_onError(t){this._on(sn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=At.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=E1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=E1(t.columns,t.old_record)),r}}const Tf=()=>{},$l={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},OE=[1e3,2e3,5e3,1e4],RE=1e4,PE=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class IE{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=$d,this.transport=null,this.heartbeatIntervalMs=$l.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Tf,this.ref=0,this.reconnectTimer=null,this.logger=Tf,this.conn=null,this.sendBuffer=[],this.serializer=new EE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...i)=>cl(async()=>{const{default:o}=await Promise.resolve().then(()=>Ei);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Ud.websocket}`,this.httpEndpoint=d2(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=vE.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:_E}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case fo.connecting:return Xa.Connecting;case fo.open:return Xa.Open;case fo.closing:return Xa.Closing;default:return Xa.Closed}}isConnected(){return this.connectionState()===Xa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new g0(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(kE,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},$l.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(sn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([PE],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:wE};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(sn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new u2(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$l.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,l,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:$d,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:$l.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Tf,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:f=>OE[f-1]||RE,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(f,d)=>d(JSON.stringify(f)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class v0 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Nt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class DE extends v0{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class zd extends v0{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var LE=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const h2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>cl(async()=>{const{default:n}=await Promise.resolve().then(()=>Ei);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},FE=()=>LE(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield cl(()=>Promise.resolve().then(()=>Ei),void 0)).Response:Response}),Vd=e=>{if(Array.isArray(e))return e.map(r=>Vd(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Vd(n)}),t},jE=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var ys=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Sf=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ME=(e,t,r)=>ys(void 0,void 0,void 0,function*(){const n=yield FE();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,i=(a==null?void 0:a.statusCode)||s+"";t(new DE(Sf(a),s,i))}).catch(a=>{t(new zd(Sf(a),a))}):t(new zd(Sf(e),e))}),$E=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(jE(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function fl(e,t,r,n,a,s){return ys(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,$E(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>ME(l,o,n))})})}function Vc(e,t,r,n){return ys(this,void 0,void 0,function*(){return fl(e,"GET",t,r,n)})}function Tn(e,t,r,n,a){return ys(this,void 0,void 0,function*(){return fl(e,"POST",t,n,a,r)})}function Wd(e,t,r,n,a){return ys(this,void 0,void 0,function*(){return fl(e,"PUT",t,n,a,r)})}function UE(e,t,r,n){return ys(this,void 0,void 0,function*(){return fl(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function p2(e,t,r,n,a){return ys(this,void 0,void 0,function*(){return fl(e,"DELETE",t,n,a,r)})}var lr=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const BE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},b1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class zE{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=h2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return lr(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},b1),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield(t=="PUT"?Wd:Tn)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return lr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:b1.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield Wd(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Nt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return lr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield Tn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new v0("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}update(t,r,n){return lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return lr(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Nt(a))return{data:null,error:a};throw a}})}copy(t,r,n){return lr(this,void 0,void 0,function*(){try{return{data:{path:(yield Tn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Nt(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return lr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Tn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Nt(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return lr(this,void 0,void 0,function*(){try{const a=yield Tn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Nt(a))return{data:null,error:a};throw a}})}download(t,r){return lr(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Vc(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Nt(o))return{data:null,error:o};throw o}})}info(t){return lr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Vc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Vd(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}exists(t){return lr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield UE(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n)&&n instanceof zd){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return lr(this,void 0,void 0,function*(){try{return{data:yield p2(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}list(t,r,n){return lr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},BE),r),{prefix:t||""});return{data:yield Tn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Nt(a))return{data:null,error:a};throw a}})}listV2(t,r){return lr(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Tn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const VE="2.12.1",WE={"X-Client-Info":`storage-js/${VE}`};var bs=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,[])).next())})};class HE{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},WE),r),this.fetch=h2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return bs(this,void 0,void 0,function*(){try{return{data:yield Vc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nt(t))return{data:null,error:t};throw t}})}getBucket(t){return bs(this,void 0,void 0,function*(){try{return{data:yield Vc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return bs(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return bs(this,void 0,void 0,function*(){try{return{data:yield Wd(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return bs(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return bs(this,void 0,void 0,function*(){try{return{data:yield p2(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}}class GE extends HE{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new zE(this.url,this.headers,t,this.fetch)}}const KE="2.57.4";let Yi="";typeof Deno<"u"?Yi="deno":typeof document<"u"?Yi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Yi="react-native":Yi="node";const ZE={"X-Client-Info":`supabase-js-${Yi}/${KE}`},XE={headers:ZE},YE={schema:"public"},qE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},JE={};var QE=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const eT=e=>{let t;return e?t=e:typeof fetch>"u"?t=Qy:t=fetch,(...r)=>t(...r)},tT=()=>typeof Headers>"u"?e2:Headers,rT=(e,t,r)=>{const n=eT(r),a=tT();return(s,i)=>QE(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var nT=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,[])).next())})};function aT(e){return e.endsWith("/")?e:e+"/"}function sT(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:f}=t,d={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>nT(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}function iT(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(aT(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const m2="2.71.1",Is=30*1e3,Hd=3,bf=Hd*Is,oT="http://localhost:9999",lT="supabase.auth.token",cT={"X-Client-Info":`gotrue-js/${m2}`},Gd="X-Supabase-Api-Version",g2={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},uT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,fT=10*60*1e3;class y0 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function $e(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class dT extends y0{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function hT(e){return $e(e)&&e.name==="AuthApiError"}class v2 extends y0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class $a extends y0{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class ca extends $a{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function pT(e){return $e(e)&&e.name==="AuthSessionMissingError"}class Ul extends $a{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Bl extends $a{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class zl extends $a{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function mT(e){return $e(e)&&e.name==="AuthImplicitGrantRedirectError"}class C1 extends $a{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Kd extends $a{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Cf(e){return $e(e)&&e.name==="AuthRetryableFetchError"}class A1 extends $a{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Zd extends $a{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Wc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),N1=` 	
\r=`.split(""),gT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<N1.length;t+=1)e[N1[t].charCodeAt(0)]=-2;for(let t=0;t<Wc.length;t+=1)e[Wc[t].charCodeAt(0)]=t;return e})();function O1(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Wc[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Wc[n]),t.queuedBits-=6}}function y2(e,t,r){const n=gT[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function R1(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{wT(i,n,r)};for(let i=0;i<e.length;i+=1)y2(e.charCodeAt(i),a,s);return t.join("")}function vT(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function yT(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}vT(n,t)}}function wT(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function _T(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)y2(e.charCodeAt(a),r,n);return new Uint8Array(t)}function kT(e){const t=[];return yT(e,r=>t.push(r)),new Uint8Array(t)}function xT(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>O1(a,r,n)),O1(null,r,n),t.join("")}function ET(e){return Math.round(Date.now()/1e3)+e}function TT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const rn=()=>typeof window<"u"&&typeof document<"u",Wa={tested:!1,writable:!1},w2=()=>{if(!rn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Wa.tested)return Wa.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Wa.tested=!0,Wa.writable=!0}catch{Wa.tested=!0,Wa.writable=!1}return Wa.writable};function ST(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const _2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>cl(async()=>{const{default:n}=await Promise.resolve().then(()=>Ei);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},bT=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ds=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ha=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},oa=async(e,t)=>{await e.removeItem(t)};class Pu{constructor(){this.promise=new Pu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Pu.promiseConstructor=Promise;function Af(e){const t=e.split(".");if(t.length!==3)throw new Zd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!uT.test(t[n]))throw new Zd("JWT not in base64url format");return{header:JSON.parse(R1(t[0])),payload:JSON.parse(R1(t[1])),signature:_T(t[2]),raw:{header:t[0],payload:t[1]}}}async function CT(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function AT(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function NT(e){return("0"+e.toString(16)).substr(-2)}function OT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,NT).join("")}async function RT(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function PT(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await RT(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Cs(e,t,r=!1){const n=OT();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Ds(e,`${t}-code-verifier`,a);const s=await PT(n);return[s,n===s?"plain":"s256"]}const IT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function DT(e){const t=e.headers.get(Gd);if(!t||!t.match(IT))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function LT(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function FT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const jT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function As(e){if(!jT.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Nf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function P1(e){return JSON.parse(JSON.stringify(e))}var MT=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Za=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),$T=[502,503,504];async function I1(e){var t;if(!bT(e))throw new Kd(Za(e),0);if($T.includes(e.status))throw new Kd(Za(e),e.status);let r;try{r=await e.json()}catch(s){throw new v2(Za(s),s)}let n;const a=DT(e);if(a&&a.getTime()>=g2["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new A1(Za(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ca}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new A1(Za(r),e.status,r.weak_password.reasons);throw new dT(Za(r),e.status||500,n)}const UT=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function ze(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[Gd]||(s[Gd]=g2["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await BT(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function BT(e,t,r,n,a,s){const i=UT(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new Kd(Za(l),0)}if(o.ok||await I1(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await I1(l)}}function Un(e){var t;let r=null;HT(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=ET(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function D1(e){const t=Un(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function pa(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function zT(e){return{data:e,error:null}}function VT(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=MT(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function WT(e){return e}function HT(e){return e.access_token&&e.refresh_token&&e.expires_in}const Of=["global","local","others"];var GT=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class KT{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=_2(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Of[0]){if(Of.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Of.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:pa})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=GT(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:VT,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if($e(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:pa})}catch(r){if($e(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:WT});if(u.error)throw u.error;const f=await u.json(),d=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);c[`${_}Page`]=g}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if($e(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){As(t);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:pa})}catch(r){if($e(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){As(t);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:pa})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){As(t);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:pa})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){As(t.userId);try{const{data:r,error:n}=await ze(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if($e(r))return{data:null,error:r};throw r}}async _deleteFactor(t){As(t.userId),As(t.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}}}function L1(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function ZT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ns={debug:!!(globalThis&&w2()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class k2 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class XT extends k2{}async function YT(e,t,r){Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new XT(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ns.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}ZT();const qT={url:oT,storageKey:lT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:cT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function F1(e,t,r){return await r()}const Os={};class Ho{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ho.nextInstanceID,Ho.nextInstanceID+=1,this.instanceID>0&&rn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},qT),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new KT({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=_2(a.fetch),this.lock=a.lock||F1,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:rn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=YT:this.lock=F1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:w2()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=L1(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=L1(this.memoryStorage)),rn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Os[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Os[this.storageKey]=Object.assign(Object.assign({},Os[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Os[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Os[this.storageKey]=Object.assign(Object.assign({},Os[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${m2}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=ST(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),rn()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),mT(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return $e(r)?{error:r}:{error:new v2("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Un}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if($e(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:u,password:f,options:d}=t;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await Cs(this.storage,this.storageKey)),s=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:f,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:v},xform:Un})}else if("phone"in t){const{phone:u,password:f,options:d}=t;s=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(a=d==null?void 0:d.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Un})}else throw new Bl("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if($e(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:D1})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:D1})}else throw new Bl("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ul}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if($e(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,i,o,l,c,u,f,d,h;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:_,wallet:w,statement:y,options:p}=t;let k;if(rn())if(typeof w=="object")k=w;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))k=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=w}const T=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const S=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),y?{statement:y}:null));let x;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")x=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)x=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in x&&"signature"in x&&(typeof x.signedMessage=="string"||x.signedMessage instanceof Uint8Array)&&x.signature instanceof Uint8Array)v=typeof x.signedMessage=="string"?x.signedMessage:new TextDecoder().decode(x.signedMessage),g=x.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${T.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(a=(n=p==null?void 0:p.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=p==null?void 0:p.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((i=p==null?void 0:p.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((o=p==null?void 0:p.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((f=(u=p==null?void 0:p.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...p.signInWithSolana.resources.map(x=>`- ${x}`)]:[]].join(`
`);const S=await k.signMessage(new TextEncoder().encode(v),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=S}}try{const{data:_,error:w}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:xT(g)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Un});if(w)throw w;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Ul}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:w})}catch(_){if($e(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(t){const r=await Ha(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Un});if(await oa(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Ul}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if($e(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Un}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ul}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if($e(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Cs(this.storage,this.storageKey));const{error:f}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Bl("You must provide either an email or phone number.")}catch(o){if($e(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Un});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if($e(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Cs(this.storage,this.storageKey)),await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:zT})}catch(s){if($e(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ca;const{error:a}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if($e(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Bl("You must provide either an email or phone number and a type")}catch(r){if($e(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ha(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<bf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await Ha(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Nf()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:pa}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ca}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:pa})})}catch(r){if($e(r))return pT(r)&&(await this._removeSession(),await oa(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new ca;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Cs(this.storage,this.storageKey));const{data:c,error:u}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:pa});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ca;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=Af(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if($e(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ca;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if($e(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!rn())throw new zl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new zl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new C1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new C1("No code detected.");const{data:y,error:p}=await this._exchangeCodeForSession(t.code);if(p)throw p;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new zl("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let d=u+f;l&&(d=parseInt(l));const h=d-u;h*1e3<=Is&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const v=d-f;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,d,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,d,u);const{data:g,error:_}=await this._getUser(s);if(_)throw _;const w={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:f,expires_at:d,refresh_token:i,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(n){if($e(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ha(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(hT(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await oa(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=TT(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Cs(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if($e(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,u;const{data:f,error:d}=s;if(d)throw d;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return rn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if($e(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if($e(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await AT(async a=>(a>0&&await CT(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Un})),(a,s)=>{const i=200*Math.pow(2,a);return s&&Cf(s)&&Date.now()+i-n<Is})}catch(n){if(this._debug(r,"error",n),$e(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),rn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Ha(this.storage,this.storageKey);if(a&&this.userStorage){let i=await Ha(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await Ds(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Nf()}else if(a&&!a.user&&!a.user){const i=await Ha(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await oa(this.storage,this.storageKey+"-user"),await Ds(this.storage,this.storageKey,a)):a.user=Nf()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<bf;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${bf}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),Cf(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ca;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Pu;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new ca;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),$e(s)){const i={session:null,error:s};return Cf(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ds(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=P1(a);await Ds(this.storage,this.storageKey,s)}else{const a=P1(r);await Ds(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await oa(this.storage,this.storageKey),await oa(this.storage,this.storageKey+"-code-verifier"),await oa(this.storage,this.storageKey+"-user"),this.userStorage&&await oa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&rn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Is);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Is);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Is}ms, refresh threshold is ${Hd} ticks`),a<=Hd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof k2)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!rn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Cs(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await ze(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if($e(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if($e(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if($e(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if($e(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Af(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+fT>a)return n;const{data:s,error:i}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};n=h.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=Af(n);r!=null&&r.allowExpired||LT(s.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:s,header:a,signature:i},error:null}}const u=FT(a.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,i,kT(`${o}.${l}`)))throw new Zd("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}}}Ho.nextInstanceID=0;const JT=Ho;class QT extends JT{constructor(t){super(t)}}var eS=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,[])).next())})};class tS{constructor(t,r,n){var a,s,i;this.supabaseUrl=t,this.supabaseKey=r;const o=iT(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:YE,realtime:JE,auth:Object.assign(Object.assign({},qE),{storageKey:l}),global:XE},u=sT(n??{},c);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=rT(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new gE(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new GE(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Z3(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return eS(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,storageKey:i,flowType:o,lock:l,debug:c},u,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new QT({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,flowType:o,lock:l,debug:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new IE(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const rS=(e,t,r)=>new tS(e,t,r);function nS(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}nS()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const x2="http://localhost:54321",aS="mock-key-for-development",j1=x2!=="http://localhost:54321",kn=rS(x2,aS,{auth:{autoRefreshToken:j1,persistSession:j1,detectSessionInUrl:!1}}),E2=B.createContext(void 0),sS=({children:e})=>{const[t,r]=B.useState(()=>{try{if(typeof window>"u")return null;const l=localStorage.getItem("auth_user");if(l){const c=JSON.parse(l);if(c&&typeof c=="object"&&c.username)return c}return null}catch(l){console.warn("Failed to parse saved user from localStorage:",l);try{localStorage.removeItem("auth_user")}catch{}return null}}),[n,a]=B.useState(!0),s=async(l,c)=>{var u,f,d,h,v,g;a(!0);try{const{data:_,error:w}=await kn.auth.signInWithPassword({email:l.includes("@")?l:`${l}@manipularium.com`,password:c});if(w){if(console.error("Supabase login error:",w.message),l==="admin"&&c==="manipularium"){const y={username:"admin"};return r(y),localStorage.setItem("auth_user",JSON.stringify(y)),!0}return!1}if(_.user){let{data:y,error:p}=await kn.from("profiles").select("*").eq("id",_.user.id).single();if(p&&p.code==="PGRST116"){const{data:T,error:S}=await kn.from("profiles").insert({id:_.user.id,username:((u=_.user.email)==null?void 0:u.split("@")[0])||"user",full_name:((f=_.user.user_metadata)==null?void 0:f.full_name)||((d=_.user.email)==null?void 0:d.split("@")[0]),role:"user"}).select().single();S?(console.error("Error creating profile:",S.message),y={id:_.user.id,username:((h=_.user.email)==null?void 0:h.split("@")[0])||"user",full_name:((v=_.user.email)==null?void 0:v.split("@")[0])||"user",role:"user"}):y=T}const k={username:(y==null?void 0:y.username)||((g=_.user.email)==null?void 0:g.split("@")[0])||"user",id:_.user.id,email:_.user.email,profile:y};return r(k),localStorage.setItem("auth_user",JSON.stringify(k)),!0}return!1}catch(_){if(console.error("Login error:",_),l==="admin"&&c==="manipularium"){const w={username:"admin"};return r(w),localStorage.setItem("auth_user",JSON.stringify(w)),!0}return!1}finally{a(!1)}},i=async()=>{try{await kn.auth.signOut()}catch(l){console.error("Logout error:",l)}r(null),localStorage.removeItem("auth_user"),localStorage.removeItem("dashboard_filters")};B.useEffect(()=>{if(t){a(!1);try{kn.auth.getSession().then(({data:{session:l}})=>{!(l!=null&&l.user)&&!t.username.includes("admin")&&i()}).catch(l=>{console.warn("Supabase session check failed:",l)})}catch(l){console.warn("Supabase not available:",l)}return}try{kn.auth.getSession().then(({data:{session:l}})=>{l!=null&&l.user&&kn.from("profiles").select("*").eq("id",l.user.id).single().then(({data:c})=>{var f;const u={username:(c==null?void 0:c.username)||((f=l.user.email)==null?void 0:f.split("@")[0])||"user",id:l.user.id,email:l.user.email,profile:c};r(u),localStorage.setItem("auth_user",JSON.stringify(u))}),a(!1)}).catch(l=>{console.warn("Supabase session initialization failed:",l),a(!1)})}catch(l){console.warn("Supabase not available:",l),a(!1)}try{const{data:{subscription:l}}=kn.auth.onAuthStateChange(async(c,u)=>{var f;if(c==="SIGNED_IN"&&(u!=null&&u.user)){const{data:d}=await kn.from("profiles").select("*").eq("id",u.user.id).single(),h={username:(d==null?void 0:d.username)||((f=u.user.email)==null?void 0:f.split("@")[0])||"user",id:u.user.id,email:u.user.email,profile:d};r(h),localStorage.setItem("auth_user",JSON.stringify(h))}else c==="SIGNED_OUT"&&(r(null),localStorage.removeItem("auth_user"),localStorage.removeItem("dashboard_filters"));a(!1)});return()=>l.unsubscribe()}catch(l){console.warn("Supabase auth listener failed:",l)}},[]);const o={user:t,isLoading:n,login:s,logout:i};return m.jsx(E2.Provider,{value:o,children:e})},Iu=()=>{const e=B.useContext(E2);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e};var dl=e=>e.type==="checkbox",es=e=>e instanceof Date,ur=e=>e==null;const T2=e=>typeof e=="object";var _t=e=>!ur(e)&&!Array.isArray(e)&&T2(e)&&!es(e),iS=e=>_t(e)&&e.target?dl(e.target)?e.target.checked:e.target.value:e,oS=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,lS=(e,t)=>e.has(oS(t)),cS=e=>{const t=e.constructor&&e.constructor.prototype;return _t(t)&&t.hasOwnProperty("isPrototypeOf")},w0=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ft(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(w0&&(e instanceof Blob||n))&&(r||_t(e)))if(t=r?[]:Object.create(Object.getPrototypeOf(e)),!r&&!cS(e))t=e;else for(const a in e)e.hasOwnProperty(a)&&(t[a]=Ft(e[a]));else return e;return t}var Du=e=>/^\w*$/.test(e),bt=e=>e===void 0,_0=e=>Array.isArray(e)?e.filter(Boolean):[],k0=e=>_0(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Ae=(e,t,r)=>{if(!t||!_t(e))return r;const n=(Du(t)?[t]:k0(t)).reduce((a,s)=>ur(a)?a:a[s],e);return bt(n)||n===e?bt(e[t])?r:e[t]:n},Sn=e=>typeof e=="boolean",qe=(e,t,r)=>{let n=-1;const a=Du(t)?[t]:k0(t),s=a.length,i=s-1;for(;++n<s;){const o=a[n];let l=r;if(n!==i){const c=e[o];l=_t(c)||Array.isArray(c)?c:isNaN(+a[n+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;e[o]=l,e=e[o]}};const M1={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ln={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},jn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},uS=Ar.createContext(null);uS.displayName="HookFormContext";var fS=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(a,s,{get:()=>{const i=s;return t._proxyFormState[i]!==ln.all&&(t._proxyFormState[i]=!n||ln.all),e[i]}});return a};const dS=typeof window<"u"?Ar.useLayoutEffect:Ar.useEffect;var An=e=>typeof e=="string",hS=(e,t,r,n,a)=>An(e)?(n&&t.watch.add(e),Ae(r,e,a)):Array.isArray(e)?e.map(s=>(n&&t.watch.add(s),Ae(r,s))):(n&&(t.watchAll=!0),r),Xd=e=>ur(e)||!T2(e);function ma(e,t,r=new WeakSet){if(Xd(e)||Xd(t))return e===t;if(es(e)&&es(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const s of n){const i=e[s];if(!a.includes(s))return!1;if(s!=="ref"){const o=t[s];if(es(i)&&es(o)||_t(i)&&_t(o)||Array.isArray(i)&&Array.isArray(o)?!ma(i,o,r):i!==o)return!1}}return!0}var x0=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},mo=e=>Array.isArray(e)?e:[e],$1=()=>{let e=[];return{get observers(){return e},next:a=>{for(const s of e)s.next&&s.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(s=>s!==a)}}),unsubscribe:()=>{e=[]}}},_r=e=>_t(e)&&!Object.keys(e).length,E0=e=>e.type==="file",cn=e=>typeof e=="function",Hc=e=>{if(!w0)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},S2=e=>e.type==="select-multiple",T0=e=>e.type==="radio",pS=e=>T0(e)||dl(e),Rf=e=>Hc(e)&&e.isConnected;function mS(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=bt(e)?n++:e[t[n++]];return e}function gS(e){for(const t in e)if(e.hasOwnProperty(t)&&!bt(e[t]))return!1;return!0}function Et(e,t){const r=Array.isArray(t)?t:Du(t)?[t]:k0(t),n=r.length===1?e:mS(e,r),a=r.length-1,s=r[a];return n&&delete n[s],a!==0&&(_t(n)&&_r(n)||Array.isArray(n)&&gS(n))&&Et(e,r.slice(0,-1)),e}var b2=e=>{for(const t in e)if(cn(e[t]))return!0;return!1};function Gc(e,t={}){const r=Array.isArray(e);if(_t(e)||r)for(const n in e)Array.isArray(e[n])||_t(e[n])&&!b2(e[n])?(t[n]=Array.isArray(e[n])?[]:{},Gc(e[n],t[n])):ur(e[n])||(t[n]=!0);return t}function C2(e,t,r){const n=Array.isArray(e);if(_t(e)||n)for(const a in e)Array.isArray(e[a])||_t(e[a])&&!b2(e[a])?bt(t)||Xd(r[a])?r[a]=Array.isArray(e[a])?Gc(e[a],[]):{...Gc(e[a])}:C2(e[a],ur(t)?{}:t[a],r[a]):r[a]=!ma(e[a],t[a]);return r}var Vi=(e,t)=>C2(e,t,Gc(t));const U1={value:!1,isValid:!1},B1={value:!0,isValid:!0};var A2=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!bt(e[0].attributes.value)?bt(e[0].value)||e[0].value===""?B1:{value:e[0].value,isValid:!0}:B1:U1}return U1},N2=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>bt(e)?e:t?e===""?NaN:e&&+e:r&&An(e)?new Date(e):n?n(e):e;const z1={isValid:!1,value:null};var O2=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,z1):z1;function V1(e){const t=e.ref;return E0(t)?t.files:T0(t)?O2(e.refs).value:S2(t)?[...t.selectedOptions].map(({value:r})=>r):dl(t)?A2(e.refs).value:N2(bt(t.value)?e.ref.value:t.value,e)}var vS=(e,t,r,n)=>{const a={};for(const s of e){const i=Ae(t,s);i&&qe(a,s,i._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},Kc=e=>e instanceof RegExp,Wi=e=>bt(e)?e:Kc(e)?e.source:_t(e)?Kc(e.value)?e.value.source:e.value:e,W1=e=>({isOnSubmit:!e||e===ln.onSubmit,isOnBlur:e===ln.onBlur,isOnChange:e===ln.onChange,isOnAll:e===ln.all,isOnTouch:e===ln.onTouched});const H1="AsyncFunction";var yS=e=>!!e&&!!e.validate&&!!(cn(e.validate)&&e.validate.constructor.name===H1||_t(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===H1)),wS=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),G1=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const go=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const s=Ae(e,a);if(s){const{_f:i,...o}=s;if(i){if(i.refs&&i.refs[0]&&t(i.refs[0],a)&&!n)return!0;if(i.ref&&t(i.ref,i.name)&&!n)return!0;if(go(o,t))break}else if(_t(o)&&go(o,t))break}}};function K1(e,t,r){const n=Ae(e,r);if(n||Du(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const s=a.join("."),i=Ae(t,s),o=Ae(e,s);if(i&&!Array.isArray(i)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};if(o&&o.root&&o.root.type)return{name:`${s}.root`,error:o.root};a.pop()}return{name:r}}var _S=(e,t,r,n)=>{r(e);const{name:a,...s}=e;return _r(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(i=>t[i]===(!n||ln.all))},kS=(e,t,r)=>!e||!t||e===t||mo(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n))),xS=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,ES=(e,t)=>!_0(Ae(e,t)).length&&Et(e,t),TS=(e,t,r)=>{const n=mo(Ae(e,r));return qe(n,"root",t[r]),qe(e,r,n),e},vc=e=>An(e);function Z1(e,t,r="validate"){if(vc(e)||Array.isArray(e)&&e.every(vc)||Sn(e)&&!e)return{type:r,message:vc(e)?e:"",ref:t}}var Rs=e=>_t(e)&&!Kc(e)?e:{value:e,message:""},X1=async(e,t,r,n,a,s)=>{const{ref:i,refs:o,required:l,maxLength:c,minLength:u,min:f,max:d,pattern:h,validate:v,name:g,valueAsNumber:_,mount:w}=e._f,y=Ae(r,g);if(!w||t.has(g))return{};const p=o?o[0]:i,k=F=>{a&&p.reportValidity&&(p.setCustomValidity(Sn(F)?"":F||""),p.reportValidity())},T={},S=T0(i),x=dl(i),D=S||x,I=(_||E0(i))&&bt(i.value)&&bt(y)||Hc(i)&&i.value===""||y===""||Array.isArray(y)&&!y.length,z=x0.bind(null,g,n,T),V=(F,q,ae,se=jn.maxLength,ge=jn.minLength)=>{const le=F?q:ae;T[g]={type:F?se:ge,message:le,ref:i,...z(F?se:ge,le)}};if(s?!Array.isArray(y)||!y.length:l&&(!D&&(I||ur(y))||Sn(y)&&!y||x&&!A2(o).isValid||S&&!O2(o).isValid)){const{value:F,message:q}=vc(l)?{value:!!l,message:l}:Rs(l);if(F&&(T[g]={type:jn.required,message:q,ref:p,...z(jn.required,q)},!n))return k(q),T}if(!I&&(!ur(f)||!ur(d))){let F,q;const ae=Rs(d),se=Rs(f);if(!ur(y)&&!isNaN(y)){const ge=i.valueAsNumber||y&&+y;ur(ae.value)||(F=ge>ae.value),ur(se.value)||(q=ge<se.value)}else{const ge=i.valueAsDate||new Date(y),le=fe=>new Date(new Date().toDateString()+" "+fe),oe=i.type=="time",j=i.type=="week";An(ae.value)&&y&&(F=oe?le(y)>le(ae.value):j?y>ae.value:ge>new Date(ae.value)),An(se.value)&&y&&(q=oe?le(y)<le(se.value):j?y<se.value:ge<new Date(se.value))}if((F||q)&&(V(!!F,ae.message,se.message,jn.max,jn.min),!n))return k(T[g].message),T}if((c||u)&&!I&&(An(y)||s&&Array.isArray(y))){const F=Rs(c),q=Rs(u),ae=!ur(F.value)&&y.length>+F.value,se=!ur(q.value)&&y.length<+q.value;if((ae||se)&&(V(ae,F.message,q.message),!n))return k(T[g].message),T}if(h&&!I&&An(y)){const{value:F,message:q}=Rs(h);if(Kc(F)&&!y.match(F)&&(T[g]={type:jn.pattern,message:q,ref:i,...z(jn.pattern,q)},!n))return k(q),T}if(v){if(cn(v)){const F=await v(y,r),q=Z1(F,p);if(q&&(T[g]={...q,...z(jn.validate,q.message)},!n))return k(q.message),T}else if(_t(v)){let F={};for(const q in v){if(!_r(F)&&!n)break;const ae=Z1(await v[q](y,r),p,q);ae&&(F={...ae,...z(q,ae.message)},k(ae.message),n&&(T[g]=F))}if(!_r(F)&&(T[g]={ref:p,...F},!n))return T}}return k(!0),T};const SS={mode:ln.onSubmit,reValidateMode:ln.onChange,shouldFocusError:!0};function bS(e={}){let t={...SS,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:cn(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=_t(t.defaultValues)||_t(t.values)?Ft(t.defaultValues||t.values)||{}:{},s=t.shouldUnregister?{}:Ft(a),i={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...u};const d={array:$1(),state:$1()},h=t.criteriaMode===ln.all,v=L=>H=>{clearTimeout(c),c=setTimeout(L,H)},g=async L=>{if(!t.disabled&&(u.isValid||f.isValid||L)){const H=t.resolver?_r((await x()).errors):await I(n,!0);H!==r.isValid&&d.state.next({isValid:H})}},_=(L,H)=>{!t.disabled&&(u.isValidating||u.validatingFields||f.isValidating||f.validatingFields)&&((L||Array.from(o.mount)).forEach(J=>{J&&(H?qe(r.validatingFields,J,H):Et(r.validatingFields,J))}),d.state.next({validatingFields:r.validatingFields,isValidating:!_r(r.validatingFields)}))},w=(L,H=[],J,_e,me=!0,ue=!0)=>{if(_e&&J&&!t.disabled){if(i.action=!0,ue&&Array.isArray(Ae(n,L))){const Se=J(Ae(n,L),_e.argA,_e.argB);me&&qe(n,L,Se)}if(ue&&Array.isArray(Ae(r.errors,L))){const Se=J(Ae(r.errors,L),_e.argA,_e.argB);me&&qe(r.errors,L,Se),ES(r.errors,L)}if((u.touchedFields||f.touchedFields)&&ue&&Array.isArray(Ae(r.touchedFields,L))){const Se=J(Ae(r.touchedFields,L),_e.argA,_e.argB);me&&qe(r.touchedFields,L,Se)}(u.dirtyFields||f.dirtyFields)&&(r.dirtyFields=Vi(a,s)),d.state.next({name:L,isDirty:V(L,H),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else qe(s,L,H)},y=(L,H)=>{qe(r.errors,L,H),d.state.next({errors:r.errors})},p=L=>{r.errors=L,d.state.next({errors:r.errors,isValid:!1})},k=(L,H,J,_e)=>{const me=Ae(n,L);if(me){const ue=Ae(s,L,bt(J)?Ae(a,L):J);bt(ue)||_e&&_e.defaultChecked||H?qe(s,L,H?ue:V1(me._f)):ae(L,ue),i.mount&&g()}},T=(L,H,J,_e,me)=>{let ue=!1,Se=!1;const Be={name:L};if(!t.disabled){if(!J||_e){(u.isDirty||f.isDirty)&&(Se=r.isDirty,r.isDirty=Be.isDirty=V(),ue=Se!==Be.isDirty);const Fe=ma(Ae(a,L),H);Se=!!Ae(r.dirtyFields,L),Fe?Et(r.dirtyFields,L):qe(r.dirtyFields,L,!0),Be.dirtyFields=r.dirtyFields,ue=ue||(u.dirtyFields||f.dirtyFields)&&Se!==!Fe}if(J){const Fe=Ae(r.touchedFields,L);Fe||(qe(r.touchedFields,L,J),Be.touchedFields=r.touchedFields,ue=ue||(u.touchedFields||f.touchedFields)&&Fe!==J)}ue&&me&&d.state.next(Be)}return ue?Be:{}},S=(L,H,J,_e)=>{const me=Ae(r.errors,L),ue=(u.isValid||f.isValid)&&Sn(H)&&r.isValid!==H;if(t.delayError&&J?(l=v(()=>y(L,J)),l(t.delayError)):(clearTimeout(c),l=null,J?qe(r.errors,L,J):Et(r.errors,L)),(J?!ma(me,J):me)||!_r(_e)||ue){const Se={..._e,...ue&&Sn(H)?{isValid:H}:{},errors:r.errors,name:L};r={...r,...Se},d.state.next(Se)}},x=async L=>{_(L,!0);const H=await t.resolver(s,t.context,vS(L||o.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return _(L),H},D=async L=>{const{errors:H}=await x(L);if(L)for(const J of L){const _e=Ae(H,J);_e?qe(r.errors,J,_e):Et(r.errors,J)}else r.errors=H;return H},I=async(L,H,J={valid:!0})=>{for(const _e in L){const me=L[_e];if(me){const{_f:ue,...Se}=me;if(ue){const Be=o.array.has(ue.name),Fe=me._f&&yS(me._f);Fe&&u.validatingFields&&_([_e],!0);const te=await X1(me,o.disabled,s,h,t.shouldUseNativeValidation&&!H,Be);if(Fe&&u.validatingFields&&_([_e]),te[ue.name]&&(J.valid=!1,H))break;!H&&(Ae(te,ue.name)?Be?TS(r.errors,te,ue.name):qe(r.errors,ue.name,te[ue.name]):Et(r.errors,ue.name))}!_r(Se)&&await I(Se,H,J)}}return J.valid},z=()=>{for(const L of o.unMount){const H=Ae(n,L);H&&(H._f.refs?H._f.refs.every(J=>!Rf(J)):!Rf(H._f.ref))&&pe(L)}o.unMount=new Set},V=(L,H)=>!t.disabled&&(L&&H&&qe(s,L,H),!ma(fe(),a)),F=(L,H,J)=>hS(L,o,{...i.mount?s:bt(H)?a:An(L)?{[L]:H}:H},J,H),q=L=>_0(Ae(i.mount?s:a,L,t.shouldUnregister?Ae(a,L,[]):[])),ae=(L,H,J={})=>{const _e=Ae(n,L);let me=H;if(_e){const ue=_e._f;ue&&(!ue.disabled&&qe(s,L,N2(H,ue)),me=Hc(ue.ref)&&ur(H)?"":H,S2(ue.ref)?[...ue.ref.options].forEach(Se=>Se.selected=me.includes(Se.value)):ue.refs?dl(ue.ref)?ue.refs.forEach(Se=>{(!Se.defaultChecked||!Se.disabled)&&(Array.isArray(me)?Se.checked=!!me.find(Be=>Be===Se.value):Se.checked=me===Se.value||!!me)}):ue.refs.forEach(Se=>Se.checked=Se.value===me):E0(ue.ref)?ue.ref.value="":(ue.ref.value=me,ue.ref.type||d.state.next({name:L,values:Ft(s)})))}(J.shouldDirty||J.shouldTouch)&&T(L,me,J.shouldTouch,J.shouldDirty,!0),J.shouldValidate&&j(L)},se=(L,H,J)=>{for(const _e in H){if(!H.hasOwnProperty(_e))return;const me=H[_e],ue=L+"."+_e,Se=Ae(n,ue);(o.array.has(L)||_t(me)||Se&&!Se._f)&&!es(me)?se(ue,me,J):ae(ue,me,J)}},ge=(L,H,J={})=>{const _e=Ae(n,L),me=o.array.has(L),ue=Ft(H);qe(s,L,ue),me?(d.array.next({name:L,values:Ft(s)}),(u.isDirty||u.dirtyFields||f.isDirty||f.dirtyFields)&&J.shouldDirty&&d.state.next({name:L,dirtyFields:Vi(a,s),isDirty:V(L,ue)})):_e&&!_e._f&&!ur(ue)?se(L,ue,J):ae(L,ue,J),G1(L,o)&&d.state.next({...r,name:L}),d.state.next({name:i.mount?L:void 0,values:Ft(s)})},le=async L=>{i.mount=!0;const H=L.target;let J=H.name,_e=!0;const me=Ae(n,J),ue=Fe=>{_e=Number.isNaN(Fe)||es(Fe)&&isNaN(Fe.getTime())||ma(Fe,Ae(s,J,Fe))},Se=W1(t.mode),Be=W1(t.reValidateMode);if(me){let Fe,te;const re=H.type?V1(me._f):iS(L),Ee=L.type===M1.BLUR||L.type===M1.FOCUS_OUT,Oe=!wS(me._f)&&!t.resolver&&!Ae(r.errors,J)&&!me._f.deps||xS(Ee,Ae(r.touchedFields,J),r.isSubmitted,Be,Se),Xe=G1(J,o,Ee);qe(s,J,re),Ee?(!H||!H.readOnly)&&(me._f.onBlur&&me._f.onBlur(L),l&&l(0)):me._f.onChange&&me._f.onChange(L);const Zt=T(J,re,Ee),or=!_r(Zt)||Xe;if(!Ee&&d.state.next({name:J,type:L.type,values:Ft(s)}),Oe)return(u.isValid||f.isValid)&&(t.mode==="onBlur"?Ee&&g():Ee||g()),or&&d.state.next({name:J,...Xe?{}:Zt});if(!Ee&&Xe&&d.state.next({...r}),t.resolver){const{errors:wr}=await x([J]);if(ue(re),_e){const Jr=K1(r.errors,n,J),Ni=K1(wr,n,Jr.name||J);Fe=Ni.error,J=Ni.name,te=_r(wr)}}else _([J],!0),Fe=(await X1(me,o.disabled,s,h,t.shouldUseNativeValidation))[J],_([J]),ue(re),_e&&(Fe?te=!1:(u.isValid||f.isValid)&&(te=await I(n,!0)));_e&&(me._f.deps&&j(me._f.deps),S(J,te,Fe,Zt))}},oe=(L,H)=>{if(Ae(r.errors,H)&&L.focus)return L.focus(),1},j=async(L,H={})=>{let J,_e;const me=mo(L);if(t.resolver){const ue=await D(bt(L)?L:me);J=_r(ue),_e=L?!me.some(Se=>Ae(ue,Se)):J}else L?(_e=(await Promise.all(me.map(async ue=>{const Se=Ae(n,ue);return await I(Se&&Se._f?{[ue]:Se}:Se)}))).every(Boolean),!(!_e&&!r.isValid)&&g()):_e=J=await I(n);return d.state.next({...!An(L)||(u.isValid||f.isValid)&&J!==r.isValid?{}:{name:L},...t.resolver||!L?{isValid:J}:{},errors:r.errors}),H.shouldFocus&&!_e&&go(n,oe,L?me:o.mount),_e},fe=L=>{const H={...i.mount?s:a};return bt(L)?H:An(L)?Ae(H,L):L.map(J=>Ae(H,J))},ye=(L,H)=>({invalid:!!Ae((H||r).errors,L),isDirty:!!Ae((H||r).dirtyFields,L),error:Ae((H||r).errors,L),isValidating:!!Ae(r.validatingFields,L),isTouched:!!Ae((H||r).touchedFields,L)}),O=L=>{L&&mo(L).forEach(H=>Et(r.errors,H)),d.state.next({errors:L?r.errors:{}})},W=(L,H,J)=>{const _e=(Ae(n,L,{_f:{}})._f||{}).ref,me=Ae(r.errors,L)||{},{ref:ue,message:Se,type:Be,...Fe}=me;qe(r.errors,L,{...Fe,...H,ref:_e}),d.state.next({name:L,errors:r.errors,isValid:!1}),J&&J.shouldFocus&&_e&&_e.focus&&_e.focus()},U=(L,H)=>cn(L)?d.state.subscribe({next:J=>"values"in J&&L(F(void 0,H),J)}):F(L,H,!0),M=L=>d.state.subscribe({next:H=>{kS(L.name,H.name,L.exact)&&_S(H,L.formState||u,we,L.reRenderRoot)&&L.callback({values:{...s},...r,...H,defaultValues:a})}}).unsubscribe,Q=L=>(i.mount=!0,f={...f,...L.formState},M({...L,formState:f})),pe=(L,H={})=>{for(const J of L?mo(L):o.mount)o.mount.delete(J),o.array.delete(J),H.keepValue||(Et(n,J),Et(s,J)),!H.keepError&&Et(r.errors,J),!H.keepDirty&&Et(r.dirtyFields,J),!H.keepTouched&&Et(r.touchedFields,J),!H.keepIsValidating&&Et(r.validatingFields,J),!t.shouldUnregister&&!H.keepDefaultValue&&Et(a,J);d.state.next({values:Ft(s)}),d.state.next({...r,...H.keepDirty?{isDirty:V()}:{}}),!H.keepIsValid&&g()},ke=({disabled:L,name:H})=>{(Sn(L)&&i.mount||L||o.disabled.has(H))&&(L?o.disabled.add(H):o.disabled.delete(H))},ce=(L,H={})=>{let J=Ae(n,L);const _e=Sn(H.disabled)||Sn(t.disabled);return qe(n,L,{...J||{},_f:{...J&&J._f?J._f:{ref:{name:L}},name:L,mount:!0,...H}}),o.mount.add(L),J?ke({disabled:Sn(H.disabled)?H.disabled:t.disabled,name:L}):k(L,!0,H.value),{..._e?{disabled:H.disabled||t.disabled}:{},...t.progressive?{required:!!H.required,min:Wi(H.min),max:Wi(H.max),minLength:Wi(H.minLength),maxLength:Wi(H.maxLength),pattern:Wi(H.pattern)}:{},name:L,onChange:le,onBlur:le,ref:me=>{if(me){ce(L,H),J=Ae(n,L);const ue=bt(me.value)&&me.querySelectorAll&&me.querySelectorAll("input,select,textarea")[0]||me,Se=pS(ue),Be=J._f.refs||[];if(Se?Be.find(Fe=>Fe===ue):ue===J._f.ref)return;qe(n,L,{_f:{...J._f,...Se?{refs:[...Be.filter(Rf),ue,...Array.isArray(Ae(a,L))?[{}]:[]],ref:{type:ue.type,name:L}}:{ref:ue}}}),k(L,!1,void 0,ue)}else J=Ae(n,L,{}),J._f&&(J._f.mount=!1),(t.shouldUnregister||H.shouldUnregister)&&!(lS(o.array,L)&&i.action)&&o.unMount.add(L)}}},ne=()=>t.shouldFocusError&&go(n,oe,o.mount),Y=L=>{Sn(L)&&(d.state.next({disabled:L}),go(n,(H,J)=>{const _e=Ae(n,J);_e&&(H.disabled=_e._f.disabled||L,Array.isArray(_e._f.refs)&&_e._f.refs.forEach(me=>{me.disabled=_e._f.disabled||L}))},0,!1))},A=(L,H)=>async J=>{let _e;J&&(J.preventDefault&&J.preventDefault(),J.persist&&J.persist());let me=Ft(s);if(d.state.next({isSubmitting:!0}),t.resolver){const{errors:ue,values:Se}=await x();r.errors=ue,me=Ft(Se)}else await I(n);if(o.disabled.size)for(const ue of o.disabled)Et(me,ue);if(Et(r.errors,"root"),_r(r.errors)){d.state.next({errors:{}});try{await L(me,J)}catch(ue){_e=ue}}else H&&await H({...r.errors},J),ne(),setTimeout(ne);if(d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:_r(r.errors)&&!_e,submitCount:r.submitCount+1,errors:r.errors}),_e)throw _e},Pe=(L,H={})=>{Ae(n,L)&&(bt(H.defaultValue)?ge(L,Ft(Ae(a,L))):(ge(L,H.defaultValue),qe(a,L,Ft(H.defaultValue))),H.keepTouched||Et(r.touchedFields,L),H.keepDirty||(Et(r.dirtyFields,L),r.isDirty=H.defaultValue?V(L,Ft(Ae(a,L))):V()),H.keepError||(Et(r.errors,L),u.isValid&&g()),d.state.next({...r}))},Re=(L,H={})=>{const J=L?Ft(L):a,_e=Ft(J),me=_r(L),ue=me?a:_e;if(H.keepDefaultValues||(a=J),!H.keepValues){if(H.keepDirtyValues){const Se=new Set([...o.mount,...Object.keys(Vi(a,s))]);for(const Be of Array.from(Se))Ae(r.dirtyFields,Be)?qe(ue,Be,Ae(s,Be)):ge(Be,Ae(ue,Be))}else{if(w0&&bt(L))for(const Se of o.mount){const Be=Ae(n,Se);if(Be&&Be._f){const Fe=Array.isArray(Be._f.refs)?Be._f.refs[0]:Be._f.ref;if(Hc(Fe)){const te=Fe.closest("form");if(te){te.reset();break}}}}if(H.keepFieldsRef)for(const Se of o.mount)ge(Se,Ae(ue,Se));else n={}}s=t.shouldUnregister?H.keepDefaultValues?Ft(a):{}:Ft(ue),d.array.next({values:{...ue}}),d.state.next({values:{...ue}})}o={mount:H.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!u.isValid||!!H.keepIsValid||!!H.keepDirtyValues,i.watch=!!t.shouldUnregister,d.state.next({submitCount:H.keepSubmitCount?r.submitCount:0,isDirty:me?!1:H.keepDirty?r.isDirty:!!(H.keepDefaultValues&&!ma(L,a)),isSubmitted:H.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:me?{}:H.keepDirtyValues?H.keepDefaultValues&&s?Vi(a,s):r.dirtyFields:H.keepDefaultValues&&L?Vi(a,L):H.keepDirty?r.dirtyFields:{},touchedFields:H.keepTouched?r.touchedFields:{},errors:H.keepErrors?r.errors:{},isSubmitSuccessful:H.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:a})},Ne=(L,H)=>Re(cn(L)?L(s):L,H),De=(L,H={})=>{const J=Ae(n,L),_e=J&&J._f;if(_e){const me=_e.refs?_e.refs[0]:_e.ref;me.focus&&(me.focus(),H.shouldSelect&&cn(me.select)&&me.select())}},we=L=>{r={...r,...L}},kt={control:{register:ce,unregister:pe,getFieldState:ye,handleSubmit:A,setError:W,_subscribe:M,_runSchema:x,_focusError:ne,_getWatch:F,_getDirty:V,_setValid:g,_setFieldArray:w,_setDisabledField:ke,_setErrors:p,_getFieldArray:q,_reset:Re,_resetDefaultValues:()=>cn(t.defaultValues)&&t.defaultValues().then(L=>{Ne(L,t.resetOptions),d.state.next({isLoading:!1})}),_removeUnmounted:z,_disableForm:Y,_subjects:d,_proxyFormState:u,get _fields(){return n},get _formValues(){return s},get _state(){return i},set _state(L){i=L},get _defaultValues(){return a},get _names(){return o},set _names(L){o=L},get _formState(){return r},get _options(){return t},set _options(L){t={...t,...L}}},subscribe:Q,trigger:j,register:ce,handleSubmit:A,watch:U,setValue:ge,getValues:fe,reset:Ne,resetField:Pe,clearErrors:O,unregister:pe,setError:W,setFocus:De,getFieldState:ye};return{...kt,formControl:kt}}function CS(e={}){const t=Ar.useRef(void 0),r=Ar.useRef(void 0),[n,a]=Ar.useState({isDirty:!1,isValidating:!1,isLoading:cn(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:cn(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:n},e.defaultValues&&!cn(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:i,...o}=bS(e);t.current={...o,formState:n}}const s=t.current.control;return s._options=e,dS(()=>{const i=s._subscribe({formState:s._proxyFormState,callback:()=>a({...s._formState}),reRenderRoot:!0});return a(o=>({...o,isReady:!0})),s._formState.isReady=!0,i},[s]),Ar.useEffect(()=>s._disableForm(e.disabled),[s,e.disabled]),Ar.useEffect(()=>{e.mode&&(s._options.mode=e.mode),e.reValidateMode&&(s._options.reValidateMode=e.reValidateMode)},[s,e.mode,e.reValidateMode]),Ar.useEffect(()=>{e.errors&&(s._setErrors(e.errors),s._focusError())},[s,e.errors]),Ar.useEffect(()=>{e.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,e.shouldUnregister]),Ar.useEffect(()=>{if(s._proxyFormState.isDirty){const i=s._getDirty();i!==n.isDirty&&s._subjects.state.next({isDirty:i})}},[s,n.isDirty]),Ar.useEffect(()=>{e.values&&!ma(e.values,r.current)?(s._reset(e.values,{keepFieldsRef:!0,...s._options.resetOptions}),r.current=e.values,a(i=>({...i}))):s._resetDefaultValues()},[s,e.values]),Ar.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),t.current.formState=fS(n,s),t.current}const Y1=(e,t,r)=>{if(e&&"reportValidity"in e){const n=Ae(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},Yd=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?Y1(n.ref,r,e):n&&n.refs&&n.refs.forEach(a=>Y1(a,r,e))}},q1=(e,t)=>{t.shouldUseNativeValidation&&Yd(e,t);const r={};for(const n in e){const a=Ae(t.fields,n),s=Object.assign(e[n]||{},{ref:a&&a.ref});if(AS(t.names||Object.keys(e),n)){const i=Object.assign({},Ae(r,n));qe(i,"root",s),qe(r,n,i)}else qe(r,n,s)}return r},AS=(e,t)=>{const r=J1(t);return e.some(n=>J1(n).match(`^${r}\\.\\d+`))};function J1(e){return e.replace(/\]|\[/g,"")}function ie(e,t,r){function n(o,l){var c;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(c=o._zod).traits??(c.traits=new Set),o._zod.traits.add(e),t(o,l);for(const u in i.prototype)u in o||Object.defineProperty(o,u,{value:i.prototype[u].bind(o)});o._zod.constr=i,o._zod.def=l}const a=(r==null?void 0:r.Parent)??Object;class s extends a{}Object.defineProperty(s,"name",{value:e});function i(o){var l;const c=r!=null&&r.Parent?new s:this;n(c,o),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:o=>{var l,c;return r!=null&&r.Parent&&o instanceof r.Parent?!0:(c=(l=o==null?void 0:o._zod)==null?void 0:l.traits)==null?void 0:c.has(e)}}),Object.defineProperty(i,"name",{value:e}),i}class ri extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class R2 extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const P2={};function fs(e){return P2}function NS(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,a])=>t.indexOf(+n)===-1).map(([n,a])=>a)}function qd(e,t){return typeof t=="bigint"?t.toString():t}function S0(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function b0(e){return e==null}function C0(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}const Q1=Symbol("evaluating");function et(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==Q1)return n===void 0&&(n=Q1,n=r()),n},set(a){Object.defineProperty(e,t,{value:a})},configurable:!0})}function OS(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function Ua(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Si(...e){const t={};for(const r of e){const n=Object.getOwnPropertyDescriptors(r);Object.assign(t,n)}return Object.defineProperties({},t)}function em(e){return JSON.stringify(e)}const I2="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Zc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const RS=S0(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Go(e){if(Zc(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(Zc(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function D2(e){return Go(e)?{...e}:e}const PS=new Set(["string","number","symbol"]);function Lu(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ba(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r!=null&&r.parent)&&(n._zod.parent=e),n}function Le(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function IS(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}function DS(e,t){const r=e._zod.def,n=Si(e._zod.def,{get shape(){const a={};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&(a[s]=r.shape[s])}return Ua(this,"shape",a),a},checks:[]});return Ba(e,n)}function LS(e,t){const r=e._zod.def,n=Si(e._zod.def,{get shape(){const a={...e._zod.def.shape};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&delete a[s]}return Ua(this,"shape",a),a},checks:[]});return Ba(e,n)}function FS(e,t){if(!Go(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const a=Si(e._zod.def,{get shape(){const s={...e._zod.def.shape,...t};return Ua(this,"shape",s),s},checks:[]});return Ba(e,a)}function jS(e,t){if(!Go(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return Ua(this,"shape",n),n},checks:e._zod.def.checks};return Ba(e,r)}function MS(e,t){const r=Si(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return Ua(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return Ba(e,r)}function $S(e,t,r){const n=Si(t._zod.def,{get shape(){const a=t._zod.def.shape,s={...a};if(r)for(const i in r){if(!(i in a))throw new Error(`Unrecognized key: "${i}"`);r[i]&&(s[i]=e?new e({type:"optional",innerType:a[i]}):a[i])}else for(const i in a)s[i]=e?new e({type:"optional",innerType:a[i]}):a[i];return Ua(this,"shape",s),s},checks:[]});return Ba(t,n)}function US(e,t,r){const n=Si(t._zod.def,{get shape(){const a=t._zod.def.shape,s={...a};if(r)for(const i in r){if(!(i in s))throw new Error(`Unrecognized key: "${i}"`);r[i]&&(s[i]=new e({type:"nonoptional",innerType:a[i]}))}else for(const i in a)s[i]=new e({type:"nonoptional",innerType:a[i]});return Ua(this,"shape",s),s},checks:[]});return Ba(t,n)}function Zs(e,t=0){var r;if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(((r=e.issues[n])==null?void 0:r.continue)!==!0)return!0;return!1}function L2(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function Vl(e){return typeof e=="string"?e:e==null?void 0:e.message}function ds(e,t,r){var a,s,i,o,l,c;const n={...e,path:e.path??[]};if(!e.message){const u=Vl((i=(s=(a=e.inst)==null?void 0:a._zod.def)==null?void 0:s.error)==null?void 0:i.call(s,e))??Vl((o=t==null?void 0:t.error)==null?void 0:o.call(t,e))??Vl((l=r.customError)==null?void 0:l.call(r,e))??Vl((c=r.localeError)==null?void 0:c.call(r,e))??"Invalid input";n.message=u}return delete n.inst,delete n.continue,t!=null&&t.reportInput||delete n.input,n}function A0(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Ko(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}const F2=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,qd,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},N0=ie("$ZodError",F2),Fu=ie("$ZodError",F2,{Parent:Error});function BS(e,t=r=>r.message){const r={},n=[];for(const a of e.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}function zS(e,t){const r=t||function(s){return s.message},n={_errors:[]},a=s=>{for(const i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(o=>a({issues:o}));else if(i.code==="invalid_key")a({issues:i.issues});else if(i.code==="invalid_element")a({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let o=n,l=0;for(;l<i.path.length;){const c=i.path[l];l===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return a(e),n}const ju=e=>(t,r,n,a)=>{const s=n?Object.assign(n,{async:!1}):{async:!1},i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new ri;if(i.issues.length){const o=new((a==null?void 0:a.Err)??e)(i.issues.map(l=>ds(l,s,fs())));throw I2(o,a==null?void 0:a.callee),o}return i.value},VS=ju(Fu),Mu=e=>async(t,r,n,a)=>{const s=n?Object.assign(n,{async:!0}):{async:!0};let i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){const o=new((a==null?void 0:a.Err)??e)(i.issues.map(l=>ds(l,s,fs())));throw I2(o,a==null?void 0:a.callee),o}return i.value},WS=Mu(Fu),$u=e=>(t,r,n)=>{const a=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},a);if(s instanceof Promise)throw new ri;return s.issues.length?{success:!1,error:new(e??N0)(s.issues.map(i=>ds(i,a,fs())))}:{success:!0,data:s.value}},HS=$u(Fu),Uu=e=>async(t,r,n)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let s=t._zod.run({value:r,issues:[]},a);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(i=>ds(i,a,fs())))}:{success:!0,data:s.value}},GS=Uu(Fu),KS=e=>(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return ju(e)(t,r,a)},ZS=e=>(t,r,n)=>ju(e)(t,r,n),XS=e=>async(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Mu(e)(t,r,a)},YS=e=>async(t,r,n)=>Mu(e)(t,r,n),qS=e=>(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return $u(e)(t,r,a)},JS=e=>(t,r,n)=>$u(e)(t,r,n),QS=e=>async(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Uu(e)(t,r,a)},e6=e=>async(t,r,n)=>Uu(e)(t,r,n),t6=/^[cC][^\s-]{8,}$/,r6=/^[0-9a-z]+$/,n6=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,a6=/^[0-9a-vA-V]{20}$/,s6=/^[A-Za-z0-9]{27}$/,i6=/^[a-zA-Z0-9_-]{21}$/,o6=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,l6=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,tm=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,c6=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,u6="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function f6(){return new RegExp(u6,"u")}const d6=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,h6=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,p6=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,m6=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,g6=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,j2=/^[A-Za-z0-9_-]*$/,v6=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,y6=/^\+(?:[0-9]){6,14}[0-9]$/,M2="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",w6=new RegExp(`^${M2}$`);function $2(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function _6(e){return new RegExp(`^${$2(e)}$`)}function k6(e){const t=$2({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${t}(?:${r.join("|")})`;return new RegExp(`^${M2}T(?:${n})$`)}const x6=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},E6=/^[^A-Z]*$/,T6=/^[^a-z]*$/,In=ie("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),S6=ie("$ZodCheckMaxLength",(e,t)=>{var r;In.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!b0(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<a&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const a=n.value;if(a.length<=t.maximum)return;const i=A0(a);n.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),b6=ie("$ZodCheckMinLength",(e,t)=>{var r;In.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!b0(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>a&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const a=n.value;if(a.length>=t.minimum)return;const i=A0(a);n.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),C6=ie("$ZodCheckLengthEquals",(e,t)=>{var r;In.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!b0(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag;a.minimum=t.length,a.maximum=t.length,a.length=t.length}),e._zod.check=n=>{const a=n.value,s=a.length;if(s===t.length)return;const i=A0(a),o=s>t.length;n.issues.push({origin:i,...o?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),Bu=ie("$ZodCheckStringFormat",(e,t)=>{var r,n;In.init(e,t),e._zod.onattach.push(a=>{const s=a._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=a=>{t.pattern.lastIndex=0,!t.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:t.format,input:a.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),A6=ie("$ZodCheckRegex",(e,t)=>{Bu.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),N6=ie("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=E6),Bu.init(e,t)}),O6=ie("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=T6),Bu.init(e,t)}),R6=ie("$ZodCheckIncludes",(e,t)=>{In.init(e,t);const r=Lu(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(a=>{const s=a._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=a=>{a.value.includes(t.includes,t.position)||a.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:a.value,inst:e,continue:!t.abort})}}),P6=ie("$ZodCheckStartsWith",(e,t)=>{In.init(e,t);const r=new RegExp(`^${Lu(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),I6=ie("$ZodCheckEndsWith",(e,t)=>{In.init(e,t);const r=new RegExp(`.*${Lu(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),D6=ie("$ZodCheckOverwrite",(e,t)=>{In.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class L6{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(i=>i),a=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(a)).map(i=>" ".repeat(this.indent*2)+i);for(const i of s)this.content.push(i)}compile(){const t=Function,r=this==null?void 0:this.args,a=[...((this==null?void 0:this.content)??[""]).map(s=>`  ${s}`)];return new t(...r,a.join(`
`))}}const F6={major:4,minor:1,patch:5},Lt=ie("$ZodType",(e,t)=>{var a;var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=F6;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const s of n)for(const i of s._zod.onattach)i(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),(a=e._zod.deferred)==null||a.push(()=>{e._zod.run=e._zod.parse});else{const s=(o,l,c)=>{let u=Zs(o),f;for(const d of l){if(d._zod.def.when){if(!d._zod.def.when(o))continue}else if(u)continue;const h=o.issues.length,v=d._zod.check(o);if(v instanceof Promise&&(c==null?void 0:c.async)===!1)throw new ri;if(f||v instanceof Promise)f=(f??Promise.resolve()).then(async()=>{await v,o.issues.length!==h&&(u||(u=Zs(o,h)))});else{if(o.issues.length===h)continue;u||(u=Zs(o,h))}}return f?f.then(()=>o):o},i=(o,l,c)=>{if(Zs(o))return o.aborted=!0,o;const u=s(l,n,c);if(u instanceof Promise){if(c.async===!1)throw new ri;return u.then(f=>e._zod.parse(f,c))}return e._zod.parse(u,c)};e._zod.run=(o,l)=>{if(l.skipChecks)return e._zod.parse(o,l);if(l.direction==="backward"){const u=e._zod.parse({value:o.value,issues:[]},{...l,skipChecks:!0});return u instanceof Promise?u.then(f=>i(f,o,l)):i(u,o,l)}const c=e._zod.parse(o,l);if(c instanceof Promise){if(l.async===!1)throw new ri;return c.then(u=>s(u,n,l))}return s(c,n,l)}}e["~standard"]={validate:s=>{var i;try{const o=HS(e,s);return o.success?{value:o.data}:{issues:(i=o.error)==null?void 0:i.issues}}catch{return GS(e,s).then(l=>{var c;return l.success?{value:l.data}:{issues:(c=l.error)==null?void 0:c.issues}})}},vendor:"zod",version:1}}),O0=ie("$ZodString",(e,t)=>{var r;Lt.init(e,t),e._zod.pattern=[...((r=e==null?void 0:e._zod.bag)==null?void 0:r.patterns)??[]].pop()??x6(e._zod.bag),e._zod.parse=(n,a)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),lt=ie("$ZodStringFormat",(e,t)=>{Bu.init(e,t),O0.init(e,t)}),j6=ie("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=l6),lt.init(e,t)}),M6=ie("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=tm(n))}else t.pattern??(t.pattern=tm());lt.init(e,t)}),$6=ie("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=c6),lt.init(e,t)}),U6=ie("$ZodURL",(e,t)=>{lt.init(e,t),e._zod.check=r=>{try{const n=r.value.trim(),a=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(a.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:v6.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(a.protocol.endsWith(":")?a.protocol.slice(0,-1):a.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=a.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),B6=ie("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=f6()),lt.init(e,t)}),z6=ie("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=i6),lt.init(e,t)}),V6=ie("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=t6),lt.init(e,t)}),W6=ie("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=r6),lt.init(e,t)}),H6=ie("$ZodULID",(e,t)=>{t.pattern??(t.pattern=n6),lt.init(e,t)}),G6=ie("$ZodXID",(e,t)=>{t.pattern??(t.pattern=a6),lt.init(e,t)}),K6=ie("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=s6),lt.init(e,t)}),Z6=ie("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=k6(t)),lt.init(e,t)}),X6=ie("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=w6),lt.init(e,t)}),Y6=ie("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=_6(t)),lt.init(e,t)}),q6=ie("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=o6),lt.init(e,t)}),J6=ie("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=d6),lt.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),Q6=ie("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=h6),lt.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),e5=ie("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=p6),lt.init(e,t)}),t5=ie("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=m6),lt.init(e,t),e._zod.check=r=>{const[n,a]=r.value.split("/");try{if(!a)throw new Error;const s=Number(a);if(`${s}`!==a)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function U2(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const r5=ie("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=g6),lt.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{U2(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function n5(e){if(!j2.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return U2(r)}const a5=ie("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=j2),lt.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{n5(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),s5=ie("$ZodE164",(e,t)=>{t.pattern??(t.pattern=y6),lt.init(e,t)});function i5(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const a=JSON.parse(atob(n));return!("typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&(!("alg"in a)||a.alg!==t))}catch{return!1}}const o5=ie("$ZodJWT",(e,t)=>{lt.init(e,t),e._zod.check=r=>{i5(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),l5=ie("$ZodUnknown",(e,t)=>{Lt.init(e,t),e._zod.parse=r=>r}),c5=ie("$ZodNever",(e,t)=>{Lt.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function rm(e,t,r){e.issues.length&&t.issues.push(...L2(r,e.issues)),t.value[r]=e.value}const u5=ie("$ZodArray",(e,t)=>{Lt.init(e,t),e._zod.parse=(r,n)=>{const a=r.value;if(!Array.isArray(a))return r.issues.push({expected:"array",code:"invalid_type",input:a,inst:e}),r;r.value=Array(a.length);const s=[];for(let i=0;i<a.length;i++){const o=a[i],l=t.element._zod.run({value:o,issues:[]},n);l instanceof Promise?s.push(l.then(c=>rm(c,r,i))):rm(l,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function Xc(e,t,r,n){e.issues.length&&t.issues.push(...L2(r,e.issues)),e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function B2(e){const t=Object.keys(e.shape);for(const n of t)if(!e.shape[n]._zod.traits.has("$ZodType"))throw new Error(`Invalid element at key "${n}": expected a Zod schema`);const r=IS(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function z2(e,t,r,n,a,s){const i=[],o=a.keySet,l=a.catchall._zod,c=l.def.type;for(const u of Object.keys(t)){if(o.has(u))continue;if(c==="never"){i.push(u);continue}const f=l.run({value:t[u],issues:[]},n);f instanceof Promise?e.push(f.then(d=>Xc(d,r,u,t))):Xc(f,r,u,t)}return i.length&&r.issues.push({code:"unrecognized_keys",keys:i,input:t,inst:s}),e.length?Promise.all(e).then(()=>r):r}const f5=ie("$ZodObject",(e,t)=>{Lt.init(e,t);const r=S0(()=>B2(t));et(e._zod,"propValues",()=>{const i=t.shape,o={};for(const l in i){const c=i[l]._zod;if(c.values){o[l]??(o[l]=new Set);for(const u of c.values)o[l].add(u)}}return o});const n=Zc,a=t.catchall;let s;e._zod.parse=(i,o)=>{s??(s=r.value);const l=i.value;if(!n(l))return i.issues.push({expected:"object",code:"invalid_type",input:l,inst:e}),i;i.value={};const c=[],u=s.shape;for(const f of s.keys){const h=u[f]._zod.run({value:l[f],issues:[]},o);h instanceof Promise?c.push(h.then(v=>Xc(v,i,f,l))):Xc(h,i,f,l)}return a?z2(c,l,i,o,r.value,e):c.length?Promise.all(c).then(()=>i):i}}),d5=ie("$ZodObjectJIT",(e,t)=>{f5.init(e,t);const r=e._zod.parse,n=S0(()=>B2(t)),a=d=>{const h=new L6(["shape","payload","ctx"]),v=n.value,g=p=>{const k=em(p);return`shape[${k}]._zod.run({ value: input[${k}], issues: [] }, ctx)`};h.write("const input = payload.value;");const _=Object.create(null);let w=0;for(const p of v.keys)_[p]=`key_${w++}`;h.write("const newResult = {}");for(const p of v.keys){const k=_[p],T=em(p);h.write(`const ${k} = ${g(p)};`),h.write(`
        if (${k}.issues.length) {
          payload.issues = payload.issues.concat(${k}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${T}, ...iss.path] : [${T}]
          })));
        }
        
        if (${k}.value === undefined) {
          if (${T} in input) {
            newResult[${T}] = undefined;
          }
        } else {
          newResult[${T}] = ${k}.value;
        }
      `)}h.write("payload.value = newResult;"),h.write("return payload;");const y=h.compile();return(p,k)=>y(d,p,k)};let s;const i=Zc,o=!P2.jitless,c=o&&RS.value,u=t.catchall;let f;e._zod.parse=(d,h)=>{f??(f=n.value);const v=d.value;return i(v)?o&&c&&(h==null?void 0:h.async)===!1&&h.jitless!==!0?(s||(s=a(t.shape)),d=s(d,h),u?z2([],v,d,h,f,e):d):r(d,h):(d.issues.push({expected:"object",code:"invalid_type",input:v,inst:e}),d)}});function nm(e,t,r,n){for(const s of e)if(s.issues.length===0)return t.value=s.value,t;const a=e.filter(s=>!Zs(s));return a.length===1?(t.value=a[0].value,a[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(s=>s.issues.map(i=>ds(i,n,fs())))}),t)}const h5=ie("$ZodUnion",(e,t)=>{Lt.init(e,t),et(e._zod,"optin",()=>t.options.some(a=>a._zod.optin==="optional")?"optional":void 0),et(e._zod,"optout",()=>t.options.some(a=>a._zod.optout==="optional")?"optional":void 0),et(e._zod,"values",()=>{if(t.options.every(a=>a._zod.values))return new Set(t.options.flatMap(a=>Array.from(a._zod.values)))}),et(e._zod,"pattern",()=>{if(t.options.every(a=>a._zod.pattern)){const a=t.options.map(s=>s._zod.pattern);return new RegExp(`^(${a.map(s=>C0(s.source)).join("|")})$`)}});const r=t.options.length===1,n=t.options[0]._zod.run;e._zod.parse=(a,s)=>{if(r)return n(a,s);let i=!1;const o=[];for(const l of t.options){const c=l._zod.run({value:a.value,issues:[]},s);if(c instanceof Promise)o.push(c),i=!0;else{if(c.issues.length===0)return c;o.push(c)}}return i?Promise.all(o).then(l=>nm(l,a,e,s)):nm(o,a,e,s)}}),p5=ie("$ZodIntersection",(e,t)=>{Lt.init(e,t),e._zod.parse=(r,n)=>{const a=r.value,s=t.left._zod.run({value:a,issues:[]},n),i=t.right._zod.run({value:a,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([l,c])=>am(r,l,c)):am(r,s,i)}});function Jd(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Go(e)&&Go(t)){const r=Object.keys(t),n=Object.keys(e).filter(s=>r.indexOf(s)!==-1),a={...e,...t};for(const s of n){const i=Jd(e[s],t[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};a[s]=i.data}return{valid:!0,data:a}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<e.length;n++){const a=e[n],s=t[n],i=Jd(a,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function am(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),Zs(e))return e;const n=Jd(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const m5=ie("$ZodEnum",(e,t)=>{Lt.init(e,t);const r=NS(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=new RegExp(`^(${r.filter(a=>PS.has(typeof a)).map(a=>typeof a=="string"?Lu(a):a.toString()).join("|")})$`),e._zod.parse=(a,s)=>{const i=a.value;return n.has(i)||a.issues.push({code:"invalid_value",values:r,input:i,inst:e}),a}}),g5=ie("$ZodTransform",(e,t)=>{Lt.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new R2(e.constructor.name);const a=t.transform(r.value,r);if(n.async)return(a instanceof Promise?a:Promise.resolve(a)).then(i=>(r.value=i,r));if(a instanceof Promise)throw new ri;return r.value=a,r}});function sm(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const v5=ie("$ZodOptional",(e,t)=>{Lt.init(e,t),e._zod.optin="optional",e._zod.optout="optional",et(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),et(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${C0(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>{if(t.innerType._zod.optin==="optional"){const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>sm(s,r.value)):sm(a,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,n)}}),y5=ie("$ZodNullable",(e,t)=>{Lt.init(e,t),et(e._zod,"optin",()=>t.innerType._zod.optin),et(e._zod,"optout",()=>t.innerType._zod.optout),et(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${C0(r.source)}|null)$`):void 0}),et(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),w5=ie("$ZodDefault",(e,t)=>{Lt.init(e,t),e._zod.optin="optional",et(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);if(r.value===void 0)return r.value=t.defaultValue,r;const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>im(s,t)):im(a,t)}});function im(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const _5=ie("$ZodPrefault",(e,t)=>{Lt.init(e,t),e._zod.optin="optional",et(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),k5=ie("$ZodNonOptional",(e,t)=>{Lt.init(e,t),et(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>om(s,e)):om(a,e)}});function om(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const x5=ie("$ZodCatch",(e,t)=>{Lt.init(e,t),et(e._zod,"optin",()=>t.innerType._zod.optin),et(e._zod,"optout",()=>t.innerType._zod.optout),et(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>(r.value=s.value,s.issues.length&&(r.value=t.catchValue({...r,error:{issues:s.issues.map(i=>ds(i,n,fs()))},input:r.value}),r.issues=[]),r)):(r.value=a.value,a.issues.length&&(r.value=t.catchValue({...r,error:{issues:a.issues.map(s=>ds(s,n,fs()))},input:r.value}),r.issues=[]),r)}}),E5=ie("$ZodPipe",(e,t)=>{Lt.init(e,t),et(e._zod,"values",()=>t.in._zod.values),et(e._zod,"optin",()=>t.in._zod.optin),et(e._zod,"optout",()=>t.out._zod.optout),et(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,n)=>{if(n.direction==="backward"){const s=t.out._zod.run(r,n);return s instanceof Promise?s.then(i=>Wl(i,t.in,n)):Wl(s,t.in,n)}const a=t.in._zod.run(r,n);return a instanceof Promise?a.then(s=>Wl(s,t.out,n)):Wl(a,t.out,n)}});function Wl(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const T5=ie("$ZodReadonly",(e,t)=>{Lt.init(e,t),et(e._zod,"propValues",()=>t.innerType._zod.propValues),et(e._zod,"values",()=>t.innerType._zod.values),et(e._zod,"optin",()=>t.innerType._zod.optin),et(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(lm):lm(a)}});function lm(e){return e.value=Object.freeze(e.value),e}const S5=ie("$ZodCustom",(e,t)=>{In.init(e,t),Lt.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{const n=r.value,a=t.fn(n);if(a instanceof Promise)return a.then(s=>cm(s,r,n,e));cm(a,r,n,e)}});function cm(e,t,r,n){if(!e){const a={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(a.params=n._zod.def.params),t.issues.push(Ko(a))}}class b5{constructor(){this._map=new Map,this._idmap=new Map}add(t,...r){const n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const n={...this.get(r)??{}};delete n.id;const a={...n,...this._map.get(t)};return Object.keys(a).length?a:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function C5(){return new b5}const Hl=C5();function A5(e,t){return new e({type:"string",...Le(t)})}function N5(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...Le(t)})}function um(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...Le(t)})}function O5(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...Le(t)})}function R5(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Le(t)})}function P5(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Le(t)})}function I5(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Le(t)})}function D5(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...Le(t)})}function L5(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...Le(t)})}function F5(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...Le(t)})}function j5(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...Le(t)})}function M5(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...Le(t)})}function $5(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...Le(t)})}function U5(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...Le(t)})}function B5(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...Le(t)})}function z5(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...Le(t)})}function V5(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...Le(t)})}function W5(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Le(t)})}function H5(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Le(t)})}function G5(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...Le(t)})}function K5(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...Le(t)})}function Z5(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...Le(t)})}function X5(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...Le(t)})}function Y5(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Le(t)})}function q5(e,t){return new e({type:"string",format:"date",check:"string_format",...Le(t)})}function J5(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...Le(t)})}function Q5(e,t){return new e({type:"string",format:"duration",check:"string_format",...Le(t)})}function eb(e){return new e({type:"unknown"})}function tb(e,t){return new e({type:"never",...Le(t)})}function V2(e,t){return new S6({check:"max_length",...Le(t),maximum:e})}function Yc(e,t){return new b6({check:"min_length",...Le(t),minimum:e})}function W2(e,t){return new C6({check:"length_equals",...Le(t),length:e})}function rb(e,t){return new A6({check:"string_format",format:"regex",...Le(t),pattern:e})}function nb(e){return new N6({check:"string_format",format:"lowercase",...Le(e)})}function ab(e){return new O6({check:"string_format",format:"uppercase",...Le(e)})}function sb(e,t){return new R6({check:"string_format",format:"includes",...Le(t),includes:e})}function ib(e,t){return new P6({check:"string_format",format:"starts_with",...Le(t),prefix:e})}function ob(e,t){return new I6({check:"string_format",format:"ends_with",...Le(t),suffix:e})}function hl(e){return new D6({check:"overwrite",tx:e})}function lb(e){return hl(t=>t.normalize(e))}function cb(){return hl(e=>e.trim())}function ub(){return hl(e=>e.toLowerCase())}function fb(){return hl(e=>e.toUpperCase())}function db(e,t,r){return new e({type:"array",element:t,...Le(r)})}function hb(e,t,r){return new e({type:"custom",check:"custom",fn:t,...Le(r)})}function pb(e){const t=mb(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(Ko(n,r.value,t._zod.def));else{const a=n;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=t),a.continue??(a.continue=!t._zod.def.abort),r.issues.push(Ko(a))}},e(r.value,r)));return t}function mb(e,t){const r=new In({check:"custom",...Le(t)});return r._zod.check=e,r}function fm(e,t){try{var r=e()}catch(n){return t(n)}return r&&r.then?r.then(void 0,t):r}function gb(e,t){for(var r={};e.length;){var n=e[0],a=n.code,s=n.message,i=n.path.join(".");if(!r[i])if("unionErrors"in n){var o=n.unionErrors[0].errors[0];r[i]={message:o.message,type:o.code}}else r[i]={message:s,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(u){return u.errors.forEach(function(f){return e.push(f)})}),t){var l=r[i].types,c=l&&l[n.code];r[i]=x0(i,t,r,a,c?[].concat(c,n.message):n.message)}e.shift()}return r}function vb(e,t){for(var r={};e.length;){var n=e[0],a=n.code,s=n.message,i=n.path.join(".");if(!r[i])if(n.code==="invalid_union"&&n.errors.length>0){var o=n.errors[0][0];r[i]={message:o.message,type:o.code}}else r[i]={message:s,type:a};if(n.code==="invalid_union"&&n.errors.forEach(function(u){return u.forEach(function(f){return e.push(f)})}),t){var l=r[i].types,c=l&&l[n.code];r[i]=x0(i,t,r,a,c?[].concat(c,n.message):n.message)}e.shift()}return r}function yb(e,t,r){if(r===void 0&&(r={}),function(n){return"_def"in n&&typeof n._def=="object"&&"typeName"in n._def}(e))return function(n,a,s){try{return Promise.resolve(fm(function(){return Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(i){return s.shouldUseNativeValidation&&Yd({},s),{errors:{},values:r.raw?Object.assign({},n):i}})},function(i){if(function(o){return Array.isArray(o==null?void 0:o.issues)}(i))return{values:{},errors:q1(gb(i.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw i}))}catch(i){return Promise.reject(i)}};if(function(n){return"_zod"in n&&typeof n._zod=="object"}(e))return function(n,a,s){try{return Promise.resolve(fm(function(){return Promise.resolve((r.mode==="sync"?VS:WS)(e,n,t)).then(function(i){return s.shouldUseNativeValidation&&Yd({},s),{errors:{},values:r.raw?Object.assign({},n):i}})},function(i){if(function(o){return o instanceof N0}(i))return{values:{},errors:q1(vb(i.issues,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw i}))}catch(i){return Promise.reject(i)}};throw new Error("Invalid input: not a Zod schema")}const wb=ie("ZodISODateTime",(e,t)=>{Z6.init(e,t),pt.init(e,t)});function _b(e){return Y5(wb,e)}const kb=ie("ZodISODate",(e,t)=>{X6.init(e,t),pt.init(e,t)});function xb(e){return q5(kb,e)}const Eb=ie("ZodISOTime",(e,t)=>{Y6.init(e,t),pt.init(e,t)});function Tb(e){return J5(Eb,e)}const Sb=ie("ZodISODuration",(e,t)=>{q6.init(e,t),pt.init(e,t)});function bb(e){return Q5(Sb,e)}const Cb=(e,t)=>{N0.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>zS(e,r)},flatten:{value:r=>BS(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,qd,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,qd,2)}},isEmpty:{get(){return e.issues.length===0}}})},Yr=ie("ZodError",Cb,{Parent:Error}),Ab=ju(Yr),Nb=Mu(Yr),Ob=$u(Yr),Rb=Uu(Yr),Pb=KS(Yr),Ib=ZS(Yr),Db=XS(Yr),Lb=YS(Yr),Fb=qS(Yr),jb=JS(Yr),Mb=QS(Yr),$b=e6(Yr),Bt=ie("ZodType",(e,t)=>(Lt.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),e.clone=(r,n)=>Ba(e,r,n),e.brand=()=>e,e.register=(r,n)=>(r.add(e,n),e),e.parse=(r,n)=>Ab(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>Ob(e,r,n),e.parseAsync=async(r,n)=>Nb(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>Rb(e,r,n),e.spa=e.safeParseAsync,e.encode=(r,n)=>Pb(e,r,n),e.decode=(r,n)=>Ib(e,r,n),e.encodeAsync=async(r,n)=>Db(e,r,n),e.decodeAsync=async(r,n)=>Lb(e,r,n),e.safeEncode=(r,n)=>Fb(e,r,n),e.safeDecode=(r,n)=>jb(e,r,n),e.safeEncodeAsync=async(r,n)=>Mb(e,r,n),e.safeDecodeAsync=async(r,n)=>$b(e,r,n),e.refine=(r,n)=>e.check(OC(r,n)),e.superRefine=r=>e.check(RC(r)),e.overwrite=r=>e.check(hl(r)),e.optional=()=>mm(e),e.nullable=()=>gm(e),e.nullish=()=>mm(gm(e)),e.nonoptional=r=>EC(e,r),e.array=()=>lC(e),e.or=r=>dC([e,r]),e.and=r=>pC(e,r),e.transform=r=>vm(e,vC(r)),e.default=r=>_C(e,r),e.prefault=r=>xC(e,r),e.catch=r=>SC(e,r),e.pipe=r=>vm(e,r),e.readonly=()=>AC(e),e.describe=r=>{const n=e.clone();return Hl.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){var r;return(r=Hl.get(e))==null?void 0:r.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return Hl.get(e);const n=e.clone();return Hl.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),H2=ie("_ZodString",(e,t)=>{O0.init(e,t),Bt.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(rb(...n)),e.includes=(...n)=>e.check(sb(...n)),e.startsWith=(...n)=>e.check(ib(...n)),e.endsWith=(...n)=>e.check(ob(...n)),e.min=(...n)=>e.check(Yc(...n)),e.max=(...n)=>e.check(V2(...n)),e.length=(...n)=>e.check(W2(...n)),e.nonempty=(...n)=>e.check(Yc(1,...n)),e.lowercase=n=>e.check(nb(n)),e.uppercase=n=>e.check(ab(n)),e.trim=()=>e.check(cb()),e.normalize=(...n)=>e.check(lb(...n)),e.toLowerCase=()=>e.check(ub()),e.toUpperCase=()=>e.check(fb())}),Ub=ie("ZodString",(e,t)=>{O0.init(e,t),H2.init(e,t),e.email=r=>e.check(N5(Bb,r)),e.url=r=>e.check(D5(zb,r)),e.jwt=r=>e.check(X5(nC,r)),e.emoji=r=>e.check(L5(Vb,r)),e.guid=r=>e.check(um(hm,r)),e.uuid=r=>e.check(O5(Gl,r)),e.uuidv4=r=>e.check(R5(Gl,r)),e.uuidv6=r=>e.check(P5(Gl,r)),e.uuidv7=r=>e.check(I5(Gl,r)),e.nanoid=r=>e.check(F5(Wb,r)),e.guid=r=>e.check(um(hm,r)),e.cuid=r=>e.check(j5(Hb,r)),e.cuid2=r=>e.check(M5(Gb,r)),e.ulid=r=>e.check($5(Kb,r)),e.base64=r=>e.check(G5(eC,r)),e.base64url=r=>e.check(K5(tC,r)),e.xid=r=>e.check(U5(Zb,r)),e.ksuid=r=>e.check(B5(Xb,r)),e.ipv4=r=>e.check(z5(Yb,r)),e.ipv6=r=>e.check(V5(qb,r)),e.cidrv4=r=>e.check(W5(Jb,r)),e.cidrv6=r=>e.check(H5(Qb,r)),e.e164=r=>e.check(Z5(rC,r)),e.datetime=r=>e.check(_b(r)),e.date=r=>e.check(xb(r)),e.time=r=>e.check(Tb(r)),e.duration=r=>e.check(bb(r))});function dm(e){return A5(Ub,e)}const pt=ie("ZodStringFormat",(e,t)=>{lt.init(e,t),H2.init(e,t)}),Bb=ie("ZodEmail",(e,t)=>{$6.init(e,t),pt.init(e,t)}),hm=ie("ZodGUID",(e,t)=>{j6.init(e,t),pt.init(e,t)}),Gl=ie("ZodUUID",(e,t)=>{M6.init(e,t),pt.init(e,t)}),zb=ie("ZodURL",(e,t)=>{U6.init(e,t),pt.init(e,t)}),Vb=ie("ZodEmoji",(e,t)=>{B6.init(e,t),pt.init(e,t)}),Wb=ie("ZodNanoID",(e,t)=>{z6.init(e,t),pt.init(e,t)}),Hb=ie("ZodCUID",(e,t)=>{V6.init(e,t),pt.init(e,t)}),Gb=ie("ZodCUID2",(e,t)=>{W6.init(e,t),pt.init(e,t)}),Kb=ie("ZodULID",(e,t)=>{H6.init(e,t),pt.init(e,t)}),Zb=ie("ZodXID",(e,t)=>{G6.init(e,t),pt.init(e,t)}),Xb=ie("ZodKSUID",(e,t)=>{K6.init(e,t),pt.init(e,t)}),Yb=ie("ZodIPv4",(e,t)=>{J6.init(e,t),pt.init(e,t)}),qb=ie("ZodIPv6",(e,t)=>{Q6.init(e,t),pt.init(e,t)}),Jb=ie("ZodCIDRv4",(e,t)=>{e5.init(e,t),pt.init(e,t)}),Qb=ie("ZodCIDRv6",(e,t)=>{t5.init(e,t),pt.init(e,t)}),eC=ie("ZodBase64",(e,t)=>{r5.init(e,t),pt.init(e,t)}),tC=ie("ZodBase64URL",(e,t)=>{a5.init(e,t),pt.init(e,t)}),rC=ie("ZodE164",(e,t)=>{s5.init(e,t),pt.init(e,t)}),nC=ie("ZodJWT",(e,t)=>{o5.init(e,t),pt.init(e,t)}),aC=ie("ZodUnknown",(e,t)=>{l5.init(e,t),Bt.init(e,t)});function pm(){return eb(aC)}const sC=ie("ZodNever",(e,t)=>{c5.init(e,t),Bt.init(e,t)});function iC(e){return tb(sC,e)}const oC=ie("ZodArray",(e,t)=>{u5.init(e,t),Bt.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(Yc(r,n)),e.nonempty=r=>e.check(Yc(1,r)),e.max=(r,n)=>e.check(V2(r,n)),e.length=(r,n)=>e.check(W2(r,n)),e.unwrap=()=>e.element});function lC(e,t){return db(oC,e,t)}const cC=ie("ZodObject",(e,t)=>{d5.init(e,t),Bt.init(e,t),et(e,"shape",()=>t.shape),e.keyof=()=>mC(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:pm()}),e.loose=()=>e.clone({...e._zod.def,catchall:pm()}),e.strict=()=>e.clone({...e._zod.def,catchall:iC()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>FS(e,r),e.safeExtend=r=>jS(e,r),e.merge=r=>MS(e,r),e.pick=r=>DS(e,r),e.omit=r=>LS(e,r),e.partial=(...r)=>$S(G2,e,r[0]),e.required=(...r)=>US(K2,e,r[0])});function uC(e,t){const r={type:"object",get shape(){return Ua(this,"shape",e?OS(e):{}),this.shape},...Le(t)};return new cC(r)}const fC=ie("ZodUnion",(e,t)=>{h5.init(e,t),Bt.init(e,t),e.options=t.options});function dC(e,t){return new fC({type:"union",options:e,...Le(t)})}const hC=ie("ZodIntersection",(e,t)=>{p5.init(e,t),Bt.init(e,t)});function pC(e,t){return new hC({type:"intersection",left:e,right:t})}const Qd=ie("ZodEnum",(e,t)=>{m5.init(e,t),Bt.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(n,a)=>{const s={};for(const i of n)if(r.has(i))s[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new Qd({...t,checks:[],...Le(a),entries:s})},e.exclude=(n,a)=>{const s={...t.entries};for(const i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new Qd({...t,checks:[],...Le(a),entries:s})}});function mC(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new Qd({type:"enum",entries:r,...Le(t)})}const gC=ie("ZodTransform",(e,t)=>{g5.init(e,t),Bt.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new R2(e.constructor.name);r.addIssue=s=>{if(typeof s=="string")r.issues.push(Ko(s,r.value,t));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),r.issues.push(Ko(i))}};const a=t.transform(r.value,r);return a instanceof Promise?a.then(s=>(r.value=s,r)):(r.value=a,r)}});function vC(e){return new gC({type:"transform",transform:e})}const G2=ie("ZodOptional",(e,t)=>{v5.init(e,t),Bt.init(e,t),e.unwrap=()=>e._zod.def.innerType});function mm(e){return new G2({type:"optional",innerType:e})}const yC=ie("ZodNullable",(e,t)=>{y5.init(e,t),Bt.init(e,t),e.unwrap=()=>e._zod.def.innerType});function gm(e){return new yC({type:"nullable",innerType:e})}const wC=ie("ZodDefault",(e,t)=>{w5.init(e,t),Bt.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function _C(e,t){return new wC({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():D2(t)}})}const kC=ie("ZodPrefault",(e,t)=>{_5.init(e,t),Bt.init(e,t),e.unwrap=()=>e._zod.def.innerType});function xC(e,t){return new kC({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():D2(t)}})}const K2=ie("ZodNonOptional",(e,t)=>{k5.init(e,t),Bt.init(e,t),e.unwrap=()=>e._zod.def.innerType});function EC(e,t){return new K2({type:"nonoptional",innerType:e,...Le(t)})}const TC=ie("ZodCatch",(e,t)=>{x5.init(e,t),Bt.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function SC(e,t){return new TC({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const bC=ie("ZodPipe",(e,t)=>{E5.init(e,t),Bt.init(e,t),e.in=t.in,e.out=t.out});function vm(e,t){return new bC({type:"pipe",in:e,out:t})}const CC=ie("ZodReadonly",(e,t)=>{T5.init(e,t),Bt.init(e,t),e.unwrap=()=>e._zod.def.innerType});function AC(e){return new CC({type:"readonly",innerType:e})}const NC=ie("ZodCustom",(e,t)=>{S5.init(e,t),Bt.init(e,t)});function OC(e,t={}){return hb(NC,e,t)}function RC(e){return pb(e)}const PC=uC({username:dm().min(1,"Nome de usuário é obrigatório").min(3,"Nome de usuário deve ter pelo menos 3 caracteres"),password:dm().min(1,"Senha é obrigatória").min(6,"Senha deve ter pelo menos 6 caracteres")}),Z2="/assets/ManipulariumLogo-8slJorZ1.png",IC=()=>{const e=c0(),{login:t,isLoading:r}=Iu(),[n,a]=B.useState(""),{register:s,handleSubmit:i,formState:{errors:o}}=CS({resolver:yb(PC)}),l=async c=>{a(""),await t(c.username,c.password)?e("/dashboard"):a("Credenciais inválidas. Verifique seu nome de usuário e senha.")};return m.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 to-black px-4 py-12",children:m.jsxs("div",{className:"w-full max-w-md space-y-8",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"mx-auto mb-6",children:m.jsx("img",{src:Z2,alt:"Manipularium Logo",className:"h-24 w-24 mx-auto drop-shadow-lg",style:{backgroundColor:"transparent"}})}),m.jsx("h2",{className:"text-3xl font-bold text-gray-100",children:"Manipularium"}),m.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Conferência Bancária - Acesso Restrito"})]}),m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 px-6 py-8",children:[m.jsxs("form",{className:"space-y-6",onSubmit:i(l),children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-300 mb-2",children:"Nome de usuário"}),m.jsx("input",{...s("username"),id:"username",name:"username",type:"text",autoComplete:"username","aria-describedby":o.username?"username-error":void 0,className:`w-full px-3 py-2 border rounded-md shadow-sm bg-gray-700 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${o.username?"border-red-400":"border-gray-600"}`,placeholder:"Digite seu nome de usuário"}),o.username&&m.jsx("p",{id:"username-error",className:"mt-1 text-sm text-red-400",role:"alert",children:o.username.message})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Senha"}),m.jsx("input",{...s("password"),id:"password",name:"password",type:"password",autoComplete:"current-password","aria-describedby":o.password?"password-error":void 0,className:`w-full px-3 py-2 border rounded-md shadow-sm bg-gray-700 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${o.password?"border-red-400":"border-gray-600"}`,placeholder:"Digite sua senha"}),o.password&&m.jsx("p",{id:"password-error",className:"mt-1 text-sm text-red-400",role:"alert",children:o.password.message})]}),n&&m.jsx("div",{className:"bg-red-900/20 border border-red-400 rounded-md p-3",children:m.jsx("p",{className:"text-sm text-red-400",role:"alert",children:n})}),m.jsx("button",{type:"submit",disabled:r,className:"w-full flex justify-center items-center py-2.5 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?m.jsxs(m.Fragment,{children:[m.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Entrando..."]}):"Entrar"})]}),m.jsx("div",{className:"mt-6 p-3 bg-indigo-900/20 border border-indigo-600/30 rounded-md",children:m.jsxs("p",{className:"text-xs text-indigo-300",children:[m.jsx("strong",{children:"Credenciais de demonstração:"}),m.jsx("br",{}),"Usuário: admin",m.jsx("br",{}),"Senha: manipularium"]})})]})]})})},DC=({children:e})=>{const{user:t}=Iu();return t?m.jsx(m.Fragment,{children:e}):m.jsx(Fd,{to:"/",replace:!0})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var X2=1252,LC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],R0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},P0=function(e){LC.indexOf(e)!=-1&&(X2=R0[0]=e)};function FC(){P0(1252)}var fn=function(e){P0(e)};function Y2(){fn(1200),FC()}function ym(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function jC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function q2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var qi=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?jC(e.slice(2)):t==254&&r==255?q2(e.slice(2)):t==65279?e.slice(1):e},Kl=function(t){return String.fromCharCode(t)},wm=function(t){return String.fromCharCode(t)},ga,_a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _m(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=_a.charAt(s)+_a.charAt(i)+_a.charAt(o)+_a.charAt(l);return t}function Lr(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=_a.indexOf(e.charAt(c++)),i=_a.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=_a.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=_a.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var We=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ws=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ia(e){return We?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function km(e){return We?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var un=function(t){return We?ws(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function _s(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function I0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return I0(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var va=We?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ws(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function MC(e){for(var t=[],r=0,n=e.length+250,a=Ia(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ia(65535),n=65530)}return t.push(a.slice(0,r)),va(t)}var mr=/\u0000/g,Ji=/[\u0001-\u0006]/g;function ni(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function dn(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}function D0(e,t){var r=""+e;return r.length>=t?r:gt(" ",t-r.length)+r}function qc(e,t){var r=""+e;return r.length>=t?r:r+gt(" ",t-r.length)}function $C(e,t){var r=""+Math.round(e);return r.length>=t?r:gt("0",t-r.length)+r}function UC(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}var xm=Math.pow(2,32);function Ps(e,t){if(e>xm||e<-xm)return $C(e,t);var r=Math.round(e);return UC(r,t)}function Jc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Em=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Pf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function BC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ue={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Tm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},zC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qc(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*i+s,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function ts(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=ZC(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var J2=new Date(1899,11,31,0,0,0),VC=J2.getTime(),WC=new Date(1900,2,1,0,0,0);function Q2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=WC&&(r+=24*60*60*1e3),(r-(VC+(e.getTimezoneOffset()-J2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function L0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function HC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function GC(e){var t=e<0?12:11,r=L0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function KC(e){var t=L0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Zo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=GC(e):t===10?r=e.toFixed(10).substr(0,12):r=KC(e),L0(HC(r.toUpperCase()))}function hs(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Zo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Xr(14,Q2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ZC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function XC(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Pf[r.m-1][1];case 5:return Pf[r.m-1][0];default:return Pf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Em[r.q][0];default:return Em[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?dn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=dn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?dn(l,c):"";return u}function ka(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ew=/%/g;function YC(e,t,r){var n=t.replace(ew,""),a=t.length-n.length;return Yn(e,n,r*Math.pow(10,2*a))+gt("%",a)}function qC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Yn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function tw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tw(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var rw=/# (\?+)( ?)\/( ?)(\d+)/;function JC(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?gt(" ",e[1].length+1+e[4].length):D0(i,e[1].length)+e[2]+"/"+e[3]+dn(o,e[4].length))}function QC(e,t,r){return r+(t===0?"":""+t)+gt(" ",e[1].length+2+e[4].length)}var nw=/^#*0*\.([0#]+)/,aw=/\).*[0#]/,sw=/\(###\) ###\\?-####/;function fr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Sm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function bm(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function eA(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function tA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function $r(e,t,r){if(e.charCodeAt(0)===40&&!t.match(aw)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$r("n",n,r):"("+$r("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return qC(e,t,r);if(t.indexOf("%")!==-1)return YC(e,t,r);if(t.indexOf("E")!==-1)return tw(t,r);if(t.charCodeAt(0)===36)return"$"+$r(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ps(l,t.length);if(t.match(/^[#?]+$/))return a=Ps(r,0),a==="0"&&(a=""),a.length>t.length?a:fr(t.substr(0,t.length-a.length))+a;if(s=t.match(rw))return JC(s,l,c);if(t.match(/^#+0+$/))return c+Ps(l,t.length-t.indexOf("0"));if(s=t.match(nw))return a=Sm(r,s[1].length).replace(/^([^\.]+)$/,"$1."+fr(s[1])).replace(/\.$/,"."+fr(s[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+gt("0",fr(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Sm(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+ka(Ps(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$r(e,t,-r):ka(""+(Math.floor(r)+eA(r,s[1].length)))+"."+dn(bm(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return $r(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ni($r(e,t.replace(/[\\-]/g,""),r)),i=0,ni(ni(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(sw))return a=$r(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Qc(l,Math.pow(10,i)-1,!1),a=""+c,u=Yn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=qc(o[2],i),u.length<s[4].length&&(u=fr(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Qc(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?D0(o[1],i)+s[2]+"/"+s[3]+qc(o[2],i):gt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Ps(r,0),t.length<=a.length?a:fr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,d=t.length-a.length-f;return fr(t.substr(0,f)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=bm(r,s[1].length),r<0?"-"+$r(e,t,-r):ka(tA(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?dn(0,3-v.length):"")+v})+"."+dn(i,s[1].length);switch(t){case"###,##0.00":return $r(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ka(Ps(l,0));return h!=="0"?c+h:"";case"###,###.00":return $r(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return $r(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function rA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Yn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function nA(e,t,r){var n=t.replace(ew,""),a=t.length-n.length;return Yn(e,n,r*Math.pow(10,2*a))+gt("%",a)}function iw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iw(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function xn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(aw)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xn("n",n,r):"("+xn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return rA(e,t,r);if(t.indexOf("%")!==-1)return nA(e,t,r);if(t.indexOf("E")!==-1)return iw(t,r);if(t.charCodeAt(0)===36)return"$"+xn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+dn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:fr(t.substr(0,t.length-a.length))+a;if(s=t.match(rw))return QC(s,l,c);if(t.match(/^#+0+$/))return c+dn(l,t.length-t.indexOf("0"));if(s=t.match(nw))return a=(""+r).replace(/^([^\.]+)$/,"$1."+fr(s[1])).replace(/\.$/,"."+fr(s[1])),a=a.replace(/\.(\d*)$/,function(v,g){return"."+g+gt("0",fr(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+ka(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xn(e,t,-r):ka(""+r)+"."+gt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return xn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ni(xn(e,t.replace(/[\\-]/g,""),r)),i=0,ni(ni(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(sw))return a=xn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Qc(l,Math.pow(10,i)-1,!1),a=""+c,u=Yn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=qc(o[2],i),u.length<s[4].length&&(u=fr(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Qc(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?D0(o[1],i)+s[2]+"/"+s[3]+qc(o[2],i):gt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:fr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,d=t.length-a.length-f;return fr(t.substr(0,f)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+xn(e,t,-r):ka(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?dn(0,3-v.length):"")+v})+"."+dn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ka(""+l);return h!=="0"?c+h:"";default:if(t.match(/\.[0#?]*$/))return xn(e,t.slice(0,t.lastIndexOf(".")),r)+fr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Yn(e,t,r){return(r|0)===r?xn(e,t,r):$r(e,t,r)}function aA(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ow=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function bi(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Jc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ow))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function sA(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,u,f,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Jc(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var h=e.charAt(++i),v=h==="("||h===")"?h:"t";a[a.length]={t:v,v:h},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=ts(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ts(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var g={t:o,v:o};if(c==null&&(c=ts(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(c!=null&&(g.v=c.H>=12?"下午":"上午"),g.t="T",i+=5,d="h"):(g.t="t",++i),c==null&&g.t==="T")return"";a[a.length]=g,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ow)){if(c==null&&(c=ts(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",bi(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var _=0,w=0,y;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=d,l="h",_<1&&(_=1);break;case"s":(y=a[i].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[i].v.match(/[Hh]/)&&(_=1),_<2&&a[i].v.match(/[Mm]/)&&(_=2),_<3&&a[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var p="",k;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=XC(a[i].t.charCodeAt(0),a[i].v,c,w),a[i].t="t";break;case"n":case"?":for(k=i+1;a[k]!=null&&((o=a[k].t)==="?"||o==="D"||(o===" "||o==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[i].v+=a[k].v,a[k]={v:"",t:";"},++k;p+=a[i].v,i=k-1;break;case"G":a[i].t="t",a[i].v=hs(t,r);break}var T="",S,x;if(p.length>0){p.charCodeAt(0)==40?(S=t<0&&p.charCodeAt(0)===45?-t:t,x=Yn("n",p,S)):(S=t<0&&n>1?-t:t,x=Yn("n",p,S),S<0&&a[0]&&a[0].t=="t"&&(x=x.substr(1),a[0].v="-"+a[0].v)),k=x.length-1;var D=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){D=i;break}var I=a.length;if(D===a.length&&x.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(k>=a[i].v.length-1?(k-=a[i].v.length,a[i].v=x.substr(k+1,a[i].v.length)):k<0?a[i].v="":(a[i].v=x.substr(0,k+1),k=-1),a[i].t="t",I=i);k>=0&&I<a.length&&(a[I].v=x.substr(0,k+1)+a[I].v)}else if(D!==a.length&&x.indexOf("E")===-1){for(k=x.indexOf(".")-1,i=D;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(u=a[i].v.indexOf(".")>-1&&i===D?a[i].v.indexOf(".")-1:a[i].v.length-1,T=a[i].v.substr(u+1);u>=0;--u)k>=0&&(a[i].v.charAt(u)==="0"||a[i].v.charAt(u)==="#")&&(T=x.charAt(k--)+T);a[i].v=T,a[i].t="t",I=i}for(k>=0&&I<a.length&&(a[I].v=x.substr(0,k+1)+a[I].v),k=x.indexOf(".")+1,i=D;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==D)){for(u=a[i].v.indexOf(".")>-1&&i===D?a[i].v.indexOf(".")+1:0,T=a[i].v.substr(0,u);u<a[i].v.length;++u)k<x.length&&(T+=x.charAt(k++));a[i].v=T,a[i].t="t",I=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(S=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=Yn(a[i].t,a[i].v,S),a[i].t="t");var z="";for(i=0;i!==a.length;++i)a[i]!=null&&(z+=a[i].v);return z}var Cm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Am(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function iA(e,t){var r=aA(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Cm),o=r[1].match(Cm);return Am(t,i)?[n,r[0]]:Am(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function Xr(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ue)[e],n==null&&(n=r.table&&r.table[Tm[e]]||Ue[Tm[e]]),n==null&&(n=zC[e]||"General");break}if(Jc(n,0))return hs(t,r);t instanceof Date&&(t=Q2(t,r.date1904));var a=iA(n,t);if(Jc(a[1]))return hs(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return sA(a[1],t,r,a[0])}function as(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ue[r]==null){t<0&&(t=r);continue}if(Ue[r]==e){t=r;break}}t<0&&(t=391)}return Ue[t]=e,t}function lw(){Ue=BC()}var oA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},cw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function lA(e){var t=typeof e=="number"?Ue[e]:e;return t=t.replace(cw,"(\\d+)"),new RegExp("^"+t+"$")}function cA(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(cw)||[]).forEach(function(f,d){var h=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":i=h;break;case"s":l=h;break;case"m":i>=0?o=h:a=h;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?u:c+"T"+u}var uA=function(){var e={};e.version="1.2.0";function t(){for(var x=0,D=new Array(256),I=0;I!=256;++I)x=I,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,D[I]=x;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(x){var D=0,I=0,z=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)V[z]=x[z];for(z=0;z!=256;++z)for(I=x[z],D=256+z;D<4096;D+=256)I=V[D]=I>>>8^x[I&255];var F=[];for(z=1;z!=16;++z)F[z-1]=typeof Int32Array<"u"?V.subarray(z*256,z*256+256):V.slice(z*256,z*256+256);return F}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],d=a[7],h=a[8],v=a[9],g=a[10],_=a[11],w=a[12],y=a[13],p=a[14];function k(x,D){for(var I=D^-1,z=0,V=x.length;z<V;)I=I>>>8^r[(I^x.charCodeAt(z++))&255];return~I}function T(x,D){for(var I=D^-1,z=x.length-15,V=0;V<z;)I=p[x[V++]^I&255]^y[x[V++]^I>>8&255]^w[x[V++]^I>>16&255]^_[x[V++]^I>>>24]^g[x[V++]]^v[x[V++]]^h[x[V++]]^d[x[V++]]^f[x[V++]]^u[x[V++]]^c[x[V++]]^l[x[V++]]^o[x[V++]]^i[x[V++]]^s[x[V++]]^r[x[V++]];for(z+=15;V<z;)I=I>>>8^r[(I^x[V++])&255];return~I}function S(x,D){for(var I=D^-1,z=0,V=x.length,F=0,q=0;z<V;)F=x.charCodeAt(z++),F<128?I=I>>>8^r[(I^F)&255]:F<2048?(I=I>>>8^r[(I^(192|F>>6&31))&255],I=I>>>8^r[(I^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,q=x.charCodeAt(z++)&1023,I=I>>>8^r[(I^(240|F>>8&7))&255],I=I>>>8^r[(I^(128|F>>2&63))&255],I=I>>>8^r[(I^(128|q>>6&15|(F&3)<<4))&255],I=I>>>8^r[(I^(128|q&63))&255]):(I=I>>>8^r[(I^(224|F>>12&15))&255],I=I>>>8^r[(I^(128|F>>6&63))&255],I=I>>>8^r[(I^(128|F&63))&255]);return~I}return e.table=r,e.bstr=k,e.buf=T,e.str=S,e}(),He=function(){var t={};t.version="1.2.1";function r(E,N){for(var b=E.split("/"),C=N.split("/"),R=0,P=0,K=Math.min(b.length,C.length);R<K;++R){if(P=b[R].length-C[R].length)return P;if(b[R]!=C[R])return b[R]<C[R]?-1:1}return b.length-C.length}function n(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:n(E.slice(0,-1));var N=E.lastIndexOf("/");return N===-1?E:E.slice(0,N+1)}function a(E){if(E.charAt(E.length-1)=="/")return a(E.slice(0,-1));var N=E.lastIndexOf("/");return N===-1?E:E.slice(N+1)}function s(E,N){typeof N=="string"&&(N=new Date(N));var b=N.getHours();b=b<<6|N.getMinutes(),b=b<<5|N.getSeconds()>>>1,E.write_shift(2,b);var C=N.getFullYear()-1980;C=C<<4|N.getMonth()+1,C=C<<5|N.getDate(),E.write_shift(2,C)}function i(E){var N=E.read_shift(2)&65535,b=E.read_shift(2)&65535,C=new Date,R=b&31;b>>>=5;var P=b&15;b>>>=4,C.setMilliseconds(0),C.setFullYear(b+1980),C.setMonth(P-1),C.setDate(R);var K=N&31;N>>>=5;var ee=N&63;return N>>>=6,C.setHours(N),C.setMinutes(ee),C.setSeconds(K<<1),C}function o(E){Vt(E,0);for(var N={},b=0;E.l<=E.length-4;){var C=E.read_shift(2),R=E.read_shift(2),P=E.l+R,K={};switch(C){case 21589:b=E.read_shift(1),b&1&&(K.mtime=E.read_shift(4)),R>5&&(b&2&&(K.atime=E.read_shift(4)),b&4&&(K.ctime=E.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}E.l=P,N[C]=K}return N}var l;function c(){return l||(l={})}function u(E,N){if(E[0]==80&&E[1]==75)return sp(E,N);if((E[0]|32)==109&&(E[1]|32)==105)return B_(E,N);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var b=3,C=512,R=0,P=0,K=0,ee=0,G=0,Z=[],X=E.slice(0,512);Vt(X,0);var de=f(X);switch(b=de[0],b){case 3:C=512;break;case 4:C=4096;break;case 0:if(de[1]==0)return sp(E,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+b)}C!==512&&(X=E.slice(0,C),Vt(X,28));var xe=E.slice(0,C);d(X,b);var be=X.read_shift(4,"i");if(b===3&&be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+be);X.l+=4,K=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),ee=X.read_shift(4,"i"),R=X.read_shift(4,"i"),G=X.read_shift(4,"i"),P=X.read_shift(4,"i");for(var ve=-1,Te=0;Te<109&&(ve=X.read_shift(4,"i"),!(ve<0));++Te)Z[Te]=ve;var Me=h(E,C);_(G,P,Me,C,Z);var ct=y(Me,K,Z,C);ct[K].name="!Directory",R>0&&ee!==q&&(ct[ee].name="!MiniFAT"),ct[Z[0]].name="!FAT",ct.fat_addrs=Z,ct.ssz=C;var ut={},Xt=[],Oi=[],Ri=[];p(K,ct,Me,Xt,R,ut,Oi,ee),v(Oi,Ri,Xt),Xt.shift();var Pi={FileIndex:Oi,FullPaths:Ri};return N&&N.raw&&(Pi.raw={header:xe,sectors:Me}),Pi}function f(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(ae,"Header Signature: "),E.l+=16;var N=E.read_shift(2,"u");return[E.read_shift(2,"u"),N]}function d(E,N){var b=9;switch(E.l+=2,b=E.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+b);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+b);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+b)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function h(E,N){for(var b=Math.ceil(E.length/N)-1,C=[],R=1;R<b;++R)C[R-1]=E.slice(R*N,(R+1)*N);return C[b-1]=E.slice(b*N),C}function v(E,N,b){for(var C=0,R=0,P=0,K=0,ee=0,G=b.length,Z=[],X=[];C<G;++C)Z[C]=X[C]=C,N[C]=b[C];for(;ee<X.length;++ee)C=X[ee],R=E[C].L,P=E[C].R,K=E[C].C,Z[C]===C&&(R!==-1&&Z[R]!==R&&(Z[C]=Z[R]),P!==-1&&Z[P]!==P&&(Z[C]=Z[P])),K!==-1&&(Z[K]=C),R!==-1&&C!=Z[C]&&(Z[R]=Z[C],X.lastIndexOf(R)<ee&&X.push(R)),P!==-1&&C!=Z[C]&&(Z[P]=Z[C],X.lastIndexOf(P)<ee&&X.push(P));for(C=1;C<G;++C)Z[C]===C&&(P!==-1&&Z[P]!==P?Z[C]=Z[P]:R!==-1&&Z[R]!==R&&(Z[C]=Z[R]));for(C=1;C<G;++C)if(E[C].type!==0){if(ee=C,ee!=Z[ee])do ee=Z[ee],N[C]=N[ee]+"/"+N[C];while(ee!==0&&Z[ee]!==-1&&ee!=Z[ee]);Z[C]=-1}for(N[0]+="/",C=1;C<G;++C)E[C].type!==2&&(N[C]+="/")}function g(E,N,b){for(var C=E.start,R=E.size,P=[],K=C;b&&R>0&&K>=0;)P.push(N.slice(K*F,K*F+F)),R-=F,K=Ya(b,K*4);return P.length===0?Ot(0):va(P).slice(0,E.size)}function _(E,N,b,C,R){var P=q;if(E===q){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var K=b[E],ee=(C>>>2)-1;if(!K)return;for(var G=0;G<ee&&(P=Ya(K,G*4))!==q;++G)R.push(P);_(Ya(K,C-4),N-1,b,C,R)}}function w(E,N,b,C,R){var P=[],K=[];R||(R=[]);var ee=C-1,G=0,Z=0;for(G=N;G>=0;){R[G]=!0,P[P.length]=G,K.push(E[G]);var X=b[Math.floor(G*4/C)];if(Z=G*4&ee,C<4+Z)throw new Error("FAT boundary crossed: "+G+" 4 "+C);if(!E[X])break;G=Ya(E[X],Z)}return{nodes:P,data:Mm([K])}}function y(E,N,b,C){var R=E.length,P=[],K=[],ee=[],G=[],Z=C-1,X=0,de=0,xe=0,be=0;for(X=0;X<R;++X)if(ee=[],xe=X+N,xe>=R&&(xe-=R),!K[xe]){G=[];var ve=[];for(de=xe;de>=0;){ve[de]=!0,K[de]=!0,ee[ee.length]=de,G.push(E[de]);var Te=b[Math.floor(de*4/C)];if(be=de*4&Z,C<4+be)throw new Error("FAT boundary crossed: "+de+" 4 "+C);if(!E[Te]||(de=Ya(E[Te],be),ve[de]))break}P[xe]={nodes:ee,data:Mm([G])}}return P}function p(E,N,b,C,R,P,K,ee){for(var G=0,Z=C.length?2:0,X=N[E].data,de=0,xe=0,be;de<X.length;de+=128){var ve=X.slice(de,de+128);Vt(ve,64),xe=ve.read_shift(2),be=U0(ve,0,xe-Z),C.push(be);var Te={name:be,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},Me=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);Me!==0&&(Te.ct=k(ve,ve.l-8));var ct=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);ct!==0&&(Te.mt=k(ve,ve.l-8)),Te.start=ve.read_shift(4,"i"),Te.size=ve.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=q,Te.name=""),Te.type===5?(G=Te.start,R>0&&G!==q&&(N[G].name="!StreamData")):Te.size>=4096?(Te.storage="fat",N[Te.start]===void 0&&(N[Te.start]=w(b,Te.start,N.fat_addrs,N.ssz)),N[Te.start].name=Te.name,Te.content=N[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:G!==q&&Te.start!==q&&N[G]&&(Te.content=g(Te,N[G].data,(N[ee]||{}).data))),Te.content&&Vt(Te.content,0),P[be]=Te,K.push(Te)}}function k(E,N){return new Date((Or(E,N+4)/1e7*Math.pow(2,32)+Or(E,N)/1e7-11644473600)*1e3)}function T(E,N){return c(),u(l.readFileSync(E),N)}function S(E,N){var b=N&&N.type;switch(b||We&&Buffer.isBuffer(E)&&(b="buffer"),b||"base64"){case"file":return T(E,N);case"base64":return u(un(Lr(E)),N);case"binary":return u(un(E),N)}return u(E,N)}function x(E,N){var b=N||{},C=b.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=C+"/",E.FileIndex[0]={name:C,type:5}),b.CLSID&&(E.FileIndex[0].clsid=b.CLSID),D(E)}function D(E){var N="Sh33tJ5";if(!He.find(E,"/"+N)){var b=Ot(4);b[0]=55,b[1]=b[3]=50,b[2]=54,E.FileIndex.push({name:N,type:2,content:b,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+N),I(E)}}function I(E,N){x(E);for(var b=!1,C=!1,R=E.FullPaths.length-1;R>=0;--R){var P=E.FileIndex[R];switch(P.type){case 0:C?b=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(P.R*P.L*P.C)&&(b=!0),P.R>-1&&P.L>-1&&P.R==P.L&&(b=!0);break;default:b=!0;break}}if(!(!b&&!N)){var K=new Date(1987,1,19),ee=0,G=Object.create?Object.create(null):{},Z=[];for(R=0;R<E.FullPaths.length;++R)G[E.FullPaths[R]]=!0,E.FileIndex[R].type!==0&&Z.push([E.FullPaths[R],E.FileIndex[R]]);for(R=0;R<Z.length;++R){var X=n(Z[R][0]);C=G[X],C||(Z.push([X,{name:a(X).replace("/",""),type:1,clsid:ge,ct:K,mt:K,content:null}]),G[X]=!0)}for(Z.sort(function(be,ve){return r(be[0],ve[0])}),E.FullPaths=[],E.FileIndex=[],R=0;R<Z.length;++R)E.FullPaths[R]=Z[R][0],E.FileIndex[R]=Z[R][1];for(R=0;R<Z.length;++R){var de=E.FileIndex[R],xe=E.FullPaths[R];if(de.name=a(xe).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||ge,R===0)de.C=Z.length>1?1:-1,de.size=0,de.type=5;else if(xe.slice(-1)=="/"){for(ee=R+1;ee<Z.length&&n(E.FullPaths[ee])!=xe;++ee);for(de.C=ee>=Z.length?-1:ee,ee=R+1;ee<Z.length&&n(E.FullPaths[ee])!=n(xe);++ee);de.R=ee>=Z.length?-1:ee,de.type=1}else n(E.FullPaths[R+1]||"")==n(xe)&&(de.R=R+1),de.type=2}}}function z(E,N){var b=N||{};if(b.fileType=="mad")return z_(E,b);switch(I(E),b.fileType){case"zip":return L_(E,b)}var C=function(be){for(var ve=0,Te=0,Me=0;Me<be.FileIndex.length;++Me){var ct=be.FileIndex[Me];if(ct.content){var ut=ct.content.length;ut>0&&(ut<4096?ve+=ut+63>>6:Te+=ut+511>>9)}}for(var Xt=be.FullPaths.length+3>>2,Oi=ve+7>>3,Ri=ve+127>>7,Pi=Oi+Te+Xt+Ri,Va=Pi+127>>7,Ku=Va<=109?0:Math.ceil((Va-109)/127);Pi+Va+Ku+127>>7>Va;)Ku=++Va<=109?0:Math.ceil((Va-109)/127);var Fn=[1,Ku,Va,Ri,Xt,Te,ve,0];return be.FileIndex[0].size=ve<<6,Fn[7]=(be.FileIndex[0].start=Fn[0]+Fn[1]+Fn[2]+Fn[3]+Fn[4]+Fn[5])+(Fn[6]+7>>3),Fn}(E),R=Ot(C[7]<<9),P=0,K=0;{for(P=0;P<8;++P)R.write_shift(1,se[P]);for(P=0;P<8;++P)R.write_shift(2,0);for(R.write_shift(2,62),R.write_shift(2,3),R.write_shift(2,65534),R.write_shift(2,9),R.write_shift(2,6),P=0;P<3;++P)R.write_shift(2,0);for(R.write_shift(4,0),R.write_shift(4,C[2]),R.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),R.write_shift(4,0),R.write_shift(4,4096),R.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:q),R.write_shift(4,C[3]),R.write_shift(-4,C[1]?C[0]-1:q),R.write_shift(4,C[1]),P=0;P<109;++P)R.write_shift(-4,P<C[2]?C[1]+P:-1)}if(C[1])for(K=0;K<C[1];++K){for(;P<236+K*127;++P)R.write_shift(-4,P<C[2]?C[1]+P:-1);R.write_shift(-4,K===C[1]-1?q:K+1)}var ee=function(be){for(K+=be;P<K-1;++P)R.write_shift(-4,P+1);be&&(++P,R.write_shift(-4,q))};for(K=P=0,K+=C[1];P<K;++P)R.write_shift(-4,le.DIFSECT);for(K+=C[2];P<K;++P)R.write_shift(-4,le.FATSECT);ee(C[3]),ee(C[4]);for(var G=0,Z=0,X=E.FileIndex[0];G<E.FileIndex.length;++G)X=E.FileIndex[G],X.content&&(Z=X.content.length,!(Z<4096)&&(X.start=K,ee(Z+511>>9)));for(ee(C[6]+7>>3);R.l&511;)R.write_shift(-4,le.ENDOFCHAIN);for(K=P=0,G=0;G<E.FileIndex.length;++G)X=E.FileIndex[G],X.content&&(Z=X.content.length,!(!Z||Z>=4096)&&(X.start=K,ee(Z+63>>6)));for(;R.l&511;)R.write_shift(-4,le.ENDOFCHAIN);for(P=0;P<C[4]<<2;++P){var de=E.FullPaths[P];if(!de||de.length===0){for(G=0;G<17;++G)R.write_shift(4,0);for(G=0;G<3;++G)R.write_shift(4,-1);for(G=0;G<12;++G)R.write_shift(4,0);continue}X=E.FileIndex[P],P===0&&(X.start=X.size?X.start-1:q);var xe=P===0&&b.root||X.name;if(Z=2*(xe.length+1),R.write_shift(64,xe,"utf16le"),R.write_shift(2,Z),R.write_shift(1,X.type),R.write_shift(1,X.color),R.write_shift(-4,X.L),R.write_shift(-4,X.R),R.write_shift(-4,X.C),X.clsid)R.write_shift(16,X.clsid,"hex");else for(G=0;G<4;++G)R.write_shift(4,0);R.write_shift(4,X.state||0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,X.start),R.write_shift(4,X.size),R.write_shift(4,0)}for(P=1;P<E.FileIndex.length;++P)if(X=E.FileIndex[P],X.size>=4096)if(R.l=X.start+1<<9,We&&Buffer.isBuffer(X.content))X.content.copy(R,R.l,0,X.size),R.l+=X.size+511&-512;else{for(G=0;G<X.size;++G)R.write_shift(1,X.content[G]);for(;G&511;++G)R.write_shift(1,0)}for(P=1;P<E.FileIndex.length;++P)if(X=E.FileIndex[P],X.size>0&&X.size<4096)if(We&&Buffer.isBuffer(X.content))X.content.copy(R,R.l,0,X.size),R.l+=X.size+63&-64;else{for(G=0;G<X.size;++G)R.write_shift(1,X.content[G]);for(;G&63;++G)R.write_shift(1,0)}if(We)R.l=R.length;else for(;R.l<R.length;)R.write_shift(1,0);return R}function V(E,N){var b=E.FullPaths.map(function(G){return G.toUpperCase()}),C=b.map(function(G){var Z=G.split("/");return Z[Z.length-(G.slice(-1)=="/"?2:1)]}),R=!1;N.charCodeAt(0)===47?(R=!0,N=b[0].slice(0,-1)+N):R=N.indexOf("/")!==-1;var P=N.toUpperCase(),K=R===!0?b.indexOf(P):C.indexOf(P);if(K!==-1)return E.FileIndex[K];var ee=!P.match(Ji);for(P=P.replace(mr,""),ee&&(P=P.replace(Ji,"!")),K=0;K<b.length;++K)if((ee?b[K].replace(Ji,"!"):b[K]).replace(mr,"")==P||(ee?C[K].replace(Ji,"!"):C[K]).replace(mr,"")==P)return E.FileIndex[K];return null}var F=64,q=-2,ae="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],ge="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(E,N,b){c();var C=z(E,b);l.writeFileSync(N,C)}function j(E){for(var N=new Array(E.length),b=0;b<E.length;++b)N[b]=String.fromCharCode(E[b]);return N.join("")}function fe(E,N){var b=z(E,N);switch(N&&N.type||"buffer"){case"file":return c(),l.writeFileSync(N.filename,b),b;case"binary":return typeof b=="string"?b:j(b);case"base64":return _m(typeof b=="string"?b:j(b));case"buffer":if(We)return Buffer.isBuffer(b)?b:ws(b);case"array":return typeof b=="string"?un(b):b}return b}var ye;function O(E){try{var N=E.InflateRaw,b=new N;if(b._processChunk(new Uint8Array([3,0]),b._finishFlushFlag),b.bytesRead)ye=E;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function W(E,N){if(!ye)return Ni(E,N);var b=ye.InflateRaw,C=new b,R=C._processChunk(E.slice(E.l),C._finishFlushFlag);return E.l+=C.bytesRead,R}function U(E){return ye?ye.deflateRawSync(E):re(E)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(E){var N=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(N>>16|N>>8|N)&255}for(var ce=typeof Uint8Array<"u",ne=ce?new Uint8Array(256):[],Y=0;Y<256;++Y)ne[Y]=ke(Y);function A(E,N){var b=ne[E&255];return N<=8?b>>>8-N:(b=b<<8|ne[E>>8&255],N<=16?b>>>16-N:(b=b<<8|ne[E>>16&255],b>>>24-N))}function Pe(E,N){var b=N&7,C=N>>>3;return(E[C]|(b<=6?0:E[C+1]<<8))>>>b&3}function Re(E,N){var b=N&7,C=N>>>3;return(E[C]|(b<=5?0:E[C+1]<<8))>>>b&7}function Ne(E,N){var b=N&7,C=N>>>3;return(E[C]|(b<=4?0:E[C+1]<<8))>>>b&15}function De(E,N){var b=N&7,C=N>>>3;return(E[C]|(b<=3?0:E[C+1]<<8))>>>b&31}function we(E,N){var b=N&7,C=N>>>3;return(E[C]|(b<=1?0:E[C+1]<<8))>>>b&127}function rt(E,N,b){var C=N&7,R=N>>>3,P=(1<<b)-1,K=E[R]>>>C;return b<8-C||(K|=E[R+1]<<8-C,b<16-C)||(K|=E[R+2]<<16-C,b<24-C)||(K|=E[R+3]<<24-C),K&P}function kt(E,N,b){var C=N&7,R=N>>>3;return C<=5?E[R]|=(b&7)<<C:(E[R]|=b<<C&255,E[R+1]=(b&7)>>8-C),N+3}function L(E,N,b){var C=N&7,R=N>>>3;return b=(b&1)<<C,E[R]|=b,N+1}function H(E,N,b){var C=N&7,R=N>>>3;return b<<=C,E[R]|=b&255,b>>>=8,E[R+1]=b,N+8}function J(E,N,b){var C=N&7,R=N>>>3;return b<<=C,E[R]|=b&255,b>>>=8,E[R+1]=b&255,E[R+2]=b>>>8,N+16}function _e(E,N){var b=E.length,C=2*b>N?2*b:N+5,R=0;if(b>=N)return E;if(We){var P=km(C);if(E.copy)E.copy(P);else for(;R<E.length;++R)P[R]=E[R];return P}else if(ce){var K=new Uint8Array(C);if(K.set)K.set(E);else for(;R<b;++R)K[R]=E[R];return K}return E.length=C,E}function me(E){for(var N=new Array(E),b=0;b<E;++b)N[b]=0;return N}function ue(E,N,b){var C=1,R=0,P=0,K=0,ee=0,G=E.length,Z=ce?new Uint16Array(32):me(32);for(P=0;P<32;++P)Z[P]=0;for(P=G;P<b;++P)E[P]=0;G=E.length;var X=ce?new Uint16Array(G):me(G);for(P=0;P<G;++P)Z[R=E[P]]++,C<R&&(C=R),X[P]=0;for(Z[0]=0,P=1;P<=C;++P)Z[P+16]=ee=ee+Z[P-1]<<1;for(P=0;P<G;++P)ee=E[P],ee!=0&&(X[P]=Z[ee+16]++);var de=0;for(P=0;P<G;++P)if(de=E[P],de!=0)for(ee=A(X[P],C)>>C-de,K=(1<<C+4-de)-1;K>=0;--K)N[ee|K<<de]=de&15|P<<4;return C}var Se=ce?new Uint16Array(512):me(512),Be=ce?new Uint16Array(32):me(32);if(!ce){for(var Fe=0;Fe<512;++Fe)Se[Fe]=0;for(Fe=0;Fe<32;++Fe)Be[Fe]=0}(function(){for(var E=[],N=0;N<32;N++)E.push(5);ue(E,Be,32);var b=[];for(N=0;N<=143;N++)b.push(8);for(;N<=255;N++)b.push(9);for(;N<=279;N++)b.push(7);for(;N<=287;N++)b.push(8);ue(b,Se,288)})();var te=function(){for(var N=ce?new Uint8Array(32768):[],b=0,C=0;b<pe.length-1;++b)for(;C<pe[b+1];++C)N[C]=b;for(;C<32768;++C)N[C]=29;var R=ce?new Uint8Array(259):[];for(b=0,C=0;b<Q.length-1;++b)for(;C<Q[b+1];++C)R[C]=b;function P(ee,G){for(var Z=0;Z<ee.length;){var X=Math.min(65535,ee.length-Z),de=Z+X==ee.length;for(G.write_shift(1,+de),G.write_shift(2,X),G.write_shift(2,~X&65535);X-- >0;)G[G.l++]=ee[Z++]}return G.l}function K(ee,G){for(var Z=0,X=0,de=ce?new Uint16Array(32768):[];X<ee.length;){var xe=Math.min(65535,ee.length-X);if(xe<10){for(Z=kt(G,Z,+(X+xe==ee.length)),Z&7&&(Z+=8-(Z&7)),G.l=Z/8|0,G.write_shift(2,xe),G.write_shift(2,~xe&65535);xe-- >0;)G[G.l++]=ee[X++];Z=G.l*8;continue}Z=kt(G,Z,+(X+xe==ee.length)+2);for(var be=0;xe-- >0;){var ve=ee[X];be=(be<<5^ve)&32767;var Te=-1,Me=0;if((Te=de[be])&&(Te|=X&-32768,Te>X&&(Te-=32768),Te<X))for(;ee[Te+Me]==ee[X+Me]&&Me<250;)++Me;if(Me>2){ve=R[Me],ve<=22?Z=H(G,Z,ne[ve+1]>>1)-1:(H(G,Z,3),Z+=5,H(G,Z,ne[ve-23]>>5),Z+=3);var ct=ve<8?0:ve-4>>2;ct>0&&(J(G,Z,Me-Q[ve]),Z+=ct),ve=N[X-Te],Z=H(G,Z,ne[ve]>>3),Z-=3;var ut=ve<4?0:ve-2>>1;ut>0&&(J(G,Z,X-Te-pe[ve]),Z+=ut);for(var Xt=0;Xt<Me;++Xt)de[be]=X&32767,be=(be<<5^ee[X])&32767,++X;xe-=Me-1}else ve<=143?ve=ve+48:Z=L(G,Z,1),Z=H(G,Z,ne[ve]),de[be]=X&32767,++X}Z=H(G,Z,0)-1}return G.l=(Z+7)/8|0,G.l}return function(G,Z){return G.length<8?P(G,Z):K(G,Z)}}();function re(E){var N=Ot(50+Math.floor(E.length*1.1)),b=te(E,N);return N.slice(0,b)}var Ee=ce?new Uint16Array(32768):me(32768),Oe=ce?new Uint16Array(32768):me(32768),Xe=ce?new Uint16Array(128):me(128),Zt=1,or=1;function wr(E,N){var b=De(E,N)+257;N+=5;var C=De(E,N)+1;N+=5;var R=Ne(E,N)+4;N+=4;for(var P=0,K=ce?new Uint8Array(19):me(19),ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],G=1,Z=ce?new Uint8Array(8):me(8),X=ce?new Uint8Array(8):me(8),de=K.length,xe=0;xe<R;++xe)K[M[xe]]=P=Re(E,N),G<P&&(G=P),Z[P]++,N+=3;var be=0;for(Z[0]=0,xe=1;xe<=G;++xe)X[xe]=be=be+Z[xe-1]<<1;for(xe=0;xe<de;++xe)(be=K[xe])!=0&&(ee[xe]=X[be]++);var ve=0;for(xe=0;xe<de;++xe)if(ve=K[xe],ve!=0){be=ne[ee[xe]]>>8-ve;for(var Te=(1<<7-ve)-1;Te>=0;--Te)Xe[be|Te<<ve]=ve&7|xe<<3}var Me=[];for(G=1;Me.length<b+C;)switch(be=Xe[we(E,N)],N+=be&7,be>>>=3){case 16:for(P=3+Pe(E,N),N+=2,be=Me[Me.length-1];P-- >0;)Me.push(be);break;case 17:for(P=3+Re(E,N),N+=3;P-- >0;)Me.push(0);break;case 18:for(P=11+we(E,N),N+=7;P-- >0;)Me.push(0);break;default:Me.push(be),G<be&&(G=be);break}var ct=Me.slice(0,b),ut=Me.slice(b);for(xe=b;xe<286;++xe)ct[xe]=0;for(xe=C;xe<30;++xe)ut[xe]=0;return Zt=ue(ct,Ee,286),or=ue(ut,Oe,30),N}function Jr(E,N){if(E[0]==3&&!(E[1]&3))return[Ia(N),2];for(var b=0,C=0,R=km(N||1<<18),P=0,K=R.length>>>0,ee=0,G=0;!(C&1);){if(C=Re(E,b),b+=3,C>>>1)C>>1==1?(ee=9,G=5):(b=wr(E,b),ee=Zt,G=or);else{b&7&&(b+=8-(b&7));var Z=E[b>>>3]|E[(b>>>3)+1]<<8;if(b+=32,Z>0)for(!N&&K<P+Z&&(R=_e(R,P+Z),K=R.length);Z-- >0;)R[P++]=E[b>>>3],b+=8;continue}for(;;){!N&&K<P+32767&&(R=_e(R,P+32767),K=R.length);var X=rt(E,b,ee),de=C>>>1==1?Se[X]:Ee[X];if(b+=de&15,de>>>=4,!(de>>>8&255))R[P++]=de;else{if(de==256)break;de-=257;var xe=de<8?0:de-4>>2;xe>5&&(xe=0);var be=P+Q[de];xe>0&&(be+=rt(E,b,xe),b+=xe),X=rt(E,b,G),de=C>>>1==1?Be[X]:Oe[X],b+=de&15,de>>>=4;var ve=de<4?0:de-2>>1,Te=pe[de];for(ve>0&&(Te+=rt(E,b,ve),b+=ve),!N&&K<be&&(R=_e(R,be+100),K=R.length);P<be;)R[P]=R[P-Te],++P}}}return N?[R,b+7>>>3]:[R.slice(0,P),b+7>>>3]}function Ni(E,N){var b=E.slice(E.l||0),C=Jr(b,N);return E.l+=C[1],C[0]}function ap(E,N){if(E)typeof console<"u"&&console.error(N);else throw new Error(N)}function sp(E,N){var b=E;Vt(b,0);var C=[],R=[],P={FileIndex:C,FullPaths:R};x(P,{root:N.root});for(var K=b.length-4;(b[K]!=80||b[K+1]!=75||b[K+2]!=5||b[K+3]!=6)&&K>=0;)--K;b.l=K+4,b.l+=4;var ee=b.read_shift(2);b.l+=6;var G=b.read_shift(4);for(b.l=G,K=0;K<ee;++K){b.l+=20;var Z=b.read_shift(4),X=b.read_shift(4),de=b.read_shift(2),xe=b.read_shift(2),be=b.read_shift(2);b.l+=8;var ve=b.read_shift(4),Te=o(b.slice(b.l+de,b.l+de+xe));b.l+=de+xe+be;var Me=b.l;b.l=ve+4,D_(b,Z,X,P,Te),b.l=Me}return P}function D_(E,N,b,C,R){E.l+=2;var P=E.read_shift(2),K=E.read_shift(2),ee=i(E);if(P&8257)throw new Error("Unsupported ZIP encryption");for(var G=E.read_shift(4),Z=E.read_shift(4),X=E.read_shift(4),de=E.read_shift(2),xe=E.read_shift(2),be="",ve=0;ve<de;++ve)be+=String.fromCharCode(E[E.l++]);if(xe){var Te=o(E.slice(E.l,E.l+xe));(Te[21589]||{}).mt&&(ee=Te[21589].mt),((R||{})[21589]||{}).mt&&(ee=R[21589].mt)}E.l+=xe;var Me=E.slice(E.l,E.l+Z);switch(K){case 8:Me=W(E,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var ct=!1;P&8&&(G=E.read_shift(4),G==134695760&&(G=E.read_shift(4),ct=!0),Z=E.read_shift(4),X=E.read_shift(4)),Z!=N&&ap(ct,"Bad compressed size: "+N+" != "+Z),X!=b&&ap(ct,"Bad uncompressed size: "+b+" != "+X),Gu(C,be,Me,{unsafe:!0,mt:ee})}function L_(E,N){var b=N||{},C=[],R=[],P=Ot(1),K=b.compression?8:0,ee=0,G=0,Z=0,X=0,de=0,xe=E.FullPaths[0],be=xe,ve=E.FileIndex[0],Te=[],Me=0;for(G=1;G<E.FullPaths.length;++G)if(be=E.FullPaths[G].slice(xe.length),ve=E.FileIndex[G],!(!ve.size||!ve.content||be=="Sh33tJ5")){var ct=X,ut=Ot(be.length);for(Z=0;Z<be.length;++Z)ut.write_shift(1,be.charCodeAt(Z)&127);ut=ut.slice(0,ut.l),Te[de]=uA.buf(ve.content,0);var Xt=ve.content;K==8&&(Xt=U(Xt)),P=Ot(30),P.write_shift(4,67324752),P.write_shift(2,20),P.write_shift(2,ee),P.write_shift(2,K),ve.mt?s(P,ve.mt):P.write_shift(4,0),P.write_shift(-4,Te[de]),P.write_shift(4,Xt.length),P.write_shift(4,ve.content.length),P.write_shift(2,ut.length),P.write_shift(2,0),X+=P.length,C.push(P),X+=ut.length,C.push(ut),X+=Xt.length,C.push(Xt),P=Ot(46),P.write_shift(4,33639248),P.write_shift(2,0),P.write_shift(2,20),P.write_shift(2,ee),P.write_shift(2,K),P.write_shift(4,0),P.write_shift(-4,Te[de]),P.write_shift(4,Xt.length),P.write_shift(4,ve.content.length),P.write_shift(2,ut.length),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(4,0),P.write_shift(4,ct),Me+=P.l,R.push(P),Me+=ut.length,R.push(ut),++de}return P=Ot(22),P.write_shift(4,101010256),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,de),P.write_shift(2,de),P.write_shift(4,Me),P.write_shift(4,X),P.write_shift(2,0),va([va(C),va(R),P])}var _l={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function F_(E,N){if(E.ctype)return E.ctype;var b=E.name||"",C=b.match(/\.([^\.]+)$/);return C&&_l[C[1]]||N&&(C=(b=N).match(/[\.\\]([^\.\\])+$/),C&&_l[C[1]])?_l[C[1]]:"application/octet-stream"}function j_(E){for(var N=_m(E),b=[],C=0;C<N.length;C+=76)b.push(N.slice(C,C+76));return b.join(`\r
`)+`\r
`}function M_(E){var N=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var X=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var b=[],C=N.split(`\r
`),R=0;R<C.length;++R){var P=C[R];if(P.length==0){b.push("");continue}for(var K=0;K<P.length;){var ee=76,G=P.slice(K,K+ee);G.charAt(ee-1)=="="?ee--:G.charAt(ee-2)=="="?ee-=2:G.charAt(ee-3)=="="&&(ee-=3),G=P.slice(K,K+ee),K+=ee,K<P.length&&(G+="="),b.push(G)}}return b.join(`\r
`)}function $_(E){for(var N=[],b=0;b<E.length;++b){for(var C=E[b];b<=E.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+E[++b];N.push(C)}for(var R=0;R<N.length;++R)N[R]=N[R].replace(/[=][0-9A-Fa-f]{2}/g,function(P){return String.fromCharCode(parseInt(P.slice(1),16))});return un(N.join(`\r
`))}function U_(E,N,b){for(var C="",R="",P="",K,ee=0;ee<10;++ee){var G=N[ee];if(!G||G.match(/^\s*$/))break;var Z=G.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":C=Z[2].trim();break;case"content-type":P=Z[2].trim();break;case"content-transfer-encoding":R=Z[2].trim();break}}switch(++ee,R.toLowerCase()){case"base64":K=un(Lr(N.slice(ee).join("")));break;case"quoted-printable":K=$_(N.slice(ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+R)}var X=Gu(E,C.slice(b.length),K,{unsafe:!0});P&&(X.ctype=P)}function B_(E,N){if(j(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var b=N&&N.root||"",C=(We&&Buffer.isBuffer(E)?E.toString("binary"):j(E)).split(`\r
`),R=0,P="";for(R=0;R<C.length;++R)if(P=C[R],!!/^Content-Location:/i.test(P)&&(P=P.slice(P.indexOf("file")),b||(b=P.slice(0,P.lastIndexOf("/")+1)),P.slice(0,b.length)!=b))for(;b.length>0&&(b=b.slice(0,b.length-1),b=b.slice(0,b.lastIndexOf("/")+1),P.slice(0,b.length)!=b););var K=(C[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var ee="--"+(K[1]||""),G=[],Z=[],X={FileIndex:G,FullPaths:Z};x(X);var de,xe=0;for(R=0;R<C.length;++R){var be=C[R];be!==ee&&be!==ee+"--"||(xe++&&U_(X,C.slice(de,R),b),de=R)}return X}function z_(E,N){var b=N||{},C=b.boundary||"SheetJS";C="------="+C;for(var R=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],P=E.FullPaths[0],K=P,ee=E.FileIndex[0],G=1;G<E.FullPaths.length;++G)if(K=E.FullPaths[G].slice(P.length),ee=E.FileIndex[G],!(!ee.size||!ee.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var Z=ee.content,X=We&&Buffer.isBuffer(Z)?Z.toString("binary"):j(Z),de=0,xe=Math.min(1024,X.length),be=0,ve=0;ve<=xe;++ve)(be=X.charCodeAt(ve))>=32&&be<128&&++de;var Te=de>=xe*4/5;R.push(C),R.push("Content-Location: "+(b.root||"file:///C:/SheetJS/")+K),R.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),R.push("Content-Type: "+F_(ee,K)),R.push(""),R.push(Te?M_(X):j_(X))}return R.push(C+`--\r
`),R.join(`\r
`)}function V_(E){var N={};return x(N,E),N}function Gu(E,N,b,C){var R=C&&C.unsafe;R||x(E);var P=!R&&He.find(E,N);if(!P){var K=E.FullPaths[0];N.slice(0,K.length)==K?K=N:(K.slice(-1)!="/"&&(K+="/"),K=(K+N).replace("//","/")),P={name:a(N),type:2},E.FileIndex.push(P),E.FullPaths.push(K),R||He.utils.cfb_gc(E)}return P.content=b,P.size=b?b.length:0,C&&(C.CLSID&&(P.clsid=C.CLSID),C.mt&&(P.mt=C.mt),C.ct&&(P.ct=C.ct)),P}function W_(E,N){x(E);var b=He.find(E,N);if(b){for(var C=0;C<E.FileIndex.length;++C)if(E.FileIndex[C]==b)return E.FileIndex.splice(C,1),E.FullPaths.splice(C,1),!0}return!1}function H_(E,N,b){x(E);var C=He.find(E,N);if(C){for(var R=0;R<E.FileIndex.length;++R)if(E.FileIndex[R]==C)return E.FileIndex[R].name=a(b),E.FullPaths[R]=b,!0}return!1}function G_(E){I(E,!0)}return t.find=V,t.read=S,t.parse=u,t.write=fe,t.writeFile=oe,t.utils={cfb_new:V_,cfb_add:Gu,cfb_del:W_,cfb_mov:H_,cfb_gc:G_,ReadShift:vo,CheckField:Rw,prep_blob:Vt,bconcat:va,use_zlib:O,_deflateRaw:re,_inflateRaw:Ni,consts:le},t}();function fA(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Rn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function F0(e){for(var t=[],r=Rn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var eu=new Date(1899,11,30,0,0,0);function gr(e,t){var r=e.getTime(),n=eu.getTime()+(e.getTimezoneOffset()-eu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var uw=new Date,dA=eu.getTime()+(uw.getTimezoneOffset()-eu.getTimezoneOffset())*6e4,Nm=uw.getTimezoneOffset();function zu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+dA),t.getTimezoneOffset()!==Nm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Nm)*6e4),t}function hA(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Om=new Date("2017-02-19T19:06:09.000Z"),fw=isNaN(Om.getFullYear())?new Date("2/19/17"):Om,pA=fw.getFullYear()==2017;function Ut(e,t){var r=new Date(e);if(pA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(fw.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ps(e,t){if(We&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return eo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return eo(q2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return eo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return eo(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Ht(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ht(e[r]));return t}function gt(e,t){for(var r="";r.length<t;)r+=e;return r}function mn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var mA=["january","february","march","april","may","june","july","august","september","october","november","december"];function mi(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&mA.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var gA=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function dw(e){return e?e.content&&e.type?ps(e.content,!0):e.data?qi(e.data):e.asNodeBuffer&&We?qi(e.asNodeBuffer().toString("binary")):e.asBinary?qi(e.asBinary()):e._data&&e._data.getContent?qi(ps(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function hw(e){if(!e)return null;if(e.data)return ym(e.data);if(e.asNodeBuffer&&We)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?ym(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function vA(e){return e&&e.name.slice(-4)===".bin"?hw(e):dw(e)}function Ur(e,t){for(var r=e.FullPaths||Rn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function j0(e,t){var r=Ur(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Tt(e,t,r){if(!r)return vA(j0(e,t));if(!t)return null;try{return Tt(e,t)}catch{return null}}function Rr(e,t,r){if(!r)return dw(j0(e,t));if(!t)return null;try{return Rr(e,t)}catch{return null}}function yA(e,t,r){return hw(j0(e,t))}function Rm(e){for(var t=e.FullPaths||Rn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function wA(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return We?n=ws(r):n=MC(r),He.utils.cfb_add(e,t,n)}He.utils.cfb_add(e,t,r)}else e.file(t,r)}function pw(e,t){switch(t.type){case"base64":return He.read(e,{type:"base64"});case"binary":return He.read(e,{type:"binary"});case"buffer":case"array":return He.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Qi(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var mw=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_A=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Pm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,kA=/<[^>]*>/g,ir=mw.match(Pm)?Pm:kA,xA=/<\w*:/,EA=/<(\/?)\w+:/;function Ie(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(_A),o=0,l="",c=0,u="",f="",d=1;if(i)for(c=0;c!=i.length;++c){for(f=i[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(d=(a=f.charCodeAt(s+1))==34||a==39?1:0,l=f.slice(s+1+d,f.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var h=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[h]&&u.slice(o-3,o)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function Dn(e){return e.replace(EA,"<$1")}var gw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},TA=F0(gw),Ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return gw[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),SA=/[&<>'"]/g,bA=/[\u0000-\u001f]/g;function M0(e){var t=e+"";return t.replace(SA,function(r){return TA[r]}).replace(/\n/g,"<br/>").replace(bA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Im=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function st(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function If(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Dm(e){var t=Ia(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Lm(e){return ws(e,"binary").toString("utf8")}var Zl="foo bar bazâð£",tt=We&&(Lm(Zl)==If(Zl)&&Lm||Dm(Zl)==If(Zl)&&Dm)||If,eo=We?function(e){return ws(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Xo=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),vw=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),CA=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),AA=/<\/?(?:vt:)?variant>/g,NA=/<(?:vt:)([^>]*)>([\s\S]*)</;function Fm(e,t){var r=Ie(e),n=e.match(CA(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(AA,"").match(NA);i&&a.push({v:tt(i[2]),t:i[1]})}),a}var OA=/(^\s|\s$|\n)/;function RA(e){return Rn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function PA(e,t,r){return"<"+e+(r!=null?RA(r):"")+(t!=null?(t.match(OA)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function $0(e){if(We&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return tt(_s(I0(e)));throw new Error("Bad input format: expected Buffer or string")}var Yo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,IA={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},DA=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function LA(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function FA(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var jm=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Mm=We?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ws(t)})):jm(e)}:jm,$m=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Gn(e,a)));return n.join("").replace(mr,"")},U0=We?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(mr,""):$m(e,t,r)}:$m,Um=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},yw=We?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Um(e,t,r)}:Um,Bm=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ls(e,a)));return n.join("")},pl=We?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Bm(t,r,n)}:Bm,ww=function(e,t){var r=Or(e,t);return r>0?pl(e,t+4,t+4+r-1):""},_w=ww,kw=function(e,t){var r=Or(e,t);return r>0?pl(e,t+4,t+4+r-1):""},xw=kw,Ew=function(e,t){var r=2*Or(e,t);return r>0?pl(e,t+4,t+4+r-1):""},Tw=Ew,Sw=function(t,r){var n=Or(t,r);return n>0?U0(t,r+4,r+4+n):""},bw=Sw,Cw=function(e,t){var r=Or(e,t);return r>0?pl(e,t+4,t+4+r):""},Aw=Cw,Nw=function(e,t){return LA(e,t)},tu=Nw,Ow=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};We&&(_w=function(t,r){if(!Buffer.isBuffer(t))return ww(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},xw=function(t,r){if(!Buffer.isBuffer(t))return kw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Tw=function(t,r){if(!Buffer.isBuffer(t))return Ew(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},bw=function(t,r){if(!Buffer.isBuffer(t))return Sw(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Aw=function(t,r){if(!Buffer.isBuffer(t))return Cw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},tu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Nw(t,r)},Ow=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ls=function(e,t){return e[t]},Gn=function(e,t){return e[t+1]*256+e[t]},jA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Or=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ya=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},MA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function vo(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,We&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Gn(this,c)),c+=2;e*=2;break;case"utf8":r=pl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=U0(this,this.l,this.l+e);break;case"wstr":return vo.call(this,e,"dbcs");case"lpstr-ansi":r=_w(this,this.l),e=4+Or(this,this.l);break;case"lpstr-cp":r=xw(this,this.l),e=4+Or(this,this.l);break;case"lpwstr":r=Tw(this,this.l),e=4+2*Or(this,this.l);break;case"lpp4":e=4+Or(this,this.l),r=bw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Or(this,this.l),r=Aw(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Ls(this,this.l+e++))!==0;)s.push(Kl(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Gn(this,this.l+e))!==0;)s.push(Kl(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Ls(this,c),this.l=c+1,o=vo.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Kl(Gn(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Ls(this,c),this.l=c+1,o=vo.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Kl(Ls(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Ls(this,this.l),this.l++,n;case 2:return n=(t==="i"?jA:Gn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ya:MA)(this,this.l),this.l+=4,n):(a=Or(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=tu(this,this.l):a=tu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=yw(this,this.l,e);break}}return this.l+=e,r}var $A=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},UA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},BA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function zA(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)BA(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,$A(this,t,this.l);break;case 8:if(n=8,r==="f"){FA(this,t,this.l);break}case 16:break;case-4:n=4,UA(this,t,this.l);break}return this.l+=n,this}function Rw(e,t){var r=yw(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Vt(e,t){e.l=t,e.read_shift=vo,e.chk=Rw,e.write_shift=zA}function sr(e,t){e.l+=t}function Ot(e){var t=Ia(e);return Vt(t,0),t}function sa(e,t,r){if(e){var n,a,s;Vt(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=ou[o]||ou[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function eh(){var e=[],t=We?256:2048,r=function(c){var u=Ot(c);return Vt(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),va(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function yo(e,t,r){var n=Ht(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function zm(e,t,r){var n=Ht(e);return n.s=yo(n.s,t.s,r),n.e=yo(n.e,t.s,r),n}function wo(e,t){if(e.cRel&&e.c<0)for(e=Ht(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ht(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=je(e);return!e.cRel&&e.cRel!=null&&(r=HA(r)),!e.rRel&&e.rRel!=null&&(r=VA(r)),r}function Df(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+It(e.s.c)+":"+(e.e.cRel?"":"$")+It(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Gt(e.s.r)+":"+(e.e.rRel?"":"$")+Gt(e.e.r):wo(e.s,t.biff)+":"+wo(e.e,t.biff)}function B0(e){return parseInt(WA(e),10)-1}function Gt(e){return""+(e+1)}function VA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function WA(e){return e.replace(/\$(\d+)$/,"$1")}function z0(e){for(var t=GA(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function It(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function HA(e){return e.replace(/^([A-Z])/,"$$$1")}function GA(e){return e.replace(/^\$([A-Z])/,"$1")}function KA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function hr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function je(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ci(e){var t=e.indexOf(":");return t==-1?{s:hr(e),e:hr(e)}:{s:hr(e.slice(0,t)),e:hr(e.slice(t+1))}}function Ge(e,t){return typeof t>"u"||typeof t=="number"?Ge(e.s,e.e):(typeof e!="string"&&(e=je(e)),typeof t!="string"&&(t=je(t)),e==t?e:e+":"+t)}function vt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Vm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Xr(e.z,r?gr(t):t)}catch{}try{return e.w=Xr((e.XF||{}).numFmtId||(r?14:0),r?gr(t):t)}catch{return""+t}}function na(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Es[e.v]||e.v:t==null?Vm(e,e.v):Vm(e,t))}function za(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Pw(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?hr(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=vt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[f].length;++d)if(!(typeof t[f][d]>"u")){var h={v:t[f][d]},v=i+f,g=o+d;if(c.s.r>v&&(c.s.r=v),c.s.c>g&&(c.s.c=g),c.e.r<v&&(c.e.r=v),c.e.c<g&&(c.e.c=g),t[f][d]&&typeof t[f][d]=="object"&&!Array.isArray(t[f][d])&&!(t[f][d]instanceof Date))h=t[f][d];else if(Array.isArray(h.v)&&(h.f=t[f][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Ue[14],n.cellDates?(h.t="d",h.w=Xr(h.z,gr(h.v))):(h.t="n",h.v=gr(h.v),h.w=Xr(h.z,h.v))):h.t="s";if(a)s[v]||(s[v]=[]),s[v][g]&&s[v][g].z&&(h.z=s[v][g].z),s[v][g]=h;else{var _=je({c:g,r:v});s[_]&&s[_].z&&(h.z=s[_].z),s[_]=h}}}return c.s.c<1e7&&(s["!ref"]=Ge(c)),s}function Ai(e,t){return Pw(null,e,t)}function ZA(e){return e.read_shift(4,"i")}function nr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function XA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function V0(e,t){var r=e.l,n=e.read_shift(1),a=nr(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(XA(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var YA=V0;function qr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ks(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var qA=nr;function W0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var JA=nr,th=W0;function H0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?tu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ya(t,0)>>2;return r?a/100:a}function Iw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var xs=Iw;function tr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function QA(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=ss[a];c&&(t.rgb=Jo(c));break;case 2:t.rgb=Jo([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function eN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Dw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function tN(e){return Dw(e,1)}function rN(e){return Dw(e,2)}var G0=2,kr=3,Xl=11,Wm=12,ru=19,Yl=64,nN=65,aN=71,sN=4108,iN=4126,jt=80,Lw=81,oN=[jt,Lw],lN={1:{n:"CodePage",t:G0},2:{n:"Category",t:jt},3:{n:"PresentationFormat",t:jt},4:{n:"ByteCount",t:kr},5:{n:"LineCount",t:kr},6:{n:"ParagraphCount",t:kr},7:{n:"SlideCount",t:kr},8:{n:"NoteCount",t:kr},9:{n:"HiddenCount",t:kr},10:{n:"MultimediaClipCount",t:kr},11:{n:"ScaleCrop",t:Xl},12:{n:"HeadingPairs",t:sN},13:{n:"TitlesOfParts",t:iN},14:{n:"Manager",t:jt},15:{n:"Company",t:jt},16:{n:"LinksUpToDate",t:Xl},17:{n:"CharacterCount",t:kr},19:{n:"SharedDoc",t:Xl},22:{n:"HyperlinksChanged",t:Xl},23:{n:"AppVersion",t:kr,p:"version"},24:{n:"DigSig",t:nN},26:{n:"ContentType",t:jt},27:{n:"ContentStatus",t:jt},28:{n:"Language",t:jt},29:{n:"Version",t:jt},255:{},2147483648:{n:"Locale",t:ru},2147483651:{n:"Behavior",t:ru},1919054434:{}},cN={1:{n:"CodePage",t:G0},2:{n:"Title",t:jt},3:{n:"Subject",t:jt},4:{n:"Author",t:jt},5:{n:"Keywords",t:jt},6:{n:"Comments",t:jt},7:{n:"Template",t:jt},8:{n:"LastAuthor",t:jt},9:{n:"RevNumber",t:jt},10:{n:"EditTime",t:Yl},11:{n:"LastPrinted",t:Yl},12:{n:"CreatedDate",t:Yl},13:{n:"ModifiedDate",t:Yl},14:{n:"PageCount",t:kr},15:{n:"WordCount",t:kr},16:{n:"CharCount",t:kr},17:{n:"Thumbnail",t:aN},18:{n:"Application",t:jt},19:{n:"DocSecurity",t:kr},255:{},2147483648:{n:"Locale",t:ru},2147483651:{n:"Behavior",t:ru},1919054434:{}},Hm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},uN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function fN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var dN=fN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ss=Ht(dN),Es={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Fw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Gm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function hN(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pN(e){var t=hN();if(!e||!e.match)return t;var r={};if((e.match(ir)||[]).forEach(function(n){var a=Ie(n);switch(a[0].replace(xA,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Gm[a.ContentType]]!==void 0&&t[Gm[a.ContentType]].push(a.PartName);break}}),t.xmlns!==IA.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Xs={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function _o(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ir)||[]).forEach(function(a){var s=Ie(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Qi(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}var mN="application/vnd.oasis.opendocument.spreadsheet";function gN(e,t){for(var r=$0(e),n,a;n=Yo.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ie(n[0],!1),a.path=="/"&&a.type!==mN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var ko=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vN=function(){for(var e=new Array(ko.length),t=0;t<ko.length;++t){var r=ko[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function jw(e){var t={};e=tt(e);for(var r=0;r<ko.length;++r){var n=ko[r],a=e.match(vN[r]);a!=null&&a.length>0&&(t[n[1]]=Ze(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Ut(t[n[1]]))}return t}var yN=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Mw(e,t,r,n){var a=[];if(typeof e=="string")a=Fm(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var i=typeof t=="string"?Fm(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function wN(e,t,r){var n={};return t||(t={}),e=tt(e),yN.forEach(function(a){var s=(e.match(Xo(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=Ze(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Mw(n.HeadingPairs,n.TitlesOfParts,t,r),t}var _N=/<[^>]+>[^<]*/g;function kN(e,t){var r={},n="",a=e.match(_N);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Ie(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ze(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ze(u);break;case"bool":r[n]=st(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Ut(u);break;case"cy":case"error":r[n]=Ze(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var xN={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Lf;function EN(e,t,r){Lf||(Lf=F0(xN)),t=Lf[t]||t,e[t]=r}function K0(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function $w(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Uw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Bw(e,t,r){return t===31?Uw(e):$w(e,t,r)}function nh(e,t,r){return Bw(e,t,r===!1?0:4)}function TN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Bw(e,t,0)}function SN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(mr,""),e.l-a&2&&(e.l+=2)}return r}function bN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(mr,"");return r}function CN(e){var t=e.l,r=nu(e,Lw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=nu(e,kr);return[r,n]}function AN(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(CN(e));return r}function Km(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(mr,"").replace(Ji,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function zw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function NN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function nu(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==Wm&&n!==t&&oN.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Wm?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return $w(e,n,4).replace(mr,"");case 31:return Uw(e);case 64:return K0(e);case 65:return zw(e);case 71:return NN(e);case 80:return nh(e,n,!s.raw).replace(mr,"");case 81:return TN(e,n).replace(mr,"");case 4108:return AN(e);case 4126:case 4127:return n==4127?SN(e):bN(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Zm(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),f=e.read_shift(4);s[i]=[u,f+r]}s.sort(function(y,p){return y[1]-p[1]});var d={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[s[i][0]];if(d[v.n]=nu(e,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fn(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(s[i][0]===1){if(o=d.CodePage=nu(e,G0),fn(o),l!==-1){var g=e.l;e.l=s[l][1],c=Km(e,o),e.l=g}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=Km(e,o)}else{var _=c[s[i][0]],w;switch(e[e.l]){case 65:e.l+=4,w=zw(e);break;case 30:e.l+=4,w=nh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=nh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=yt(e,4);break;case 64:e.l+=4,w=Ut(K0(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[_]=w}}return e.l=r+n,d}function Xm(e,t,r){var n=e.content;if(!n)return{};Vt(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==He.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var f=Zm(n,t),d={SystemIdentifier:c};for(var h in f)d[h]=f[h];if(d.FMTID=s,a===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=Zm(n,null)}catch{}for(h in v)d[h]=v[h];return d.FMTID=[s,i],d}function la(e,t){return e.read_shift(t),null}function ON(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function yt(e,t){return e.read_shift(t)===1}function St(e){return e.read_shift(2,"u")}function Vw(e,t){return ON(e,t,St)}function RN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ml(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function PN(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ms(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function gl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ms(e,n,r)}function Ts(e,t,r){if(r.biff>5)return gl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function IN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function DN(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(mr,"");return n&&(e.l+=24),a}function LN(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(mr,"");return r+i}function FN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return DN(e);case"0303000000000000c000000000000046":return LN(e);default:throw new Error("Unsupported Moniker "+r)}}function ql(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(mr,""):"";return r}function jN(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",u,f;a&16&&(s=ql(e,r-e.l)),a&128&&(i=ql(e,r-e.l)),(a&257)===257&&(o=ql(e,r-e.l)),(a&257)===1&&(l=FN(e,r-e.l)),a&8&&(c=ql(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=K0(e)),e.l=r;var d=i||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return u&&(h.guid=u),f&&(h.time=f),s&&(h.Tooltip=s),h}function Ww(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Hw(e,t){var r=Ww(e);return r[3]=0,r}function Ln(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function MN(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function $N(e,t,r){return t===0?"":Ts(e,t,r)}function UN(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Gw(e){var t=e.read_shift(2),r=H0(e);return[t,r]}function BN(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=ml(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Vu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Kw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var zN=Kw;function Zw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function VN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function WN(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Jt(e){e.l+=2,e.l+=e.read_shift(2)}var HN={0:Jt,4:Jt,5:Jt,6:Jt,7:WN,8:Jt,9:Jt,10:Jt,11:Jt,12:Jt,13:VN,14:Jt,15:Jt,16:Jt,17:Jt,18:Jt,19:Jt,20:Jt,21:Zw};function GN(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(HN[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Jl(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function KN(e,t){return t===0||e.read_shift(2),1200}function ZN(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ts(e,0,r);return e.read_shift(t+n-e.l),a}function XN(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function YN(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=ml(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function qN(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(PN(e));return s.Count=n,s.Unique=a,s}function JN(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function QN(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function eO(e){var t=MN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function tO(e){return e.read_shift(2),e.read_shift(4)}function Ym(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function rO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function nO(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function aO(){}function sO(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ml(e,0,r),n}function iO(e){var t=Ln(e);return t.isst=e.read_shift(4),t}function oO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ln(e);r.biff==2&&e.l++;var s=gl(e,n-e.l,r);return a.val=s,a}function lO(e,t,r){var n=e.read_shift(2),a=Ts(e,0,r);return[n,a]}var cO=Ts;function qm(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function uO(e){var t=e.read_shift(2),r=e.read_shift(2),n=Gw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function fO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Gw(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function dO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function hO(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=uN[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function pO(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=hO(e,t,n.fStyle,r),n}function mO(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Jm(e,t,r){var n=Ln(e);(r.biff==2||t==9)&&++e.l;var a=RN(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function gO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ln(e),a=tr(e);return n.val=a,n}var Qm=$N;function vO(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ms(e,s),o=[];n>e.l;)o.push(gl(e));return[s,a,i,o]}function eg(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=BN(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var yO=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function tg(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=ms(e,i,r);a&32&&(c=yO[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:QP(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:f}}function Xw(e,t,r){if(r.biff<8)return wO(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(UN(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function wO(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ml(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function _O(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=ms(e,n,r),i=ms(e,a,r);return[s,i]}function kO(e,t,r){var n=Kw(e);e.l++;var a=e.read_shift(1);return t-=8,[eI(e,t,r),a,n]}function rg(e,t,r){var n=zN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,qP(e,t,r)]}function xO(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function EO(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Ts(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function TO(e,t,r){return EO(e,t,r)}function SO(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Vu(e));return r}function bO(e,t,r){if(r&&r.biff<8)return AO(e,t,r);var n=Zw(e),a=GN(e,t-22,n[1]);return{cmo:n,ft:a}}var CO={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function AO(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((CO[n]||sr)(e,t,r)),{cmo:[a,n,s],ft:i}}function NO(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=IN(e,6,r);var o=e.read_shift(2);e.read_shift(2),St(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=ms(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function OO(e,t){var r=Vu(e);e.l+=16;var n=jN(e,t-24);return[r,n]}function RO(e,t){e.read_shift(2);var r=Vu(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(mr,""),[r,n]}function PO(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Hm[r]||r,r=e.read_shift(2),t[1]=Hm[r]||r,t}function IO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Hw(e));return r}function DO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Hw(e));return r}function LO(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Yw(e,t,r){if(!r.cellStyles)return sr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function FO(e,t){var r={};return t<32||(e.l+=16,r.header=tr(e),r.footer=tr(e),e.l+=2),r}function jO(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var MO=Ln,$O=Vw,UO=gl;function BO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function zO(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ln(e);++e.l;var a=Ts(e,t-7,r);return n.t="str",n.val=a,n}function VO(e){var t=Ln(e);++e.l;var r=tr(e);return t.t="n",t.val=r,t}function WO(e){var t=Ln(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function HO(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function GO(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function KO(e,t,r){var n=e.l+t,a=Ln(e),s=e.read_shift(2),i=ms(e,s,r);return e.l=n,a.t="str",a.val=i,a}var ZO=[2,3,48,49,131,139,140,245],ng=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=F0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Ia(1);switch(l.type){case"base64":u=un(Lr(o));break;case"binary":u=un(o);break;case"buffer":case"array":u=o;break}Vt(u,0);var f=u.read_shift(1),d=!!(f&136),h=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,_=521;f==2&&(g=u.read_shift(2)),u.l+=3,f!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(_=u.read_shift(2));var w=u.read_shift(2),y=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var p=[],k={},T=Math.min(u.length,f==2?521:_-10-(h?264:0)),S=v?32:11;u.l<T&&u[u.l]!=13;)switch(k={},k.name=ga.utils.decode(y,u.slice(u.l,u.l+S)).replace(/[\u0000\r\n].*$/g,""),u.l+=S,k.type=String.fromCharCode(u.read_shift(1)),f!=2&&!v&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),f==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&p.push(k),f!=2&&(u.l+=v?13:14),k.type){case"B":(!h||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var x=0,D=0;for(c[0]=[],D=0;D!=p.length;++D)c[0][D]=p[D].name;for(;g-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++x]=[],D=0,D=0;D!=p.length;++D){var I=u.slice(u.l,u.l+p[D].len);u.l+=p[D].len,Vt(I,0);var z=ga.utils.decode(y,I);switch(p[D].type){case"C":z.trim().length&&(c[x][D]=z.replace(/\s+$/,""));break;case"D":z.length===8?c[x][D]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):c[x][D]=z;break;case"F":c[x][D]=parseFloat(z.trim());break;case"+":case"I":c[x][D]=v?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":c[x][D]=!0;break;case"N":case"F":c[x][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[x][D]="##MEMO##"+(v?parseInt(z.trim(),10):I.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(c[x][D]=+z||0);break;case"@":c[x][D]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":c[x][D]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":c[x][D]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[x][D]=-I.read_shift(-8,"f");break;case"B":if(h&&p[D].len==8){c[x][D]=I.read_shift(8,"f");break}case"G":case"P":I.l+=p[D].len;break;case"0":if(p[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+p[D].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=p,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ai(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return za(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&fn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=eh(),f=uh(o,{header:1,raw:!0,cellDates:!0}),d=f[0],h=f.slice(1),v=o["!cols"]||[],g=0,_=0,w=0,y=1;for(g=0;g<d.length;++g){if(((v[g]||{}).DBF||{}).name){d[g]=v[g].DBF.name,++w;continue}if(d[g]!=null){if(++w,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(_=0;_<1024;++_)if(d.indexOf(d[g]+"_"+_)==-1){d[g]+="_"+_;break}}}}var p=vt(o["!ref"]),k=[],T=[],S=[];for(g=0;g<=p.e.c-p.s.c;++g){var x="",D="",I=0,z=[];for(_=0;_<h.length;++_)h[_][g]!=null&&z.push(h[_][g]);if(z.length==0||d[g]==null){k[g]="?";continue}for(_=0;_<z.length;++_){switch(typeof z[_]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=z[_]instanceof Date?"D":"C";break;default:D="C"}I=Math.max(I,String(z[_]).length),x=x&&x!=D?"C":D}I>250&&(I=250),D=((v[g]||{}).DBF||{}).type,D=="C"&&v[g].DBF.len>I&&(I=v[g].DBF.len),x=="B"&&D=="N"&&(x="N",S[g]=v[g].DBF.dec,I=v[g].DBF.len),T[g]=x=="C"||D=="N"?I:s[x]||0,y+=T[g],k[g]=x}var V=u.next(32);for(V.write_shift(4,318902576),V.write_shift(4,h.length),V.write_shift(2,296+32*w),V.write_shift(2,y),g=0;g<4;++g)V.write_shift(4,0);for(V.write_shift(4,0|(+t[X2]||3)<<8),g=0,_=0;g<d.length;++g)if(d[g]!=null){var F=u.next(32),q=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,q,"sbcs"),F.write_shift(1,k[g]=="?"?"C":k[g],"sbcs"),F.write_shift(4,_),F.write_shift(1,T[g]||s[k[g]]||0),F.write_shift(1,S[g]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),_+=T[g]||s[k[g]]||0}var ae=u.next(264);for(ae.write_shift(4,13),g=0;g<65;++g)ae.write_shift(4,0);for(g=0;g<h.length;++g){var se=u.next(y);for(se.write_shift(1,0),_=0;_<d.length;++_)if(d[_]!=null)switch(k[_]){case"L":se.write_shift(1,h[g][_]==null?63:h[g][_]?84:70);break;case"B":se.write_shift(8,h[g][_]||0,"f");break;case"N":var ge="0";for(typeof h[g][_]=="number"&&(ge=h[g][_].toFixed(S[_]||0)),w=0;w<T[_]-ge.length;++w)se.write_shift(1,32);se.write_shift(1,ge,"sbcs");break;case"D":h[g][_]?(se.write_shift(4,("0000"+h[g][_].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(h[g][_].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+h[g][_].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var le=String(h[g][_]!=null?h[g][_]:"").slice(0,T[_]);for(se.write_shift(1,le,"sbcs"),w=0;w<T[_]-le.length;++w)se.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),XO=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Rn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,h){var v=e[h];return typeof v=="number"?wm(v):v},n=function(d,h,v){var g=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?d:wm(g)};e["|"]=254;function a(d,h){switch(h.type){case"base64":return s(Lr(d),h);case"binary":return s(d,h);case"buffer":return s(We&&Buffer.isBuffer(d)?d.toString("binary"):_s(d),h);case"array":return s(ps(d),h)}throw new Error("Unrecognized type "+h.type)}function s(d,h){var v=d.split(/[\n\r]+/),g=-1,_=-1,w=0,y=0,p=[],k=[],T=null,S={},x=[],D=[],I=[],z=0,V;for(+h.codepage>=0&&fn(+h.codepage);w!==v.length;++w){z=0;var F=v[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=F.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),ae=q[0],se;if(F.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&k.push(F.slice(3).replace(/;;/g,";"));break;case"C":var ge=!1,le=!1,oe=!1,j=!1,fe=-1,ye=-1;for(y=1;y<q.length;++y)switch(q[y].charAt(0)){case"A":break;case"X":_=parseInt(q[y].slice(1))-1,le=!0;break;case"Y":for(g=parseInt(q[y].slice(1))-1,le||(_=0),V=p.length;V<=g;++V)p[V]=[];break;case"K":se=q[y].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(mn(se))?isNaN(mi(se).getDate())||(se=Ut(se)):(se=mn(se),T!==null&&bi(T)&&(se=zu(se))),ge=!0;break;case"E":j=!0;var O=ai(q[y].slice(1),{r:g,c:_});p[g][_]=[p[g][_],O];break;case"S":oe=!0,p[g][_]=[p[g][_],"S5S"];break;case"G":break;case"R":fe=parseInt(q[y].slice(1))-1;break;case"C":ye=parseInt(q[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+F)}if(ge&&(p[g][_]&&p[g][_].length==2?p[g][_][0]=se:p[g][_]=se,T=null),oe){if(j)throw new Error("SYLK shared formula cannot have own formula");var W=fe>-1&&p[fe][ye];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");p[g][_][1]=i_(W[1],{r:g-fe,c:_-ye})}break;case"F":var U=0;for(y=1;y<q.length;++y)switch(q[y].charAt(0)){case"X":_=parseInt(q[y].slice(1))-1,++U;break;case"Y":for(g=parseInt(q[y].slice(1))-1,V=p.length;V<=g;++V)p[V]=[];break;case"M":z=parseInt(q[y].slice(1))/20;break;case"F":break;case"G":break;case"P":T=k[parseInt(q[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=q[y].slice(1).split(" "),V=parseInt(I[0],10);V<=parseInt(I[1],10);++V)z=parseInt(I[2],10),D[V-1]=z===0?{hidden:!0}:{wch:z},gi(D[V-1]);break;case"C":_=parseInt(q[y].slice(1))-1,D[_]||(D[_]={});break;case"R":g=parseInt(q[y].slice(1))-1,x[g]||(x[g]={}),z>0?(x[g].hpt=z,x[g].hpx=Qo(z)):z===0&&(x[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+F)}U<1&&(T=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+F)}}return x.length>0&&(S["!rows"]=x),D.length>0&&(S["!cols"]=D),h&&h.sheetRows&&(p=p.slice(0,h.sheetRows)),[p,S]}function i(d,h){var v=a(d,h),g=v[0],_=v[1],w=Ai(g,h);return Rn(_).forEach(function(y){w[y]=_[y]}),w}function o(d,h){return za(i(d,h),h)}function l(d,h,v,g){var _="C;Y"+(v+1)+";X"+(g+1)+";K";switch(d.t){case"n":_+=d.v||0,d.f&&!d.F&&(_+=";E"+L8(d.f,{r:v,c:g}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||d.v;break;case"d":_+='"'+(d.w||d.v)+'"';break;case"s":_+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(d,h){h.forEach(function(v,g){var _="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=su(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=iu(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&d.push(_)})}function u(d,h){h.forEach(function(v,g){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*n_(v.hpx)+";"),_.length>2&&d.push(_+"R"+(g+1))})}function f(d,h){var v=["ID;PWXL;N;E"],g=[],_=vt(d["!ref"]),w,y=Array.isArray(d),p=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&c(v,d["!cols"]),d["!rows"]&&u(v,d["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var k=_.s.r;k<=_.e.r;++k)for(var T=_.s.c;T<=_.e.c;++T){var S=je({r:k,c:T});w=y?(d[k]||[])[T]:d[S],!(!w||w.v==null&&(!w.f||w.F))&&g.push(l(w,d,k,T))}return v.join(p)+p+g.join(p)+p+"E"+p}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),YO=function(){function e(s,i){switch(i.type){case"base64":return t(Lr(s),i);case"binary":return t(s,i);case"buffer":return t(We&&Buffer.isBuffer(s)?s.toString("binary"):_s(s),i);case"array":return t(ps(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),h=d[0],v=d[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+h){case-1:if(g==="BOT"){f[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[l][c]=!0:g==="FALSE"?f[l][c]=!1:isNaN(mn(v))?isNaN(mi(v).getDate())?f[l][c]=v:f[l][c]=Ut(v):f[l][c]=mn(v),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(s,i){return Ai(e(s,i),i)}function n(s,i){return za(r(s,i),i)}var a=function(){var s=function(l,c,u,f,d){l.push(c),l.push(u+","+f),l.push('"'+d.replace(/"/g,'""')+'"')},i=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=vt(l["!ref"]),f,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){i(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var g=je({r:h,c:v});if(f=d?(l[h]||[])[v]:l[g],!f){i(c,1,0,"");continue}switch(f.t){case"n":var _=f.w;!_&&f.v!=null&&(_=f.v),_==null?f.f&&!f.F?i(c,1,0,"="+f.f):i(c,1,0,""):i(c,0,_,"V");break;case"b":i(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Xr(f.z||Ue[14],gr(Ut(f.v)))),i(c,0,f.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var w=`\r
`,y=c.join(w);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),qO=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var h=f.split(`
`),v=-1,g=-1,_=0,w=[];_!==h.length;++_){var y=h[_].trim().split(":");if(y[0]==="cell"){var p=hr(y[1]);if(w.length<=p.r)for(v=w.length;v<=p.r;++v)w[v]||(w[v]=[]);switch(v=p.r,g=p.c,y[2]){case"t":w[v][g]=e(y[3]);break;case"v":w[v][g]=+y[3];break;case"vtf":var k=y[y.length-1];case"vtc":switch(y[3]){case"nl":w[v][g]=!!+y[4];break;default:w[v][g]=+y[4];break}y[2]=="vtf"&&(w[v][g]=[w[v][g],k])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(f,d){return Ai(r(f,d),d)}function a(f,d){return za(n(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var d=[],h=[],v,g="",_=Ci(f["!ref"]),w=Array.isArray(f),y=_.s.r;y<=_.e.r;++y)for(var p=_.s.c;p<=_.e.c;++p)if(g=je({r:y,c:p}),v=w?(f[y]||[])[p]:f[g],!(!v||v.v==null||v.t==="z")){switch(h=["cell",g,"t"],v.t){case"s":case"str":h.push(t(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=t(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var k=gr(Ut(v.v));h[2]="vtc",h[3]="nd",h[4]=""+k,h[5]=v.w||Xr(v.z||Ue[14],k);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[s,i,o,i,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),qo=function(){function e(u,f,d,h,v){v.raw?f[d][h]=u:u===""||(u==="TRUE"?f[d][h]=!0:u==="FALSE"?f[d][h]=!1:isNaN(mn(u))?isNaN(mi(u).getDate())?f[d][h]=u:f[d][h]=Ut(u):f[d][h]=mn(u))}function t(u,f){var d=f||{},h=[];if(!u||u.length===0)return h;for(var v=u.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var _=10,w=0,y=0;y<=g;++y)w=v[y].indexOf(" "),w==-1?w=v[y].length:w++,_=Math.max(_,w);for(y=0;y<=g;++y){h[y]=[];var p=0;for(e(v[y].slice(0,_).trim(),h,y,p,d),p=1;p<=(v[y].length-_)/10+1;++p)e(v[y].slice(_+(p-1)*10,_+p*10).trim(),h,y,p,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},d=!1,h=0,v=0;h<u.length;++h)(v=u.charCodeAt(h))==34?d=!d:!d&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&v.push([f[h],h]);if(!v.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&v.push([f[h],h])}return v.sort(function(g,_){return g[0]-_[0]||n[g[1]]-n[_[1]]}),r[v.pop()[1]]||44}function s(u,f){var d=f||{},h="",v=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):d&&d.FS?h=d.FS:h=a(u.slice(0,1024));var _=0,w=0,y=0,p=0,k=0,T=h.charCodeAt(0),S=!1,x=0,D=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var I=d.dateNF!=null?lA(d.dateNF):null;function z(){var V=u.slice(p,k),F={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)F.t="z";else if(d.raw)F.t="s",F.v=V;else if(V.trim().length===0)F.t="s",F.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(F.t="s",F.v=V.slice(2,-1).replace(/""/g,'"')):j8(V)?(F.t="n",F.f=V.slice(1)):(F.t="s",F.v=V);else if(V=="TRUE")F.t="b",F.v=!0;else if(V=="FALSE")F.t="b",F.v=!1;else if(!isNaN(y=mn(V)))F.t="n",d.cellText!==!1&&(F.w=V),F.v=y;else if(!isNaN(mi(V).getDate())||I&&V.match(I)){F.z=d.dateNF||Ue[14];var q=0;I&&V.match(I)&&(V=cA(V,d.dateNF,V.match(I)||[]),q=1),d.cellDates?(F.t="d",F.v=Ut(V,q)):(F.t="n",F.v=gr(Ut(V,q))),d.cellText!==!1&&(F.w=Xr(F.z,F.v instanceof Date?gr(F.v):F.v)),d.cellNF||delete F.z}else F.t="s",F.v=V;if(F.t=="z"||(d.dense?(v[_]||(v[_]=[]),v[_][w]=F):v[je({c:w,r:_})]=F),p=k+1,D=u.charCodeAt(p),g.e.c<w&&(g.e.c=w),g.e.r<_&&(g.e.r=_),x==T)++w;else if(w=0,++_,d.sheetRows&&d.sheetRows<=_)return!0}e:for(;k<u.length;++k)switch(x=u.charCodeAt(k)){case 34:D===34&&(S=!S);break;case T:case 10:case 13:if(!S&&z())break e;break}return k-p>0&&z(),v["!ref"]=Ge(g),v}function i(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):Ai(t(u,f),f)}function o(u,f){var d="",h=f.type=="string"?[0,0,0,0]:tp(u,f);switch(f.type){case"base64":d=Lr(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof ga<"u"?d=ga.utils.decode(f.codepage,u):d=We&&Buffer.isBuffer(u)?u.toString("binary"):_s(u);break;case"array":d=ps(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=tt(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=tt(d):f.type=="binary"&&typeof ga<"u"&&f.codepage&&(d=ga.utils.decode(f.codepage,ga.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?qO.to_sheet(f.type=="string"?d:tt(d),f):i(d,f)}function l(u,f){return za(o(u,f),f)}function c(u){for(var f=[],d=vt(u["!ref"]),h,v=Array.isArray(u),g=d.s.r;g<=d.e.r;++g){for(var _=[],w=d.s.c;w<=d.e.c;++w){var y=je({r:g,c:w});if(h=v?(u[g]||[])[w]:u[y],!h||h.v==null){_.push("          ");continue}for(var p=(h.w||(na(h),h.w)||"").slice(0,10);p.length<10;)p+=" ";_.push(p+(w===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function JO(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=XO.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return qo.to_workbook(e,t)}}var xo=function(){function e(O,W,U){if(O){Vt(O,O.l||0);for(var M=U.Enum||fe;O.l<O.length;){var Q=O.read_shift(2),pe=M[Q]||M[65535],ke=O.read_shift(2),ce=O.l+ke,ne=pe.f&&pe.f(O,ke,U);if(O.l=ce,W(ne,pe,Q))return}}}function t(O,W){switch(W.type){case"base64":return r(un(Lr(O)),W);case"binary":return r(un(O),W);case"buffer":case"array":return r(O,W)}throw"Unsupported type "+W.type}function r(O,W){if(!O)return O;var U=W||{},M=U.dense?[]:{},Q="Sheet1",pe="",ke=0,ce={},ne=[],Y=[],A={s:{r:0,c:0},e:{r:0,c:0}},Pe=U.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)U.Enum=fe,e(O,function(we,rt,kt){switch(kt){case 0:U.vers=we,we>=4096&&(U.qpro=!0);break;case 6:A=we;break;case 204:we&&(pe=we);break;case 222:pe=we;break;case 15:case 51:U.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:kt==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=U.dateNF||Ue[14],U.cellDates&&(we[1].t="d",we[1].v=zu(we[1].v))),U.qpro&&we[3]>ke&&(M["!ref"]=Ge(A),ce[Q]=M,ne.push(Q),M=U.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},ke=we[3],Q=pe||"Sheet"+(ke+1),pe="");var L=U.dense?(M[we[0].r]||[])[we[0].c]:M[je(we[0])];if(L){L.t=we[1].t,L.v=we[1].v,we[1].z!=null&&(L.z=we[1].z),we[1].f!=null&&(L.f=we[1].f);break}U.dense?(M[we[0].r]||(M[we[0].r]=[]),M[we[0].r][we[0].c]=we[1]):M[je(we[0])]=we[1];break}},U);else if(O[2]==26||O[2]==14)U.Enum=ye,O[2]==14&&(U.qpro=!0,O.l=0),e(O,function(we,rt,kt){switch(kt){case 204:Q=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>ke&&(M["!ref"]=Ge(A),ce[Q]=M,ne.push(Q),M=U.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},ke=we[3],Q="Sheet"+(ke+1)),Pe>0&&we[0].r>=Pe)break;U.dense?(M[we[0].r]||(M[we[0].r]=[]),M[we[0].r][we[0].c]=we[1]):M[je(we[0])]=we[1],A.e.c<we[0].c&&(A.e.c=we[0].c),A.e.r<we[0].r&&(A.e.r=we[0].r);break;case 27:we[14e3]&&(Y[we[14e3][0]]=we[14e3][1]);break;case 1537:Y[we[0]]=we[1],we[0]==ke&&(Q=we[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(M["!ref"]=Ge(A),ce[pe||Q]=M,ne.push(pe||Q),!Y.length)return{SheetNames:ne,Sheets:ce};for(var Re={},Ne=[],De=0;De<Y.length;++De)ce[ne[De]]?(Ne.push(Y[De]||ne[De]),Re[Y[De]]=ce[Y[De]]||ce[ne[De]]):(Ne.push(Y[De]),Re[Y[De]]={"!ref":"A1"});return{SheetNames:Ne,Sheets:Re}}function n(O,W){var U=W||{};if(+U.codepage>=0&&fn(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var M=eh(),Q=vt(O["!ref"]),pe=Array.isArray(O),ke=[];tn(M,0,s(1030)),tn(M,6,l(Q));for(var ce=Math.min(Q.e.r,8191),ne=Q.s.r;ne<=ce;++ne)for(var Y=Gt(ne),A=Q.s.c;A<=Q.e.c;++A){ne===Q.s.r&&(ke[A]=It(A));var Pe=ke[A]+Y,Re=pe?(O[ne]||[])[A]:O[Pe];if(!(!Re||Re.t=="z"))if(Re.t=="n")(Re.v|0)==Re.v&&Re.v>=-32768&&Re.v<=32767?tn(M,13,h(ne,A,Re.v)):tn(M,14,g(ne,A,Re.v));else{var Ne=na(Re);tn(M,15,f(ne,A,Ne.slice(0,239)))}}return tn(M,1),M.end()}function a(O,W){var U=W||{};if(+U.codepage>=0&&fn(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var M=eh();tn(M,0,i(O));for(var Q=0,pe=0;Q<O.SheetNames.length;++Q)(O.Sheets[O.SheetNames[Q]]||{})["!ref"]&&tn(M,27,j(O.SheetNames[Q],pe++));var ke=0;for(Q=0;Q<O.SheetNames.length;++Q){var ce=O.Sheets[O.SheetNames[Q]];if(!(!ce||!ce["!ref"])){for(var ne=vt(ce["!ref"]),Y=Array.isArray(ce),A=[],Pe=Math.min(ne.e.r,8191),Re=ne.s.r;Re<=Pe;++Re)for(var Ne=Gt(Re),De=ne.s.c;De<=ne.e.c;++De){Re===ne.s.r&&(A[De]=It(De));var we=A[De]+Ne,rt=Y?(ce[Re]||[])[De]:ce[we];if(!(!rt||rt.t=="z"))if(rt.t=="n")tn(M,23,z(Re,De,ke,rt.v));else{var kt=na(rt);tn(M,22,x(Re,De,ke,kt.slice(0,239)))}}++ke}}return tn(M,1),M.end()}function s(O){var W=Ot(2);return W.write_shift(2,O),W}function i(O){var W=Ot(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var U=0,M=0,Q=0,pe=0;pe<O.SheetNames.length;++pe){var ke=O.SheetNames[pe],ce=O.Sheets[ke];if(!(!ce||!ce["!ref"])){++Q;var ne=Ci(ce["!ref"]);U<ne.e.r&&(U=ne.e.r),M<ne.e.c&&(M=ne.e.c)}}return U>8191&&(U=8191),W.write_shift(2,U),W.write_shift(1,Q),W.write_shift(1,M),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(O,W,U){var M={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&U.qpro?(M.s.c=O.read_shift(1),O.l++,M.s.r=O.read_shift(2),M.e.c=O.read_shift(1),O.l++,M.e.r=O.read_shift(2),M):(M.s.c=O.read_shift(2),M.s.r=O.read_shift(2),W==12&&U.qpro&&(O.l+=2),M.e.c=O.read_shift(2),M.e.r=O.read_shift(2),W==12&&U.qpro&&(O.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function l(O){var W=Ot(8);return W.write_shift(2,O.s.c),W.write_shift(2,O.s.r),W.write_shift(2,O.e.c),W.write_shift(2,O.e.r),W}function c(O,W,U){var M=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(M[0].c=O.read_shift(1),M[3]=O.read_shift(1),M[0].r=O.read_shift(2),O.l+=2):(M[2]=O.read_shift(1),M[0].c=O.read_shift(2),M[0].r=O.read_shift(2)),M}function u(O,W,U){var M=O.l+W,Q=c(O,W,U);if(Q[1].t="s",U.vers==20768){O.l++;var pe=O.read_shift(1);return Q[1].v=O.read_shift(pe,"utf8"),Q}return U.qpro&&O.l++,Q[1].v=O.read_shift(M-O.l,"cstr"),Q}function f(O,W,U){var M=Ot(7+U.length);M.write_shift(1,255),M.write_shift(2,W),M.write_shift(2,O),M.write_shift(1,39);for(var Q=0;Q<M.length;++Q){var pe=U.charCodeAt(Q);M.write_shift(1,pe>=128?95:pe)}return M.write_shift(1,0),M}function d(O,W,U){var M=c(O,W,U);return M[1].v=O.read_shift(2,"i"),M}function h(O,W,U){var M=Ot(7);return M.write_shift(1,255),M.write_shift(2,W),M.write_shift(2,O),M.write_shift(2,U,"i"),M}function v(O,W,U){var M=c(O,W,U);return M[1].v=O.read_shift(8,"f"),M}function g(O,W,U){var M=Ot(13);return M.write_shift(1,255),M.write_shift(2,W),M.write_shift(2,O),M.write_shift(8,U,"f"),M}function _(O,W,U){var M=O.l+W,Q=c(O,W,U);if(Q[1].v=O.read_shift(8,"f"),U.qpro)O.l=M;else{var pe=O.read_shift(2);k(O.slice(O.l,O.l+pe),Q),O.l+=pe}return Q}function w(O,W,U){var M=W&32768;return W&=-32769,W=(M?O:0)+(W>=8192?W-16384:W),(M?"":"$")+(U?It(W):Gt(W))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},p=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(O,W){Vt(O,0);for(var U=[],M=0,Q="",pe="",ke="",ce="";O.l<O.length;){var ne=O[O.l++];switch(ne){case 0:U.push(O.read_shift(8,"f"));break;case 1:pe=w(W[0].c,O.read_shift(2),!0),Q=w(W[0].r,O.read_shift(2),!1),U.push(pe+Q);break;case 2:{var Y=w(W[0].c,O.read_shift(2),!0),A=w(W[0].r,O.read_shift(2),!1);pe=w(W[0].c,O.read_shift(2),!0),Q=w(W[0].r,O.read_shift(2),!1),U.push(Y+A+":"+pe+Q)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(O.read_shift(2));break;case 6:{for(var Pe="";ne=O[O.l++];)Pe+=String.fromCharCode(ne);U.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:ce=U.pop(),ke=U.pop(),U.push(["AND","OR"][ne-20]+"("+ke+","+ce+")");break;default:if(ne<32&&p[ne])ce=U.pop(),ke=U.pop(),U.push(ke+p[ne]+ce);else if(y[ne]){if(M=y[ne][1],M==69&&(M=O[O.l++]),M>U.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+U.join("|")+"|");return}var Re=U.slice(-M);U.length-=M,U.push(y[ne][0]+"("+Re.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}U.length==1?W[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function T(O){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=O.read_shift(2),W[3]=O[O.l++],W[0].c=O[O.l++],W}function S(O,W){var U=T(O);return U[1].t="s",U[1].v=O.read_shift(W-4,"cstr"),U}function x(O,W,U,M){var Q=Ot(6+M.length);Q.write_shift(2,O),Q.write_shift(1,U),Q.write_shift(1,W),Q.write_shift(1,39);for(var pe=0;pe<M.length;++pe){var ke=M.charCodeAt(pe);Q.write_shift(1,ke>=128?95:ke)}return Q.write_shift(1,0),Q}function D(O,W){var U=T(O);U[1].v=O.read_shift(2);var M=U[1].v>>1;if(U[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return U[1].v=M,U}function I(O,W){var U=T(O),M=O.read_shift(4),Q=O.read_shift(4),pe=O.read_shift(2);if(pe==65535)return M===0&&Q===3221225472?(U[1].t="e",U[1].v=15):M===0&&Q===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var ke=pe&32768;return pe=(pe&32767)-16446,U[1].v=(1-ke*2)*(Q*Math.pow(2,pe+32)+M*Math.pow(2,pe)),U}function z(O,W,U,M){var Q=Ot(14);if(Q.write_shift(2,O),Q.write_shift(1,U),Q.write_shift(1,W),M==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var pe=0,ke=0,ce=0,ne=0;return M<0&&(pe=1,M=-M),ke=Math.log2(M)|0,M/=Math.pow(2,ke-31),ne=M>>>0,ne&2147483648||(M/=2,++ke,ne=M>>>0),M-=ne,ne|=2147483648,ne>>>=0,M*=Math.pow(2,32),ce=M>>>0,Q.write_shift(4,ce),Q.write_shift(4,ne),ke+=16383+(pe?32768:0),Q.write_shift(2,ke),Q}function V(O,W){var U=I(O);return O.l+=W-14,U}function F(O,W){var U=T(O),M=O.read_shift(4);return U[1].v=M>>6,U}function q(O,W){var U=T(O),M=O.read_shift(8,"f");return U[1].v=M,U}function ae(O,W){var U=q(O);return O.l+=W-10,U}function se(O,W){return O[O.l+W-1]==0?O.read_shift(W,"cstr"):""}function ge(O,W){var U=O[O.l++];U>W-1&&(U=W-1);for(var M="";M.length<U;)M+=String.fromCharCode(O[O.l++]);return M}function le(O,W,U){if(!(!U.qpro||W<21)){var M=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var Q=O.read_shift(W-21,"cstr");return[M,Q]}}function oe(O,W){for(var U={},M=O.l+W;O.l<M;){var Q=O.read_shift(2);if(Q==14e3){for(U[Q]=[0,""],U[Q][0]=O.read_shift(2);O[O.l];)U[Q][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return U}function j(O,W){var U=Ot(5+O.length);U.write_shift(2,14e3),U.write_shift(2,W);for(var M=0;M<O.length;++M){var Q=O.charCodeAt(M);U[U.l++]=Q>127?95:Q}return U[U.l++]=0,U}var fe={0:{n:"BOF",f:St},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:ge},65535:{n:""}},ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function QO(e){var t={},r=e.match(ir),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Ie(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=R0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var eR=function(){var e=Xo("t"),t=Xo("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Ze(i[1])},l=s.match(t);return l&&(o.s=QO(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),tR=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),rR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,nR=/<(?:\w+:)?r>/,aR=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Z0(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ze(tt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=tt(e),r&&(n.h=M0(n.t))):e.match(nR)&&(n.r=tt(e),n.t=Ze(tt((e.replace(aR,"").match(rR)||[]).join("").replace(ir,""))),r&&(n.h=tR(eR(n.r)))),n):{t:""}}var sR=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,iR=/<(?:\w+:)?(?:si|sstItem)>/g,oR=/<\/(?:\w+:)?(?:si|sstItem)>/;function lR(e,t){var r=[],n="";if(!e)return r;var a=e.match(sR);if(a){n=a[2].replace(iR,"").split(oR);for(var s=0;s!=n.length;++s){var i=Z0(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Ie(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function cR(e){return[e.read_shift(4),e.read_shift(4)]}function uR(e,t){var r=[],n=!1;return sa(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function qw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function qn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function fR(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=qn(e,4),t.U=qn(e,4),t.W=qn(e,4),t}function dR(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function hR(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(dR(e));return t}function pR(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function mR(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=qn(e,4),t.U=qn(e,4),t.W=qn(e,4),t}function gR(e){var t=mR(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Jw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Qw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function vR(e){var t=qn(e);switch(t.Minor){case 2:return[t.Minor,yR(e)];case 3:return[t.Minor,wR()];case 4:return[t.Minor,_R(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function yR(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Jw(e,r),a=Qw(e,e.length-e.l);return{t:"Std",h:n,v:a}}function wR(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _R(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ir,function(s){var i=Ie(s);switch(Dn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function kR(e,t){var r={},n=r.EncryptionVersionInfo=qn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Jw(e,a),t-=a,r.EncryptionVerifier=Qw(e,t),r}function xR(e){var t={},r=t.EncryptionVersionInfo=qn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ER(e){var t=0,r,n=qw(e),a=n.length+1,s,i,o,l,c;for(r=Ia(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var e_=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=qw(i),l=s(o),c=o.length,u=Ia(16),f=0;f!=16;++f)u[f]=0;var d,h,v;for((c&1)===1&&(d=l>>8,u[c]=a(e[0],d),--c,d=l&255,h=o[o.length-1],u[c]=a(h,d));c>0;)--c,d=l>>8,u[c]=a(o[c],d),--c,d=l&255,u[c]=a(o[c],d);for(c=15,v=15-o.length;v>0;)d=l>>8,u[c]=a(e[v],d),--c,--v,d=l&255,u[c]=a(o[c],d),--c,--v;return u}}(),TR=function(e,t,r,n,a){a||(a=t),n||(n=e_(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},SR=function(e){var t=0,r=e_(e);return function(n){var a=TR("",n,t,r);return t=a[1],a[0]}};function bR(e,t,r,n){var a={key:St(e),verificationBytes:St(e)};return r.password&&(a.verifier=ER(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=SR(r.password)),a}function CR(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=xR(e):n.Data=kR(e,t),n}function AR(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?CR(e,t-2,n):bR(e,r.biff>=8?t:t-2,r,n),n}var NR=function(){function e(a,s){switch(s.type){case"base64":return t(Lr(a),s);case"binary":return t(a,s);case"buffer":return t(We&&Buffer.isBuffer(a)?a.toString("binary"):_s(a),s);case"array":return t(ps(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,h=0,v,g=-1;v=d.exec(u);){switch(v[0]){case"\\cell":var _=u.slice(h,d.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++g,_.length){var w={v:_,t:"s"};Array.isArray(o)?o[f][g]=w:o[je({r:f,c:g})]=w}break}h=d.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=Ge(c),o}function r(a,s){return za(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=vt(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var f=je({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(na(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function OR(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Jo(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function RR(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function PR(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function au(e,t){if(t===0)return e;var r=RR(OR(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Jo(PR(r))}var t_=6,IR=15,DR=1,dr=t_;function su(e){return Math.floor((e+Math.round(128/dr)/256)*dr)}function iu(e){return Math.floor((e-5)/dr*100+.5)/100}function ah(e){return Math.round((e*dr+5)/dr*256)/256}function Ff(e){return ah(iu(su(e)))}function X0(e){var t=Math.abs(e-Ff(e)),r=dr;if(t>.005)for(dr=DR;dr<IR;++dr)Math.abs(e-Ff(e))<=t&&(t=Math.abs(e-Ff(e)),r=dr);dr=r}function gi(e){e.width?(e.wpx=su(e.width),e.wch=iu(e.wpx),e.MDW=dr):e.wpx?(e.wch=iu(e.wpx),e.width=ah(e.wch),e.MDW=dr):typeof e.wch=="number"&&(e.width=ah(e.wch),e.wpx=su(e.width),e.MDW=dr),e.customWidth&&delete e.customWidth}var LR=96,r_=LR;function n_(e){return e*96/r_}function Qo(e){return e*r_/96}var FR={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function jR(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(ir)||[]).forEach(function(i){var o=Ie(i);switch(Dn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=st(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=st(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function MR(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(ir)||[]).forEach(function(i){var o=Ie(i);switch(Dn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function $R(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(ir)||[]).forEach(function(i){var o=Ie(i);switch(Dn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=tt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?st(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?st(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?st(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?st(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?st(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?st(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?st(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=R0[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=st(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=ss[a.color.index];a.color.index==81&&(l=ss[1]),l||(l=ss[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=au(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function UR(e,t,r){t.NumberFmt=[];for(var n=Rn(Ue),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ue[n[a]];var s=e[0].match(ir);if(s)for(a=0;a<s.length;++a){var i=Ie(s[a]);switch(Dn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ze(tt(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}as(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Ql=["numFmtId","fillId","fontId","borderId","xfId"],ec=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BR(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(ir)||[]).forEach(function(s){var i=Ie(s),o=0;switch(Dn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Ql.length;++o)n[Ql[o]]&&(n[Ql[o]]=parseInt(n[Ql[o]],10));for(o=0;o<ec.length;++o)n[ec[o]]&&(n[ec[o]]=st(n[ec[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=st(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var zR=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&UR(f,u,c),(f=o.match(a))&&$R(f,u,l,c),(f=o.match(n))&&MR(f,u,l,c),(f=o.match(s))&&jR(f,u,l,c),(f=o.match(r))&&BR(f,u,c),u}}();function VR(e,t){var r=e.read_shift(2),n=nr(e);return[r,n]}function WR(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=eN(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=QA(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=nr(e),n}var HR=sr;function GR(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var KR=sr;function ZR(e,t,r){var n={};n.NumberFmt=[];for(var a in Ue)n.NumberFmt[a]=Ue[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return sa(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],as(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=au(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var XR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function YR(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ir)||[]).forEach(function(a){var s=Ie(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[XR.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function qR(){}function JR(){}var QR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,e8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,t8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function r8(e,t,r){t.themeElements={};var n;[["clrScheme",QR,YR],["fontScheme",e8,qR],["fmtScheme",t8,JR]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var n8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function a_(e,t){(!e||e.length===0)&&(e=a8());var r,n={};if(!(r=e.match(n8)))throw new Error("themeElements not found in theme");return r8(r[0],n,t),n.raw=e,n}function a8(e,t){var r=[mw];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function s8(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=pw(s,{type:"array"})}catch{return}var o=Rr(i,"theme/theme/theme1.xml",!0);if(o)return a_(o,r)}}function i8(e){return e.read_shift(4)}function o8(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=l8(e,4);break;case 2:t.xclrValue=Ww(e);break;case 3:t.xclrValue=i8(e);break;case 4:e.l+=4;break}return e.l+=8,t}function l8(e,t){return sr(e,t)}function c8(e,t){return sr(e,t)}function u8(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=o8(e);break;case 6:n[1]=c8(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function f8(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(u8(e,r-e.l));return{ixfe:n,ext:s}}function d8(e,t){t.forEach(function(r){switch(r[0]){}})}function h8(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:nr(e)}}function p8(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function m8(e){return e.l+=4,e.read_shift(4)!=0}function g8(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return sa(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function v8(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(ir,function(o){var l=Ie(o);switch(Dn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function y8(e){var t=[];if(!e)return t;var r=1;return(e.match(ir)||[]).forEach(function(n){var a=Ie(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function w8(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=je(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function _8(e,t,r){var n=[];return sa(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function k8(e,t,r,n){if(!e)return e;var a=n||{},s=!1;sa(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function x8(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function ag(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=hr(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=vt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ge(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function E8(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ie(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=hr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&Z0(f[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function T8(e,t){var r=[],n=!1,a={},s=0;return e.replace(ir,function(o,l){var c=Ie(o);switch(Dn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function S8(e,t){var r=[],n=!1;return e.replace(ir,function(s){var i=Ie(s);switch(Dn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function b8(e){var t={};t.iauthor=e.read_shift(4);var r=xs(e);return t.rfx=r.s,t.ref=je(r.s),e.l+=16,t}var C8=nr;function A8(e,t){var r=[],n=[],a={},s=!1;return sa(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var N8="application/vnd.ms-office.vbaProject";function O8(e){var t=He.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");He.utils.cfb_add(t,a,e.FileIndex[n].content)}}),He.write(t)}function R8(){return{"!type":"dialog"}}function P8(){return{"!type":"dialog"}}function I8(){return{"!type":"macro"}}function D8(){return{"!type":"macro"}}var ai=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+It(u)+(l?"":"$")+Gt(c)}return function(a,s){return t=s,a.replace(e,r)}}(),s_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,L8=function(){return function(t,r){return t.replace(s_,function(n,a,s,i,o,l){var c=z0(i)-(s?0:r.c),u=B0(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return a+"R"+f+"C"+d})}}();function i_(e,t){return e.replace(s_,function(r,n,a,s,i,o){return n+(a=="$"?a+s:It(z0(s)+t.c))+(i=="$"?i+o:Gt(B0(o)+t.r))})}function F8(e,t,r){var n=Ci(t),a=n.s,s=hr(r),i={r:s.r-a.r,c:s.c-a.c};return i_(e,i)}function j8(e){return e.length!=1}function sg(e){return e.replace(/_xlfn\./g,"")}function xt(e){e.l+=1}function Da(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function o_(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return l_(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Da(e),o=Da(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function l_(e){var t=Da(e),r=Da(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function M8(e,t,r){if(r.biff<8)return l_(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Da(e),i=Da(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function c_(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return $8(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Da(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function $8(e){var t=Da(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function U8(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function B8(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return z8(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function z8(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function V8(e,t,r){var n=(e[e.l++]&96)>>5,a=o_(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function W8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=o_(e,s,r);return[n,a,i]}function H8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function G8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function K8(e,t,r){var n=(e[e.l++]&96)>>5,a=M8(e,t-1,r);return[n,a]}function Z8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ig(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function X8(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Y8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function q8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function J8(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Q8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function u_(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function eP(e){return e.read_shift(2),u_(e)}function tP(e){return e.read_shift(2),u_(e)}function rP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=c_(e,0,r);return[n,a]}function nP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=B8(e,0,r);return[n,a]}function aP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=c_(e,0,r);return[n,a,s]}function sP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[iI[a],h_[a],n]}function iP(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:oP(e);return[a,(s[0]===0?h_:sI)[s[1]]]}function oP(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function lP(e,t,r){e.l+=r&&r.biff==2?3:4}function cP(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function uP(e){return e.l++,Es[e.read_shift(1)]}function fP(e){return e.l++,e.read_shift(2)}function dP(e){return e.l++,e.read_shift(1)!==0}function hP(e){return e.l++,tr(e)}function pP(e,t,r){return e.l++,ml(e,t-1,r)}function mP(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=yt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Es[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=tr(e);break;case 2:r[1]=Ts(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function gP(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?xs:Vu)(e));return a}function vP(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=mP(e,r.biff);return i}function yP(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function wP(e,t,r){if(r.biff==5)return _P(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function _P(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function kP(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function xP(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function EP(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function TP(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var SP=sr,bP=sr,CP=sr;function vl(e,t,r){return e.l+=2,[U8(e)]}function Y0(e){return e.l+=6,[]}var AP=vl,NP=Y0,OP=Y0,RP=vl;function f_(e){return e.l+=2,[St(e),e.read_shift(2)&1]}var PP=vl,IP=f_,DP=Y0,LP=vl,FP=vl,jP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function MP(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=jP[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function $P(e){return e.l+=2,[e.read_shift(4)]}function UP(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function BP(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function zP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function WP(e){return e.l+=4,[0,0]}var og={1:{n:"PtgExp",f:cP},2:{n:"PtgTbl",f:CP},3:{n:"PtgAdd",f:xt},4:{n:"PtgSub",f:xt},5:{n:"PtgMul",f:xt},6:{n:"PtgDiv",f:xt},7:{n:"PtgPower",f:xt},8:{n:"PtgConcat",f:xt},9:{n:"PtgLt",f:xt},10:{n:"PtgLe",f:xt},11:{n:"PtgEq",f:xt},12:{n:"PtgGe",f:xt},13:{n:"PtgGt",f:xt},14:{n:"PtgNe",f:xt},15:{n:"PtgIsect",f:xt},16:{n:"PtgUnion",f:xt},17:{n:"PtgRange",f:xt},18:{n:"PtgUplus",f:xt},19:{n:"PtgUminus",f:xt},20:{n:"PtgPercent",f:xt},21:{n:"PtgParen",f:xt},22:{n:"PtgMissArg",f:xt},23:{n:"PtgStr",f:pP},26:{n:"PtgSheet",f:UP},27:{n:"PtgEndSheet",f:BP},28:{n:"PtgErr",f:uP},29:{n:"PtgBool",f:dP},30:{n:"PtgInt",f:fP},31:{n:"PtgNum",f:hP},32:{n:"PtgArray",f:Z8},33:{n:"PtgFunc",f:sP},34:{n:"PtgFuncVar",f:iP},35:{n:"PtgName",f:yP},36:{n:"PtgRef",f:rP},37:{n:"PtgArea",f:V8},38:{n:"PtgMemArea",f:kP},39:{n:"PtgMemErr",f:SP},40:{n:"PtgMemNoMem",f:bP},41:{n:"PtgMemFunc",f:xP},42:{n:"PtgRefErr",f:EP},43:{n:"PtgAreaErr",f:H8},44:{n:"PtgRefN",f:nP},45:{n:"PtgAreaN",f:K8},46:{n:"PtgMemAreaN",f:zP},47:{n:"PtgMemNoMemN",f:VP},57:{n:"PtgNameX",f:wP},58:{n:"PtgRef3d",f:aP},59:{n:"PtgArea3d",f:W8},60:{n:"PtgRefErr3d",f:TP},61:{n:"PtgAreaErr3d",f:G8},255:{}},HP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},GP={1:{n:"PtgElfLel",f:f_},2:{n:"PtgElfRw",f:LP},3:{n:"PtgElfCol",f:AP},6:{n:"PtgElfRwV",f:FP},7:{n:"PtgElfColV",f:RP},10:{n:"PtgElfRadical",f:PP},11:{n:"PtgElfRadicalS",f:DP},13:{n:"PtgElfColS",f:NP},15:{n:"PtgElfColSV",f:OP},16:{n:"PtgElfRadicalLel",f:IP},25:{n:"PtgList",f:MP},29:{n:"PtgSxName",f:$P},255:{}},KP={0:{n:"PtgAttrNoop",f:WP},1:{n:"PtgAttrSemi",f:Q8},2:{n:"PtgAttrIf",f:q8},4:{n:"PtgAttrChoose",f:X8},8:{n:"PtgAttrGoto",f:Y8},16:{n:"PtgAttrSum",f:lP},32:{n:"PtgAttrBaxcel",f:ig},33:{n:"PtgAttrBaxcel",f:ig},64:{n:"PtgAttrSpace",f:eP},65:{n:"PtgAttrSpaceSemi",f:tP},128:{n:"PtgAttrIfError",f:J8},255:{}};function yl(e,t,r,n){if(n.biff<8)return sr(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=vP(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=gP(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(sr(e,t)),s}function wl(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=og[s]||og[HP[s]],(s===24||s===25)&&(a=(s===24?GP:KP)[e[e.l+1]]),!a||!a.f?sr(e,t):i.push([a.n,a.f(e,t,r)]);return i}function ZP(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var XP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function YP(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function d_(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function lg(e,t,r){var n=d_(e,t,r);return n=="#REF"?n:YP(n,r)}function Qt(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,d=0,h,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,_="",w=0,y=e[0].length;w<y;++w){var p=e[0][w];switch(p[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:_=gt(" ",e[0][g][1][1]);break;case 1:_=gt("\r",e[0][g][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+_,g=-1}o.push(c+XP[p[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=yo(p[1][1],i,a),o.push(wo(u,s));break;case"PtgRefN":u=r?yo(p[1][1],r,a):p[1][1],o.push(wo(u,s));break;case"PtgRef3d":f=p[1][1],u=yo(p[1][2],i,a),v=lg(n,f,a),o.push(v+"!"+wo(u,s));break;case"PtgFunc":case"PtgFuncVar":var k=p[1][0],T=p[1][1];k||(k=0),k&=127;var S=k==0?[]:o.slice(-k);o.length-=k,T==="User"&&(T=S.shift()),o.push(T+"("+S.join(",")+")");break;case"PtgBool":o.push(p[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(p[1]);break;case"PtgNum":o.push(String(p[1]));break;case"PtgStr":o.push('"'+p[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(p[1]);break;case"PtgAreaN":h=zm(p[1][1],r?{s:r}:i,a),o.push(Df(h,a));break;case"PtgArea":h=zm(p[1][1],i,a),o.push(Df(h,a));break;case"PtgArea3d":f=p[1][1],h=p[1][2],v=lg(n,f,a),o.push(v+"!"+Df(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=p[1][2];var x=(n.names||[])[d-1]||(n[0]||[])[d],D=x?x.Name:"SH33TJSNAME"+String(d);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),o.push(D);break;case"PtgNameX":var I=p[1][1];d=p[1][2];var z;if(a.biff<=5)I<0&&(I=-I),n[I]&&(z=n[I][d]);else{var V="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][d]&&n[I][d].itab>0&&(V=n.SheetNames[n[I][d].itab-1]+"!"):V=n.SheetNames[d-1]+"!"),n[I]&&n[I][d])V+=n[I][d].Name;else if(n[0]&&n[0][d])V+=n[0][d].Name;else{var F=(d_(n,I,a)||"").split(";;");F[d-1]?V=F[d-1]:V+="SH33TJSERRX"}o.push(V);break}z||(z={Name:"SH33TJSERRY"}),o.push(z.Name);break;case"PtgParen":var q="(",ae=")";if(g>=0){switch(_="",e[0][g][1][0]){case 2:q=gt(" ",e[0][g][1][1])+q;break;case 3:q=gt("\r",e[0][g][1][1])+q;break;case 4:ae=gt(" ",e[0][g][1][1])+ae;break;case 5:ae=gt("\r",e[0][g][1][1])+ae;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(q+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:p[1][1],r:p[1][0]};var se={c:r.c,r:r.r};if(n.sharedf[je(u)]){var ge=n.sharedf[je(u)];o.push(Qt(ge,i,se,n,a))}else{var le=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Qt(c[1],i,se,n,a)),le=!0;break}le||o.push(p[1])}break;case"PtgArray":o.push("{"+ZP(p[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+p[1].idx+"[#"+p[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(p));default:throw new Error("Unrecognized Formula Token: "+String(p))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&oe.indexOf(e[0][w][0])==-1){p=e[0][g];var j=!0;switch(p[1][0]){case 4:j=!1;case 0:_=gt(" ",p[1][1]);break;case 5:j=!1;case 1:_=gt("\r",p[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+p[1][0])}o.push((j?_:"")+o.pop()+(j?"":_)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function qP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],sr(e,t-2)];var o=wl(e,i,r);return t!==i+a&&(s=yl(e,t-i-a,o,r)),e.l=n,[o,s]}function JP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],sr(e,t-2)];var o=wl(e,i,r);return t!==i+a&&(s=yl(e,t-i-a,o,r)),e.l=n,[o,s]}function QP(e,t,r,n){var a=e.l+t,s=wl(e,n,r),i;return a!==e.l&&(i=yl(e,a-e.l,s,r)),[s,i]}function eI(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=wl(e,s,r);return s==65535?[[],sr(e,t-2)]:(t!==s+2&&(a=yl(e,n-s-2,i,r)),[i,a])}function tI(e){var t;if(Gn(e,e.l+6)!==65535)return[tr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function jf(e,t,r){var n=e.l+t,a=Ln(e);r.biff==2&&++e.l;var s=tI(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=JP(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function Wu(e,t,r){var n=e.read_shift(4),a=wl(e,n,r),s=e.read_shift(4),i=s>0?yl(e,s,a,r):null;return[a,i]}var rI=Wu,Hu=Wu,nI=Wu,aI=Wu,sI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},h_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iI={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Mf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Eo={},si={};function To(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function p_(e,t,r,n,a,s){try{n.cellNF&&(e.z=Ue[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ut(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ue[t]==null&&as(oA[t]||"General",t),e.t==="e")e.w=e.w||Es[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v);else if(e.t==="d"){var i=gr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Zo(i)}else{if(e.v===void 0)return"";e.w=hs(e.v,si)}else e.t==="d"?e.w=Xr(t,gr(e.v),si):e.w=Xr(t,e.v,si)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=au(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=au(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function oI(e,t){var r=vt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ge(r))}var lI=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,cI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,uI=/<(?:\w:)?hyperlink [^>]*>/mg,fI=/"(\w*:\w*)"/,dI=/<(?:\w:)?col\b[^>]*[\/]?>/g,hI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pI=/<(?:\w:)?pageMargins[^>]*\/>/g,m_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,mI=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,gI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vI(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(cI);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var d=c.match(m_);d?q0(d[0],o,a,r):(d=c.match(mI))&&yI(d[0],d[1]||"",o,a,r);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var v=c.slice(h,h+50).match(fI);v&&oI(o,v[1])}var g=c.match(gI);g&&g[1]&&TI(g[1],a);var _=[];if(t.cellStyles){var w=c.match(dI);w&&kI(_,w)}f&&SI(f[1],o,t,l,s,i);var y=u.match(hI);y&&(o["!autofilter"]=xI(y[0]));var p=[],k=u.match(lI);if(k)for(h=0;h!=k.length;++h)p[h]=vt(k[h].slice(k[h].indexOf('"')+1));var T=u.match(uI);T&&wI(o,T,n);var S=u.match(pI);if(S&&(o["!margins"]=_I(Ie(S[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ge(l)),t.sheetRows>0&&o["!ref"]){var x=vt(o["!ref"]);t.sheetRows<=+x.e.r&&(x.e.r=t.sheetRows-1,x.e.r>l.e.r&&(x.e.r=l.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>l.e.c&&(x.e.c=l.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ge(x))}return _.length>0&&(o["!cols"]=_),p.length>0&&(o["!merges"]=p),o}function q0(e,t,r,n){var a=Ie(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ze(tt(a.codeName)))}function yI(e,t,r,n,a){q0(e.slice(0,e.indexOf(">")),r,n,a)}function wI(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Ie(tt(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Ze(s.location))):(s.Target="#"+Ze(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=vt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=je({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function _I(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function kI(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ie(t[n],!0);a.hidden&&(a.hidden=st(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,X0(a.width)),gi(a);s<=i;)e[s++]=Ht(a)}}function xI(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var EI=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function TI(e,t){t.Views||(t.Views=[{}]),(e.match(EI)||[]).forEach(function(r,n){var a=Ie(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),st(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var SI=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Xo("v"),i=Xo("f");return function(l,c,u,f,d,h){for(var v=0,g="",_=[],w=[],y=0,p=0,k=0,T="",S,x,D=0,I=0,z,V,F=0,q=0,ae=Array.isArray(h.CellXf),se,ge=[],le=[],oe=Array.isArray(c),j=[],fe={},ye=!1,O=!!u.sheetStubs,W=l.split(t),U=0,M=W.length;U!=M;++U){g=W[U].trim();var Q=g.length;if(Q!==0){var pe=0;e:for(v=0;v<Q;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(u&&u.cellStyles){if(x=Ie(g.slice(pe,v),!0),D=x.r!=null?parseInt(x.r,10):D+1,I=-1,u.sheetRows&&u.sheetRows<D)continue;fe={},ye=!1,x.ht&&(ye=!0,fe.hpt=parseFloat(x.ht),fe.hpx=Qo(fe.hpt)),x.hidden=="1"&&(ye=!0,fe.hidden=!0),x.outlineLevel!=null&&(ye=!0,fe.level=+x.outlineLevel),ye&&(j[D-1]=fe)}break;case"<":pe=v;break}if(pe>=v)break;if(x=Ie(g.slice(pe,v),!0),D=x.r!=null?parseInt(x.r,10):D+1,I=-1,!(u.sheetRows&&u.sheetRows<D)){f.s.r>D-1&&(f.s.r=D-1),f.e.r<D-1&&(f.e.r=D-1),u&&u.cellStyles&&(fe={},ye=!1,x.ht&&(ye=!0,fe.hpt=parseFloat(x.ht),fe.hpx=Qo(fe.hpt)),x.hidden=="1"&&(ye=!0,fe.hidden=!0),x.outlineLevel!=null&&(ye=!0,fe.level=+x.outlineLevel),ye&&(j[D-1]=fe)),_=g.slice(v).split(e);for(var ke=0;ke!=_.length&&_[ke].trim().charAt(0)=="<";++ke);for(_=_.slice(ke),v=0;v!=_.length;++v)if(g=_[v].trim(),g.length!==0){if(w=g.match(r),y=v,p=0,k=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,w!=null&&w.length===2){for(y=0,T=w[1],p=0;p!=T.length&&!((k=T.charCodeAt(p)-64)<1||k>26);++p)y=26*y+k;--y,I=y}else++I;for(p=0;p!=g.length&&g.charCodeAt(p)!==62;++p);if(++p,x=Ie(g.slice(0,p),!0),x.r||(x.r=je({r:D-1,c:I})),T=g.slice(p),S={t:""},(w=T.match(s))!=null&&w[1]!==""&&(S.v=Ze(w[1])),u.cellFormula){if((w=T.match(i))!=null&&w[1]!==""){if(S.f=Ze(tt(w[1])).replace(/\r\n/g,`
`),u.xlfn||(S.f=sg(S.f)),w[0].indexOf('t="array"')>-1)S.F=(T.match(a)||[])[1],S.F.indexOf(":")>-1&&ge.push([vt(S.F),S.F]);else if(w[0].indexOf('t="shared"')>-1){V=Ie(w[0]);var ce=Ze(tt(w[1]));u.xlfn||(ce=sg(ce)),le[parseInt(V.si,10)]=[V,ce,x.r]}}else(w=T.match(/<f[^>]*\/>/))&&(V=Ie(w[0]),le[V.si]&&(S.f=F8(le[V.si][1],le[V.si][2],x.r)));var ne=hr(x.r);for(p=0;p<ge.length;++p)ne.r>=ge[p][0].s.r&&ne.r<=ge[p][0].e.r&&ne.c>=ge[p][0].s.c&&ne.c<=ge[p][0].e.c&&(S.F=ge[p][1])}if(x.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(O)S.t="z";else continue;else S.t=x.t||"n";switch(f.s.c>I&&(f.s.c=I),f.e.c<I&&(f.e.c=I),S.t){case"n":if(S.v==""||S.v==null){if(!O)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!O)continue;S.t="z"}else z=Eo[parseInt(S.v,10)],S.v=z.t,S.r=z.r,u.cellHTML&&(S.h=z.h);break;case"str":S.t="s",S.v=S.v!=null?tt(S.v):"",u.cellHTML&&(S.h=M0(S.v));break;case"inlineStr":w=T.match(n),S.t="s",w!=null&&(z=Z0(w[1]))?(S.v=z.t,u.cellHTML&&(S.h=z.h)):S.v="";break;case"b":S.v=st(S.v);break;case"d":u.cellDates?S.v=Ut(S.v,1):(S.v=gr(Ut(S.v,1)),S.t="n");break;case"e":(!u||u.cellText!==!1)&&(S.w=S.v),S.v=Fw[S.v];break}if(F=q=0,se=null,ae&&x.s!==void 0&&(se=h.CellXf[x.s],se!=null&&(se.numFmtId!=null&&(F=se.numFmtId),u.cellStyles&&se.fillId!=null&&(q=se.fillId))),p_(S,F,q,u,d,h),u.cellDates&&ae&&S.t=="n"&&bi(Ue[F])&&(S.t="d",S.v=zu(S.v)),x.cm&&u.xlmeta){var Y=(u.xlmeta.Cell||[])[+x.cm-1];Y&&Y.type=="XLDAPR"&&(S.D=!0)}if(oe){var A=hr(x.r);c[A.r]||(c[A.r]=[]),c[A.r][A.c]=S}else c[x.r]=S}}}}j.length>0&&(c["!rows"]=j)}}();function bI(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var CI=xs;function AI(){}function NI(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=qA(e),r}function OI(e){var t=qr(e);return[t]}function RI(e){var t=ks(e);return[t]}function PI(e){var t=qr(e),r=e.read_shift(1);return[t,r,"b"]}function II(e){var t=ks(e),r=e.read_shift(1);return[t,r,"b"]}function DI(e){var t=qr(e),r=e.read_shift(1);return[t,r,"e"]}function LI(e){var t=ks(e),r=e.read_shift(1);return[t,r,"e"]}function FI(e){var t=qr(e),r=e.read_shift(4);return[t,r,"s"]}function jI(e){var t=ks(e),r=e.read_shift(4);return[t,r,"s"]}function MI(e){var t=qr(e),r=tr(e);return[t,r,"n"]}function g_(e){var t=ks(e),r=tr(e);return[t,r,"n"]}function $I(e){var t=qr(e),r=H0(e);return[t,r,"n"]}function UI(e){var t=ks(e),r=H0(e);return[t,r,"n"]}function BI(e){var t=qr(e),r=V0(e);return[t,r,"is"]}function zI(e){var t=qr(e),r=nr(e);return[t,r,"str"]}function VI(e){var t=ks(e),r=nr(e);return[t,r,"str"]}function WI(e,t,r){var n=e.l+t,a=qr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);i[3]=Qt(o,null,a,r.supbooks,r)}else e.l=n;return i}function HI(e,t,r){var n=e.l+t,a=qr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);i[3]=Qt(o,null,a,r.supbooks,r)}else e.l=n;return i}function GI(e,t,r){var n=e.l+t,a=qr(e);a.r=r["!row"];var s=tr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);i[3]=Qt(o,null,a,r.supbooks,r)}else e.l=n;return i}function KI(e,t,r){var n=e.l+t,a=qr(e);a.r=r["!row"];var s=nr(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);i[3]=Qt(o,null,a,r.supbooks,r)}else e.l=n;return i}var ZI=xs;function XI(e,t){var r=e.l+t,n=xs(e),a=W0(e),s=nr(e),i=nr(e),o=nr(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function YI(){}function qI(e,t,r){var n=e.l+t,a=Iw(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=rI(e,n-e.l,r);i[1]=o}else e.l=n;return i}function JI(e,t,r){var n=e.l+t,a=xs(e),s=[a];if(r.cellFormula){var i=aI(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var QI=["left","right","top","bottom","header","footer"];function eD(e){var t={};return QI.forEach(function(r){t[r]=tr(e)}),t}function tD(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function rD(){}function nD(){}function aD(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,d=!1,h,v,g,_,w,y,p,k,T,S=[];o.biff=12,o["!row"]=0;var x=0,D=!1,I=[],z={},V=o.supbooks||a.supbooks||[[]];if(V.sharedf=z,V.arrayf=I,V.SheetNames=a.SheetNames||a.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=V,a.Names))for(var F=0;F<a.Names.length;++F)V[0][F+1]=a.Names[F];var q=[],ae=[],se=!1;ou[16]={n:"BrtShortReal",f:g_};var ge;if(sa(e,function(j,fe,ye){if(!d)switch(ye){case 148:c=j;break;case 0:h=j,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),k=Gt(_=h.r),o["!row"]=h.r,(j.hidden||j.hpt||j.level!=null)&&(j.hpt&&(j.hpx=Qo(j.hpt)),ae[j.r]=j);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:j[2]},j[2]){case"n":v.v=j[1];break;case"s":p=Eo[j[1]],v.v=p.t,v.r=p.r;break;case"b":v.v=!!j[1];break;case"e":v.v=j[1],o.cellText!==!1&&(v.w=Es[v.v]);break;case"str":v.t="s",v.v=j[1];break;case"is":v.t="s",v.v=j[1].t;break}if((g=i.CellXf[j[0].iStyleRef])&&p_(v,g.numFmtId,null,o,s,i),w=j[0].c==-1?w+1:j[0].c,o.dense?(l[_]||(l[_]=[]),l[_][w]=v):l[It(w)+k]=v,o.cellFormula){for(D=!1,x=0;x<I.length;++x){var O=I[x];h.r>=O[0].s.r&&h.r<=O[0].e.r&&w>=O[0].s.c&&w<=O[0].e.c&&(v.F=Ge(O[0]),D=!0)}!D&&j.length>3&&(v.f=j[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>w&&(u.s.c=w),u.e.r<h.r&&(u.e.r=h.r),u.e.c<w&&(u.e.c=w),o.cellDates&&g&&v.t=="n"&&bi(Ue[g.numFmtId])){var W=ts(v.v);W&&(v.t="d",v.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}ge&&(ge.type=="XLDAPR"&&(v.D=!0),ge=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;v={t:"z",v:void 0},w=j[0].c==-1?w+1:j[0].c,o.dense?(l[_]||(l[_]=[]),l[_][w]=v):l[It(w)+k]=v,u.s.r>h.r&&(u.s.r=h.r),u.s.c>w&&(u.s.c=w),u.e.r<h.r&&(u.e.r=h.r),u.e.c<w&&(u.e.c=w),ge&&(ge.type=="XLDAPR"&&(v.D=!0),ge=void 0);break;case 176:S.push(j);break;case 49:ge=((o.xlmeta||{}).Cell||[])[j-1];break;case 494:var U=n["!id"][j.relId];for(U?(j.Target=U.Target,j.loc&&(j.Target+="#"+j.loc),j.Rel=U):j.relId==""&&(j.Target="#"+j.loc),_=j.rfx.s.r;_<=j.rfx.e.r;++_)for(w=j.rfx.s.c;w<=j.rfx.e.c;++w)o.dense?(l[_]||(l[_]=[]),l[_][w]||(l[_][w]={t:"z",v:void 0}),l[_][w].l=j):(y=je({c:w,r:_}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=j);break;case 426:if(!o.cellFormula)break;I.push(j),T=o.dense?l[_][w]:l[It(w)+k],T.f=Qt(j[1],u,{r:h.r,c:w},V,o),T.F=Ge(j[0]);break;case 427:if(!o.cellFormula)break;z[je(j[0].s)]=j[1],T=o.dense?l[_][w]:l[It(w)+k],T.f=Qt(j[1],u,{r:h.r,c:w},V,o);break;case 60:if(!o.cellStyles)break;for(;j.e>=j.s;)q[j.e--]={width:j.w/256,hidden:!!(j.flags&1),level:j.level},se||(se=!0,X0(j.w/256)),gi(q[j.e+1]);break;case 161:l["!autofilter"]={ref:Ge(j)};break;case 476:l["!margins"]=j;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),j.name&&(a.Sheets[r].CodeName=j.name),(j.above||j.left)&&(l["!outline"]={above:j.above,left:j.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),j.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!fe.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+ye.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ge(c||u)),o.sheetRows&&l["!ref"]){var le=vt(l["!ref"]);o.sheetRows<=+le.e.r&&(le.e.r=o.sheetRows-1,le.e.r>u.e.r&&(le.e.r=u.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>u.e.c&&(le.e.c=u.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ge(le))}return S.length>0&&(l["!merges"]=S),q.length>0&&(l["!cols"]=q),ae.length>0&&(l["!rows"]=ae),l}function sD(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=Ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function iD(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=sD(f);u.s.r=u.s.c=0,u.e.c=o,c=It(o),d[0].forEach(function(h,v){i[c+Gt(v)]={t:"n",v:h,z:d[1]},l=v}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=Ge(u)),i}function oD(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(m_);return o&&q0(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function lD(e,t){e.l+=10;var r=nr(e);return{name:r}}function cD(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return sa(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var v_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],uD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],fD=[],dD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ug(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=st(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function fg(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=st(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function y_(e){fg(e.WBProps,v_),fg(e.CalcPr,dD),ug(e.WBView,uD),ug(e.Sheets,fD),si.date1904=st(e.WBProps.date1904)}var hD="][*?/\\".split("");function pD(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hD.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var mD=/<\w+:workbook/;function gD(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(ir,function(l,c){var u=Ie(l);switch(Dn(u[0])){case"<?xml":break;case"<workbook":l.match(mD)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":v_.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=st(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=tt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ze(tt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=tt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),st(u.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=Ze(tt(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),DA.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return y_(r),r}function vD(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=th(e),r.name=nr(e),r}function yD(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?nr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function wD(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _D(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=JA(e),i=nI(e,0,r),o=W0(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function kD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],ou[16]={n:"BrtFRTArchID$",f:wD},sa(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Qt(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),y_(r),r.Names=s,r.supbooks=i,r}function xD(e,t,r){return t.slice(-4)===".bin"?kD(e,r):gD(e,r)}function ED(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?aD(e,n,r,a,s,i,o):vI(e,n,r,a,s,i,o)}function TD(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?cD(e,n,r,a,s):oD(e,n,r,a,s)}function SD(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?I8():D8()}function bD(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?R8():P8()}function CD(e,t,r,n){return t.slice(-4)===".bin"?ZR(e,r,n):zR(e,r,n)}function AD(e,t,r){return a_(e,r)}function ND(e,t,r){return t.slice(-4)===".bin"?uR(e,r):lR(e,r)}function OD(e,t,r){return t.slice(-4)===".bin"?A8(e,r):E8(e,r)}function RD(e,t,r){return t.slice(-4)===".bin"?_8(e):y8(e)}function PD(e,t,r,n){return r.slice(-4)===".bin"?k8(e,t,r,n):void 0}function ID(e,t,r){return t.slice(-4)===".bin"?g8(e,t,r):v8(e,t,r)}var w_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,__=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function en(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(w_),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(__),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function DD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(w_),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(__),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var So;function LD(e,t){var r=So[e]||Ze(e);return r==="General"?hs(t):Xr(r,t)}function FD(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=st(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ut(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ze(t)]=a}function jD(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Es[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v):e.w=hs(e.v):e.w=LD(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=So[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&bi(n)){var a=ts(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function MD(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=FR[n.Pattern]||n.Pattern)}e[t.ID]=t}function $D(e,t,r,n,a,s,i,o,l,c){var u="General",f=n.StyleID,d={};c=c||{};var h=[],v=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=st(e);break;case"String":n.t="s",n.r=Im(Ze(e)),n.v=e.indexOf("<")>-1?Ze(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ut(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ze(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Fw[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Im(t||e));break}if(jD(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=Ze(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=ai(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ai("RC:RC",a):n.ArrayRange&&(n.F=ai(n.ArrayRange,a),l.push([vt(n.F),n.F]))}else for(v=0;v<l.length;++v)a.r>=l[v][0].s.r&&a.r<=l[v][0].e.r&&a.c>=l[v][0].s.c&&a.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(h.forEach(function(_){!d.patternType&&_.patternType&&(d.patternType=_.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function UD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function $f(e,t){var r=t||{};lw();var n=qi($0(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=tt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Ht(r);return i.type="string",qo.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(rt){a.indexOf("<"+rt)>=0&&(s=!0)}),s)return XD(n,r);So={"General Number":"General","General Date":Ue[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ue[15],"Short Date":Ue[14],"Long Time":Ue[19],"Medium Time":Ue[18],"Short Time":Ue[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ue[2],Standard:Ue[4],Percent:Ue[10],Scientific:Ue[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],d=r.dense?[]:{},h="",v={},g={},_=en('<Data ss:Type="String">'),w=0,y=0,p=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},S={},x="",D=0,I=[],z={},V={},F=0,q=[],ae=[],se={},ge=[],le,oe=!1,j=[],fe=[],ye={},O=0,W=0,U={Sheets:[],WBProps:{date1904:!1}},M={};Yo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";o=Yo.exec(n);)switch(o[3]=(Q=o[3]).toLowerCase()){case"data":if(Q=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?$D(n.slice(w,o.index),x,_,l[l.length-1][0]=="comment"?se:v,{c:y,r:p},T,ge[y],g,j,r):(x="",_=en(o[0]),w=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ae.length>0&&(v.c=ae),(!r.sheetRows||r.sheetRows>p)&&v.v!==void 0&&(r.dense?(d[p]||(d[p]=[]),d[p][y]=v):d[It(y)+Gt(p)]=v),v.HRef&&(v.l={Target:Ze(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(O=y+(parseInt(v.MergeAcross,10)|0),W=p+(parseInt(v.MergeDown,10)|0),I.push({s:{c:y,r:p},e:{c:O,r:W}})),!r.sheetStubs)v.MergeAcross?y=O+1:++y;else if(v.MergeAcross||v.MergeDown){for(var pe=y;pe<=O;++pe)for(var ke=p;ke<=W;++ke)(pe>y||ke>p)&&(r.dense?(d[ke]||(d[ke]=[]),d[ke][pe]={t:"z"}):d[It(pe)+Gt(ke)]={t:"z"});y=O+1}else++y;else v=DD(o[0]),v.Index&&(y=+v.Index-1),y<k.s.c&&(k.s.c=y),y>k.e.c&&(k.e.c=y),o[0].slice(-2)==="/>"&&++y,ae=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(p<k.s.r&&(k.s.r=p),p>k.e.r&&(k.e.r=p),o[0].slice(-2)==="/>"&&(g=en(o[0]),g.Index&&(p=+g.Index-1)),y=0,++p):(g=en(o[0]),g.Index&&(p=+g.Index-1),ye={},(g.AutoFitHeight=="0"||g.Height)&&(ye.hpx=parseInt(g.Height,10),ye.hpt=n_(ye.hpx),fe[p]=ye),g.Hidden=="1"&&(ye.hidden=!0,fe[p]=ye));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(h),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(d["!ref"]=Ge(k),r.sheetRows&&r.sheetRows<=k.e.r&&(d["!fullref"]=d["!ref"],k.e.r=r.sheetRows-1,d["!ref"]=Ge(k))),I.length&&(d["!merges"]=I),ge.length>0&&(d["!cols"]=ge),fe.length>0&&(d["!rows"]=fe),u[h]=d}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=y=0,l.push([o[3],!1]),c=en(o[0]),h=Ze(c.Name),d=r.dense?[]:{},I=[],j=[],fe=[],M={name:h,Hidden:0},U.Sheets.push(M);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ge=[],oe=!1}break;case"style":o[1]==="/"?MD(T,S,r):S=en(o[0]);break;case"numberformat":S.nf=Ze(en(o[0]).Format||"General"),So[S.nf]&&(S.nf=So[S.nf]);for(var ce=0;ce!=392&&Ue[ce]!=S.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(Ue[ce]==null){as(S.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(le=en(o[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!oe&&le.wpx>10){oe=!0,dr=t_;for(var ne=0;ne<ge.length;++ne)ge[ne]&&gi(ge[ne])}oe&&gi(le),ge[le.Index-1||ge.length]=le;for(var Y=0;Y<+le.Span;++Y)ge[ge.length]=Ht(le);break;case"namedrange":if(o[1]==="/")break;U.Names||(U.Names=[]);var A=Ie(o[0]),Pe={Name:A.Name,Ref:ai(A.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Pe.Sheet=U.Sheets.length-1),U.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x+=n.slice(D,o.index):D=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=en(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?EN(z,Q,n.slice(F,o.index)):F=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));UD(se),ae.push(se)}else l.push([o[3],!1]),c=en(o[0]),se={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Re=en(o[0]);d["!autofilter"]={ref:ai(Re.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return vg(n,r);var Ne=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ne=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ne=!1}break;case"excelworkbook":switch(o[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ne=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ne=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(F,o.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else F=o.index+o[0].length;break;case"header":d["!margins"]||To(d["!margins"]={},"xlml"),isNaN(+Ie(o[0]).Margin)||(d["!margins"].header=+Ie(o[0]).Margin);break;case"footer":d["!margins"]||To(d["!margins"]={},"xlml"),isNaN(+Ie(o[0]).Margin)||(d["!margins"].footer=+Ie(o[0]).Margin);break;case"pagemargins":var De=Ie(o[0]);d["!margins"]||To(d["!margins"]={},"xlml"),isNaN(+De.Top)||(d["!margins"].top=+De.Top),isNaN(+De.Left)||(d["!margins"].left=+De.Left),isNaN(+De.Right)||(d["!margins"].right=+De.Right),isNaN(+De.Bottom)||(d["!margins"].bottom=+De.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ne=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ne=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ne=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ne=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ne=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ne=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ne=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ne=!1}break;case"smarttags":break;default:Ne=!1;break}if(Ne||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?FD(V,Q,q,n.slice(F,o.index)):(q=o,F=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var we={};return!r.bookSheets&&!r.bookProps&&(we.Sheets=u),we.SheetNames=f,we.Workbook=U,we.SSF=Ht(Ue),we.Props=z,we.Custprops=V,we}function sh(e,t){switch(ep(t=t||{}),t.type||"base64"){case"base64":return $f(Lr(e),t);case"binary":case"buffer":case"file":return $f(e,t);case"array":return $f(_s(e),t)}}function BD(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=tN(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=rN(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var zD=[60,1084,2066,2165,2175];function VD(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Gn(r,r.l),c=ih[l],u=0;c!=null&&zD.indexOf(l)>-1;)s=Gn(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),i.push(o),r.l+=4+s,c=ih[l=Gn(r,r.l)];var f=va(i);Vt(f,0);var d=0;f.lens=[];for(var h=0;h<i.length;++h)f.lens.push(d),d+=i[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function _n(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ue[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Es[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v):e.w=hs(e.v):e.w=Xr(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&bi(Ue[n]||String(n))){var a=ts(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function tc(e,t,r){return{v:e,ixfe:t,t:r}}function WD(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",u={},f,d="",h,v,g,_,w={},y=[],p,k,T=[],S=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},I=function(re){return re<8?ss[re]:re<64&&S[re-8]||ss[re]},z=function(re,Ee,Oe){var Xe=Ee.XF.data;if(!(!Xe||!Xe.patternType||!Oe||!Oe.cellStyles)){Ee.s={},Ee.s.patternType=Xe.patternType;var Zt;(Zt=Jo(I(Xe.icvFore)))&&(Ee.s.fgColor={rgb:Zt}),(Zt=Jo(I(Xe.icvBack)))&&(Ee.s.bgColor={rgb:Zt})}},V=function(re,Ee,Oe){if(!(ye>1)&&!(Oe.sheetRows&&re.r>=Oe.sheetRows)){if(Oe.cellStyles&&Ee.XF&&Ee.XF.data&&z(re,Ee,Oe),delete Ee.ixfe,delete Ee.XF,f=re,d=je(re),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),re.r<i.s.r&&(i.s.r=re.r),re.c<i.s.c&&(i.s.c=re.c),re.r+1>i.e.r&&(i.e.r=re.r+1),re.c+1>i.e.c&&(i.e.c=re.c+1),Oe.cellFormula&&Ee.f){for(var Xe=0;Xe<y.length;++Xe)if(!(y[Xe][0].s.c>re.c||y[Xe][0].s.r>re.r)&&!(y[Xe][0].e.c<re.c||y[Xe][0].e.r<re.r)){Ee.F=Ge(y[Xe][0]),(y[Xe][0].s.c!=re.c||y[Xe][0].s.r!=re.r)&&delete Ee.f,Ee.f&&(Ee.f=""+Qt(y[Xe][1],i,re,j,F));break}}Oe.dense?(a[re.r]||(a[re.r]=[]),a[re.r][re.c]=Ee):a[d]=Ee}},F={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var q,ae=[],se=[],ge=[],le=[],oe=!1,j=[];j.SheetNames=F.snames,j.sharedf=F.sharedf,j.arrayf=F.arrayf,j.names=[],j.XTI=[];var fe=0,ye=0,O=0,W=[],U=[],M;F.codepage=1200,fn(1200);for(var Q=!1;e.l<e.length-1;){var pe=e.l,ke=e.read_shift(2);if(ke===0&&fe===10)break;var ce=e.l===e.length?0:e.read_shift(2),ne=ih[ke];if(ne&&ne.f){if(t.bookSheets&&fe===133&&ke!==133)break;if(fe=ke,ne.r===2||ne.r==12){var Y=e.read_shift(2);if(ce-=2,!F.enc&&Y!==ke&&((Y&255)<<8|Y>>8)!==ke)throw new Error("rt mismatch: "+Y+"!="+ke);ne.r==12&&(e.l+=10,ce-=10)}var A={};if(ke===10?A=ne.f(e,ce,F):A=VD(ke,ne,e,ce,F),ye==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(ke){case 34:r.opts.Date1904=x.WBProps.date1904=A;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=A,!t.password)throw new Error("File is password-protected");if(A.valid==null)throw new Error("Encryption scheme unsupported");if(!A.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=A;break;case 66:var Pe=Number(A);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}fn(F.codepage=Pe),Q=!0;break;case 317:F.rrtabid=A;break;case 25:F.winlocked=A;break;case 439:r.opts.RefreshAll=A;break;case 12:r.opts.CalcCount=A;break;case 16:r.opts.CalcDelta=A;break;case 17:r.opts.CalcIter=A;break;case 13:r.opts.CalcMode=A;break;case 14:r.opts.CalcPrecision=A;break;case 95:r.opts.CalcSaveRecalc=A;break;case 15:F.CalcRefMode=A;break;case 2211:r.opts.FullCalc=A;break;case 129:A.fDialog&&(a["!type"]="dialog"),A.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),A.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:T.push(A);break;case 430:j.push([A]),j[j.length-1].XTI=[];break;case 35:case 547:j[j.length-1].push(A);break;case 24:case 536:M={Name:A.Name,Ref:Qt(A.rgce,i,null,j,F)},A.itab>0&&(M.Sheet=A.itab-1),j.names.push(M),j[0]||(j[0]=[],j[0].XTI=[]),j[j.length-1].push(A),A.Name=="_xlnm._FilterDatabase"&&A.itab>0&&A.rgce&&A.rgce[0]&&A.rgce[0][0]&&A.rgce[0][0][0]=="PtgArea3d"&&(U[A.itab-1]={ref:Ge(A.rgce[0][0][1][2])});break;case 22:F.ExternCount=A;break;case 23:j.length==0&&(j[0]=[],j[0].XTI=[]),j[j.length-1].XTI=j[j.length-1].XTI.concat(A),j.XTI=j.XTI.concat(A);break;case 2196:if(F.biff<8)break;M!=null&&(M.Comment=A[1]);break;case 18:a["!protect"]=A;break;case 19:A!==0&&F.WTF&&console.error("Password verifier: "+A);break;case 133:s[A.pos]=A,F.snames.push(A.name);break;case 10:{if(--ye)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ge(i),t.sheetRows&&t.sheetRows<=i.e.r){var Re=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ge(i),i.e.r=Re}i.e.r++,i.e.c++}ae.length>0&&(a["!merges"]=ae),se.length>0&&(a["!objects"]=se),ge.length>0&&(a["!cols"]=ge),le.length>0&&(a["!rows"]=le),x.Sheets.push(D)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[A.BIFFVer]||8),F.biffguess=A.BIFFVer==0,A.BIFFVer==0&&A.dt==4096&&(F.biff=5,Q=!0,fn(F.codepage=28591)),F.biff==8&&A.BIFFVer==0&&A.dt==16&&(F.biff=2),ye++)break;if(a=t.dense?[]:{},F.biff<8&&!Q&&(Q=!0,fn(F.codepage=t.codepage||1252)),F.biff<5||A.BIFFVer==0&&A.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ne={pos:e.l-ce,name:c};s[Ne.pos]=Ne,F.snames.push(c)}else c=(s[pe]||{name:""}).name;A.dt==32&&(a["!type"]="chart"),A.dt==64&&(a["!type"]="macro"),ae=[],se=[],F.arrayf=y=[],ge=[],le=[],oe=!1,D={Hidden:(s[pe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[A.r]||[])[A.c]:a[je({c:A.c,r:A.r})])&&++A.c,p={ixfe:A.ixfe,XF:T[A.ixfe]||{},v:A.val,t:"n"},O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V({c:A.c,r:A.r},p,t);break;case 5:case 517:p={ixfe:A.ixfe,XF:T[A.ixfe],v:A.val,t:A.t},O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V({c:A.c,r:A.r},p,t);break;case 638:p={ixfe:A.ixfe,XF:T[A.ixfe],v:A.rknum,t:"n"},O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V({c:A.c,r:A.r},p,t);break;case 189:for(var De=A.c;De<=A.C;++De){var we=A.rkrec[De-A.c][0];p={ixfe:we,XF:T[we],v:A.rkrec[De-A.c][1],t:"n"},O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V({c:De,r:A.r},p,t)}break;case 6:case 518:case 1030:{if(A.val=="String"){o=A;break}if(p=tc(A.val,A.cell.ixfe,A.tt),p.XF=T[p.ixfe],t.cellFormula){var rt=A.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var kt=rt[0][0][1][0],L=rt[0][0][1][1],H=je({r:kt,c:L});w[H]?p.f=""+Qt(A.formula,i,A.cell,j,F):p.F=((t.dense?(a[kt]||[])[L]:a[H])||{}).F}else p.f=""+Qt(A.formula,i,A.cell,j,F)}O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V(A.cell,p,t),o=A}break;case 7:case 519:if(o)o.val=A,p=tc(A,o.cell.ixfe,"s"),p.XF=T[p.ixfe],t.cellFormula&&(p.f=""+Qt(o.formula,i,o.cell,j,F)),O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V(o.cell,p,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(A);var J=je(A[0].s);if(h=t.dense?(a[A[0].s.r]||[])[A[0].s.c]:a[J],t.cellFormula&&h){if(!o||!J||!h)break;h.f=""+Qt(A[1],i,A[0],j,F),h.F=Ge(A[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;w[je(o.cell)]=A[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[je(o.cell)],(h||{}).f=""+Qt(A[0],i,f,j,F)}}break;case 253:p=tc(l[A.isst].t,A.ixfe,"s"),l[A.isst].h&&(p.h=l[A.isst].h),p.XF=T[p.ixfe],O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V({c:A.c,r:A.r},p,t);break;case 513:t.sheetStubs&&(p={ixfe:A.ixfe,XF:T[A.ixfe],t:"z"},O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V({c:A.c,r:A.r},p,t));break;case 190:if(t.sheetStubs)for(var _e=A.c;_e<=A.C;++_e){var me=A.ixfe[_e-A.c];p={ixfe:me,XF:T[me],t:"z"},O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V({c:_e,r:A.r},p,t)}break;case 214:case 516:case 4:p=tc(A.val,A.ixfe,"s"),p.XF=T[p.ixfe],O>0&&(p.z=W[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),V({c:A.c,r:A.r},p,t);break;case 0:case 512:ye===1&&(i=A);break;case 252:l=A;break;case 1054:if(F.biff==4){W[O++]=A[1];for(var ue=0;ue<O+163&&Ue[ue]!=A[1];++ue);ue>=163&&as(A[1],O+163)}else as(A[1],A[0]);break;case 30:{W[O++]=A;for(var Se=0;Se<O+163&&Ue[Se]!=A;++Se);Se>=163&&as(A,O+163)}break;case 229:ae=ae.concat(A);break;case 93:se[A.cmo[0]]=F.lastobj=A;break;case 438:F.lastobj.TxO=A;break;case 127:F.lastobj.ImData=A;break;case 440:for(_=A[0].s.r;_<=A[0].e.r;++_)for(g=A[0].s.c;g<=A[0].e.c;++g)h=t.dense?(a[_]||[])[g]:a[je({c:g,r:_})],h&&(h.l=A[1]);break;case 2048:for(_=A[0].s.r;_<=A[0].e.r;++_)for(g=A[0].s.c;g<=A[0].e.c;++g)h=t.dense?(a[_]||[])[g]:a[je({c:g,r:_})],h&&h.l&&(h.l.Tooltip=A[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;h=t.dense?(a[A[0].r]||[])[A[0].c]:a[je(A[0])];var Be=se[A[2]];h||(t.dense?(a[A[0].r]||(a[A[0].r]=[]),h=a[A[0].r][A[0].c]={t:"z"}):h=a[je(A[0])]={t:"z"},i.e.r=Math.max(i.e.r,A[0].r),i.s.r=Math.min(i.s.r,A[0].r),i.e.c=Math.max(i.e.c,A[0].c),i.s.c=Math.min(i.s.c,A[0].c)),h.c||(h.c=[]),v={a:A[1],t:Be.TxO.t},h.c.push(v)}break;case 2173:d8(T[A.ixfe],A.ext);break;case 125:{if(!F.cellStyles)break;for(;A.e>=A.s;)ge[A.e--]={width:A.w/256,level:A.level||0,hidden:!!(A.flags&1)},oe||(oe=!0,X0(A.w/256)),gi(ge[A.e+1])}break;case 520:{var Fe={};A.level!=null&&(le[A.r]=Fe,Fe.level=A.level),A.hidden&&(le[A.r]=Fe,Fe.hidden=!0),A.hpt&&(le[A.r]=Fe,Fe.hpt=A.hpt,Fe.hpx=Qo(A.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||To(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=A;break;case 161:a["!margins"]||To(a["!margins"]={}),a["!margins"].header=A.header,a["!margins"].footer=A.footer;break;case 574:A.RTL&&(x.Views[0].RTL=!0);break;case 146:S=A;break;case 2198:q=A;break;case 140:k=A;break;case 442:c?D.CodeName=A||D.name:x.WBProps.CodeName=A||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),e.l+=ce}return r.SheetNames=Rn(s).sort(function(te,re){return Number(te)-Number(re)}).map(function(te){return s[te].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&U.forEach(function(te,re){r.Sheets[r.SheetNames[re]]["!autofilter"]=te}),r.Strings=l,r.SSF=Ht(Ue),F.enc&&(r.Encryption=F.enc),q&&(r.Themes=q),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),j.names.length>0&&(x.Names=j.names),r.Workbook=x,r}var dg={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function HD(e,t,r){var n=He.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Xm(n,lN,dg.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=He.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Xm(i,cN,dg.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(Mw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function k_(e,t){t||(t={}),ep(t),Y2(),t.codepage&&P0(t.codepage);var r,n;if(e.FullPaths){if(He.find(e,"/encryption"))throw new Error("File is password-protected");r=He.find(e,"!CompObj"),n=He.find(e,"/Workbook")||He.find(e,"/Book")}else{switch(t.type){case"base64":e=un(Lr(e));break;case"binary":e=un(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Vt(e,0),n={content:e}}var a,s;if(r&&BD(r),t.bookProps&&!t.bookSheets)a={};else{var i=We?"buffer":"array";if(n&&n.content)a=WD(n.content,t);else if((s=He.find(e,"PerfectOffice_MAIN"))&&s.content)a=xo.to_workbook(s.content,(t.type=i,t));else if((s=He.find(e,"NativeContent_MAIN"))&&s.content)a=xo.to_workbook(s.content,(t.type=i,t));else throw(s=He.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&He.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=O8(e))}var o={};return e.FullPaths&&HD(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var ou={0:{f:bI},1:{f:OI},2:{f:$I},3:{f:DI},4:{f:PI},5:{f:MI},6:{f:zI},7:{f:FI},8:{f:KI},9:{f:GI},10:{f:WI},11:{f:HI},12:{f:RI},13:{f:UI},14:{f:LI},15:{f:II},16:{f:g_},17:{f:VI},18:{f:jI},19:{f:V0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_D},40:{},42:{},43:{f:WR},44:{f:VR},45:{f:HR},46:{f:KR},47:{f:GR},48:{},49:{f:ZA},50:{},51:{f:p8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Yw},62:{f:BI},63:{f:w8},64:{f:rD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:sr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:tD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:NI},148:{f:CI,p:16},151:{f:YI},152:{},153:{f:yD},154:{},155:{},156:{f:vD},157:{},158:{},159:{T:1,f:cR},160:{T:-1},161:{T:1,f:xs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ZI},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:h8},336:{T:-1},337:{f:m8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:th},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Xw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:qI},427:{f:JI},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:eD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:AI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XI},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:th},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:C8},633:{T:1},634:{T:-1},635:{T:1,f:b8},636:{T:-1},637:{f:YA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:nD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ih={6:{f:jf},10:{f:la},12:{f:St},13:{f:St},14:{f:yt},15:{f:yt},16:{f:tr},17:{f:yt},18:{f:yt},19:{f:St},20:{f:Qm},21:{f:Qm},23:{f:Xw},24:{f:tg},25:{f:yt},26:{},27:{},28:{f:TO},29:{},34:{f:yt},35:{f:eg},38:{f:tr},39:{f:tr},40:{f:tr},41:{f:tr},42:{f:yt},43:{f:yt},47:{f:AR},49:{f:sO},51:{f:St},60:{},61:{f:rO},64:{f:yt},65:{f:aO},66:{f:St},77:{},80:{},81:{},82:{},85:{f:St},89:{},90:{},91:{},92:{f:ZN},93:{f:bO},94:{},95:{f:yt},96:{},97:{},99:{f:yt},125:{f:Yw},128:{f:mO},129:{f:XN},130:{f:St},131:{f:yt},132:{f:yt},133:{f:YN},134:{},140:{f:PO},141:{f:St},144:{},146:{f:DO},151:{},152:{},153:{},154:{},155:{},156:{f:St},157:{},158:{},160:{f:$O},161:{f:FO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:fO},190:{f:dO},193:{f:la},197:{},198:{},199:{},200:{},201:{},202:{f:yt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:St},220:{},221:{f:yt},222:{},224:{f:pO},225:{f:KN},226:{f:la},227:{},229:{f:SO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:qN},253:{f:iO},255:{f:JN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Vw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yt},353:{f:la},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vO},431:{f:yt},432:{},433:{},434:{},437:{},438:{f:NO},439:{f:yt},440:{f:OO},441:{},442:{f:gl},443:{},444:{f:St},445:{},446:{},448:{f:la},449:{f:tO,r:2},450:{f:la},512:{f:qm},513:{f:MO},515:{f:gO},516:{f:oO},517:{f:Jm},519:{f:UO},520:{f:QN},523:{},545:{f:rg},549:{f:Ym},566:{},574:{f:nO},638:{f:uO},659:{},1048:{},1054:{f:lO},1084:{},1212:{f:kO},2048:{f:RO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jl},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:la},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:LO,r:12},2173:{f:f8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_O,r:12},2197:{},2198:{f:s8,r:12},2199:{},2200:{},2201:{},2202:{f:xO,r:12},2203:{f:la},2204:{},2205:{},2206:{},2207:{},2211:{f:eO},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:St},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:IO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:qm},1:{},2:{f:WO},3:{f:VO},4:{f:zO},5:{f:Jm},7:{f:HO},8:{},9:{f:Jl},11:{},22:{f:St},30:{f:cO},31:{},32:{},33:{f:rg},36:{},37:{f:Ym},50:{f:GO},62:{},52:{},67:{},68:{f:St},69:{},86:{},126:{},127:{f:BO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:KO},223:{},234:{},354:{},421:{},518:{f:jf},521:{f:Jl},536:{f:tg},547:{f:eg},561:{},579:{},1030:{f:jf},1033:{f:Jl},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function tn(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Ow(r)&&e.push(r)}}function hg(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=gA(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<l.length;++i){var g=l[i].trim(),_=g.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(_!="<td"&&_!="<th")){var w=g.split(/<\/t[dh]>/i);for(o=0;o<w.length;++o){var y=w[o].trim();if(y.match(/<t[dh]/i)){for(var p=y,k=0;p.charAt(0)=="<"&&(k=p.indexOf(">"))>-1;)p=p.slice(k+1);for(var T=0;T<v.length;++T){var S=v[T];S.s.c==u&&S.s.r<c&&c<=S.e.r&&(u=S.e.c+1,T=-1)}var x=Ie(y.slice(0,y.indexOf(">")));d=x.colspan?+x.colspan:1,((f=+x.rowspan)>1||d>1)&&v.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+d-1}});var D=x.t||x["data-t"]||"";if(!p.length){u+=d;continue}if(p=vw(p),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!p.length){u+=d;continue}var I={t:"s",v:p};r.raw||!p.trim().length||D=="s"||(p==="TRUE"?I={t:"b",v:!0}:p==="FALSE"?I={t:"b",v:!1}:isNaN(mn(p))?isNaN(mi(p).getDate())||(I={t:"d",v:Ut(p)},r.cellDates||(I={t:"n",v:gr(I.v)}),I.z=r.dateNF||Ue[14]):I={t:"n",v:mn(p)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=I):n[je({r:c,c:u})]=I,u+=d}}}}return n["!ref"]=Ge(h),v.length&&(n["!merges"]=v),n}function GD(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=je({r,c:i}),f=n.dense?(e[r]||[])[i]:e[u],d=f&&f.v!=null&&(f.h||M0(f.w||(na(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+u,s.push(PA("td",d,h))}}var v="<tr>";return v+s.join("")+"</tr>"}var KD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ZD="</body></html>";function XD(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return za(hg(r[0],t),t);var n=rp();return r.forEach(function(a,s){np(n,hg(a,t),"Sheet"+(s+1))}),n}function YD(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function qD(e,t){var r=t||{},n=r.header!=null?r.header:KD,a=r.footer!=null?r.footer:ZD,s=[n],i=Ci(e["!ref"]);r.dense=Array.isArray(e),s.push(YD(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(GD(e,i,o,r));return s.push("</table>"+a),s.join("")}function x_(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?hr(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=Ci(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],d=0,h=e["!rows"]||(e["!rows"]=[]),v=0,g=0,_=0,w=0,y=0,p=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&g<l;++v){var k=o[v];if(pg(k)){if(n.display)continue;h[g]={hidden:!0}}var T=k.children;for(_=w=0;_<T.length;++_){var S=T[_];if(!(n.display&&pg(S))){var x=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):vw(S.innerHTML),D=S.getAttribute("data-z")||S.getAttribute("z");for(d=0;d<f.length;++d){var I=f[d];I.s.c==w+s&&I.s.r<g+a&&g+a<=I.e.r&&(w=I.e.c+1-s,d=-1)}p=+S.getAttribute("colspan")||1,((y=+S.getAttribute("rowspan")||1)>1||p>1)&&f.push({s:{r:g+a,c:w+s},e:{r:g+a+(y||1)-1,c:w+s+(p||1)-1}});var z={t:"s",v:x},V=S.getAttribute("data-t")||S.getAttribute("t")||"";x!=null&&(x.length==0?z.t=V||"z":n.raw||x.trim().length==0||V=="s"||(x==="TRUE"?z={t:"b",v:!0}:x==="FALSE"?z={t:"b",v:!1}:isNaN(mn(x))?isNaN(mi(x).getDate())||(z={t:"d",v:Ut(x)},n.cellDates||(z={t:"n",v:gr(z.v)}),z.z=n.dateNF||Ue[14]):z={t:"n",v:mn(x)})),z.z===void 0&&D!=null&&(z.z=D);var F="",q=S.getElementsByTagName("A");if(q&&q.length)for(var ae=0;ae<q.length&&!(q[ae].hasAttribute("href")&&(F=q[ae].getAttribute("href"),F.charAt(0)!="#"));++ae);F&&F.charAt(0)!="#"&&(z.l={Target:F}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][w+s]=z):e[je({c:w+s,r:g+a})]=z,c.e.c<w+s&&(c.e.c=w+s),w+=p}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,g-1+a),e["!ref"]=Ge(c),g>=l&&(e["!fullref"]=Ge((c.e.r=o.length-v+g-1+a,c))),e}function E_(e,t){var r=t||{},n=r.dense?[]:{};return x_(n,e,t)}function JD(e,t){return za(E_(e,t),t)}function pg(e){var t="",r=QD(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function QD(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function e7(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ze(t.replace(/<[^>]*>/g,""));return[r]}var mg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function T_(e,t){var r=t||{},n=$0(e),a=[],s,i,o={name:""},l="",c=0,u,f,d={},h=[],v=r.dense?[]:{},g,_,w={value:""},y="",p=0,k=[],T=-1,S=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,I={},z=[],V={},F=0,q=0,ae=[],se=1,ge=1,le=[],oe={Names:[]},j={},fe=["",""],ye=[],O={},W="",U=0,M=!1,Q=!1,pe=0;for(Yo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Yo.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(x.e.c>=x.s.c&&x.e.r>=x.s.r?v["!ref"]=Ge(x):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=x.e.r&&(v["!fullref"]=v["!ref"],x.e.r=r.sheetRows-1,v["!ref"]=Ge(x)),z.length&&(v["!merges"]=z),ae.length&&(v["!rows"]=ae),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),d[u.name]=v,Q=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Ie(g[0],!1),T=S=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,v=r.dense?[]:{},z=[],ae=[],Q=!0);break;case"table-row-group":g[1]==="/"?--D:++D;break;case"table-row":case"行":if(g[1]==="/"){T+=se,se=1;break}if(f=Ie(g[0],!1),f.行号?T=f.行号-1:T==-1&&(T=0),se=+f["number-rows-repeated"]||1,se<10)for(pe=0;pe<se;++pe)D>0&&(ae[T+pe]={level:D});S=-1;break;case"covered-table-cell":g[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(v[T]||(v[T]=[]),v[T][S]={t:"z"}):v[je({r:T,c:S})]={t:"z"}),y="",k=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++S,w=Ie(g[0],!1),ge=parseInt(w["number-columns-repeated"]||"1",10),_={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(_.f=cg(Ze(w.formula))),(w.数据类型||w["value-type"])=="string"&&(_.t="s",_.v=Ze(w["string-value"]||""),r.dense?(v[T]||(v[T]=[]),v[T][S]=_):v[je({r:T,c:S})]=_),S+=ge-1;else if(g[1]!=="/"){++S,y="",p=0,k=[],ge=1;var ke=se?T+se-1:T;if(S>x.e.c&&(x.e.c=S),S<x.s.c&&(x.s.c=S),T<x.s.r&&(x.s.r=T),ke>x.e.r&&(x.e.r=ke),w=Ie(g[0],!1),ye=[],O={},_={t:w.数据类型||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=Ze(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(F=parseInt(w["number-matrix-rows-spanned"],10)||0,q=parseInt(w["number-matrix-columns-spanned"],10)||0,V={s:{r:T,c:S},e:{r:T+F-1,c:S+q-1}},_.F=Ge(V),le.push([V,_.F])),w.formula)_.f=cg(w.formula);else for(pe=0;pe<le.length;++pe)T>=le[pe][0].s.r&&T<=le[pe][0].e.r&&S>=le[pe][0].s.c&&S<=le[pe][0].e.c&&(_.F=le[pe][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(F=parseInt(w["number-rows-spanned"],10)||0,q=parseInt(w["number-columns-spanned"],10)||0,V={s:{r:T,c:S},e:{r:T+F-1,c:S+q-1}},z.push(V)),w["number-columns-repeated"]&&(ge=parseInt(w["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=st(w["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(w.value);break;case"percentage":_.t="n",_.v=parseFloat(w.value);break;case"currency":_.t="n",_.v=parseFloat(w.value);break;case"date":_.t="d",_.v=Ut(w["date-value"]),r.cellDates||(_.t="n",_.v=gr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=hA(w["time-value"])/86400,r.cellDates&&(_.t="d",_.v=zu(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(w.数据数值);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",w["string-value"]!=null&&(y=Ze(w["string-value"]),k=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(M=!1,_.t==="s"&&(_.v=y||"",k.length&&(_.R=k),M=p==0),j.Target&&(_.l=j),ye.length>0&&(_.c=ye,ye=[]),y&&r.cellText!==!1&&(_.w=y),M&&(_.t="z",delete _.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var ce=0;ce<se;++ce){if(ge=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(v[T+ce]||(v[T+ce]=[]),v[T+ce][S]=ce==0?_:Ht(_);--ge>0;)v[T+ce][S+ge]=Ht(_);else for(v[je({r:T+ce,c:S})]=_;--ge>0;)v[je({r:T+ce,c:S+ge})]=Ht(_);x.e.c<=S&&(x.e.c=S)}ge=parseInt(w["number-columns-repeated"]||"1",10),S+=ge-1,ge=0,_={},y="",k=[]}j={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s;O.t=y,k.length&&(O.R=k),O.a=W,ye.push(O)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);W="",U=0,y="",p=0,k=[];break;case"creator":g[1]==="/"?W=n.slice(U,g.index):U=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);y="",p=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(I[o.name]=l,(s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Ie(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ie(g[0],!1),l+=mg[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ie(g[0],!1),l+=mg[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":i=Ie(g[0],!1),fe=Mf(i["cell-range-address"]);var ne={Name:i.name,Ref:fe[0]+"!"+fe[1]};Q&&(ne.Sheet=h.length),oe.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!w||!w["string-value"])){var Y=e7(n.slice(p,g.index));y=(y.length>0?y+`
`:"")+Y[0]}else Ie(g[0],!1),p=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{fe=Mf(Ie(g[0])["target-range-address"]),d[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(j=Ie(g[0],!1),!j.href)break;j.Target=Ze(j.href),delete j.href,j.Target.charAt(0)=="#"&&j.Target.indexOf(".")>-1?(fe=Mf(j.Target.slice(1)),j.Target="#"+fe[0]+"!"+fe[1]):j.Target.match(/^\.\.[\\\/]/)&&(j.Target=j.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var A={Sheets:d,SheetNames:h,Workbook:oe};return r.bookSheets&&delete A.Sheets,A}function gg(e,t){t=t||{},Ur(e,"META-INF/manifest.xml")&&gN(Tt(e,"META-INF/manifest.xml"),t);var r=Rr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=T_(tt(r),t);return Ur(e,"meta.xml")&&(n.Props=jw(Tt(e,"meta.xml"))),n}function vg(e,t){return T_(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function J0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function oh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):tt(_s(e))}function lh(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function yg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function t7(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function el(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Dt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function rr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=el(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=el(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Q0(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function r7(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=el(e,n),s=rr(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Dt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=rr(o.data),c=Dt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=Dt(s[3][0].data)>>>0>0),r.push(i)}return r}function n7(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=el(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[lh(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=lh(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function a7(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(n7(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return lh(t)}function s7(e,t,r,n){var a=J0(e),s=a.getUint32(4,!0),i=(n>1?12:8)+yg(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=yg(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function i7(e,t,r){var n=J0(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=t7(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function o7(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return s7(e,t,r,e[0]);case 5:return i7(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Oa(e){var t=rr(e);return el(t[1][0].data)}function wg(e,t){var r=rr(t.data),n=Dt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=rr(i.data),l=Dt(o[1][0].data)>>>0;switch(n){case 1:s[l]=oh(o[3][0].data);break;case 8:{var c=e[Oa(o[9][0].data)][0],u=rr(c.data),f=e[Oa(u[1][0].data)][0],d=Dt(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=rr(f.data);s[l]=h[3].map(function(v){return oh(v.data)}).join("")}break}}),s}function l7(e,t){var r,n,a,s,i,o,l,c,u,f,d,h,v,g,_=rr(e),w=Dt(_[1][0].data)>>>0,y=Dt(_[2][0].data)>>>0,p=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Dt(_[8][0].data)>0||!1,k,T;if((s=(a=_[7])==null?void 0:a[0])!=null&&s.data&&t!=0)k=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,T=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=_[4])==null?void 0:u[0])!=null&&f.data&&t!=1)k=(h=(d=_[4])==null?void 0:d[0])==null?void 0:h.data,T=(g=(v=_[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=p?4:1,x=J0(k),D=[],I=0;I<k.length/2;++I){var z=x.getUint16(I*2,!0);z<65535&&D.push([I,z])}if(D.length!=y)throw"Expected ".concat(y," cells, found ").concat(D.length);var V=[];for(I=0;I<D.length-1;++I)V[D[I][0]]=T.subarray(D[I][1]*S,D[I+1][1]*S);return D.length>=1&&(V[D[D.length-1][0]]=T.subarray(D[D.length-1][1]*S)),{R:w,cells:V}}function c7(e,t){var r,n=rr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Dt(n[7][0].data)>>>0>0?1:0:-1,s=Q0(n[5],function(i){return l7(i,a)});return{nrows:Dt(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function u7(e,t,r){var n,a=rr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Dt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Dt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ge(s);var i=rr(a[4][0].data),o=wg(e,e[Oa(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?wg(e,e[Oa(i[17][0].data)][0]):[],c=rr(i[3][0].data),u=0;c[1].forEach(function(f){var d=rr(f.data),h=e[Oa(d[2][0].data)][0],v=Dt(h.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=c7(e,h);g.data.forEach(function(_,w){_.forEach(function(y,p){var k=je({r:u+w,c:p}),T=o7(y,o,l);T&&(r[k]=T)})}),u+=g.nrows})}function f7(e,t){var r=rr(t.data),n={"!ref":"A1"},a=e[Oa(r[2][0].data)],s=Dt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return u7(e,a[0],n),n}function d7(e,t){var r,n=rr(t.data),a={name:(r=n[1])!=null&&r[0]?oh(n[1][0].data):"",sheets:[]},s=Q0(n[2],Oa);return s.forEach(function(i){e[i].forEach(function(o){var l=Dt(o.meta[1][0].data);l==6e3&&a.sheets.push(f7(e,o))})}),a}function h7(e,t){var r=rp(),n=rr(t.data),a=Q0(n[1],Oa);if(a.forEach(function(s){e[s].forEach(function(i){var o=Dt(i.meta[1][0].data);if(o==2){var l=d7(e,i);l.sheets.forEach(function(c,u){np(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Uf(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=a7(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=r7(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Dt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var u=Dt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return h7(s,o)}function p7(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function ep(e){p7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function m7(e){return Xs.WS.indexOf(e)>-1?"sheet":e==Xs.CS?"chart":e==Xs.DS?"dialog":e==Xs.MS?"macro":e&&e.length?e:"sheet"}function g7(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,m7(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function v7(e,t,r,n,a,s,i,o,l,c,u,f){try{s[n]=_o(Rr(e,r,!0),t);var d=Tt(e,t),h;switch(o){case"sheet":h=ED(d,t,a,l,s[n],c,u,f);break;case"chart":if(h=TD(d,t,a,l,s[n],c,u,f),!h||!h["!drawel"])break;var v=Qi(h["!drawel"].Target,t),g=rh(v),_=x8(Rr(e,v,!0),_o(Rr(e,g,!0),v)),w=Qi(_,v),y=rh(w);h=iD(Rr(e,w,!0),w,l,_o(Rr(e,y,!0),w),c,h);break;case"macro":h=SD(d,t,a,l,s[n],c,u,f);break;case"dialog":h=bD(d,t,a,l,s[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var p=[];s&&s[n]&&Rn(s[n]).forEach(function(k){var T="";if(s[n][k].Type==Xs.CMNT){T=Qi(s[n][k].Target,t);var S=OD(Tt(e,T,!0),T,l);if(!S||!S.length)return;ag(h,S,!1)}s[n][k].Type==Xs.TCMNT&&(T=Qi(s[n][k].Target,t),p=p.concat(T8(Tt(e,T,!0),l)))}),p&&p.length&&ag(h,p,!0,l.people||[])}catch(k){if(l.WTF)throw k}}function Mr(e){return e.charAt(0)=="/"?e.slice(1):e}function y7(e,t){if(lw(),t=t||{},ep(t),Ur(e,"META-INF/manifest.xml")||Ur(e,"objectdata.xml"))return gg(e,t);if(Ur(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Uf<"u"){if(e.FileIndex)return Uf(e);var r=He.utils.cfb_new();return Rm(e).forEach(function(ae){wA(r,ae,yA(e,ae))}),Uf(r)}throw new Error("Unsupported NUMBERS file")}if(!Ur(e,"[Content_Types].xml"))throw Ur(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ur(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Rm(e),a=pN(Rr(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Tt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Tt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Eo=[],a.sst)try{Eo=ND(Tt(e,Mr(a.sst)),a.sst,t)}catch(ae){if(t.WTF)throw ae}t.cellStyles&&a.themes.length&&(l=AD(Rr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=CD(Tt(e,Mr(a.style)),a.style,l,t))}a.links.map(function(ae){try{var se=_o(Rr(e,rh(Mr(ae))),ae);return PD(Tt(e,Mr(ae)),se,ae,t)}catch{}});var u=xD(Tt(e,Mr(a.workbooks[0])),a.workbooks[0],t),f={},d="";a.coreprops.length&&(d=Tt(e,Mr(a.coreprops[0]),!0),d&&(f=jw(d)),a.extprops.length!==0&&(d=Tt(e,Mr(a.extprops[0]),!0),d&&wN(d,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(d=Rr(e,Mr(a.custprops[0]),!0),d&&(h=kN(d,t)));var v={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(se){return se.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(v.Props=f,v.Custprops=h),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var g={};t.bookDeps&&a.calcchain&&(g=RD(Tt(e,Mr(a.calcchain)),a.calcchain));var _=0,w={},y,p;{var k=u.Sheets;f.Worksheets=k.length,f.SheetNames=[];for(var T=0;T!=k.length;++T)f.SheetNames[T]=k[T].name}var S=s?"bin":"xml",x=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,x+1)+"_rels/"+a.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");Ur(e,D)||(D="xl/_rels/workbook."+S+".rels");var I=_o(Rr(e,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=ID(Tt(e,Mr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=S8(Tt(e,Mr(a.people[0])),t)),I&&(I=g7(I,u.Sheets));var z=Tt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var V="sheet";if(I&&I[_]?(y="xl/"+I[_][1].replace(/[\/]?xl\//,""),Ur(e,y)||(y=I[_][1]),Ur(e,y)||(y=D.replace(/_rels\/.*$/,"")+I[_][1]),V=I[_][2]):(y="xl/worksheets/sheet"+(_+1-z)+"."+S,y=y.replace(/sheet0\./,"sheet.")),p=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==_&&(F=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==f.SheetNames[_].toLowerCase()&&(F=1);if(!F)continue e}}v7(e,y,p,f.SheetNames[_],_,w,i,V,t,u,l,c)}return v={Directory:a,Workbook:u,Props:f,Custprops:h,Deps:g,Sheets:i,SheetNames:f.SheetNames,Strings:Eo,Styles:c,Themes:l,SSF:Ht(Ue)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(ae,se){ae=ae.replace(/^Root Entry[\/]/,""),v.keys.push(ae),v.files[ae]=e.FileIndex[se]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=Tt(e,Mr(a.vba[0]),!0):a.defaults&&a.defaults.bin===N8&&(v.vbaraw=Tt(e,"xl/vbaProject.bin",!0))),v}function w7(e,t){var r=t||{},n="Workbook",a=He.find(e,n);try{if(n="/!DataSpaces/Version",a=He.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(fR(a.content),n="/!DataSpaces/DataSpaceMap",a=He.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=hR(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=He.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=pR(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=He.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);gR(a.content)}catch{}if(n="/EncryptionInfo",a=He.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=vR(a.content);if(n="/EncryptedPackage",a=He.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function tp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Lr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _7(e,t){return He.find(e,"EncryptedPackage")?w7(e,t):k_(e,t)}function k7(e,t){var r,n=e,a=t||{};return a.type||(a.type=We&&Buffer.isBuffer(e)?"buffer":"base64"),r=pw(n,a),y7(r,a)}function S_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return sh(e.slice(r),t);default:break e}return qo.to_workbook(e,t)}function x7(e,t){var r="",n=tp(e,t);switch(t.type){case"base64":r=Lr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ps(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=tt(r)),t.type="binary",S_(r,t)}function E7(e,t){var r=e;return t.type=="base64"&&(r=Lr(r)),r=ga.utils.decode(1200,r.slice(2),"str"),t.type="binary",S_(r,t)}function T7(e){return e.match(/[^\x00-\x7F]/)?eo(e):e}function Bf(e,t,r,n){return n?(r.type="string",qo.to_workbook(e,r)):qo.to_workbook(t,r)}function ch(e,t){Y2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ch(new Uint8Array(e),(r=Ht(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),si={},r.dateNF&&(si.dateNF=r.dateNF),r.type||(r.type=We&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=We?"buffer":"binary",n=fA(e),typeof Uint8Array<"u"&&!We&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=T7(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Ht(r),r.type="array",ch(I0(n),r)}switch((a=tp(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return _7(He.read(n,r),r);break;case 9:if(a[1]<=8)return k_(n,r);break;case 60:return sh(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return JO(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return YO.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?k7(n,r):Bf(e,n,r,s);case 239:return a[3]===60?sh(n,r):Bf(e,n,r,s);case 255:if(a[1]===254)return E7(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return xo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return xo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ng.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return NR.to_workbook(n,r);break;case 10:case 13:case 32:return x7(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ZO.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?ng.to_workbook(n,r):Bf(e,n,r,s)}function S7(e,t,r,n,a,s,i,o){var l=Gt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var h=t.s.c;h<=t.e.c;++h){var v=i?e[r][h]:e[n[h]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[h]!=null&&(d[s[h]]=c);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[h]!=null){if(g==null)if(v.t=="e"&&g===null)d[s[h]]=null;else if(c!==void 0)d[s[h]]=c;else if(u&&g===null)d[s[h]]=null;else continue;else d[s[h]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?g:na(v,g,o);g!=null&&(f=!1)}}return{row:d,isempty:f}}function uh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=vt(u);break;case"number":l=vt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=Gt(l.s.r),d=[],h=[],v=0,g=0,_=Array.isArray(e),w=l.s.r,y=0,p={};_&&!e[w]&&(e[w]=[]);var k=c.skipHidden&&e["!cols"]||[],T=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(k[y]||{}).hidden)switch(d[y]=It(y),r=_?e[w][y]:e[d[y]+f],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=d[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=na(r,null,c),g=p[i]||0,!g)p[i]=1;else{do o=i+"_"+g++;while(p[o]);p[i]=g,p[o]=1}s[y]=o}for(w=l.s.r+a;w<=l.e.r;++w)if(!(T[w]||{}).hidden){var S=S7(e,l,w,d,n,s,_,c);(S.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(h[v++]=S.row)}return h.length=v,h}var _g=/"/g;function b7(e,t,r,n,a,s,i,o){for(var l=!0,c=[],u="",f=Gt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var h=o.dense?(e[r]||[])[d]:e[n[d]+f];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(o.rawNumbers&&h.t=="n"?h.v:na(h,null,o));for(var v=0,g=0;v!==u.length;++v)if((g=u.charCodeAt(v))===a||g===s||g===34||o.forceQuotes){u='"'+u.replace(_g,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(_g,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function b_(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=vt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(d[v]||{}).hidden||(f[v]=It(v));for(var g=0,_=a.s.r;_<=a.e.r;++_)(h[_]||{}).hidden||(u=b7(e,a,_,f,i,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function C7(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=b_(e,t);return r}function A7(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=vt(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=It(o);for(var u=a.s.r;u<=a.e.r;++u)for(s=Gt(u),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function C_(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?hr(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var f=vt(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(i=f.e.r+1,u.e.r=i+t.length-1+a)}else i==-1&&(i=0,u.e.r=t.length-1+a);var d=n.header||[],h=0;t.forEach(function(g,_){Rn(g).forEach(function(w){(h=d.indexOf(w))==-1&&(d[h=d.length]=w);var y=g[w],p="z",k="",T=je({c:o+h,r:i+_+a});c=tl(s,T),y&&typeof y=="object"&&!(y instanceof Date)?s[T]=y:(typeof y=="number"?p="n":typeof y=="boolean"?p="b":typeof y=="string"?p="s":y instanceof Date?(p="d",n.cellDates||(p="n",y=gr(y)),k=n.dateNF||Ue[14]):y===null&&n.nullError&&(p="e",y=0),c?(c.t=p,c.v=y,delete c.w,delete c.R,k&&(c.z=k)):s[T]=c={t:p,v:y},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var v=Gt(i);if(a)for(h=0;h<d.length;++h)s[It(h+o)+v]={t:"s",v:d[h]};return s["!ref"]=Ge(u),s}function N7(e,t){return C_(null,e,t)}function tl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=hr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?tl(e,je(t)):tl(e,je({r:t,c:r||0}))}function O7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function rp(){return{SheetNames:[],Sheets:{}}}function np(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(pD(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function R7(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=O7(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function P7(e,t){return e.z=t,e}function A_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function I7(e,t,r){return A_(e,"#"+t,r)}function D7(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function L7(e,t,r,n){for(var a=typeof t!="string"?t:vt(t),s=typeof t=="string"?t:Ge(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=tl(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var F7={encode_col:It,encode_row:Gt,encode_cell:je,encode_range:Ge,decode_col:z0,decode_row:B0,split_cell:KA,decode_cell:hr,decode_range:Ci,format_cell:na,sheet_add_aoa:Pw,sheet_add_json:C_,sheet_add_dom:x_,aoa_to_sheet:Ai,json_to_sheet:N7,table_to_sheet:E_,table_to_book:JD,sheet_to_csv:b_,sheet_to_txt:C7,sheet_to_json:uh,sheet_to_html:qD,sheet_to_formulae:A7,sheet_to_row_object_array:uh,sheet_get_cell:tl,book_new:rp,book_append_sheet:np,book_set_sheet_visibility:R7,cell_set_number_format:P7,cell_set_hyperlink:A_,cell_set_internal_link:I7,cell_add_comment:D7,sheet_set_array_formula:L7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Kn(e){if(!e)return"";try{let t;if(typeof e=="string")if(e.includes("/")){const[s,i,o]=e.split("/");s.length===4?t=new Date(parseInt(s),parseInt(i)-1,parseInt(o)):o.length===4?t=new Date(parseInt(o),parseInt(i)-1,parseInt(s)):t=new Date(e)}else if(e.includes("-")){const[s,i,o]=e.split("-");s.length===4?t=new Date(e):t=new Date(parseInt(o),parseInt(i)-1,parseInt(s))}else t=new Date(e);else typeof e=="number"?e<1e5?t=new Date((e-25569)*86400*1e3):t=new Date(e):t=new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return`${r}-${n}-${a}`}catch{return""}}function N_(e){if(!e)return null;try{const[t,r,n]=e.split("-").map(s=>parseInt(s,10));if(!t||!r||!n||t<1||t>31||r<1||r>12)return null;const a=new Date(n,r-1,t);return a.getDate()!==t||a.getMonth()!==r-1||a.getFullYear()!==n?null:a}catch{return null}}function fh(e){if(!e)return"";try{let t;if(typeof e=="string")if(e.includes("-")&&e.split("-")[0].length===2){if(t=N_(e),!t)return""}else t=new Date(e);else t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]}catch{return""}}function bn(e){if(!e)return"";try{let t;if(typeof e=="string")if(e.includes("-")&&e.split("-")[0].length===2){if(t=N_(e),!t)return""}else t=new Date(e);else t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return""}}function j7(e){if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}}function to(){return Kn(new Date)}const M7={"PIX RECEBIDO":/pix\s*recebid/i,"PIX ENVIADO":/pix\s*enviad/i,TED:/\bted\b/i,DOC:/\bdoc\b/i,CARTÃO:/cart[aã]o/i,DINHEIRO:/dinheiro/i,BOLETO:/boleto/i,TRANSFERÊNCIA:/transfer[eê]ncia/i,DEPÓSITO:/dep[oó]sito/i,SAQUE:/saque/i},Hi={date:["data","date","data do lançamento","data do lancamento","dt","data mov","data movimento"],history:["histórico","historico","descrição","descricao","histórico/descrição","historico/descricao","descrição/histórico","descricao/historico","desc"],value:["valor","valor (r$)","valor r$","vlr","val"],credit:["crédito","credito","entrada","receita"],debit:["débito","debito","saída","saida","despesa"]};async function O_(e){console.log("parseExcelFile: Starting to parse file:",e.name);try{console.log("parseExcelFile: Reading file as arrayBuffer...");const t=await e.arrayBuffer();console.log("parseExcelFile: ArrayBuffer size:",t.byteLength),console.log("parseExcelFile: Reading workbook with XLSX...");const r=ch(t,{type:"array"});if(console.log("parseExcelFile: Workbook sheet names:",r.SheetNames),r.SheetNames.length===0)return{success:!1,data:[],errors:["Arquivo não contém planilhas"],warnings:[],stats:{totalRows:0,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}};const n=r.Sheets[r.SheetNames[0]],a=F7.sheet_to_json(n,{header:1});if(a.length<2)return{success:!1,data:[],errors:["Arquivo não contém dados suficientes"],warnings:[],stats:{totalRows:0,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}};const s=$7(a);if(!s)return{success:!1,data:[],errors:["Não foi possível encontrar cabeçalhos válidos. Verifique se o arquivo contém colunas: Data, Histórico e Valor"],warnings:[],stats:{totalRows:0,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}};const{headerRowIndex:i,columnIndexes:o}=s,l=[];if(o.date===-1&&l.push("Data"),o.history===-1&&l.push("Histórico"),o.value===-1&&(o.credit===-1||o.debit===-1)&&l.push("Valor (ou Crédito/Débito)"),l.length>0)return{success:!1,data:[],errors:[`Colunas essenciais não encontradas: ${l.join(", ")}. Sugestões de nomes aceitos: Data/Date, Histórico/Descrição, Valor/Valor(R$)`],warnings:[],stats:{totalRows:a.length-i-1,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}};const c=[],u=[];let f=0,d=0,h=0,v=0;for(let g=i+1;g<a.length;g++){const _=a[g];if(!_||_.every(y=>!y||String(y).trim()===""))continue;const w=B7(_,o,g+1);c.push(w),w.validationStatus==="valid"?(d++,f+=w.value):w.validationStatus==="warning"?(h++,f+=w.value,w.validationMessage&&u.push(`Linha ${g+1}: ${w.validationMessage}`)):v++}return{success:!0,data:c,errors:[],warnings:u,stats:{totalRows:c.length,validRows:d,rowsWithWarnings:h,rowsWithErrors:v,totalValue:f}}}catch(t){return{success:!1,data:[],errors:[`Erro ao processar arquivo: ${t instanceof Error?t.message:"Erro desconhecido"}`],warnings:[],stats:{totalRows:0,validRows:0,rowsWithWarnings:0,rowsWithErrors:0,totalValue:0}}}}function $7(e){for(let t=0;t<Math.min(10,e.length);t++){const r=e[t];if(!r)continue;const n=r.map(s=>String(s||"").toLowerCase().trim()),a=U7(n);if(a.date!==-1&&a.history!==-1&&(a.value!==-1||a.credit!==-1&&a.debit!==-1))return{headerRowIndex:t,columnIndexes:a}}return null}function U7(e){const t={date:-1,history:-1,value:-1,credit:-1,debit:-1};return e.forEach((r,n)=>{const a=r.toLowerCase().trim();a&&(t.date===-1&&Hi.date.some(s=>a.includes(s))&&(t.date=n),t.history===-1&&Hi.history.some(s=>a.includes(s))&&(t.history=n),t.value===-1&&Hi.value.some(s=>a.includes(s))&&(t.value=n),t.credit===-1&&Hi.credit.some(s=>a.includes(s))&&(t.credit=n),t.debit===-1&&Hi.debit.some(s=>a.includes(s))&&(t.debit=n))}),t}function B7(e,t,r){const n=[];let a="valid";const s=e[t.date],i=z7(s);i||(n.push("Data inválida"),a="warning");const o=String(e[t.history]||""),l=V7(o),c=W7(o);c||(n.push("CPF não encontrado"),a==="valid"&&(a="warning"));let u=0;if(t.value!==-1)u=zf(e[t.value]);else if(t.credit!==-1&&t.debit!==-1){const f=zf(e[t.credit]),d=zf(e[t.debit]);u=f-d}return isNaN(u)&&(n.push("Valor inválido"),a="error",u=0),{date:i||"Data inválida",paymentType:l||"OUTROS",cpf:c||"",value:Math.round(u*100)/100,originalHistory:o,validationStatus:a,validationMessage:n.length>0?n.join(", "):void 0}}function z7(e){if(!e)return null;try{let t;if(typeof e=="number")t=new Date((e-25569)*86400*1e3);else{const r=String(e).trim();if(r.match(/^\d{2}\/\d{2}\/\d{4}$/)){const[n,a,s]=r.split("/");t=new Date(parseInt(s),parseInt(a)-1,parseInt(n))}else if(r.match(/^\d{4}-\d{2}-\d{2}$/))t=new Date(r);else if(r.match(/^\d{2}-\d{2}-\d{4}$/)){const[n,a,s]=r.split("-");t=new Date(parseInt(s),parseInt(a)-1,parseInt(n))}else t=new Date(r)}return isNaN(t.getTime())?null:Kn(t)}catch{return null}}function V7(e){const t=e.toUpperCase();for(const[r,n]of Object.entries(M7))if(n.test(e))return r;return t.includes("PIX")?t.includes("ENVIO")||t.includes("TRANSF")?"PIX ENVIADO":"PIX RECEBIDO":null}function W7(e){const r=e.replace(/\D/g,"").match(/\d{11}/);if(r){const a=r[0];if(!/^(\d)\1{10}$/.test(a))return a}const n=e.match(/\d{3}\.?\d{3}\.?\d{3}-?\d{2}/);return n?n[0].replace(/\D/g,""):null}function zf(e){if(typeof e=="number")return e;if(typeof e=="string"){let t=e.replace(/[R$\s]/g,"");t=t.replace(",","."),t=t.replace(/[^\d.-]/g,"");const r=parseFloat(t);return isNaN(r)?0:r}return 0}function Vr(e,t,r){const[n,a]=B.useState(()=>{try{if(typeof window>"u")return t;const s=localStorage.getItem(e);if(s&&s!=="undefined"&&s!=="null"){const i=r!=null&&r.deserialize?r.deserialize(s):JSON.parse(s);if(i!=null)return i}return t}catch(s){console.warn(`Failed to load ${e} from localStorage:`,s);try{localStorage.removeItem(e)}catch{}return t}});return B.useEffect(()=>{try{const s=r!=null&&r.serialize?r.serialize(n):JSON.stringify(n);localStorage.setItem(e,s)}catch(s){console.warn(`Failed to save ${e} to localStorage:`,s)}},[e,n,r]),[n,a]}function R_(){return Vr("dashboard_filters",{selectedDate:new Date().toISOString().split("T")[0],searchValue:"",currentPage:1,statusFilter:"all",conferenceValue:""})}const H7=({data:e,stats:t,transferredIds:r})=>{const[n,a]=Vr("datatable_sort_field","date"),[s,i]=Vr("datatable_sort_direction","desc"),[o,l]=Vr("datatable_filter_payment_type","all"),[c,u]=Vr("datatable_filter_cpf",""),[f,d]=Vr("datatable_current_page",1),h=20,v=B.useMemo(()=>{const T=new Set(e.map(S=>S.paymentType));return Array.from(T).sort()},[e]),g=B.useMemo(()=>{let T=[...e];return r&&r.size>0&&(T=T.filter((S,x)=>{const D=`row-${x}-${S.date}-${S.value}`;return!r.has(D)})),o!=="all"&&(T=T.filter(S=>S.paymentType===o)),c&&(T=T.filter(S=>S.cpf.includes(c))),T.sort((S,x)=>{let D=0;switch(n){case"date":const I=S.date.split("/").reverse().join(""),z=x.date.split("/").reverse().join("");D=I.localeCompare(z);break;case"value":D=S.value-x.value;break;case"paymentType":D=S.paymentType.localeCompare(x.paymentType);break;case"cpf":D=S.cpf.localeCompare(x.cpf);break}return s==="asc"?D:-D}),T},[e,r,o,c,n,s]),_=Math.ceil(g.length/h),w=g.slice((f-1)*h,f*h),y=T=>{n===T?i(s==="asc"?"desc":"asc"):(a(T),i("asc"))},p=T=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(T),k=T=>T?T.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):"-";return m.jsxs("div",{className:"h-full flex flex-col",children:[m.jsx("div",{className:"bg-gray-900 border-b border-gray-700 p-4",children:m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400",children:"Total de Linhas"}),m.jsx("p",{className:"text-lg font-semibold text-gray-100",children:t.totalRows})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400",children:"Linhas Válidas"}),m.jsx("p",{className:"text-lg font-semibold text-green-400",children:t.validRows})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400",children:"Com Avisos"}),m.jsx("p",{className:"text-lg font-semibold text-yellow-400",children:t.rowsWithWarnings})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400",children:"Com Erros"}),m.jsx("p",{className:"text-lg font-semibold text-red-400",children:t.rowsWithErrors})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400",children:"Valor Total"}),m.jsx("p",{className:"text-lg font-semibold text-gray-100",children:p(t.totalValue)})]})]})}),m.jsx("div",{className:"bg-gray-800 border-b border-gray-700 p-4",children:m.jsxs("div",{className:"flex flex-wrap gap-4",children:[m.jsxs("div",{className:"flex-1 min-w-[200px]",children:[m.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Filtrar por Tipo de Pagamento"}),m.jsxs("select",{value:o,onChange:T=>{l(T.target.value),d(1)},className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[m.jsx("option",{value:"all",children:"Todos"}),v.map(T=>m.jsx("option",{value:T,children:T},T))]})]}),m.jsxs("div",{className:"flex-1 min-w-[200px]",children:[m.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Filtrar por CPF"}),m.jsx("input",{type:"text",value:c,onChange:T=>{u(T.target.value.replace(/\D/g,"")),d(1)},placeholder:"Digite o CPF (somente números)",className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),m.jsx("div",{className:"flex items-end",children:m.jsx("button",{onClick:()=>{l("all"),u(""),d(1)},className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar Filtros"})})]})}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("table",{className:"w-full",children:[m.jsx("thead",{className:"bg-gray-900 sticky top-0 z-10",children:m.jsxs("tr",{children:[m.jsx("th",{className:"px-4 py-3 text-left",children:m.jsxs("button",{onClick:()=>y("date"),className:"flex items-center space-x-1 text-xs font-medium text-gray-300 hover:text-gray-100",children:[m.jsx("span",{children:"Data"}),n==="date"&&m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:s==="asc"?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})})]})}),m.jsx("th",{className:"px-4 py-3 text-left",children:m.jsxs("button",{onClick:()=>y("paymentType"),className:"flex items-center space-x-1 text-xs font-medium text-gray-300 hover:text-gray-100",children:[m.jsx("span",{children:"Tipo de Pagamento"}),n==="paymentType"&&m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:s==="asc"?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})})]})}),m.jsx("th",{className:"px-4 py-3 text-left",children:m.jsxs("button",{onClick:()=>y("cpf"),className:"flex items-center space-x-1 text-xs font-medium text-gray-300 hover:text-gray-100",children:[m.jsx("span",{children:"CPF"}),n==="cpf"&&m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:s==="asc"?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})})]})}),m.jsx("th",{className:"px-4 py-3 text-right",children:m.jsxs("button",{onClick:()=>y("value"),className:"flex items-center justify-end space-x-1 text-xs font-medium text-gray-300 hover:text-gray-100 ml-auto",children:[m.jsx("span",{children:"Valor (R$)"}),n==="value"&&m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:s==="asc"?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})})]})}),m.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300",children:"Histórico Original"}),m.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300",children:"Status"})]})}),m.jsx("tbody",{className:"divide-y divide-gray-700",children:w.map((T,S)=>m.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[m.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:T.date}),m.jsx("td",{className:"px-4 py-3",children:m.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${T.paymentType==="PIX RECEBIDO"?"bg-green-900/50 text-green-300 border border-green-700":T.paymentType==="PIX ENVIADO"?"bg-red-900/50 text-red-300 border border-red-700":T.paymentType==="TED"?"bg-blue-900/50 text-blue-300 border border-blue-700":T.paymentType==="CARTÃO"?"bg-purple-900/50 text-purple-300 border border-purple-700":"bg-gray-700 text-gray-300 border border-gray-600"}`,children:T.paymentType})}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-mono",children:k(T.cpf)}),m.jsx("td",{className:`px-4 py-3 text-sm text-right font-mono ${T.value>=0?"text-green-400":"text-red-400"}`,children:p(T.value)}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-400 max-w-xs truncate",title:T.originalHistory,children:T.originalHistory}),m.jsxs("td",{className:"px-4 py-3 text-center",children:[T.validationStatus==="valid"&&m.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-green-900/50 text-green-400",children:m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),T.validationStatus==="warning"&&m.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-yellow-900/50 text-yellow-400",title:T.validationMessage,children:m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),T.validationStatus==="error"&&m.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-red-900/50 text-red-400",title:T.validationMessage,children:m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},S))})]})}),_>1&&m.jsxs("div",{className:"bg-gray-900 border-t border-gray-700 px-4 py-3 flex items-center justify-between",children:[m.jsxs("div",{className:"text-sm text-gray-400",children:["Mostrando ",(f-1)*h+1," a ",Math.min(f*h,g.length)," de ",g.length," registros"]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:()=>d(Math.max(1,f-1)),disabled:f===1,className:"px-3 py-1 text-sm font-medium text-gray-300 bg-gray-800 border border-gray-700 rounded-md hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Anterior"}),m.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,_)},(T,S)=>{const x=f<=3?S+1:f>=_-2?_-4+S:f-2+S;return x<1||x>_?null:m.jsx("button",{onClick:()=>d(x),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${f===x?"bg-indigo-600 text-white":"text-gray-300 bg-gray-800 border border-gray-700 hover:bg-gray-700"}`,children:x},x)})}),m.jsx("button",{onClick:()=>d(Math.min(_,f+1)),disabled:f===_,className:"px-3 py-1 text-sm font-medium text-gray-300 bg-gray-800 border border-gray-700 rounded-md hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Próximo"})]})]})]})};function lu(e){if(typeof e=="number")return Math.round(e*100)/100;if(!e||typeof e!="string")return 0;let t=e.trim().replace(/[R$\s]/g,"").replace(/[^\d,.-]/g,"");const r=t.lastIndexOf(","),n=t.lastIndexOf(".");r>n?t=t.replace(/\./g,"").replace(",","."):n>r&&(t=t.replace(/,/g,""));const a=parseFloat(t);return isNaN(a)?0:Math.round(a*100)/100}const cu=new WeakMap;function kg(e){const t=new Map;return e.forEach((r,n)=>{let a=cu.get(r);a===void 0&&(a=lu(r.value),cu.set(r,a)),a!==0&&(t.has(a)||t.set(a,[]),t.get(a).push({id:`row-${n}-${r.date}-${r.value}`,date:r.date,paymentType:r.paymentType,cpf:r.cpf,value:r.value,originalHistory:r.originalHistory,rowIndex:n}))}),t}function xg(e,t,r){const n=lu(e);if(n===0)return{hasMatches:!1,matches:[],normalizedInput:0};if(r){const s=r.get(n)||[];return{hasMatches:s.length>0,matches:s,normalizedInput:n}}const a=[];return t.forEach((s,i)=>{let o=cu.get(s);o===void 0&&(o=lu(s.value),cu.set(s,o)),o===n&&a.push({id:`row-${i}-${s.date}-${s.value}`,date:s.date,paymentType:s.paymentType,cpf:s.cpf,value:s.value,originalHistory:s.originalHistory,rowIndex:i})}),{hasMatches:a.length>0,matches:a,normalizedInput:n}}function Eg(e){if(!e||e.trim()==="")return{isValid:!1,error:"Digite um valor para conferir"};const t=lu(e);return t===0?{isValid:!1,error:"Informe um valor válido (ex.: 123,45)"}:t<0?{isValid:!1,error:"O valor deve ser positivo"}:{isValid:!0}}function bo(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const G7=({isOpen:e,matches:t,searchValue:r,onSelect:n,onClose:a})=>{if(!e)return null;const s=l=>l?l.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):"-",i=l=>{l.target===l.currentTarget&&a()},o=l=>{l.key==="Escape"&&a()};return m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:i,onKeyDown:o,children:m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 w-full max-w-4xl mx-4 max-h-[80vh] overflow-hidden",children:[m.jsx("div",{className:"bg-gray-900 px-6 py-4 border-b border-gray-700",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Múltiplas Correspondências Encontradas"}),m.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Valor pesquisado: ",m.jsx("span",{className:"text-indigo-400 font-mono",children:bo(r)}),"- Encontrados ",t.length," registros"]})]}),m.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-100 hover:bg-gray-700 rounded-md transition-colors","aria-label":"Fechar modal",children:m.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),m.jsxs("div",{className:"p-6",children:[m.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Selecione qual registro deseja transferir para a Conferência de Caixa:"}),m.jsx("div",{className:"overflow-auto max-h-96",children:m.jsx("div",{className:"space-y-2",children:t.map((l,c)=>m.jsxs("button",{onClick:()=>n(l),className:"w-full p-4 bg-gray-700 hover:bg-gray-600 border border-gray-600 hover:border-indigo-500 rounded-lg transition-colors text-left focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-800",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Data"}),m.jsx("p",{className:"text-sm text-gray-100 font-medium",children:l.date})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Tipo de Pagamento"}),m.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${l.paymentType==="PIX RECEBIDO"?"bg-green-900/50 text-green-300 border border-green-700":l.paymentType==="PIX ENVIADO"?"bg-red-900/50 text-red-300 border border-red-700":l.paymentType==="TED"?"bg-blue-900/50 text-blue-300 border border-blue-700":l.paymentType==="CARTÃO"?"bg-purple-900/50 text-purple-300 border border-purple-700":"bg-gray-600 text-gray-300 border border-gray-500"}`,children:l.paymentType})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"CPF"}),m.jsx("p",{className:"text-sm text-gray-100 font-mono",children:s(l.cpf)})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Valor"}),m.jsx("p",{className:`text-sm font-mono font-semibold ${l.value>=0?"text-green-400":"text-red-400"}`,children:bo(l.value)})]})]}),l.originalHistory&&m.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-600",children:[m.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Histórico Original"}),m.jsx("p",{className:"text-xs text-gray-300 truncate",title:l.originalHistory,children:l.originalHistory})]}),m.jsx("div",{className:"mt-3 flex items-center justify-end",children:m.jsxs("div",{className:"flex items-center text-indigo-400",children:[m.jsx("span",{className:"text-xs",children:"Clique para selecionar"}),m.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]},l.id))})})]}),m.jsx("div",{className:"bg-gray-900 px-6 py-4 border-t border-gray-700 flex justify-end space-x-3",children:m.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-indigo-500 transition-colors",children:"Cancelar"})})]})})},K7=({conferredItems:e,onRemoveItem:t})=>{const[r,n]=B.useState("conferredAt"),[a,s]=B.useState("desc"),i=f=>{r===f?s(a==="asc"?"desc":"asc"):(n(f),s("asc"))},o=[...e].sort((f,d)=>{let h=0;switch(r){case"date":const v=f.date.split("/").reverse().join(""),g=d.date.split("/").reverse().join("");h=v.localeCompare(g);break;case"value":h=f.value-d.value;break;case"conferredAt":h=f.conferredAt.getTime()-d.conferredAt.getTime();break}return a==="asc"?h:-h}),l=f=>f?f.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):"-",c=f=>new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(f),u=e.reduce((f,d)=>f+d.value,0);return e.length===0?m.jsx("div",{className:"h-full flex flex-col",children:m.jsx("div",{className:"flex-1 flex items-center justify-center",children:m.jsxs("div",{className:"text-center",children:[m.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),m.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-300",children:"Nenhum valor conferido ainda"}),m.jsx("p",{className:"mt-2 text-sm text-gray-500",children:'Use o campo "Conferir Valor" na sidebar para transferir registros para cá.'})]})})}):m.jsxs("div",{className:"h-full flex flex-col",children:[m.jsx("div",{className:"bg-gray-900 border-b border-gray-700 p-4",children:m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400",children:"Total de Itens"}),m.jsx("p",{className:"text-lg font-semibold text-gray-100",children:e.length})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-400",children:"Valor Total Conferido"}),m.jsx("p",{className:"text-lg font-semibold text-green-400",children:bo(u)})]}),m.jsxs("div",{className:"hidden md:block",children:[m.jsx("p",{className:"text-xs text-gray-400",children:"Última Conferência"}),m.jsx("p",{className:"text-sm text-gray-300",children:e.length>0&&c([...e].sort((f,d)=>d.conferredAt.getTime()-f.conferredAt.getTime())[0].conferredAt)})]})]})}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("table",{className:"w-full",children:[m.jsx("thead",{className:"bg-gray-900 sticky top-0 z-10",children:m.jsxs("tr",{children:[m.jsx("th",{className:"px-4 py-3 text-left",children:m.jsxs("button",{onClick:()=>i("date"),className:"flex items-center space-x-1 text-xs font-medium text-gray-300 hover:text-gray-100",children:[m.jsx("span",{children:"Data"}),r==="date"&&m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a==="asc"?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})})]})}),m.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300",children:"Tipo de Pagamento"}),m.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300",children:"CPF"}),m.jsx("th",{className:"px-4 py-3 text-right",children:m.jsxs("button",{onClick:()=>i("value"),className:"flex items-center justify-end space-x-1 text-xs font-medium text-gray-300 hover:text-gray-100 ml-auto",children:[m.jsx("span",{children:"Valor (R$)"}),r==="value"&&m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a==="asc"?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})})]})}),m.jsx("th",{className:"px-4 py-3 text-left",children:m.jsxs("button",{onClick:()=>i("conferredAt"),className:"flex items-center space-x-1 text-xs font-medium text-gray-300 hover:text-gray-100",children:[m.jsx("span",{children:"Conferido em"}),r==="conferredAt"&&m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a==="asc"?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})})]})}),m.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300",children:"Ações"})]})}),m.jsx("tbody",{className:"divide-y divide-gray-700",children:o.map(f=>m.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[m.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:f.date}),m.jsx("td",{className:"px-4 py-3",children:m.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${f.paymentType==="PIX RECEBIDO"?"bg-green-900/50 text-green-300 border border-green-700":f.paymentType==="PIX ENVIADO"?"bg-red-900/50 text-red-300 border border-red-700":f.paymentType==="TED"?"bg-blue-900/50 text-blue-300 border border-blue-700":f.paymentType==="CARTÃO"?"bg-purple-900/50 text-purple-300 border border-purple-700":"bg-gray-700 text-gray-300 border border-gray-600"}`,children:f.paymentType})}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-mono",children:l(f.cpf)}),m.jsx("td",{className:`px-4 py-3 text-sm text-right font-mono ${f.value>=0?"text-green-400":"text-red-400"}`,children:bo(f.value)}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:c(f.conferredAt)}),m.jsx("td",{className:"px-4 py-3 text-center",children:m.jsx("button",{onClick:()=>t(f.conferredId),className:"p-1 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded transition-colors",title:"Remover da conferência","aria-label":`Remover item de ${bo(f.value)} da conferência`,children:m.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]},f.conferredId))})]})})]})},Z7=({selectedFile:e,onDateSelected:t,className:r=""})=>{const[n,a]=B.useState("automatic"),[s,i]=B.useState(fh(new Date)),[o,l]=B.useState(null),[c,u]=B.useState(!1),[f,d]=B.useState(null);B.useEffect(()=>{e&&n==="automatic"&&h()},[e,n]);const h=async()=>{if(e){u(!0),d(null);try{const w=await O_(e);if(w.success&&w.data.length>0){const y=w.data.map(p=>p.date).filter(p=>p&&p!=="Invalid Date");if(y.length>0){const p=y.reduce((S,x)=>(S[x]=(S[x]||0)+1,S),{}),k=Object.entries(p).sort(([,S],[,x])=>x-S)[0][0],T=Kn(k);l(T),t(T,"automatic")}else{const p=to();l(p),d("Nenhuma data válida encontrada no arquivo. Usando data atual."),t(p,"automatic")}}else{const y=to();l(y),d("Não foi possível detectar data do arquivo. Usando data atual."),t(y,"automatic")}}catch(w){console.error("Error detecting date from file:",w);const y=to();l(y),d("Erro ao detectar data. Usando data atual."),t(y,"automatic")}finally{u(!1)}}},v=w=>{if(a(w),d(null),w==="automatic"&&o)t(o,"automatic");else if(w==="manual"){const y=Kn(s);t(y,"manual")}},g=w=>{if(i(w),n==="manual"){const y=Kn(w);t(y,"manual")}},_=()=>n==="automatic"?o||to():Kn(s);return m.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border border-gray-700 ${r}`,children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"2"}),"Selecionar Dia"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"flex items-center cursor-pointer group",children:[m.jsx("input",{type:"radio",name:"dateMode",value:"automatic",checked:n==="automatic",onChange:()=>v("automatic"),className:"mr-2 text-indigo-600 focus:ring-indigo-500"}),m.jsxs("div",{className:"flex-1",children:[m.jsx("span",{className:"text-sm text-gray-300 group-hover:text-gray-100",children:"Data Automática"}),n==="automatic"&&o&&m.jsxs("span",{className:"ml-2 text-xs text-indigo-400",children:["(",bn(o),")"]})]})]}),m.jsxs("label",{className:"flex items-center cursor-pointer group",children:[m.jsx("input",{type:"radio",name:"dateMode",value:"manual",checked:n==="manual",onChange:()=>v("manual"),className:"mr-2 text-indigo-600 focus:ring-indigo-500"}),m.jsx("span",{className:"text-sm text-gray-300 group-hover:text-gray-100",children:"Selecionar Manualmente"})]})]}),n==="manual"&&m.jsxs("div",{className:"mt-2",children:[m.jsx("label",{htmlFor:"manual-date-input",className:"sr-only",children:"Data manual"}),m.jsx("input",{id:"manual-date-input",type:"date",value:s,onChange:w=>g(w.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Selecionar data manualmente"})]}),c&&m.jsx("div",{className:"p-2 bg-indigo-900/20 border border-indigo-600 rounded-md",children:m.jsxs("div",{className:"flex items-center",children:[m.jsxs("svg",{className:"animate-spin h-4 w-4 text-indigo-400 mr-2",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),m.jsx("span",{className:"text-xs text-indigo-400",children:"Detectando data do arquivo..."})]})}),f&&m.jsx("div",{className:"p-2 bg-yellow-900/20 border border-yellow-600 rounded-md",children:m.jsx("p",{className:"text-xs text-yellow-400",children:f})}),m.jsx("div",{className:"bg-gray-900 rounded p-3 border border-gray-600",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-xs text-gray-400",children:"Data selecionada:"}),m.jsxs("div",{className:"text-right",children:[m.jsx("span",{className:"text-sm text-indigo-400 font-medium",children:bn(_())}),m.jsxs("span",{className:"block text-xs text-gray-500 mt-1",children:["Modo: ",n==="automatic"?"Automático":"Manual"]})]})]})}),m.jsx("div",{className:"p-2 bg-gray-700 rounded-md",children:m.jsx("p",{className:"text-xs text-gray-400",children:n==="automatic"?"A data será detectada automaticamente do arquivo carregado.":"Você está selecionando a data manualmente."})})]})]})},P_="00000000-0000-0000-0000-000000000001",Mn={from:e=>kn.from(e),auth:{getUser:async()=>({data:{user:{id:P_}}})}};async function $n(){return P_}class ii{static async saveBankingUpload(t,r,n,a){const s=await $n(),i=t.map(l=>({operation_date:n,operation_type:"banking_upload",document_number:l.documentNumber,date:l.date,description:l.description,value:l.value,bank_name:l.bankName,account_number:l.accountNumber,transaction_type:l.transactionType,balance:l.balance,file_name:r,file_upload_date:n,upload_mode:a,status:"pending",user_id:s,metadata:l})),{error:o}=await Mn.from("conference_history").insert(i);if(o)throw console.error("Error saving banking upload:",o),o}static async saveCashConference(t,r,n){const a=await $n(),s={operation_date:r,operation_type:"cash_conference",document_number:t.documentNumber,description:t.description,value:t.value,conferred_at:new Date().toISOString(),conferred_by:a,status:n,user_id:a,metadata:t},{error:i}=await Mn.from("conference_history").insert(s);if(i)throw console.error("Error saving cash conference:",i),i}static async saveNotFound(t,r){const n=await $n(),a=parseFloat(t.replace(",",".").replace(/[^\d.-]/g,"")),s={operation_date:r,operation_type:"not_found",value:isNaN(a)?0:a,status:"not_found",user_id:n,metadata:{originalValue:t}},{error:i}=await Mn.from("conference_history").insert(s);if(i)throw console.error("Error saving not found value:",i),i}static async getHistoryByDate(t){const r=await $n(),{data:n,error:a}=await Mn.from("conference_history").select("*").eq("operation_date",t).eq("user_id",r).order("operation_timestamp",{ascending:!1});if(a)throw console.error("Error fetching history:",a),a;return n||[]}static async getDailySummary(t){await $n();const{data:r,error:n}=await Mn.from("daily_summary").select("*").eq("operation_date",t).single();if(n&&n.code!=="PGRST116")throw console.error("Error fetching daily summary:",n),n;return r}static async getHistoryByDateRange(t,r){const n=await $n(),{data:a,error:s}=await Mn.from("conference_history").select("*").gte("operation_date",t).lte("operation_date",r).eq("user_id",n).order("operation_date",{ascending:!1}).order("operation_timestamp",{ascending:!1});if(s)throw console.error("Error fetching history range:",s),s;return a||[]}static async updateConferenceStatus(t,r){const n=await $n(),{error:a}=await Mn.from("conference_history").update({status:r,updated_at:new Date().toISOString(),conferred_at:r==="conferred"?new Date().toISOString():null,conferred_by:r==="conferred"?n:null}).eq("id",t).eq("user_id",n);if(a)throw console.error("Error updating conference status:",a),a}static async deleteHistoryEntry(t){const r=await $n(),{error:n}=await Mn.from("conference_history").delete().eq("id",t).eq("user_id",r);if(n)throw console.error("Error deleting history entry:",n),n}static async clearDayHistory(t){const r=await $n(),{error:n}=await Mn.from("conference_history").delete().eq("operation_date",t).eq("user_id",r);if(n)throw console.error("Error clearing day history:",n),n}}const X7=({className:e="",onDataLoaded:t})=>{const[r,n]=B.useState(fh(new Date)),[a,s]=B.useState([]),[i,o]=B.useState(null),[l,c]=B.useState(!1),[u,f]=B.useState(null),[d,h]=B.useState("day"),v=async()=>{c(!0),f(null);try{let p=[];if(d==="day"){const k=Kn(r);p=await ii.getHistoryByDate(k);const T=await ii.getDailySummary(k);o(T)}else{const k=new Date(r),T=new Date(r);d==="week"?T.setDate(T.getDate()-7):d==="month"&&T.setMonth(T.getMonth()-1),p=await ii.getHistoryByDateRange(Kn(T),Kn(k)),o(null)}s(p),t&&t(p),p.length===0&&f("Nenhum registro encontrado para o período selecionado.")}catch(p){console.error("Error loading history:",p),f("Erro ao carregar histórico. Tente novamente.")}finally{c(!1)}},g=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p),_=p=>{switch(p){case"banking_upload":return"Upload Bancário";case"cash_conference":return"Conferência de Caixa";case"not_found":return"Não Encontrado";default:return p}},w=p=>{switch(p){case"conferred":return m.jsx("span",{className:"px-2 py-1 text-xs bg-green-900/30 text-green-400 border border-green-600 rounded",children:"Conferido"});case"not_found":return m.jsx("span",{className:"px-2 py-1 text-xs bg-red-900/30 text-red-400 border border-red-600 rounded",children:"Não Encontrado"});case"pending":return m.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-900/30 text-yellow-400 border border-yellow-600 rounded",children:"Pendente"});default:return null}},y=()=>{const p={banking_upload:[],cash_conference:[],not_found:[]};return a.forEach(k=>{p[k.operation_type]&&p[k.operation_type].push(k)}),p};return m.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border border-gray-700 ${e}`,children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"4"}),"Histórico por Data"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"history-date-input",className:"block text-xs text-gray-400 mb-1",children:"Selecionar data"}),m.jsx("input",{id:"history-date-input",type:"date",value:r,onChange:p=>n(p.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Selecionar data"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"period-select",className:"block text-xs text-gray-400 mb-1",children:"Período"}),m.jsxs("select",{id:"period-select",value:d,onChange:p=>h(p.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Selecionar período",children:[m.jsx("option",{value:"day",children:"Dia específico"}),m.jsx("option",{value:"week",children:"Última semana"}),m.jsx("option",{value:"month",children:"Último mês"})]})]})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:v,disabled:l,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"Carregando...":"Carregar Histórico"}),m.jsx("button",{onClick:()=>{const p=fh(new Date);n(p),h("day")},className:"px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",title:"Carregar dia atual",children:"Hoje"})]}),u&&m.jsx("div",{className:"p-2 bg-red-900/20 border border-red-400 rounded-md",children:m.jsx("p",{className:"text-xs text-red-400",children:u})}),i&&m.jsxs("div",{className:"bg-gray-900 rounded p-3 border border-gray-600",children:[m.jsx("h4",{className:"text-xs font-medium text-gray-400 mb-2",children:"Resumo do Dia"}),m.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Uploads:"}),m.jsx("span",{className:"text-gray-200",children:i.banking_total_uploaded})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Conferidos:"}),m.jsx("span",{className:"text-green-400",children:i.total_conferred||0})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Não encontrados:"}),m.jsx("span",{className:"text-red-400",children:i.cash_not_found_count})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"text-gray-400",children:"Valor total:"}),m.jsx("span",{className:"text-indigo-400",children:g(i.total_value||0)})]})]})]}),a.length>0&&m.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:Object.entries(y()).map(([p,k])=>k.length===0?null:m.jsxs("div",{className:"bg-gray-900 rounded p-3 border border-gray-600",children:[m.jsxs("h4",{className:"text-xs font-medium text-gray-300 mb-2",children:[_(p)," (",k.length,")"]}),m.jsxs("div",{className:"space-y-2",children:[k.slice(0,5).map(T=>m.jsxs("div",{className:"bg-gray-800 rounded p-2 border border-gray-700",children:[m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{className:"flex-1",children:[T.document_number&&m.jsxs("div",{className:"text-xs text-gray-400",children:["Doc: ",T.document_number]}),T.description&&m.jsx("div",{className:"text-xs text-gray-300 truncate",children:T.description}),T.value&&m.jsx("div",{className:"text-xs font-medium text-indigo-400",children:g(T.value)})]}),m.jsx("div",{className:"ml-2",children:w(T.status)})]}),T.operation_timestamp&&m.jsx("div",{className:"text-xs text-gray-500 mt-1",children:j7(T.operation_timestamp)})]},T.id)),k.length>5&&m.jsxs("div",{className:"text-xs text-gray-400 text-center",children:["... e mais ",k.length-5," registros"]})]})]},p))}),l&&m.jsx("div",{className:"flex items-center justify-center py-8",children:m.jsxs("svg",{className:"animate-spin h-8 w-8 text-indigo-500",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]})},I_="dashboard_launches",Y7=()=>{try{const e=localStorage.getItem(I_);if(e)return JSON.parse(e).map(r=>{let n=new Date,a=new Date;try{if(r.date){const s=new Date(r.date);isNaN(s.getTime())||(n=s)}}catch{console.warn("Invalid date value:",r.date)}try{if(r.timestamp){const s=new Date(r.timestamp);isNaN(s.getTime())||(a=s)}}catch{console.warn("Invalid timestamp value:",r.timestamp)}return{...r,date:n,timestamp:a}})}catch(e){console.error("Error loading launches:",e)}return[]},Tg=e=>{try{localStorage.setItem(I_,JSON.stringify(e))}catch(t){console.error("Error saving launches:",t)}},q7=({currentDate:e,operationDate:t,onLaunchAdded:r,conferredItems:n})=>{const[a,s]=R_(),[i,o]=B.useState(null),[l,c]=B.useState(null),[u,f]=B.useState(""),[d,h]=B.useState(Y7),[v,g]=B.useState(null),[_,w]=B.useState(null),[y,p]=B.useState("date"),[k,T]=B.useState("desc"),[S,x]=B.useState(null),[D,I]=B.useState("all"),[z,V]=B.useState(!1),[F,q]=B.useState(null),ae=B.useRef(null),se=B.useCallback(()=>{if(a.selectedDate){const[Y,A,Pe]=a.selectedDate.split("-");return new Date(parseInt(Y),parseInt(A)-1,parseInt(Pe))}if(t){const[Y,A,Pe]=t.split("/");return new Date(parseInt(Pe),parseInt(A)-1,parseInt(Y))}return e},[a.selectedDate,t,e]),ge=B.useMemo(()=>[{id:"credit_1x",label:"Cartão de Crédito 1x",group:"credit"},{id:"credit_2x",label:"Cartão de Crédito 2x",group:"credit"},{id:"credit_3x",label:"Cartão de Crédito 3x",group:"credit"},{id:"credit_4x",label:"Cartão de Crédito 4x",group:"credit"},{id:"credit_5x",label:"Cartão de Crédito 5x",group:"credit"},{id:"debit",label:"Débito",group:"other"},{id:"cash",label:"Dinheiro",group:"other"},{id:"coins",label:"Moedas",group:"other"},{id:"deposit",label:"Depósito",group:"other"}],[]),le=Y=>{const A=Y.replace(/[^\d,]/g,"").replace(",","."),Pe=parseFloat(A);return isNaN(Pe)?"":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Pe)},oe=Y=>{const A=Y.target.value;f(A),g(null)},j=B.useCallback(()=>{var kt;if(g(null),w(null),!i){g("Selecione um método de pagamento");return}if(i.startsWith("credit")&&l===null){g("Informe se é link (Sim/Não)");return}const Y=parseFloat(u.replace(",",".").replace(/[^\d.-]/g,""));if(isNaN(Y)||Y<=0){g("Digite um valor válido maior que zero");return}const A=((kt=ge.find(L=>L.id===i))==null?void 0:kt.label)||"",Pe=i.startsWith("credit")&&l!==null?` / Link: ${l?"Sim":"Não"}`:"",Re=se(),Ne={id:`launch-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,date:Re,paymentType:`${A}${Pe}`,isLink:i.startsWith("credit")?l||!1:void 0,value:Y,timestamp:new Date};i==="credit_1x"&&(Ne.credit1x=Y),i==="credit_2x"&&(Ne.credit2x=Y),i==="credit_3x"&&(Ne.credit3x=Y),i==="credit_4x"&&(Ne.credit4x=Y),i==="credit_5x"&&(Ne.credit5x=Y);const De=[Ne,...d];h(De),Tg(De);const we={id:Ne.id,date:bn(Ne.date),description:Ne.paymentType,value:Ne.value,originalHistory:"Manual",source:"manual",cpf:"",conferredAt:new Date,conferredId:Ne.id};n.some(L=>L.conferredId===Ne.id)?w("Lançamento adicionado com sucesso"):(r(we),w("Lançamento criado e enviado para Conferência de Caixa")),f(""),ae.current&&ae.current.focus(),setTimeout(()=>w(null),3e3)},[i,l,u,se,d,n,r]),fe=B.useCallback(()=>{I("all"),s(Y=>({...Y,selectedDate:""})),x("Todos os filtros foram removidos"),setTimeout(()=>x(null),3e3),ae.current&&ae.current.focus()},[s]),ye=B.useCallback(Y=>{if(I(Y),Y==="all")x("Exibindo todos os tipos de pagamento");else{const A=ge.find(Pe=>Pe.id===Y);x(`Filtrado por: ${(A==null?void 0:A.label)||Y}`)}setTimeout(()=>x(null),3e3),ae.current&&ae.current.focus()},[ge]),O=Y=>{o(Y),g(null),Y.startsWith("credit")||c(null)},W=Y=>{y===Y?T(A=>A==="asc"?"desc":"asc"):(p(Y),T("asc"))},U=Y=>{q(Y),V(!0)},M=()=>{if(!F)return;const Y=d.filter(A=>A.id!==F.id);h(Y),Tg(Y),r&&r({id:F.id,conferredId:F.id,remove:!0}),w("Lançamento desfeito com sucesso"),V(!1),q(null),ae.current&&ae.current.focus(),setTimeout(()=>w(null),3e3)},Q=()=>{V(!1),q(null)},pe=[...d].sort((Y,A)=>{const Pe=k==="asc"?1:-1;return y==="date"?(Y.timestamp.getTime()-A.timestamp.getTime())*Pe:(Y.value-A.value)*Pe}),ke=se(),ce=pe.filter(Y=>{const A=Y.date.toDateString()===ke.toDateString();let Pe=!0;if(D!=="all"){const Re=Y.paymentType.toLowerCase().replace(/\s+/g,"_"),Ne=D.toString();if(Ne.startsWith("credit_")){Pe=Re.includes("crédito")||Re.includes("credito");const De=Ne.match(/credit_(\d+)x/);if(De){const we=De[1];Pe=Pe&&Re.includes(`${we}x`)}}else Ne==="debit"?Pe=Re.includes("débito")||Re.includes("debito"):Ne==="cash"?Pe=Re.includes("dinheiro"):Ne==="coins"?Pe=Re.includes("moedas"):Ne==="deposit"&&(Pe=Re.includes("depósito")||Re.includes("deposito"))}return A&&Pe}),ne={general:ce.reduce((Y,A)=>Y+A.value,0),credit1x:ce.reduce((Y,A)=>Y+(A.credit1x||0),0),credit2x:ce.reduce((Y,A)=>Y+(A.credit2x||0),0),credit3x:ce.reduce((Y,A)=>Y+(A.credit3x||0),0),credit4x:ce.reduce((Y,A)=>Y+(A.credit4x||0),0),credit5x:ce.reduce((Y,A)=>Y+(A.credit5x||0),0)};return B.useEffect(()=>{const Y=A=>{A.key==="Enter"&&ae.current===document.activeElement&&j()};return document.addEventListener("keydown",Y),()=>document.removeEventListener("keydown",Y)},[j]),m.jsxs(m.Fragment,{children:[m.jsx("aside",{className:"w-80 bg-gray-900 border-r border-gray-800 sticky top-32 self-start",children:m.jsxs("div",{className:"p-4 space-y-4",children:[m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-100 mb-3",children:"Selecionar Pagamento"}),m.jsxs("div",{className:"space-y-2 mb-3",children:[m.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Cartão de Crédito"}),ge.filter(Y=>Y.group==="credit").map(Y=>m.jsx("button",{onClick:()=>O(Y.id),className:`w-full text-left px-3 py-2 text-sm rounded-md transition-colors ${i===Y.id?"bg-indigo-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-gray-100"}`,"aria-label":Y.label,children:Y.label},Y.id)),(i==null?void 0:i.startsWith("credit"))&&m.jsxs("div",{className:"pl-3 space-y-2 mt-2",children:[m.jsx("p",{className:"text-xs text-gray-400",children:"É link?"}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:()=>c(!0),className:`flex-1 px-3 py-1 text-xs rounded-md transition-colors ${l===!0?"bg-green-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Sim"}),m.jsx("button",{onClick:()=>c(!1),className:`flex-1 px-3 py-1 text-xs rounded-md transition-colors ${l===!1?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Não"})]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Outros Métodos"}),ge.filter(Y=>Y.group==="other").map(Y=>m.jsx("button",{onClick:()=>O(Y.id),className:`w-full text-left px-3 py-2 text-sm rounded-md transition-colors ${i===Y.id?"bg-indigo-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-gray-100"}`,"aria-label":Y.label,children:Y.label},Y.id))]})]}),m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-100 mb-3",children:"Preencher Valor"}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("input",{ref:ae,type:"text",placeholder:"Digite o valor (ex: 123,45)",value:u,onChange:oe,className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Valor do lançamento"}),m.jsx("button",{onClick:j,disabled:!i||!u,className:"w-full px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Adicionar"})]}),v&&m.jsx("div",{className:"mt-2 p-2 bg-red-900/20 border border-red-400 rounded-md",children:m.jsx("p",{className:"text-xs text-red-400",children:v})}),_&&m.jsx("div",{className:"mt-2 p-2 bg-green-900/20 border border-green-400 rounded-md",children:m.jsx("p",{className:"text-xs text-green-400",children:_})})]}),m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-100 mb-3",children:"Filtrar por Data"}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"bg-gray-900 rounded p-2 border border-gray-600",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-xs text-gray-400",children:"Data atual:"}),m.jsx("span",{className:"text-sm text-indigo-400 font-medium",children:bn(ke)})]})}),m.jsx("input",{type:"date",value:a.selectedDate,onChange:Y=>s(A=>({...A,selectedDate:Y.target.value})),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500","aria-label":"Selecionar data para filtro"}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:()=>{x("Filtro aplicado"),setTimeout(()=>x(null),2e3),ae.current&&ae.current.focus()},className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:"Aplicar"}),m.jsx("button",{onClick:()=>{const Y=new Date().toISOString().split("T")[0];s(A=>({...A,selectedDate:Y})),x("Data de hoje selecionada"),setTimeout(()=>x(null),2e3),ae.current&&ae.current.focus()},className:"flex-1 px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Hoje"}),m.jsx("button",{onClick:()=>{s(Y=>({...Y,selectedDate:""})),x("Filtro limpo"),setTimeout(()=>x(null),2e3),ae.current&&ae.current.focus()},className:"flex-1 px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar"})]}),S&&m.jsx("div",{className:"p-2 bg-indigo-900/20 border border-indigo-400 rounded-md",children:m.jsx("p",{className:"text-xs text-indigo-400",children:S})}),ce.length===0&&d.length>0&&m.jsx("div",{className:"p-2 bg-yellow-900/20 border border-yellow-400 rounded-md",children:m.jsxs("p",{className:"text-xs text-yellow-400",children:["Nenhum lançamento encontrado para ",bn(ke)]})})]})]})]})}),m.jsx("main",{className:"flex-1 bg-gray-950 p-6 min-h-[calc(100vh-8rem)] min-w-0",children:m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 h-full flex flex-col",children:[m.jsxs("div",{className:"p-4 border-b border-gray-700",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Lançamentos Manuais"}),m.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[ce.length," lançamento(s) para ",bn(ke)]})]}),m.jsx("div",{className:"bg-gray-800 border-b border-gray-700 p-4",children:m.jsxs("div",{className:"flex flex-wrap gap-4",children:[m.jsxs("div",{className:"flex-1 min-w-[200px]",children:[m.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Filtrar por Tipo de Pagamento"}),m.jsxs("select",{value:D,onChange:Y=>ye(Y.target.value),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[m.jsx("option",{value:"all",children:"Todos"}),m.jsx("option",{value:"credit_1x",children:"Crédito 1x"}),m.jsx("option",{value:"credit_2x",children:"Crédito 2x"}),m.jsx("option",{value:"credit_3x",children:"Crédito 3x"}),m.jsx("option",{value:"credit_4x",children:"Crédito 4x"}),m.jsx("option",{value:"credit_5x",children:"Crédito 5x"}),m.jsx("option",{value:"debit",children:"Débito"}),m.jsx("option",{value:"cash",children:"Dinheiro"}),m.jsx("option",{value:"coins",children:"Moedas"}),m.jsx("option",{value:"deposit",children:"Depósito"})]})]}),m.jsx("div",{className:"flex items-end",children:m.jsx("button",{onClick:fe,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar Filtros"})})]})}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("table",{className:"w-full text-sm text-left text-gray-300",children:[m.jsx("thead",{className:"text-xs text-gray-400 uppercase bg-gray-900 sticky top-0",children:m.jsxs("tr",{children:[m.jsx("th",{scope:"col",className:"px-6 py-3 cursor-pointer hover:bg-gray-800",onClick:()=>W("date"),children:m.jsxs("div",{className:"flex items-center",children:["Data",m.jsx("svg",{className:"w-3 h-3 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:m.jsx("path",{d:"M5 12a1 1 0 102 0V6.414l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L5 6.414V12zM15 8a1 1 0 10-2 0v5.586l-1.293-1.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L15 13.586V8z"})})]})}),m.jsx("th",{scope:"col",className:"px-6 py-3",children:"Tipo de Pagamento"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 1x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 2x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 3x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 4x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Crédito 5x"}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-right cursor-pointer hover:bg-gray-800",onClick:()=>W("value"),children:m.jsxs("div",{className:"flex items-center justify-end",children:["Valor (R$)",m.jsx("svg",{className:"w-3 h-3 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:m.jsx("path",{d:"M5 12a1 1 0 102 0V6.414l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L5 6.414V12zM15 8a1 1 0 10-2 0v5.586l-1.293-1.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L15 13.586V8z"})})]})}),m.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Ações"})]})}),m.jsx("tbody",{children:ce.length===0?m.jsx("tr",{children:m.jsx("td",{colSpan:9,className:"px-6 py-8 text-center text-gray-500",children:"Nenhum lançamento registrado para esta data"})}):ce.map(Y=>m.jsxs("tr",{className:"bg-gray-800 border-b border-gray-700 hover:bg-gray-750",children:[m.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:bn(Y.date)}),m.jsx("td",{className:"px-6 py-4",children:m.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-700 text-gray-300",children:Y.paymentType})}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:Y.credit1x?le(Y.credit1x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:Y.credit2x?le(Y.credit2x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:Y.credit3x?le(Y.credit3x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:Y.credit4x?le(Y.credit4x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono",children:Y.credit5x?le(Y.credit5x.toString()):"-"}),m.jsx("td",{className:"px-6 py-4 text-right font-mono text-green-400",children:le(Y.value.toString())}),m.jsx("td",{className:"px-6 py-4 text-center",children:m.jsx("button",{onClick:()=>U(Y),className:"px-2 py-1 text-xs font-medium text-red-300 bg-red-900/20 border border-red-600 rounded hover:bg-red-900/30 transition-colors","aria-label":"Desfazer lançamento",children:"Desfazer"})})]},Y.id))}),ce.length>0&&m.jsx("tfoot",{className:"text-xs text-gray-300 bg-gray-900 border-t-2 border-indigo-500",children:m.jsxs("tr",{children:[m.jsx("td",{colSpan:2,className:"px-6 py-3 font-semibold",children:"Total Geral"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:ne.credit1x>0?le(ne.credit1x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:ne.credit2x>0?le(ne.credit2x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:ne.credit3x>0?le(ne.credit3x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:ne.credit4x>0?le(ne.credit4x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold",children:ne.credit5x>0?le(ne.credit5x.toString()):"-"}),m.jsx("td",{className:"px-6 py-3 text-right font-mono font-semibold text-green-400",children:le(ne.general.toString())}),m.jsx("td",{className:"px-6 py-3"})]})})]})})]})}),z&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 p-6 max-w-md w-full mx-4",children:m.jsxs("div",{className:"flex items-start",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-6 w-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("h3",{className:"text-lg font-medium text-gray-100 mb-2",children:"Confirmar Desfazer"}),m.jsx("p",{className:"text-sm text-gray-300 mb-6",children:"Tem certeza que deseja desfazer este lançamento? Ele será removido de todas as abas."}),F&&m.jsx("div",{className:"bg-gray-900 rounded p-3 mb-4 border border-gray-700",children:m.jsxs("div",{className:"text-xs text-gray-400",children:[m.jsxs("p",{children:["Tipo: ",F.paymentType]}),m.jsxs("p",{children:["Valor: ",le(F.value.toString())]}),m.jsxs("p",{children:["Data: ",bn(F.date)]})]})}),m.jsxs("div",{className:"flex space-x-3",children:[m.jsx("button",{onClick:M,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500 transition-colors",children:"Confirmar"}),m.jsx("button",{onClick:Q,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-gray-500 transition-colors",children:"Cancelar"})]})]})]})})})]})};function J7(e,t){const[r,n]=B.useState(e);return B.useEffect(()=>{const a=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}const Q7=()=>{const{user:e,logout:t}=Iu(),[r,n]=R_(),[a,s]=Vr("dashboard_active_tab","banking"),[i,o]=Vr("dashboard_show_history",!1),[l,c]=B.useState(null),[u,f]=B.useState(to()),[d,h]=B.useState("automatic"),[v,g]=B.useState(!1),[_,w]=B.useState(null),[y,p]=B.useState([]),[k,T]=Vr("dashboard_parse_result",null),[S,x]=B.useState(null),[D,I]=Vr("dashboard_conferred_items",[],{serialize:te=>JSON.stringify(te.map(re=>({...re,conferredAt:re.conferredAt.toISOString()}))),deserialize:te=>JSON.parse(te).map(re=>{let Ee=new Date;try{if(re.conferredAt){const Oe=new Date(re.conferredAt);isNaN(Oe.getTime())||(Ee=Oe)}}catch{console.warn("Invalid conferredAt value:",re.conferredAt)}return{...re,conferredAt:Ee}})}),[z,V]=Vr("dashboard_transferred_ids",new Set,{serialize:te=>JSON.stringify(Array.from(te)),deserialize:te=>new Set(JSON.parse(te))}),[F,q]=Vr("dashboard_not_found_history",[],{serialize:te=>JSON.stringify(te.map(re=>({...re,timestamp:re.timestamp.toISOString()}))),deserialize:te=>JSON.parse(te).map(re=>{let Ee=new Date;try{if(re.timestamp){const Oe=new Date(re.timestamp);isNaN(Oe.getTime())||(Ee=Oe)}}catch{console.warn("Invalid timestamp value:",re.timestamp)}return{...re,timestamp:Ee}})}),[ae,se]=B.useState(!1),[ge,le]=B.useState([]),[oe,j]=B.useState(!1),[fe,ye]=B.useState(null),[O,W]=B.useState(null),[U,M]=B.useState(!1),[Q,pe]=B.useState(null),[ke,ce]=B.useState([]),[ne,Y]=B.useState(!1),A=J7(r.conferenceValue,300);B.useEffect(()=>{if(A&&(k!=null&&k.data)&&S)if(Eg(A).isValid){const re=xg(A,k.data,S);pe(re.matches.length)}else pe(null);else pe(null)},[A,k,S]),B.useEffect(()=>{if(k&&k.data&&k.data.length>0&&!S){console.log("Creating value index from persistent data...");const te=kg(k.data);x(te),console.log(`Índice criado com ${te.size} valores únicos`)}},[k]);const Pe=te=>{var Ee;const re=(Ee=te.target.files)==null?void 0:Ee[0];console.log("File selected:",re),re&&(console.log("File details:",{name:re.name,size:re.size,type:re.type}),c(re),w(null))},Re=async()=>{if(console.log("handleLoadFile called, selectedFile:",l),!l){console.log("No file selected");return}console.log("Starting file processing..."),g(!0),w(null);try{const te=Date.now();console.log("Calling parseExcelFile...");const re=await O_(l);console.log("parseExcelFile result:",re);const Ee=Date.now()-te;if(re.success){T(re);const Oe=kg(re.data);x(Oe),console.log(`Índice criado com ${Oe.size} valores únicos`),console.log(`Arquivo processado em ${Ee}ms`),console.log(`Linhas processadas: ${re.stats.totalRows}`),console.log(`Linhas válidas: ${re.stats.validRows}`),console.log(`Avisos: ${re.warnings.length}`);try{await ii.saveBankingUpload(re.data,l.name,u,d),console.log("Data saved to database successfully")}catch(Xe){console.error("Error saving to database:",Xe)}}else w(re.errors.join(`
`)),T(null)}catch(te){w(`Erro ao processar arquivo: ${te instanceof Error?te.message:"Erro desconhecido"}`),T(null)}finally{g(!1)}},Ne=()=>{c(null),T(null),x(null),w(null),V(new Set),I([]),q([]);const te=document.getElementById("fileInput");te&&(te.value="")},De=()=>{if(!r.selectedDate){ye("Selecione uma data para carregar o histórico.");return}console.log("Carregando histórico para data:",r.selectedDate);try{if(!r.selectedDate||r.selectedDate==="Invalid Date"){ye("Data inválida selecionada.");return}const te=new Date(r.selectedDate+"T00:00:00"),re=bn(te),Ee=D.filter(wr=>{if(!wr.conferredAt)return!1;const Jr=new Date(wr.conferredAt);return!isNaN(Jr.getTime())&&Jr.toDateString()===te.toDateString()}),Oe=F.filter(wr=>{if(!wr.timestamp)return!1;const Jr=new Date(wr.timestamp);return!isNaN(Jr.getTime())&&Jr.toDateString()===te.toDateString()}),Xe=Ee.length,Zt=Oe.length,or=Ee.reduce((wr,Jr)=>wr+Jr.value,0);if(Xe===0&&Zt===0)ye(`Nenhum registro encontrado para ${re}.`),ce([]),Y(!1);else{const wr=[`Histórico de ${re}:`,`• ${Xe} conferências realizadas`,`• ${Zt} valores não encontrados`,or>0?`• Valor total: ${new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(or)}`:""].filter(Boolean).join(`
`);W(wr),setTimeout(()=>W(null),5e3),ce(Ee),Y(!0),Xe>0&&s("cash")}}catch(te){console.error("Erro ao filtrar por data:",te),ye("Erro ao carregar histórico. Verifique a data selecionada.")}},we=()=>{M(!0)},rt=()=>{I([]),V(new Set),q([]),Se(""),ye(null),W("Dia atual reiniciado com sucesso."),setTimeout(()=>W(null),3e3),M(!1),setTimeout(()=>{const te=document.querySelector('input[placeholder*="Digite o valor"]');te&&(te.focus(),te.select())},100)},kt=()=>{M(!1)},L=B.useCallback(async()=>{if(!k||!k.data){ye("Carregue uma planilha para usar esta função.");return}const te=Eg(r.conferenceValue);if(!te.isValid){ye(te.error||"Valor inválido");return}se(!0),ye(null),W(null);try{const re=xg(r.conferenceValue,k.data,S||void 0);if(!re.hasMatches){const Oe=parseFloat(r.conferenceValue.replace(",",".").replace(/[^\d.-]/g,"")),Zt={value:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(isNaN(Oe)?0:Oe),timestamp:new Date,status:"not_found"};q(or=>[Zt,...or]);try{await ii.saveNotFound(r.conferenceValue,u)}catch(or){console.error("Error saving not found to database:",or)}ye("Valor não encontrado nos dados carregados."),W("Valor salvo no histórico de não encontrados."),setTimeout(()=>W(null),3e3),Se(""),setTimeout(()=>{const or=document.querySelector('input[placeholder*="Digite o valor"]');or&&(or.focus(),or.select())},100),se(!1);return}const Ee=re.matches.filter(Oe=>!D.some(Xe=>Xe.id===Oe.id));if(Ee.length===0){ye("Este valor já foi conferido."),se(!1);return}Ee.length===1?await H(Ee[0]):(le(Ee),j(!0))}catch{ye("Erro ao buscar valor. Tente novamente.")}finally{se(!1)}},[r.conferenceValue,k,D,u]),H=B.useCallback(async te=>{const re=`conf-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Ee={...te,conferredAt:new Date,conferredId:re};I(Oe=>[...Oe,Ee]),V(Oe=>new Set([...Oe,te.id]));try{await ii.saveCashConference(te,u,"conferred")}catch(Oe){console.error("Error saving conference to database:",Oe)}Se(""),W("Valor encontrado e transferido para Conferência de Caixa."),setTimeout(()=>{const Oe=document.querySelector('input[placeholder*="Digite o valor"]');Oe&&(Oe.focus(),Oe.select())},100),setTimeout(()=>W(null),3e3)},[u]),J=B.useCallback(te=>{H(te),j(!1),le([])},[H]),_e=B.useCallback(()=>{j(!1),le([]),se(!1)},[]),me=B.useCallback(te=>{const re=D.find(Ee=>Ee.conferredId===te);re&&(I(Ee=>Ee.filter(Oe=>Oe.conferredId!==te)),V(Ee=>{const Oe=new Set(Ee);return Oe.delete(re.id),Oe}))},[D]),ue=te=>{s(te),ye(null),W(null)},Se=te=>{n(re=>({...re,conferenceValue:te}))},Be=te=>{Se(te),ye(null),W(null)},Fe=B.useCallback(te=>{if(te.remove)I(re=>re.filter(Ee=>Ee.conferredId!==te.conferredId));else{const re={id:te.id,date:te.date,description:te.description,value:te.value,cpf:te.cpf||"",originalHistory:te.originalHistory,source:te.source,conferredAt:te.conferredAt,conferredId:te.conferredId};I(Ee=>[...Ee,re])}},[]);return m.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-black",children:[m.jsx("header",{className:"bg-gray-900 shadow-lg border-b border-gray-800",children:m.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[m.jsxs("div",{className:"flex justify-between items-center h-16",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("img",{src:Z2,alt:"Manipularium Logo",className:"h-8 w-auto drop-shadow-lg"}),m.jsx("h1",{className:"ml-3 text-xl font-semibold text-gray-100",children:"Manipularium - Sistema de Conferência"})]}),m.jsxs("div",{className:"flex items-center space-x-4",children:[m.jsx("span",{className:"text-sm text-gray-300",children:m.jsx("strong",{className:"text-gray-100",children:e==null?void 0:e.username})}),m.jsxs("button",{onClick:t,className:"inline-flex items-center px-3 py-2 border border-gray-700 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-300 bg-gray-800 hover:bg-gray-700 hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-colors",children:[m.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sair"]})]})]}),m.jsxs("div",{className:"flex space-x-1 border-t border-gray-800 pt-2",children:[m.jsx("button",{onClick:()=>ue("launches"),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${a==="launches"?"bg-gray-800 text-gray-100 border-b-2 border-indigo-500":"text-gray-400 hover:text-gray-100 hover:bg-gray-800/50"}`,children:"Lançamentos"}),m.jsxs("button",{onClick:()=>ue("banking"),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${a==="banking"?"bg-gray-800 text-gray-100 border-b-2 border-indigo-500":"text-gray-400 hover:text-gray-100 hover:bg-gray-800/50"}`,children:["Conferência Bancária",k&&m.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-indigo-600 text-white rounded-full",children:k.stats.totalRows-z.size})]}),m.jsxs("button",{onClick:()=>ue("cash"),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${a==="cash"?"bg-gray-800 text-gray-100 border-b-2 border-indigo-500":"text-gray-400 hover:text-gray-100 hover:bg-gray-800/50"}`,children:["Conferência de Caixa",D.length>0&&m.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-green-600 text-white rounded-full",children:D.length})]})]})]})}),m.jsx("div",{className:"flex min-h-[calc(100vh-8rem)]",children:a==="launches"?m.jsx(q7,{currentDate:u?(()=>{try{const[te,re,Ee]=u.split("/");return new Date(parseInt(Ee),parseInt(re)-1,parseInt(te))}catch{return new Date}})():new Date,operationDate:u,onLaunchAdded:Fe,conferredItems:D}):a==="banking"?m.jsxs(m.Fragment,{children:[m.jsx("aside",{className:"w-80 bg-gray-900 border-r border-gray-800 sticky top-32 self-start",children:m.jsxs("div",{className:"p-4 space-y-4",children:[m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"1"}),"Carregar Planilha"]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("input",{type:"file",id:"fileInput",accept:".xlsx,.xls,.csv",onChange:Pe,className:"hidden"}),m.jsx("label",{htmlFor:"fileInput",className:"block w-full px-3 py-2 text-sm text-gray-300 bg-gray-700 border border-gray-600 rounded-md cursor-pointer hover:bg-gray-600 transition-colors text-center",onClick:()=>console.log("Label clicked"),children:l?`✅ ${l.name}`:"📁 Escolher arquivo"}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:Re,disabled:!l||v,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:v?"Processando...":"Carregar"}),m.jsx("button",{onClick:Ne,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar"})]})]})]}),m.jsx(Z7,{selectedFile:l,onDateSelected:(te,re)=>{f(te),h(re)}}),m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs",children:"3"}),"Conferir Valor"]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"relative",children:[m.jsx("input",{type:"text",placeholder:"Digite o valor (ex: 123,45)",value:r.conferenceValue,onChange:te=>Be(te.target.value),onKeyDown:te=>te.key==="Enter"&&!ae&&L(),disabled:!k||ae,className:"w-full px-3 py-2 pr-20 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"}),Q!==null&&m.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:m.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${Q>0?"bg-green-900/50 text-green-400 border border-green-600":"bg-red-900/50 text-red-400 border border-red-600"}`,children:Q>0?`${Q} ${Q===1?"resultado":"resultados"}`:"Sem resultados"})})]}),m.jsx("button",{onClick:L,disabled:!k||ae||!r.conferenceValue.trim(),className:"w-full px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:ae?m.jsxs(m.Fragment,{children:[m.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Buscando..."]}):"OK"}),fe&&m.jsx("div",{className:"p-2 bg-red-900/20 border border-red-400 rounded-md",children:m.jsx("p",{className:"text-xs text-red-400",children:fe})}),O&&m.jsx("div",{className:"p-2 bg-green-900/20 border border-green-400 rounded-md",children:m.jsx("p",{className:"text-xs text-green-400",children:O})}),!k&&m.jsx("div",{className:"p-2 bg-gray-700 border border-gray-600 rounded-md",children:m.jsx("p",{className:"text-xs text-gray-400",children:"Carregue uma planilha para usar esta função"})}),m.jsx("button",{onClick:we,className:"w-full px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Reiniciar dia atual"}),m.jsxs("button",{onClick:()=>o(!i),className:"w-full px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors flex items-center justify-between",children:[m.jsx("span",{children:"Histórico de valores não encontrados"}),m.jsxs("div",{className:"flex items-center space-x-2",children:[F.length>0&&m.jsx("span",{className:"px-2 py-1 text-xs bg-red-600 text-white rounded-full",children:F.length}),m.jsx("svg",{className:`w-4 h-4 transform transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),i&&m.jsx("div",{className:"mt-2 p-2 bg-gray-900 rounded-md border border-gray-700 max-h-40 overflow-y-auto",children:F.length===0?m.jsx("p",{className:"text-xs text-gray-400",children:"Nenhum valor não encontrado"}):m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2",children:[m.jsxs("span",{className:"text-xs font-medium text-gray-300",children:[F.length," valor(es) não encontrado(s)"]}),m.jsx("button",{onClick:()=>q([]),className:"text-xs text-red-400 hover:text-red-300 transition-colors",title:"Limpar histórico",children:"Limpar"})]}),F.map((te,re)=>m.jsxs("div",{className:"bg-gray-800 rounded p-2 border border-gray-600",children:[m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsx("span",{className:"text-xs text-gray-200 font-mono",children:te.value}),m.jsx("span",{className:"text-xs text-red-400 bg-red-900/30 px-1 rounded",children:"Não encontrado"})]}),m.jsx("div",{className:"mt-1 text-xs text-gray-400",children:new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format(te.timestamp)})]},re))]})})]})]}),m.jsx(X7,{onDataLoaded:te=>{p(te);const re=te.filter(Ee=>Ee.operation_type==="cash_conference"&&Ee.status==="conferred").map(Ee=>({...Ee.metadata,conferredAt:(()=>{try{const Oe=Ee.conferred_at||Ee.operation_timestamp||"";return Oe?new Date(Oe):new Date}catch{return new Date}})(),conferredId:Ee.id||`hist-${Ee.operation_timestamp}`}));re.length>0&&(ce(re),Y(!0),s("cash"))}})]})}),m.jsx("main",{className:"flex-1 bg-gray-950 p-6 min-h-[calc(100vh-8rem)] min-w-0",children:v?m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 min-h-full p-8 flex items-center justify-center",children:m.jsxs("div",{className:"text-center",children:[m.jsxs("svg",{className:"animate-spin h-12 w-12 text-indigo-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[m.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),m.jsx("p",{className:"mt-4 text-gray-300",children:"Processando arquivo..."})]})}):_?m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 min-h-full p-8",children:m.jsx("div",{className:"max-w-md mx-auto",children:m.jsx("div",{className:"bg-red-900/20 border border-red-400 rounded-md p-4",children:m.jsxs("div",{className:"flex",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:m.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),m.jsxs("div",{className:"ml-3",children:[m.jsx("h3",{className:"text-sm font-medium text-red-400",children:"Erro ao processar arquivo"}),m.jsx("div",{className:"mt-2 text-sm text-red-300",children:m.jsx("p",{style:{whiteSpace:"pre-line"},children:_})}),m.jsx("div",{className:"mt-4",children:m.jsx("button",{onClick:Ne,className:"px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Tentar novamente"})})]})]})})})}):k?m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 min-h-[calc(100vh-12rem)] flex flex-col overflow-auto",children:[k.warnings.length>0&&m.jsx("div",{className:"bg-yellow-900/20 border-b border-yellow-700 p-4",children:m.jsxs("div",{className:"flex items-start",children:[m.jsx("svg",{className:"h-5 w-5 text-yellow-400 mt-0.5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:m.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("h3",{className:"text-sm font-medium text-yellow-400",children:"Avisos encontrados durante o processamento"}),m.jsxs("div",{className:"mt-2 text-xs text-yellow-300 max-h-20 overflow-y-auto",children:[k.warnings.slice(0,5).map((te,re)=>m.jsx("p",{children:te},re)),k.warnings.length>5&&m.jsxs("p",{className:"mt-1 font-semibold",children:["... e mais ",k.warnings.length-5," avisos"]})]})]})]})}),m.jsx(H7,{data:k.data,stats:k.stats,transferredIds:z})]}):m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 min-h-full p-8",children:m.jsx("div",{className:"flex items-center justify-center h-full",children:m.jsxs("div",{className:"text-center",children:[m.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),m.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-300",children:"Conferência Bancária"}),m.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Carregue uma planilha para começar a conferir valores."})]})})})})]}):m.jsxs(m.Fragment,{children:[m.jsx("aside",{className:"w-80 bg-gray-900 border-r border-gray-800 sticky top-32 self-start",children:m.jsx("div",{className:"p-4",children:m.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-100 mb-3 flex items-center",children:[m.jsx("svg",{className:"w-5 h-5 text-indigo-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Filtrar por Data"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Data específica"}),m.jsx("input",{type:"date",value:r.selectedDate,onChange:te=>n(re=>({...re,selectedDate:te.target.value})),className:"w-full px-3 py-2 text-sm text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),m.jsx("button",{onClick:De,className:"w-full px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:"Aplicar Filtro"}),m.jsx("button",{onClick:()=>n(te=>({...te,selectedDate:""})),className:"w-full px-3 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 transition-colors",children:"Limpar Filtro"})]}),m.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-700",children:[m.jsx("h4",{className:"text-xs font-medium text-gray-400 mb-3",children:"Resumo"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsx("span",{className:"text-gray-400",children:"Total de itens:"}),m.jsx("span",{className:"text-gray-200 font-medium",children:D.length})]}),m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsx("span",{className:"text-gray-400",children:"Valor total:"}),m.jsx("span",{className:"text-green-400 font-medium",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(D.reduce((te,re)=>te+re.value,0))})]}),D.length>0&&m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsx("span",{className:"text-gray-400",children:"Última conferência:"}),m.jsx("span",{className:"text-gray-200 font-medium",children:new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format([...D].sort((te,re)=>re.conferredAt.getTime()-te.conferredAt.getTime())[0].conferredAt)})]})]})]})]})})}),m.jsx("main",{className:"flex-1 bg-gray-950 p-6 min-h-[calc(100vh-8rem)] min-w-0",children:m.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 h-full",children:[ne&&m.jsx("div",{className:"bg-indigo-900/20 border-b border-indigo-700 p-3",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("svg",{className:"w-4 h-4 text-indigo-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),m.jsxs("span",{className:"text-sm font-medium text-indigo-400",children:["Filtrado por: ",r.selectedDate&&bn(r.selectedDate)]})]}),m.jsxs("span",{className:"text-xs text-indigo-300",children:[ke.length," registro(s)"]})]})}),m.jsx(K7,{conferredItems:ne?ke:D,onRemoveItem:me})]})})]})}),m.jsx(G7,{isOpen:oe,matches:ge,searchValue:ge.length>0?ge[0].value:0,onSelect:J,onClose:_e}),U&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 p-6 max-w-md w-full mx-4",children:m.jsxs("div",{className:"flex items-start",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-6 w-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("h3",{className:"text-lg font-medium text-gray-100 mb-2",children:"Confirmar Reinício"}),m.jsx("p",{className:"text-sm text-gray-300 mb-6",children:"Tem certeza que deseja reiniciar o dia atual? Todos os dados transferidos e históricos serão apagados."}),m.jsxs("div",{className:"flex space-x-3",children:[m.jsx("button",{onClick:rt,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500 transition-colors",children:"Confirmar"}),m.jsx("button",{onClick:kt,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-gray-500 transition-colors",children:"Cancelar"})]})]})]})})})]})};class eL extends B.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null,errorInfo:null},this.handleReload=()=>{window.location.reload()},this.handleClearStorage=()=>{localStorage.clear(),window.location.reload()}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,r){console.error("ErrorBoundary caught an error:",t,r),this.setState({error:t,errorInfo:r})}render(){return this.state.hasError?m.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-black flex items-center justify-center p-4",children:m.jsx("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-700 p-6 max-w-2xl w-full",children:m.jsxs("div",{className:"flex items-start mb-4",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-8 w-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),m.jsxs("div",{className:"ml-3 flex-1",children:[m.jsx("h1",{className:"text-xl font-semibold text-gray-100 mb-2",children:"Erro na Aplicação"}),m.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Ocorreu um erro inesperado. Isso pode ser causado por dados corrompidos no armazenamento local ou um problema na aplicação."}),!1,m.jsxs("div",{className:"flex space-x-3",children:[m.jsx("button",{onClick:this.handleReload,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-indigo-500 transition-colors",children:"Recarregar Página"}),m.jsx("button",{onClick:this.handleClearStorage,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-gray-500 transition-colors",children:"Limpar Dados e Recarregar"})]}),m.jsx("p",{className:"mt-3 text-xs text-gray-400",children:"Se o problema persistir, entre em contato com o suporte técnico."})]})]})})}):this.props.children}}function tL(){const{user:e,isLoading:t}=Iu();return t?m.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 to-black",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),m.jsx("p",{className:"text-gray-400",children:"Carregando..."})]})}):m.jsxs(u3,{children:[m.jsx(pc,{path:"/",element:e?m.jsx(Fd,{to:"/dashboard",replace:!0}):m.jsx(IC,{})}),m.jsx(pc,{path:"/dashboard",element:m.jsx(DC,{children:m.jsx(Q7,{})})}),m.jsx(pc,{path:"*",element:m.jsx(Fd,{to:"/",replace:!0})})]})}function rL(){return m.jsx(eL,{children:m.jsx(sS,{children:m.jsx(tL,{})})})}jy(document.getElementById("root")).render(m.jsx(B.StrictMode,{children:m.jsx(I3,{children:m.jsx(rL,{})})}));
